function f_(e,t){for(var n=0;n<t.length;n++){const a=t[n];if(typeof a!="string"&&!Array.isArray(a)){for(const s in a)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(a,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>a[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Rm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Og={exports:{}},dd={},_g={exports:{}},vr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N2;function p_(){if(N2)return vr;N2=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;function g(H){return H===null||typeof H!="object"?null:(H=f&&H[f]||H["@@iterator"],typeof H=="function"?H:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function y(H,te,fe){this.props=H,this.context=te,this.refs=w,this.updater=fe||N}y.prototype.isReactComponent={},y.prototype.setState=function(H,te){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,te,"setState")},y.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function E(){}E.prototype=y.prototype;function O(H,te,fe){this.props=H,this.context=te,this.refs=w,this.updater=fe||N}var T=O.prototype=new E;T.constructor=O,v(T,y.prototype),T.isPureReactComponent=!0;var A=Array.isArray,I=Object.prototype.hasOwnProperty,C={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function F(H,te,fe){var Le,he={},K=null,be=null;if(te!=null)for(Le in te.ref!==void 0&&(be=te.ref),te.key!==void 0&&(K=""+te.key),te)I.call(te,Le)&&!P.hasOwnProperty(Le)&&(he[Le]=te[Le]);var re=arguments.length-2;if(re===1)he.children=fe;else if(1<re){for(var ie=Array(re),ne=0;ne<re;ne++)ie[ne]=arguments[ne+2];he.children=ie}if(H&&H.defaultProps)for(Le in re=H.defaultProps,re)he[Le]===void 0&&(he[Le]=re[Le]);return{$$typeof:e,type:H,key:K,ref:be,props:he,_owner:C.current}}function R(H,te){return{$$typeof:e,type:H.type,key:te,ref:H.ref,props:H.props,_owner:H._owner}}function $(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function L(H){var te={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(fe){return te[fe]})}var G=/\/+/g;function X(H,te){return typeof H=="object"&&H!==null&&H.key!=null?L(""+H.key):te.toString(36)}function me(H,te,fe,Le,he){var K=typeof H;(K==="undefined"||K==="boolean")&&(H=null);var be=!1;if(H===null)be=!0;else switch(K){case"string":case"number":be=!0;break;case"object":switch(H.$$typeof){case e:case t:be=!0}}if(be)return be=H,he=he(be),H=Le===""?"."+X(be,0):Le,A(he)?(fe="",H!=null&&(fe=H.replace(G,"$&/")+"/"),me(he,te,fe,"",function(ne){return ne})):he!=null&&($(he)&&(he=R(he,fe+(!he.key||be&&be.key===he.key?"":(""+he.key).replace(G,"$&/")+"/")+H)),te.push(he)),1;if(be=0,Le=Le===""?".":Le+":",A(H))for(var re=0;re<H.length;re++){K=H[re];var ie=Le+X(K,re);be+=me(K,te,fe,ie,he)}else if(ie=g(H),typeof ie=="function")for(H=ie.call(H),re=0;!(K=H.next()).done;)K=K.value,ie=Le+X(K,re++),be+=me(K,te,fe,ie,he);else if(K==="object")throw te=String(H),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.");return be}function se(H,te,fe){if(H==null)return H;var Le=[],he=0;return me(H,Le,"","",function(K){return te.call(fe,K,he++)}),Le}function ee(H){if(H._status===-1){var te=H._result;te=te(),te.then(function(fe){(H._status===0||H._status===-1)&&(H._status=1,H._result=fe)},function(fe){(H._status===0||H._status===-1)&&(H._status=2,H._result=fe)}),H._status===-1&&(H._status=0,H._result=te)}if(H._status===1)return H._result.default;throw H._result}var W={current:null},U={transition:null},Q={ReactCurrentDispatcher:W,ReactCurrentBatchConfig:U,ReactCurrentOwner:C};function Y(){throw Error("act(...) is not supported in production builds of React.")}return vr.Children={map:se,forEach:function(H,te,fe){se(H,function(){te.apply(this,arguments)},fe)},count:function(H){var te=0;return se(H,function(){te++}),te},toArray:function(H){return se(H,function(te){return te})||[]},only:function(H){if(!$(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},vr.Component=y,vr.Fragment=n,vr.Profiler=s,vr.PureComponent=O,vr.StrictMode=a,vr.Suspense=u,vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,vr.act=Y,vr.cloneElement=function(H,te,fe){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var Le=v({},H.props),he=H.key,K=H.ref,be=H._owner;if(te!=null){if(te.ref!==void 0&&(K=te.ref,be=C.current),te.key!==void 0&&(he=""+te.key),H.type&&H.type.defaultProps)var re=H.type.defaultProps;for(ie in te)I.call(te,ie)&&!P.hasOwnProperty(ie)&&(Le[ie]=te[ie]===void 0&&re!==void 0?re[ie]:te[ie])}var ie=arguments.length-2;if(ie===1)Le.children=fe;else if(1<ie){re=Array(ie);for(var ne=0;ne<ie;ne++)re[ne]=arguments[ne+2];Le.children=re}return{$$typeof:e,type:H.type,key:he,ref:K,props:Le,_owner:be}},vr.createContext=function(H){return H={$$typeof:l,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:i,_context:H},H.Consumer=H},vr.createElement=F,vr.createFactory=function(H){var te=F.bind(null,H);return te.type=H,te},vr.createRef=function(){return{current:null}},vr.forwardRef=function(H){return{$$typeof:d,render:H}},vr.isValidElement=$,vr.lazy=function(H){return{$$typeof:p,_payload:{_status:-1,_result:H},_init:ee}},vr.memo=function(H,te){return{$$typeof:m,type:H,compare:te===void 0?null:te}},vr.startTransition=function(H){var te=U.transition;U.transition={};try{H()}finally{U.transition=te}},vr.unstable_act=Y,vr.useCallback=function(H,te){return W.current.useCallback(H,te)},vr.useContext=function(H){return W.current.useContext(H)},vr.useDebugValue=function(){},vr.useDeferredValue=function(H){return W.current.useDeferredValue(H)},vr.useEffect=function(H,te){return W.current.useEffect(H,te)},vr.useId=function(){return W.current.useId()},vr.useImperativeHandle=function(H,te,fe){return W.current.useImperativeHandle(H,te,fe)},vr.useInsertionEffect=function(H,te){return W.current.useInsertionEffect(H,te)},vr.useLayoutEffect=function(H,te){return W.current.useLayoutEffect(H,te)},vr.useMemo=function(H,te){return W.current.useMemo(H,te)},vr.useReducer=function(H,te,fe){return W.current.useReducer(H,te,fe)},vr.useRef=function(H){return W.current.useRef(H)},vr.useState=function(H){return W.current.useState(H)},vr.useSyncExternalStore=function(H,te,fe){return W.current.useSyncExternalStore(H,te,fe)},vr.useTransition=function(){return W.current.useTransition()},vr.version="18.3.1",vr}var S2;function Su(){return S2||(S2=1,_g.exports=p_()),_g.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C2;function g_(){if(C2)return dd;C2=1;var e=Su(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(d,u,m){var p,f={},g=null,N=null;m!==void 0&&(g=""+m),u.key!==void 0&&(g=""+u.key),u.ref!==void 0&&(N=u.ref);for(p in u)a.call(u,p)&&!i.hasOwnProperty(p)&&(f[p]=u[p]);if(d&&d.defaultProps)for(p in u=d.defaultProps,u)f[p]===void 0&&(f[p]=u[p]);return{$$typeof:t,type:d,key:g,ref:N,props:f,_owner:s.current}}return dd.Fragment=n,dd.jsx=l,dd.jsxs=l,dd}var k2;function x_(){return k2||(k2=1,Og.exports=g_()),Og.exports}var r=x_(),$m={},Mg={exports:{}},La={},Rg={exports:{}},$g={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A2;function y_(){return A2||(A2=1,(function(e){function t(U,Q){var Y=U.length;U.push(Q);e:for(;0<Y;){var H=Y-1>>>1,te=U[H];if(0<s(te,Q))U[H]=Q,U[Y]=te,Y=H;else break e}}function n(U){return U.length===0?null:U[0]}function a(U){if(U.length===0)return null;var Q=U[0],Y=U.pop();if(Y!==Q){U[0]=Y;e:for(var H=0,te=U.length,fe=te>>>1;H<fe;){var Le=2*(H+1)-1,he=U[Le],K=Le+1,be=U[K];if(0>s(he,Y))K<te&&0>s(be,he)?(U[H]=be,U[K]=Y,H=K):(U[H]=he,U[Le]=Y,H=Le);else if(K<te&&0>s(be,Y))U[H]=be,U[K]=Y,H=K;else break e}}return Q}function s(U,Q){var Y=U.sortIndex-Q.sortIndex;return Y!==0?Y:U.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var u=[],m=[],p=1,f=null,g=3,N=!1,v=!1,w=!1,y=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(U){for(var Q=n(m);Q!==null;){if(Q.callback===null)a(m);else if(Q.startTime<=U)a(m),Q.sortIndex=Q.expirationTime,t(u,Q);else break;Q=n(m)}}function A(U){if(w=!1,T(U),!v)if(n(u)!==null)v=!0,ee(I);else{var Q=n(m);Q!==null&&W(A,Q.startTime-U)}}function I(U,Q){v=!1,w&&(w=!1,E(F),F=-1),N=!0;var Y=g;try{for(T(Q),f=n(u);f!==null&&(!(f.expirationTime>Q)||U&&!L());){var H=f.callback;if(typeof H=="function"){f.callback=null,g=f.priorityLevel;var te=H(f.expirationTime<=Q);Q=e.unstable_now(),typeof te=="function"?f.callback=te:f===n(u)&&a(u),T(Q)}else a(u);f=n(u)}if(f!==null)var fe=!0;else{var Le=n(m);Le!==null&&W(A,Le.startTime-Q),fe=!1}return fe}finally{f=null,g=Y,N=!1}}var C=!1,P=null,F=-1,R=5,$=-1;function L(){return!(e.unstable_now()-$<R)}function G(){if(P!==null){var U=e.unstable_now();$=U;var Q=!0;try{Q=P(!0,U)}finally{Q?X():(C=!1,P=null)}}else C=!1}var X;if(typeof O=="function")X=function(){O(G)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,se=me.port2;me.port1.onmessage=G,X=function(){se.postMessage(null)}}else X=function(){y(G,0)};function ee(U){P=U,C||(C=!0,X())}function W(U,Q){F=y(function(){U(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){v||N||(v=!0,ee(I))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(U){switch(g){case 1:case 2:case 3:var Q=3;break;default:Q=g}var Y=g;g=Q;try{return U()}finally{g=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,Q){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var Y=g;g=U;try{return Q()}finally{g=Y}},e.unstable_scheduleCallback=function(U,Q,Y){var H=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?H+Y:H):Y=H,U){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=Y+te,U={id:p++,callback:Q,priorityLevel:U,startTime:Y,expirationTime:te,sortIndex:-1},Y>H?(U.sortIndex=Y,t(m,U),n(u)===null&&U===n(m)&&(w?(E(F),F=-1):w=!0,W(A,Y-H))):(U.sortIndex=te,t(u,U),v||N||(v=!0,ee(I))),U},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(U){var Q=g;return function(){var Y=g;g=Q;try{return U.apply(this,arguments)}finally{g=Y}}}})($g)),$g}var I2;function b_(){return I2||(I2=1,Rg.exports=y_()),Rg.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E2;function v_(){if(E2)return La;E2=1;var e=Su(),t=b_();function n(o){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+o,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function i(o,c){l(o,c),l(o+"Capture",c)}function l(o,c){for(s[o]=c,o=0;o<c.length;o++)a.add(c[o])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function g(o){return u.call(f,o)?!0:u.call(p,o)?!1:m.test(o)?f[o]=!0:(p[o]=!0,!1)}function N(o,c,h,x){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return x?!1:h!==null?!h.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function v(o,c,h,x){if(c===null||typeof c>"u"||N(o,c,h,x))return!0;if(x)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function w(o,c,h,x,k,M,V){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=x,this.attributeNamespace=k,this.mustUseProperty=h,this.propertyName=o,this.type=c,this.sanitizeURL=M,this.removeEmptyString=V}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){y[o]=new w(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var c=o[0];y[c]=new w(c,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){y[o]=new w(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){y[o]=new w(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){y[o]=new w(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){y[o]=new w(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){y[o]=new w(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){y[o]=new w(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){y[o]=new w(o,5,!1,o.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function O(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var c=o.replace(E,O);y[c]=new w(c,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var c=o.replace(E,O);y[c]=new w(c,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var c=o.replace(E,O);y[c]=new w(c,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){y[o]=new w(o,1,!1,o.toLowerCase(),null,!1,!1)}),y.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){y[o]=new w(o,1,!1,o.toLowerCase(),null,!0,!0)});function T(o,c,h,x){var k=y.hasOwnProperty(c)?y[c]:null;(k!==null?k.type!==0:x||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(v(c,h,k,x)&&(h=null),x||k===null?g(c)&&(h===null?o.removeAttribute(c):o.setAttribute(c,""+h)):k.mustUseProperty?o[k.propertyName]=h===null?k.type===3?!1:"":h:(c=k.attributeName,x=k.attributeNamespace,h===null?o.removeAttribute(c):(k=k.type,h=k===3||k===4&&h===!0?"":""+h,x?o.setAttributeNS(x,c,h):o.setAttribute(c,h))))}var A=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),C=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),$=Symbol.for("react.provider"),L=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),W=Symbol.for("react.offscreen"),U=Symbol.iterator;function Q(o){return o===null||typeof o!="object"?null:(o=U&&o[U]||o["@@iterator"],typeof o=="function"?o:null)}var Y=Object.assign,H;function te(o){if(H===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);H=c&&c[1]||""}return`
`+H+o}var fe=!1;function Le(o,c){if(!o||fe)return"";fe=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(He){var x=He}Reflect.construct(o,[],c)}else{try{c.call()}catch(He){x=He}o.call(c.prototype)}else{try{throw Error()}catch(He){x=He}o()}}catch(He){if(He&&x&&typeof He.stack=="string"){for(var k=He.stack.split(`
`),M=x.stack.split(`
`),V=k.length-1,pe=M.length-1;1<=V&&0<=pe&&k[V]!==M[pe];)pe--;for(;1<=V&&0<=pe;V--,pe--)if(k[V]!==M[pe]){if(V!==1||pe!==1)do if(V--,pe--,0>pe||k[V]!==M[pe]){var Ne=`
`+k[V].replace(" at new "," at ");return o.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",o.displayName)),Ne}while(1<=V&&0<=pe);break}}}finally{fe=!1,Error.prepareStackTrace=h}return(o=o?o.displayName||o.name:"")?te(o):""}function he(o){switch(o.tag){case 5:return te(o.type);case 16:return te("Lazy");case 13:return te("Suspense");case 19:return te("SuspenseList");case 0:case 2:case 15:return o=Le(o.type,!1),o;case 11:return o=Le(o.type.render,!1),o;case 1:return o=Le(o.type,!0),o;default:return""}}function K(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case P:return"Fragment";case C:return"Portal";case R:return"Profiler";case F:return"StrictMode";case X:return"Suspense";case me:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case L:return(o.displayName||"Context")+".Consumer";case $:return(o._context.displayName||"Context")+".Provider";case G:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case se:return c=o.displayName||null,c!==null?c:K(o.type)||"Memo";case ee:c=o._payload,o=o._init;try{return K(o(c))}catch{}}return null}function be(o){var c=o.type;switch(o.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=c.render,o=o.displayName||o.name||"",c.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(c);case 8:return c===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function re(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function ie(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ne(o){var c=ie(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),x=""+o[c];if(!o.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var k=h.get,M=h.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return k.call(this)},set:function(V){x=""+V,M.call(this,V)}}),Object.defineProperty(o,c,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(V){x=""+V},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function Te(o){o._valueTracker||(o._valueTracker=ne(o))}function ve(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var h=c.getValue(),x="";return o&&(x=ie(o)?o.checked?"true":"false":o.value),o=x,o!==h?(c.setValue(o),!0):!1}function We(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ie(o,c){var h=c.checked;return Y({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??o._wrapperState.initialChecked})}function je(o,c){var h=c.defaultValue==null?"":c.defaultValue,x=c.checked!=null?c.checked:c.defaultChecked;h=re(c.value!=null?c.value:h),o._wrapperState={initialChecked:x,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function oe(o,c){c=c.checked,c!=null&&T(o,"checked",c,!1)}function $e(o,c){oe(o,c);var h=re(c.value),x=c.type;if(h!=null)x==="number"?(h===0&&o.value===""||o.value!=h)&&(o.value=""+h):o.value!==""+h&&(o.value=""+h);else if(x==="submit"||x==="reset"){o.removeAttribute("value");return}c.hasOwnProperty("value")?lt(o,c.type,h):c.hasOwnProperty("defaultValue")&&lt(o,c.type,re(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(o.defaultChecked=!!c.defaultChecked)}function et(o,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var x=c.type;if(!(x!=="submit"&&x!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+o._wrapperState.initialValue,h||c===o.value||(o.value=c),o.defaultValue=c}h=o.name,h!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,h!==""&&(o.name=h)}function lt(o,c,h){(c!=="number"||We(o.ownerDocument)!==o)&&(h==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+h&&(o.defaultValue=""+h))}var rt=Array.isArray;function Lt(o,c,h,x){if(o=o.options,c){c={};for(var k=0;k<h.length;k++)c["$"+h[k]]=!0;for(h=0;h<o.length;h++)k=c.hasOwnProperty("$"+o[h].value),o[h].selected!==k&&(o[h].selected=k),k&&x&&(o[h].defaultSelected=!0)}else{for(h=""+re(h),c=null,k=0;k<o.length;k++){if(o[k].value===h){o[k].selected=!0,x&&(o[k].defaultSelected=!0);return}c!==null||o[k].disabled||(c=o[k])}c!==null&&(c.selected=!0)}}function kt(o,c){if(c.dangerouslySetInnerHTML!=null)throw Error(n(91));return Y({},c,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function Oe(o,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(n(92));if(rt(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),h=c}o._wrapperState={initialValue:re(h)}}function Nt(o,c){var h=re(c.value),x=re(c.defaultValue);h!=null&&(h=""+h,h!==o.value&&(o.value=h),c.defaultValue==null&&o.defaultValue!==h&&(o.defaultValue=h)),x!=null&&(o.defaultValue=""+x)}function Mt(o){var c=o.textContent;c===o._wrapperState.initialValue&&c!==""&&c!==null&&(o.value=c)}function rr(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ft(o,c){return o==null||o==="http://www.w3.org/1999/xhtml"?rr(c):o==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var cr,or=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,x,k){MSApp.execUnsafeLocalFunction(function(){return o(c,h,x,k)})}:o})(function(o,c){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=c;else{for(cr=cr||document.createElement("div"),cr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=cr.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;c.firstChild;)o.appendChild(c.firstChild)}});function ke(o,c){if(c){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=c;return}}o.textContent=c}var ht={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_e=["Webkit","ms","Moz","O"];Object.keys(ht).forEach(function(o){_e.forEach(function(c){c=c+o.charAt(0).toUpperCase()+o.substring(1),ht[c]=ht[o]})});function tt(o,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||ht.hasOwnProperty(o)&&ht[o]?(""+c).trim():c+"px"}function gt(o,c){o=o.style;for(var h in c)if(c.hasOwnProperty(h)){var x=h.indexOf("--")===0,k=tt(h,c[h],x);h==="float"&&(h="cssFloat"),x?o.setProperty(h,k):o[h]=k}}var Pt=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ot(o,c){if(c){if(Pt[o]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(n(137,o));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(n(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(n(61))}if(c.style!=null&&typeof c.style!="object")throw Error(n(62))}}function vt(o,c){if(o.indexOf("-")===-1)return typeof c.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nr=null;function Yt(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Or=null,Sr=null,$t=null;function gr(o){if(o=Gc(o)){if(typeof Or!="function")throw Error(n(280));var c=o.stateNode;c&&(c=Ju(c),Or(o.stateNode,o.type,c))}}function kr(o){Sr?$t?$t.push(o):$t=[o]:Sr=o}function b(){if(Sr){var o=Sr,c=$t;if($t=Sr=null,gr(o),c)for(o=0;o<c.length;o++)gr(c[o])}}function B(o,c){return o(c)}function Pe(){}var Se=!1;function Ae(o,c,h){if(Se)return o(c,h);Se=!0;try{return B(o,c,h)}finally{Se=!1,(Sr!==null||$t!==null)&&(Pe(),b())}}function Xe(o,c){var h=o.stateNode;if(h===null)return null;var x=Ju(h);if(x===null)return null;h=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(o=o.type,x=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!x;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(n(231,c,typeof h));return h}var Ke=!1;if(d)try{var Ve={};Object.defineProperty(Ve,"passive",{get:function(){Ke=!0}}),window.addEventListener("test",Ve,Ve),window.removeEventListener("test",Ve,Ve)}catch{Ke=!1}function ut(o,c,h,x,k,M,V,pe,Ne){var He=Array.prototype.slice.call(arguments,3);try{c.apply(h,He)}catch(ft){this.onError(ft)}}var Je=!1,ae=null,ct=!1,st=null,dt={onError:function(o){Je=!0,ae=o}};function it(o,c,h,x,k,M,V,pe,Ne){Je=!1,ae=null,ut.apply(dt,arguments)}function xt(o,c,h,x,k,M,V,pe,Ne){if(it.apply(this,arguments),Je){if(Je){var He=ae;Je=!1,ae=null}else throw Error(n(198));ct||(ct=!0,st=He)}}function Bt(o){var c=o,h=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(h=c.return),o=c.return;while(o)}return c.tag===3?h:null}function qt(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function Ar(o){if(Bt(o)!==o)throw Error(n(188))}function Ir(o){var c=o.alternate;if(!c){if(c=Bt(o),c===null)throw Error(n(188));return c!==o?null:o}for(var h=o,x=c;;){var k=h.return;if(k===null)break;var M=k.alternate;if(M===null){if(x=k.return,x!==null){h=x;continue}break}if(k.child===M.child){for(M=k.child;M;){if(M===h)return Ar(k),o;if(M===x)return Ar(k),c;M=M.sibling}throw Error(n(188))}if(h.return!==x.return)h=k,x=M;else{for(var V=!1,pe=k.child;pe;){if(pe===h){V=!0,h=k,x=M;break}if(pe===x){V=!0,x=k,h=M;break}pe=pe.sibling}if(!V){for(pe=M.child;pe;){if(pe===h){V=!0,h=M,x=k;break}if(pe===x){V=!0,x=M,h=k;break}pe=pe.sibling}if(!V)throw Error(n(189))}}if(h.alternate!==x)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?o:c}function gn(o){return o=Ir(o),o!==null?sn(o):null}function sn(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var c=sn(o);if(c!==null)return c;o=o.sibling}return null}var Ht=t.unstable_scheduleCallback,Dr=t.unstable_cancelCallback,dr=t.unstable_shouldYield,Vt=t.unstable_requestPaint,er=t.unstable_now,Nr=t.unstable_getCurrentPriorityLevel,xn=t.unstable_ImmediatePriority,dn=t.unstable_UserBlockingPriority,Qn=t.unstable_NormalPriority,js=t.unstable_LowPriority,jn=t.unstable_IdlePriority,Fn=null,yn=null;function Tn(o){if(yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(Fn,o,void 0,(o.current.flags&128)===128)}catch{}}var on=Math.clz32?Math.clz32:oi,ii=Math.log,ns=Math.LN2;function oi(o){return o>>>=0,o===0?32:31-(ii(o)/ns|0)|0}var Bn=64,Ha=4194304;function as(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Va(o,c){var h=o.pendingLanes;if(h===0)return 0;var x=0,k=o.suspendedLanes,M=o.pingedLanes,V=h&268435455;if(V!==0){var pe=V&~k;pe!==0?x=as(pe):(M&=V,M!==0&&(x=as(M)))}else V=h&~k,V!==0?x=as(V):M!==0&&(x=as(M));if(x===0)return 0;if(c!==0&&c!==x&&(c&k)===0&&(k=x&-x,M=c&-c,k>=M||k===16&&(M&4194240)!==0))return c;if((x&4)!==0&&(x|=h&16),c=o.entangledLanes,c!==0)for(o=o.entanglements,c&=x;0<c;)h=31-on(c),k=1<<h,x|=o[h],c&=~k;return x}function D(o,c){switch(o){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q(o,c){for(var h=o.suspendedLanes,x=o.pingedLanes,k=o.expirationTimes,M=o.pendingLanes;0<M;){var V=31-on(M),pe=1<<V,Ne=k[V];Ne===-1?((pe&h)===0||(pe&x)!==0)&&(k[V]=D(pe,c)):Ne<=c&&(o.expiredLanes|=pe),M&=~pe}}function Z(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function ce(){var o=Bn;return Bn<<=1,(Bn&4194240)===0&&(Bn=64),o}function Fe(o){for(var c=[],h=0;31>h;h++)c.push(o);return c}function De(o,c,h){o.pendingLanes|=c,c!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,c=31-on(c),o[c]=h}function Ze(o,c){var h=o.pendingLanes&~c;o.pendingLanes=c,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=c,o.mutableReadLanes&=c,o.entangledLanes&=c,c=o.entanglements;var x=o.eventTimes;for(o=o.expirationTimes;0<h;){var k=31-on(h),M=1<<k;c[k]=0,x[k]=-1,o[k]=-1,h&=~M}}function bt(o,c){var h=o.entangledLanes|=c;for(o=o.entanglements;h;){var x=31-on(h),k=1<<x;k&c|o[x]&c&&(o[x]|=c),h&=~k}}var St=0;function Kt(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var ar,_r,ea,ia,Un,Wa=!1,oa=[],ta=null,zn=null,wa=null,la=new Map,Ya=new Map,S=[],ue="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qe(o,c){switch(o){case"focusin":case"focusout":ta=null;break;case"dragenter":case"dragleave":zn=null;break;case"mouseover":case"mouseout":wa=null;break;case"pointerover":case"pointerout":la.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ya.delete(c.pointerId)}}function we(o,c,h,x,k,M){return o===null||o.nativeEvent!==M?(o={blockedOn:c,domEventName:h,eventSystemFlags:x,nativeEvent:M,targetContainers:[k]},c!==null&&(c=Gc(c),c!==null&&_r(c)),o):(o.eventSystemFlags|=x,c=o.targetContainers,k!==null&&c.indexOf(k)===-1&&c.push(k),o)}function de(o,c,h,x,k){switch(c){case"focusin":return ta=we(ta,o,c,h,x,k),!0;case"dragenter":return zn=we(zn,o,c,h,x,k),!0;case"mouseover":return wa=we(wa,o,c,h,x,k),!0;case"pointerover":var M=k.pointerId;return la.set(M,we(la.get(M)||null,o,c,h,x,k)),!0;case"gotpointercapture":return M=k.pointerId,Ya.set(M,we(Ya.get(M)||null,o,c,h,x,k)),!0}return!1}function ze(o){var c=jo(o.target);if(c!==null){var h=Bt(c);if(h!==null){if(c=h.tag,c===13){if(c=qt(h),c!==null){o.blockedOn=c,Un(o.priority,function(){ea(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Ee(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var h=Mr(o.domEventName,o.eventSystemFlags,c[0],o.nativeEvent);if(h===null){h=o.nativeEvent;var x=new h.constructor(h.type,h);nr=x,h.target.dispatchEvent(x),nr=null}else return c=Gc(h),c!==null&&_r(c),o.blockedOn=h,!1;c.shift()}return!0}function ye(o,c,h){Ee(o)&&h.delete(c)}function Ge(){Wa=!1,ta!==null&&Ee(ta)&&(ta=null),zn!==null&&Ee(zn)&&(zn=null),wa!==null&&Ee(wa)&&(wa=null),la.forEach(ye),Ya.forEach(ye)}function Qe(o,c){o.blockedOn===c&&(o.blockedOn=null,Wa||(Wa=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Ge)))}function Jt(o){function c(k){return Qe(k,o)}if(0<oa.length){Qe(oa[0],o);for(var h=1;h<oa.length;h++){var x=oa[h];x.blockedOn===o&&(x.blockedOn=null)}}for(ta!==null&&Qe(ta,o),zn!==null&&Qe(zn,o),wa!==null&&Qe(wa,o),la.forEach(c),Ya.forEach(c),h=0;h<S.length;h++)x=S[h],x.blockedOn===o&&(x.blockedOn=null);for(;0<S.length&&(h=S[0],h.blockedOn===null);)ze(h),h.blockedOn===null&&S.shift()}var Ct=A.ReactCurrentBatchConfig,ur=!0;function Wt(o,c,h,x){var k=St,M=Ct.transition;Ct.transition=null;try{St=1,mr(o,c,h,x)}finally{St=k,Ct.transition=M}}function zr(o,c,h,x){var k=St,M=Ct.transition;Ct.transition=null;try{St=4,mr(o,c,h,x)}finally{St=k,Ct.transition=M}}function mr(o,c,h,x){if(ur){var k=Mr(o,c,h,x);if(k===null)Np(o,c,x,br,h),qe(o,x);else if(de(k,o,c,h,x))x.stopPropagation();else if(qe(o,x),c&4&&-1<ue.indexOf(o)){for(;k!==null;){var M=Gc(k);if(M!==null&&ar(M),M=Mr(o,c,h,x),M===null&&Np(o,c,x,br,h),M===k)break;k=M}k!==null&&x.stopPropagation()}else Np(o,c,x,null,h)}}var br=null;function Mr(o,c,h,x){if(br=null,o=Yt(x),o=jo(o),o!==null)if(c=Bt(o),c===null)o=null;else if(h=c.tag,h===13){if(o=qt(c),o!==null)return o;o=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null);return br=o,null}function un(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Nr()){case xn:return 1;case dn:return 4;case Qn:case js:return 16;case jn:return 536870912;default:return 16}default:return 16}}var hr=null,Er=null,mn=null;function Nn(){if(mn)return mn;var o,c=Er,h=c.length,x,k="value"in hr?hr.value:hr.textContent,M=k.length;for(o=0;o<h&&c[o]===k[o];o++);var V=h-o;for(x=1;x<=V&&c[h-x]===k[M-x];x++);return mn=k.slice(o,1<x?1-x:void 0)}function Sn(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Cn(){return!0}function Pa(){return!1}function qr(o){function c(h,x,k,M,V){this._reactName=h,this._targetInst=k,this.type=x,this.nativeEvent=M,this.target=V,this.currentTarget=null;for(var pe in o)o.hasOwnProperty(pe)&&(h=o[pe],this[pe]=h?h(M):M[pe]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Cn:Pa,this.isPropagationStopped=Pa,this}return Y(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Cn)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Cn)},persist:function(){},isPersistent:Cn}),c}var ja={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qn=qr(ja),Hr=Y({},ja,{view:0,detail:0}),li=qr(Hr),Fi,ci,Ls,vo=Y({},Hr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pl,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Ls&&(Ls&&o.type==="mousemove"?(Fi=o.screenX-Ls.screenX,ci=o.screenY-Ls.screenY):ci=Fi=0,Ls=o),Fi)},movementY:function(o){return"movementY"in o?o.movementY:ci}}),Mc=qr(vo),Lu=Y({},vo,{dataTransfer:0}),Rc=qr(Lu),Na=Y({},Hr,{relatedTarget:0}),ul=qr(Na),$c=Y({},ja,{animationName:0,elapsedTime:0,pseudoElement:0}),hp=qr($c),Fu=Y({},ja,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),ml=qr(Fu),Bu=Y({},ja,{data:0}),Lc=qr(Bu),hl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zu(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=Uu[o])?!!c[o]:!1}function pl(){return zu}var Fc=Y({},Hr,{key:function(o){if(o.key){var c=hl[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=Sn(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?fl[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pl,charCode:function(o){return o.type==="keypress"?Sn(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Sn(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),qu=qr(Fc),_=Y({},vo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z=qr(_),J=Y({},Hr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pl}),le=qr(J),Ue=Y({},ja,{propertyName:0,elapsedTime:0,pseudoElement:0}),Re=qr(Ue),at=Y({},vo,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),yt=qr(at),Zt=[9,13,27,32],fr=d&&"CompositionEvent"in window,sr=null;d&&"documentMode"in document&&(sr=document.documentMode);var Wr=d&&"TextEvent"in window&&!sr,ca=d&&(!fr||sr&&8<sr&&11>=sr),Ta=" ",Da=!1;function wo(o,c){switch(o){case"keyup":return Zt.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bc(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Fs=!1;function u5(o,c){switch(o){case"compositionend":return Bc(c);case"keypress":return c.which!==32?null:(Da=!0,Ta);case"textInput":return o=c.data,o===Ta&&Da?null:o;default:return null}}function m5(o,c){if(Fs)return o==="compositionend"||!fr&&wo(o,c)?(o=Nn(),mn=Er=hr=null,Fs=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return ca&&c.locale!=="ko"?null:c.data;default:return null}}var h5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vj(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!h5[o.type]:c==="textarea"}function wj(o,c,h,x){kr(x),c=Ku(c,"onChange"),0<c.length&&(h=new qn("onChange","change",null,h,x),o.push({event:h,listeners:c}))}var Uc=null,zc=null;function f5(o){Fj(o,0)}function Hu(o){var c=vl(o);if(ve(c))return o}function p5(o,c){if(o==="change")return c}var jj=!1;if(d){var fp;if(d){var pp="oninput"in document;if(!pp){var Nj=document.createElement("div");Nj.setAttribute("oninput","return;"),pp=typeof Nj.oninput=="function"}fp=pp}else fp=!1;jj=fp&&(!document.documentMode||9<document.documentMode)}function Sj(){Uc&&(Uc.detachEvent("onpropertychange",Cj),zc=Uc=null)}function Cj(o){if(o.propertyName==="value"&&Hu(zc)){var c=[];wj(c,zc,o,Yt(o)),Ae(f5,c)}}function g5(o,c,h){o==="focusin"?(Sj(),Uc=c,zc=h,Uc.attachEvent("onpropertychange",Cj)):o==="focusout"&&Sj()}function x5(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Hu(zc)}function y5(o,c){if(o==="click")return Hu(c)}function b5(o,c){if(o==="input"||o==="change")return Hu(c)}function v5(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Ns=typeof Object.is=="function"?Object.is:v5;function qc(o,c){if(Ns(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var h=Object.keys(o),x=Object.keys(c);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var k=h[x];if(!u.call(c,k)||!Ns(o[k],c[k]))return!1}return!0}function kj(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Aj(o,c){var h=kj(o);o=0;for(var x;h;){if(h.nodeType===3){if(x=o+h.textContent.length,o<=c&&x>=c)return{node:h,offset:c-o};o=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=kj(h)}}function Ij(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?Ij(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function Ej(){for(var o=window,c=We();c instanceof o.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)o=c.contentWindow;else break;c=We(o.document)}return c}function gp(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}function w5(o){var c=Ej(),h=o.focusedElem,x=o.selectionRange;if(c!==h&&h&&h.ownerDocument&&Ij(h.ownerDocument.documentElement,h)){if(x!==null&&gp(h)){if(c=x.start,o=x.end,o===void 0&&(o=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(o,h.value.length);else if(o=(c=h.ownerDocument||document)&&c.defaultView||window,o.getSelection){o=o.getSelection();var k=h.textContent.length,M=Math.min(x.start,k);x=x.end===void 0?M:Math.min(x.end,k),!o.extend&&M>x&&(k=x,x=M,M=k),k=Aj(h,M);var V=Aj(h,x);k&&V&&(o.rangeCount!==1||o.anchorNode!==k.node||o.anchorOffset!==k.offset||o.focusNode!==V.node||o.focusOffset!==V.offset)&&(c=c.createRange(),c.setStart(k.node,k.offset),o.removeAllRanges(),M>x?(o.addRange(c),o.extend(V.node,V.offset)):(c.setEnd(V.node,V.offset),o.addRange(c)))}}for(c=[],o=h;o=o.parentNode;)o.nodeType===1&&c.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)o=c[h],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var j5=d&&"documentMode"in document&&11>=document.documentMode,gl=null,xp=null,Hc=null,yp=!1;function Pj(o,c,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;yp||gl==null||gl!==We(x)||(x=gl,"selectionStart"in x&&gp(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Hc&&qc(Hc,x)||(Hc=x,x=Ku(xp,"onSelect"),0<x.length&&(c=new qn("onSelect","select",null,c,h),o.push({event:c,listeners:x}),c.target=gl)))}function Vu(o,c){var h={};return h[o.toLowerCase()]=c.toLowerCase(),h["Webkit"+o]="webkit"+c,h["Moz"+o]="moz"+c,h}var xl={animationend:Vu("Animation","AnimationEnd"),animationiteration:Vu("Animation","AnimationIteration"),animationstart:Vu("Animation","AnimationStart"),transitionend:Vu("Transition","TransitionEnd")},bp={},Tj={};d&&(Tj=document.createElement("div").style,"AnimationEvent"in window||(delete xl.animationend.animation,delete xl.animationiteration.animation,delete xl.animationstart.animation),"TransitionEvent"in window||delete xl.transitionend.transition);function Wu(o){if(bp[o])return bp[o];if(!xl[o])return o;var c=xl[o],h;for(h in c)if(c.hasOwnProperty(h)&&h in Tj)return bp[o]=c[h];return o}var Dj=Wu("animationend"),Oj=Wu("animationiteration"),_j=Wu("animationstart"),Mj=Wu("transitionend"),Rj=new Map,$j="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bi(o,c){Rj.set(o,c),i(c,[o])}for(var vp=0;vp<$j.length;vp++){var wp=$j[vp],N5=wp.toLowerCase(),S5=wp[0].toUpperCase()+wp.slice(1);Bi(N5,"on"+S5)}Bi(Dj,"onAnimationEnd"),Bi(Oj,"onAnimationIteration"),Bi(_j,"onAnimationStart"),Bi("dblclick","onDoubleClick"),Bi("focusin","onFocus"),Bi("focusout","onBlur"),Bi(Mj,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),C5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vc));function Lj(o,c,h){var x=o.type||"unknown-event";o.currentTarget=h,xt(x,c,void 0,o),o.currentTarget=null}function Fj(o,c){c=(c&4)!==0;for(var h=0;h<o.length;h++){var x=o[h],k=x.event;x=x.listeners;e:{var M=void 0;if(c)for(var V=x.length-1;0<=V;V--){var pe=x[V],Ne=pe.instance,He=pe.currentTarget;if(pe=pe.listener,Ne!==M&&k.isPropagationStopped())break e;Lj(k,pe,He),M=Ne}else for(V=0;V<x.length;V++){if(pe=x[V],Ne=pe.instance,He=pe.currentTarget,pe=pe.listener,Ne!==M&&k.isPropagationStopped())break e;Lj(k,pe,He),M=Ne}}}if(ct)throw o=st,ct=!1,st=null,o}function Zr(o,c){var h=c[Ep];h===void 0&&(h=c[Ep]=new Set);var x=o+"__bubble";h.has(x)||(Bj(c,o,2,!1),h.add(x))}function jp(o,c,h){var x=0;c&&(x|=4),Bj(h,o,x,c)}var Yu="_reactListening"+Math.random().toString(36).slice(2);function Wc(o){if(!o[Yu]){o[Yu]=!0,a.forEach(function(h){h!=="selectionchange"&&(C5.has(h)||jp(h,!1,o),jp(h,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[Yu]||(c[Yu]=!0,jp("selectionchange",!1,c))}}function Bj(o,c,h,x){switch(un(c)){case 1:var k=Wt;break;case 4:k=zr;break;default:k=mr}h=k.bind(null,c,h,o),k=void 0,!Ke||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(k=!0),x?k!==void 0?o.addEventListener(c,h,{capture:!0,passive:k}):o.addEventListener(c,h,!0):k!==void 0?o.addEventListener(c,h,{passive:k}):o.addEventListener(c,h,!1)}function Np(o,c,h,x,k){var M=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var V=x.tag;if(V===3||V===4){var pe=x.stateNode.containerInfo;if(pe===k||pe.nodeType===8&&pe.parentNode===k)break;if(V===4)for(V=x.return;V!==null;){var Ne=V.tag;if((Ne===3||Ne===4)&&(Ne=V.stateNode.containerInfo,Ne===k||Ne.nodeType===8&&Ne.parentNode===k))return;V=V.return}for(;pe!==null;){if(V=jo(pe),V===null)return;if(Ne=V.tag,Ne===5||Ne===6){x=M=V;continue e}pe=pe.parentNode}}x=x.return}Ae(function(){var He=M,ft=Yt(h),pt=[];e:{var mt=Rj.get(o);if(mt!==void 0){var At=qn,Tt=o;switch(o){case"keypress":if(Sn(h)===0)break e;case"keydown":case"keyup":At=qu;break;case"focusin":Tt="focus",At=ul;break;case"focusout":Tt="blur",At=ul;break;case"beforeblur":case"afterblur":At=ul;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":At=Mc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":At=Rc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":At=le;break;case Dj:case Oj:case _j:At=hp;break;case Mj:At=Re;break;case"scroll":At=li;break;case"wheel":At=yt;break;case"copy":case"cut":case"paste":At=ml;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":At=z}var Rt=(c&4)!==0,bn=!Rt&&o==="scroll",Me=Rt?mt!==null?mt+"Capture":null:mt;Rt=[];for(var Ce=He,Be;Ce!==null;){Be=Ce;var wt=Be.stateNode;if(Be.tag===5&&wt!==null&&(Be=wt,Me!==null&&(wt=Xe(Ce,Me),wt!=null&&Rt.push(Yc(Ce,wt,Be)))),bn)break;Ce=Ce.return}0<Rt.length&&(mt=new At(mt,Tt,null,h,ft),pt.push({event:mt,listeners:Rt}))}}if((c&7)===0){e:{if(mt=o==="mouseover"||o==="pointerover",At=o==="mouseout"||o==="pointerout",mt&&h!==nr&&(Tt=h.relatedTarget||h.fromElement)&&(jo(Tt)||Tt[di]))break e;if((At||mt)&&(mt=ft.window===ft?ft:(mt=ft.ownerDocument)?mt.defaultView||mt.parentWindow:window,At?(Tt=h.relatedTarget||h.toElement,At=He,Tt=Tt?jo(Tt):null,Tt!==null&&(bn=Bt(Tt),Tt!==bn||Tt.tag!==5&&Tt.tag!==6)&&(Tt=null)):(At=null,Tt=He),At!==Tt)){if(Rt=Mc,wt="onMouseLeave",Me="onMouseEnter",Ce="mouse",(o==="pointerout"||o==="pointerover")&&(Rt=z,wt="onPointerLeave",Me="onPointerEnter",Ce="pointer"),bn=At==null?mt:vl(At),Be=Tt==null?mt:vl(Tt),mt=new Rt(wt,Ce+"leave",At,h,ft),mt.target=bn,mt.relatedTarget=Be,wt=null,jo(ft)===He&&(Rt=new Rt(Me,Ce+"enter",Tt,h,ft),Rt.target=Be,Rt.relatedTarget=bn,wt=Rt),bn=wt,At&&Tt)t:{for(Rt=At,Me=Tt,Ce=0,Be=Rt;Be;Be=yl(Be))Ce++;for(Be=0,wt=Me;wt;wt=yl(wt))Be++;for(;0<Ce-Be;)Rt=yl(Rt),Ce--;for(;0<Be-Ce;)Me=yl(Me),Be--;for(;Ce--;){if(Rt===Me||Me!==null&&Rt===Me.alternate)break t;Rt=yl(Rt),Me=yl(Me)}Rt=null}else Rt=null;At!==null&&Uj(pt,mt,At,Rt,!1),Tt!==null&&bn!==null&&Uj(pt,bn,Tt,Rt,!0)}}e:{if(mt=He?vl(He):window,At=mt.nodeName&&mt.nodeName.toLowerCase(),At==="select"||At==="input"&&mt.type==="file")var Ut=p5;else if(vj(mt))if(jj)Ut=b5;else{Ut=x5;var Gt=g5}else(At=mt.nodeName)&&At.toLowerCase()==="input"&&(mt.type==="checkbox"||mt.type==="radio")&&(Ut=y5);if(Ut&&(Ut=Ut(o,He))){wj(pt,Ut,h,ft);break e}Gt&&Gt(o,mt,He),o==="focusout"&&(Gt=mt._wrapperState)&&Gt.controlled&&mt.type==="number"&&lt(mt,"number",mt.value)}switch(Gt=He?vl(He):window,o){case"focusin":(vj(Gt)||Gt.contentEditable==="true")&&(gl=Gt,xp=He,Hc=null);break;case"focusout":Hc=xp=gl=null;break;case"mousedown":yp=!0;break;case"contextmenu":case"mouseup":case"dragend":yp=!1,Pj(pt,h,ft);break;case"selectionchange":if(j5)break;case"keydown":case"keyup":Pj(pt,h,ft)}var Xt;if(fr)e:{switch(o){case"compositionstart":var ir="onCompositionStart";break e;case"compositionend":ir="onCompositionEnd";break e;case"compositionupdate":ir="onCompositionUpdate";break e}ir=void 0}else Fs?wo(o,h)&&(ir="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(ir="onCompositionStart");ir&&(ca&&h.locale!=="ko"&&(Fs||ir!=="onCompositionStart"?ir==="onCompositionEnd"&&Fs&&(Xt=Nn()):(hr=ft,Er="value"in hr?hr.value:hr.textContent,Fs=!0)),Gt=Ku(He,ir),0<Gt.length&&(ir=new Lc(ir,o,null,h,ft),pt.push({event:ir,listeners:Gt}),Xt?ir.data=Xt:(Xt=Bc(h),Xt!==null&&(ir.data=Xt)))),(Xt=Wr?u5(o,h):m5(o,h))&&(He=Ku(He,"onBeforeInput"),0<He.length&&(ft=new Lc("onBeforeInput","beforeinput",null,h,ft),pt.push({event:ft,listeners:He}),ft.data=Xt))}Fj(pt,c)})}function Yc(o,c,h){return{instance:o,listener:c,currentTarget:h}}function Ku(o,c){for(var h=c+"Capture",x=[];o!==null;){var k=o,M=k.stateNode;k.tag===5&&M!==null&&(k=M,M=Xe(o,h),M!=null&&x.unshift(Yc(o,M,k)),M=Xe(o,c),M!=null&&x.push(Yc(o,M,k))),o=o.return}return x}function yl(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function Uj(o,c,h,x,k){for(var M=c._reactName,V=[];h!==null&&h!==x;){var pe=h,Ne=pe.alternate,He=pe.stateNode;if(Ne!==null&&Ne===x)break;pe.tag===5&&He!==null&&(pe=He,k?(Ne=Xe(h,M),Ne!=null&&V.unshift(Yc(h,Ne,pe))):k||(Ne=Xe(h,M),Ne!=null&&V.push(Yc(h,Ne,pe)))),h=h.return}V.length!==0&&o.push({event:c,listeners:V})}var k5=/\r\n?/g,A5=/\u0000|\uFFFD/g;function zj(o){return(typeof o=="string"?o:""+o).replace(k5,`
`).replace(A5,"")}function Gu(o,c,h){if(c=zj(c),zj(o)!==c&&h)throw Error(n(425))}function Xu(){}var Sp=null,Cp=null;function kp(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Ap=typeof setTimeout=="function"?setTimeout:void 0,I5=typeof clearTimeout=="function"?clearTimeout:void 0,qj=typeof Promise=="function"?Promise:void 0,E5=typeof queueMicrotask=="function"?queueMicrotask:typeof qj<"u"?function(o){return qj.resolve(null).then(o).catch(P5)}:Ap;function P5(o){setTimeout(function(){throw o})}function Ip(o,c){var h=c,x=0;do{var k=h.nextSibling;if(o.removeChild(h),k&&k.nodeType===8)if(h=k.data,h==="/$"){if(x===0){o.removeChild(k),Jt(c);return}x--}else h!=="$"&&h!=="$?"&&h!=="$!"||x++;h=k}while(h);Jt(c)}function Ui(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return o}function Hj(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return o;c--}else h==="/$"&&c++}o=o.previousSibling}return null}var bl=Math.random().toString(36).slice(2),Bs="__reactFiber$"+bl,Kc="__reactProps$"+bl,di="__reactContainer$"+bl,Ep="__reactEvents$"+bl,T5="__reactListeners$"+bl,D5="__reactHandles$"+bl;function jo(o){var c=o[Bs];if(c)return c;for(var h=o.parentNode;h;){if(c=h[di]||h[Bs]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(o=Hj(o);o!==null;){if(h=o[Bs])return h;o=Hj(o)}return c}o=h,h=o.parentNode}return null}function Gc(o){return o=o[Bs]||o[di],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function vl(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(n(33))}function Ju(o){return o[Kc]||null}var Pp=[],wl=-1;function zi(o){return{current:o}}function Qr(o){0>wl||(o.current=Pp[wl],Pp[wl]=null,wl--)}function Kr(o,c){wl++,Pp[wl]=o.current,o.current=c}var qi={},da=zi(qi),Oa=zi(!1),No=qi;function jl(o,c){var h=o.type.contextTypes;if(!h)return qi;var x=o.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===c)return x.__reactInternalMemoizedMaskedChildContext;var k={},M;for(M in h)k[M]=c[M];return x&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=c,o.__reactInternalMemoizedMaskedChildContext=k),k}function _a(o){return o=o.childContextTypes,o!=null}function Zu(){Qr(Oa),Qr(da)}function Vj(o,c,h){if(da.current!==qi)throw Error(n(168));Kr(da,c),Kr(Oa,h)}function Wj(o,c,h){var x=o.stateNode;if(c=c.childContextTypes,typeof x.getChildContext!="function")return h;x=x.getChildContext();for(var k in x)if(!(k in c))throw Error(n(108,be(o)||"Unknown",k));return Y({},h,x)}function Qu(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||qi,No=da.current,Kr(da,o),Kr(Oa,Oa.current),!0}function Yj(o,c,h){var x=o.stateNode;if(!x)throw Error(n(169));h?(o=Wj(o,c,No),x.__reactInternalMemoizedMergedChildContext=o,Qr(Oa),Qr(da),Kr(da,o)):Qr(Oa),Kr(Oa,h)}var ui=null,em=!1,Tp=!1;function Kj(o){ui===null?ui=[o]:ui.push(o)}function O5(o){em=!0,Kj(o)}function Hi(){if(!Tp&&ui!==null){Tp=!0;var o=0,c=St;try{var h=ui;for(St=1;o<h.length;o++){var x=h[o];do x=x(!0);while(x!==null)}ui=null,em=!1}catch(k){throw ui!==null&&(ui=ui.slice(o+1)),Ht(xn,Hi),k}finally{St=c,Tp=!1}}return null}var Nl=[],Sl=0,tm=null,rm=0,ss=[],is=0,So=null,mi=1,hi="";function Co(o,c){Nl[Sl++]=rm,Nl[Sl++]=tm,tm=o,rm=c}function Gj(o,c,h){ss[is++]=mi,ss[is++]=hi,ss[is++]=So,So=o;var x=mi;o=hi;var k=32-on(x)-1;x&=~(1<<k),h+=1;var M=32-on(c)+k;if(30<M){var V=k-k%5;M=(x&(1<<V)-1).toString(32),x>>=V,k-=V,mi=1<<32-on(c)+k|h<<k|x,hi=M+o}else mi=1<<M|h<<k|x,hi=o}function Dp(o){o.return!==null&&(Co(o,1),Gj(o,1,0))}function Op(o){for(;o===tm;)tm=Nl[--Sl],Nl[Sl]=null,rm=Nl[--Sl],Nl[Sl]=null;for(;o===So;)So=ss[--is],ss[is]=null,hi=ss[--is],ss[is]=null,mi=ss[--is],ss[is]=null}var Ka=null,Ga=null,rn=!1,Ss=null;function Xj(o,c){var h=ds(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=o,c=o.deletions,c===null?(o.deletions=[h],o.flags|=16):c.push(h)}function Jj(o,c){switch(o.tag){case 5:var h=o.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(o.stateNode=c,Ka=o,Ga=Ui(c.firstChild),!0):!1;case 6:return c=o.pendingProps===""||c.nodeType!==3?null:c,c!==null?(o.stateNode=c,Ka=o,Ga=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=So!==null?{id:mi,overflow:hi}:null,o.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=ds(18,null,null,0),h.stateNode=c,h.return=o,o.child=h,Ka=o,Ga=null,!0):!1;default:return!1}}function _p(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Mp(o){if(rn){var c=Ga;if(c){var h=c;if(!Jj(o,c)){if(_p(o))throw Error(n(418));c=Ui(h.nextSibling);var x=Ka;c&&Jj(o,c)?Xj(x,h):(o.flags=o.flags&-4097|2,rn=!1,Ka=o)}}else{if(_p(o))throw Error(n(418));o.flags=o.flags&-4097|2,rn=!1,Ka=o}}}function Zj(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Ka=o}function nm(o){if(o!==Ka)return!1;if(!rn)return Zj(o),rn=!0,!1;var c;if((c=o.tag!==3)&&!(c=o.tag!==5)&&(c=o.type,c=c!=="head"&&c!=="body"&&!kp(o.type,o.memoizedProps)),c&&(c=Ga)){if(_p(o))throw Qj(),Error(n(418));for(;c;)Xj(o,c),c=Ui(c.nextSibling)}if(Zj(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));e:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"){if(c===0){Ga=Ui(o.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}o=o.nextSibling}Ga=null}}else Ga=Ka?Ui(o.stateNode.nextSibling):null;return!0}function Qj(){for(var o=Ga;o;)o=Ui(o.nextSibling)}function Cl(){Ga=Ka=null,rn=!1}function Rp(o){Ss===null?Ss=[o]:Ss.push(o)}var _5=A.ReactCurrentBatchConfig;function Xc(o,c,h){if(o=h.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(n(309));var x=h.stateNode}if(!x)throw Error(n(147,o));var k=x,M=""+o;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===M?c.ref:(c=function(V){var pe=k.refs;V===null?delete pe[M]:pe[M]=V},c._stringRef=M,c)}if(typeof o!="string")throw Error(n(284));if(!h._owner)throw Error(n(290,o))}return o}function am(o,c){throw o=Object.prototype.toString.call(c),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o))}function eN(o){var c=o._init;return c(o._payload)}function tN(o){function c(Me,Ce){if(o){var Be=Me.deletions;Be===null?(Me.deletions=[Ce],Me.flags|=16):Be.push(Ce)}}function h(Me,Ce){if(!o)return null;for(;Ce!==null;)c(Me,Ce),Ce=Ce.sibling;return null}function x(Me,Ce){for(Me=new Map;Ce!==null;)Ce.key!==null?Me.set(Ce.key,Ce):Me.set(Ce.index,Ce),Ce=Ce.sibling;return Me}function k(Me,Ce){return Me=Zi(Me,Ce),Me.index=0,Me.sibling=null,Me}function M(Me,Ce,Be){return Me.index=Be,o?(Be=Me.alternate,Be!==null?(Be=Be.index,Be<Ce?(Me.flags|=2,Ce):Be):(Me.flags|=2,Ce)):(Me.flags|=1048576,Ce)}function V(Me){return o&&Me.alternate===null&&(Me.flags|=2),Me}function pe(Me,Ce,Be,wt){return Ce===null||Ce.tag!==6?(Ce=Ag(Be,Me.mode,wt),Ce.return=Me,Ce):(Ce=k(Ce,Be),Ce.return=Me,Ce)}function Ne(Me,Ce,Be,wt){var Ut=Be.type;return Ut===P?ft(Me,Ce,Be.props.children,wt,Be.key):Ce!==null&&(Ce.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===ee&&eN(Ut)===Ce.type)?(wt=k(Ce,Be.props),wt.ref=Xc(Me,Ce,Be),wt.return=Me,wt):(wt=Im(Be.type,Be.key,Be.props,null,Me.mode,wt),wt.ref=Xc(Me,Ce,Be),wt.return=Me,wt)}function He(Me,Ce,Be,wt){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==Be.containerInfo||Ce.stateNode.implementation!==Be.implementation?(Ce=Ig(Be,Me.mode,wt),Ce.return=Me,Ce):(Ce=k(Ce,Be.children||[]),Ce.return=Me,Ce)}function ft(Me,Ce,Be,wt,Ut){return Ce===null||Ce.tag!==7?(Ce=Oo(Be,Me.mode,wt,Ut),Ce.return=Me,Ce):(Ce=k(Ce,Be),Ce.return=Me,Ce)}function pt(Me,Ce,Be){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return Ce=Ag(""+Ce,Me.mode,Be),Ce.return=Me,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case I:return Be=Im(Ce.type,Ce.key,Ce.props,null,Me.mode,Be),Be.ref=Xc(Me,null,Ce),Be.return=Me,Be;case C:return Ce=Ig(Ce,Me.mode,Be),Ce.return=Me,Ce;case ee:var wt=Ce._init;return pt(Me,wt(Ce._payload),Be)}if(rt(Ce)||Q(Ce))return Ce=Oo(Ce,Me.mode,Be,null),Ce.return=Me,Ce;am(Me,Ce)}return null}function mt(Me,Ce,Be,wt){var Ut=Ce!==null?Ce.key:null;if(typeof Be=="string"&&Be!==""||typeof Be=="number")return Ut!==null?null:pe(Me,Ce,""+Be,wt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case I:return Be.key===Ut?Ne(Me,Ce,Be,wt):null;case C:return Be.key===Ut?He(Me,Ce,Be,wt):null;case ee:return Ut=Be._init,mt(Me,Ce,Ut(Be._payload),wt)}if(rt(Be)||Q(Be))return Ut!==null?null:ft(Me,Ce,Be,wt,null);am(Me,Be)}return null}function At(Me,Ce,Be,wt,Ut){if(typeof wt=="string"&&wt!==""||typeof wt=="number")return Me=Me.get(Be)||null,pe(Ce,Me,""+wt,Ut);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case I:return Me=Me.get(wt.key===null?Be:wt.key)||null,Ne(Ce,Me,wt,Ut);case C:return Me=Me.get(wt.key===null?Be:wt.key)||null,He(Ce,Me,wt,Ut);case ee:var Gt=wt._init;return At(Me,Ce,Be,Gt(wt._payload),Ut)}if(rt(wt)||Q(wt))return Me=Me.get(Be)||null,ft(Ce,Me,wt,Ut,null);am(Ce,wt)}return null}function Tt(Me,Ce,Be,wt){for(var Ut=null,Gt=null,Xt=Ce,ir=Ce=0,Wn=null;Xt!==null&&ir<Be.length;ir++){Xt.index>ir?(Wn=Xt,Xt=null):Wn=Xt.sibling;var Pr=mt(Me,Xt,Be[ir],wt);if(Pr===null){Xt===null&&(Xt=Wn);break}o&&Xt&&Pr.alternate===null&&c(Me,Xt),Ce=M(Pr,Ce,ir),Gt===null?Ut=Pr:Gt.sibling=Pr,Gt=Pr,Xt=Wn}if(ir===Be.length)return h(Me,Xt),rn&&Co(Me,ir),Ut;if(Xt===null){for(;ir<Be.length;ir++)Xt=pt(Me,Be[ir],wt),Xt!==null&&(Ce=M(Xt,Ce,ir),Gt===null?Ut=Xt:Gt.sibling=Xt,Gt=Xt);return rn&&Co(Me,ir),Ut}for(Xt=x(Me,Xt);ir<Be.length;ir++)Wn=At(Xt,Me,ir,Be[ir],wt),Wn!==null&&(o&&Wn.alternate!==null&&Xt.delete(Wn.key===null?ir:Wn.key),Ce=M(Wn,Ce,ir),Gt===null?Ut=Wn:Gt.sibling=Wn,Gt=Wn);return o&&Xt.forEach(function(Qi){return c(Me,Qi)}),rn&&Co(Me,ir),Ut}function Rt(Me,Ce,Be,wt){var Ut=Q(Be);if(typeof Ut!="function")throw Error(n(150));if(Be=Ut.call(Be),Be==null)throw Error(n(151));for(var Gt=Ut=null,Xt=Ce,ir=Ce=0,Wn=null,Pr=Be.next();Xt!==null&&!Pr.done;ir++,Pr=Be.next()){Xt.index>ir?(Wn=Xt,Xt=null):Wn=Xt.sibling;var Qi=mt(Me,Xt,Pr.value,wt);if(Qi===null){Xt===null&&(Xt=Wn);break}o&&Xt&&Qi.alternate===null&&c(Me,Xt),Ce=M(Qi,Ce,ir),Gt===null?Ut=Qi:Gt.sibling=Qi,Gt=Qi,Xt=Wn}if(Pr.done)return h(Me,Xt),rn&&Co(Me,ir),Ut;if(Xt===null){for(;!Pr.done;ir++,Pr=Be.next())Pr=pt(Me,Pr.value,wt),Pr!==null&&(Ce=M(Pr,Ce,ir),Gt===null?Ut=Pr:Gt.sibling=Pr,Gt=Pr);return rn&&Co(Me,ir),Ut}for(Xt=x(Me,Xt);!Pr.done;ir++,Pr=Be.next())Pr=At(Xt,Me,ir,Pr.value,wt),Pr!==null&&(o&&Pr.alternate!==null&&Xt.delete(Pr.key===null?ir:Pr.key),Ce=M(Pr,Ce,ir),Gt===null?Ut=Pr:Gt.sibling=Pr,Gt=Pr);return o&&Xt.forEach(function(h_){return c(Me,h_)}),rn&&Co(Me,ir),Ut}function bn(Me,Ce,Be,wt){if(typeof Be=="object"&&Be!==null&&Be.type===P&&Be.key===null&&(Be=Be.props.children),typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case I:e:{for(var Ut=Be.key,Gt=Ce;Gt!==null;){if(Gt.key===Ut){if(Ut=Be.type,Ut===P){if(Gt.tag===7){h(Me,Gt.sibling),Ce=k(Gt,Be.props.children),Ce.return=Me,Me=Ce;break e}}else if(Gt.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===ee&&eN(Ut)===Gt.type){h(Me,Gt.sibling),Ce=k(Gt,Be.props),Ce.ref=Xc(Me,Gt,Be),Ce.return=Me,Me=Ce;break e}h(Me,Gt);break}else c(Me,Gt);Gt=Gt.sibling}Be.type===P?(Ce=Oo(Be.props.children,Me.mode,wt,Be.key),Ce.return=Me,Me=Ce):(wt=Im(Be.type,Be.key,Be.props,null,Me.mode,wt),wt.ref=Xc(Me,Ce,Be),wt.return=Me,Me=wt)}return V(Me);case C:e:{for(Gt=Be.key;Ce!==null;){if(Ce.key===Gt)if(Ce.tag===4&&Ce.stateNode.containerInfo===Be.containerInfo&&Ce.stateNode.implementation===Be.implementation){h(Me,Ce.sibling),Ce=k(Ce,Be.children||[]),Ce.return=Me,Me=Ce;break e}else{h(Me,Ce);break}else c(Me,Ce);Ce=Ce.sibling}Ce=Ig(Be,Me.mode,wt),Ce.return=Me,Me=Ce}return V(Me);case ee:return Gt=Be._init,bn(Me,Ce,Gt(Be._payload),wt)}if(rt(Be))return Tt(Me,Ce,Be,wt);if(Q(Be))return Rt(Me,Ce,Be,wt);am(Me,Be)}return typeof Be=="string"&&Be!==""||typeof Be=="number"?(Be=""+Be,Ce!==null&&Ce.tag===6?(h(Me,Ce.sibling),Ce=k(Ce,Be),Ce.return=Me,Me=Ce):(h(Me,Ce),Ce=Ag(Be,Me.mode,wt),Ce.return=Me,Me=Ce),V(Me)):h(Me,Ce)}return bn}var kl=tN(!0),rN=tN(!1),sm=zi(null),im=null,Al=null,$p=null;function Lp(){$p=Al=im=null}function Fp(o){var c=sm.current;Qr(sm),o._currentValue=c}function Bp(o,c,h){for(;o!==null;){var x=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),o===h)break;o=o.return}}function Il(o,c){im=o,$p=Al=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&c)!==0&&(Ma=!0),o.firstContext=null)}function os(o){var c=o._currentValue;if($p!==o)if(o={context:o,memoizedValue:c,next:null},Al===null){if(im===null)throw Error(n(308));Al=o,im.dependencies={lanes:0,firstContext:o}}else Al=Al.next=o;return c}var ko=null;function Up(o){ko===null?ko=[o]:ko.push(o)}function nN(o,c,h,x){var k=c.interleaved;return k===null?(h.next=h,Up(c)):(h.next=k.next,k.next=h),c.interleaved=h,fi(o,x)}function fi(o,c){o.lanes|=c;var h=o.alternate;for(h!==null&&(h.lanes|=c),h=o,o=o.return;o!==null;)o.childLanes|=c,h=o.alternate,h!==null&&(h.childLanes|=c),h=o,o=o.return;return h.tag===3?h.stateNode:null}var Vi=!1;function zp(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aN(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function pi(o,c){return{eventTime:o,lane:c,tag:0,payload:null,callback:null,next:null}}function Wi(o,c,h){var x=o.updateQueue;if(x===null)return null;if(x=x.shared,(Cr&2)!==0){var k=x.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),x.pending=c,fi(o,h)}return k=x.interleaved,k===null?(c.next=c,Up(x)):(c.next=k.next,k.next=c),x.interleaved=c,fi(o,h)}function om(o,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var x=c.lanes;x&=o.pendingLanes,h|=x,c.lanes=h,bt(o,h)}}function sN(o,c){var h=o.updateQueue,x=o.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var k=null,M=null;if(h=h.firstBaseUpdate,h!==null){do{var V={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};M===null?k=M=V:M=M.next=V,h=h.next}while(h!==null);M===null?k=M=c:M=M.next=c}else k=M=c;h={baseState:x.baseState,firstBaseUpdate:k,lastBaseUpdate:M,shared:x.shared,effects:x.effects},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=c:o.next=c,h.lastBaseUpdate=c}function lm(o,c,h,x){var k=o.updateQueue;Vi=!1;var M=k.firstBaseUpdate,V=k.lastBaseUpdate,pe=k.shared.pending;if(pe!==null){k.shared.pending=null;var Ne=pe,He=Ne.next;Ne.next=null,V===null?M=He:V.next=He,V=Ne;var ft=o.alternate;ft!==null&&(ft=ft.updateQueue,pe=ft.lastBaseUpdate,pe!==V&&(pe===null?ft.firstBaseUpdate=He:pe.next=He,ft.lastBaseUpdate=Ne))}if(M!==null){var pt=k.baseState;V=0,ft=He=Ne=null,pe=M;do{var mt=pe.lane,At=pe.eventTime;if((x&mt)===mt){ft!==null&&(ft=ft.next={eventTime:At,lane:0,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null});e:{var Tt=o,Rt=pe;switch(mt=c,At=h,Rt.tag){case 1:if(Tt=Rt.payload,typeof Tt=="function"){pt=Tt.call(At,pt,mt);break e}pt=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=Rt.payload,mt=typeof Tt=="function"?Tt.call(At,pt,mt):Tt,mt==null)break e;pt=Y({},pt,mt);break e;case 2:Vi=!0}}pe.callback!==null&&pe.lane!==0&&(o.flags|=64,mt=k.effects,mt===null?k.effects=[pe]:mt.push(pe))}else At={eventTime:At,lane:mt,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},ft===null?(He=ft=At,Ne=pt):ft=ft.next=At,V|=mt;if(pe=pe.next,pe===null){if(pe=k.shared.pending,pe===null)break;mt=pe,pe=mt.next,mt.next=null,k.lastBaseUpdate=mt,k.shared.pending=null}}while(!0);if(ft===null&&(Ne=pt),k.baseState=Ne,k.firstBaseUpdate=He,k.lastBaseUpdate=ft,c=k.shared.interleaved,c!==null){k=c;do V|=k.lane,k=k.next;while(k!==c)}else M===null&&(k.shared.lanes=0);Eo|=V,o.lanes=V,o.memoizedState=pt}}function iN(o,c,h){if(o=c.effects,c.effects=null,o!==null)for(c=0;c<o.length;c++){var x=o[c],k=x.callback;if(k!==null){if(x.callback=null,x=h,typeof k!="function")throw Error(n(191,k));k.call(x)}}}var Jc={},Us=zi(Jc),Zc=zi(Jc),Qc=zi(Jc);function Ao(o){if(o===Jc)throw Error(n(174));return o}function qp(o,c){switch(Kr(Qc,c),Kr(Zc,o),Kr(Us,Jc),o=c.nodeType,o){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Ft(null,"");break;default:o=o===8?c.parentNode:c,c=o.namespaceURI||null,o=o.tagName,c=Ft(c,o)}Qr(Us),Kr(Us,c)}function El(){Qr(Us),Qr(Zc),Qr(Qc)}function oN(o){Ao(Qc.current);var c=Ao(Us.current),h=Ft(c,o.type);c!==h&&(Kr(Zc,o),Kr(Us,h))}function Hp(o){Zc.current===o&&(Qr(Us),Qr(Zc))}var ln=zi(0);function cm(o){for(var c=o;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Vp=[];function Wp(){for(var o=0;o<Vp.length;o++)Vp[o]._workInProgressVersionPrimary=null;Vp.length=0}var dm=A.ReactCurrentDispatcher,Yp=A.ReactCurrentBatchConfig,Io=0,cn=null,Dn=null,Hn=null,um=!1,ed=!1,td=0,M5=0;function ua(){throw Error(n(321))}function Kp(o,c){if(c===null)return!1;for(var h=0;h<c.length&&h<o.length;h++)if(!Ns(o[h],c[h]))return!1;return!0}function Gp(o,c,h,x,k,M){if(Io=M,cn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,dm.current=o===null||o.memoizedState===null?F5:B5,o=h(x,k),ed){M=0;do{if(ed=!1,td=0,25<=M)throw Error(n(301));M+=1,Hn=Dn=null,c.updateQueue=null,dm.current=U5,o=h(x,k)}while(ed)}if(dm.current=fm,c=Dn!==null&&Dn.next!==null,Io=0,Hn=Dn=cn=null,um=!1,c)throw Error(n(300));return o}function Xp(){var o=td!==0;return td=0,o}function zs(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?cn.memoizedState=Hn=o:Hn=Hn.next=o,Hn}function ls(){if(Dn===null){var o=cn.alternate;o=o!==null?o.memoizedState:null}else o=Dn.next;var c=Hn===null?cn.memoizedState:Hn.next;if(c!==null)Hn=c,Dn=o;else{if(o===null)throw Error(n(310));Dn=o,o={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},Hn===null?cn.memoizedState=Hn=o:Hn=Hn.next=o}return Hn}function rd(o,c){return typeof c=="function"?c(o):c}function Jp(o){var c=ls(),h=c.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=o;var x=Dn,k=x.baseQueue,M=h.pending;if(M!==null){if(k!==null){var V=k.next;k.next=M.next,M.next=V}x.baseQueue=k=M,h.pending=null}if(k!==null){M=k.next,x=x.baseState;var pe=V=null,Ne=null,He=M;do{var ft=He.lane;if((Io&ft)===ft)Ne!==null&&(Ne=Ne.next={lane:0,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null}),x=He.hasEagerState?He.eagerState:o(x,He.action);else{var pt={lane:ft,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null};Ne===null?(pe=Ne=pt,V=x):Ne=Ne.next=pt,cn.lanes|=ft,Eo|=ft}He=He.next}while(He!==null&&He!==M);Ne===null?V=x:Ne.next=pe,Ns(x,c.memoizedState)||(Ma=!0),c.memoizedState=x,c.baseState=V,c.baseQueue=Ne,h.lastRenderedState=x}if(o=h.interleaved,o!==null){k=o;do M=k.lane,cn.lanes|=M,Eo|=M,k=k.next;while(k!==o)}else k===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function Zp(o){var c=ls(),h=c.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=o;var x=h.dispatch,k=h.pending,M=c.memoizedState;if(k!==null){h.pending=null;var V=k=k.next;do M=o(M,V.action),V=V.next;while(V!==k);Ns(M,c.memoizedState)||(Ma=!0),c.memoizedState=M,c.baseQueue===null&&(c.baseState=M),h.lastRenderedState=M}return[M,x]}function lN(){}function cN(o,c){var h=cn,x=ls(),k=c(),M=!Ns(x.memoizedState,k);if(M&&(x.memoizedState=k,Ma=!0),x=x.queue,Qp(mN.bind(null,h,x,o),[o]),x.getSnapshot!==c||M||Hn!==null&&Hn.memoizedState.tag&1){if(h.flags|=2048,nd(9,uN.bind(null,h,x,k,c),void 0,null),Vn===null)throw Error(n(349));(Io&30)!==0||dN(h,c,k)}return k}function dN(o,c,h){o.flags|=16384,o={getSnapshot:c,value:h},c=cn.updateQueue,c===null?(c={lastEffect:null,stores:null},cn.updateQueue=c,c.stores=[o]):(h=c.stores,h===null?c.stores=[o]:h.push(o))}function uN(o,c,h,x){c.value=h,c.getSnapshot=x,hN(c)&&fN(o)}function mN(o,c,h){return h(function(){hN(c)&&fN(o)})}function hN(o){var c=o.getSnapshot;o=o.value;try{var h=c();return!Ns(o,h)}catch{return!0}}function fN(o){var c=fi(o,1);c!==null&&Is(c,o,1,-1)}function pN(o){var c=zs();return typeof o=="function"&&(o=o()),c.memoizedState=c.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rd,lastRenderedState:o},c.queue=o,o=o.dispatch=L5.bind(null,cn,o),[c.memoizedState,o]}function nd(o,c,h,x){return o={tag:o,create:c,destroy:h,deps:x,next:null},c=cn.updateQueue,c===null?(c={lastEffect:null,stores:null},cn.updateQueue=c,c.lastEffect=o.next=o):(h=c.lastEffect,h===null?c.lastEffect=o.next=o:(x=h.next,h.next=o,o.next=x,c.lastEffect=o)),o}function gN(){return ls().memoizedState}function mm(o,c,h,x){var k=zs();cn.flags|=o,k.memoizedState=nd(1|c,h,void 0,x===void 0?null:x)}function hm(o,c,h,x){var k=ls();x=x===void 0?null:x;var M=void 0;if(Dn!==null){var V=Dn.memoizedState;if(M=V.destroy,x!==null&&Kp(x,V.deps)){k.memoizedState=nd(c,h,M,x);return}}cn.flags|=o,k.memoizedState=nd(1|c,h,M,x)}function xN(o,c){return mm(8390656,8,o,c)}function Qp(o,c){return hm(2048,8,o,c)}function yN(o,c){return hm(4,2,o,c)}function bN(o,c){return hm(4,4,o,c)}function vN(o,c){if(typeof c=="function")return o=o(),c(o),function(){c(null)};if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function wN(o,c,h){return h=h!=null?h.concat([o]):null,hm(4,4,vN.bind(null,c,o),h)}function eg(){}function jN(o,c){var h=ls();c=c===void 0?null:c;var x=h.memoizedState;return x!==null&&c!==null&&Kp(c,x[1])?x[0]:(h.memoizedState=[o,c],o)}function NN(o,c){var h=ls();c=c===void 0?null:c;var x=h.memoizedState;return x!==null&&c!==null&&Kp(c,x[1])?x[0]:(o=o(),h.memoizedState=[o,c],o)}function SN(o,c,h){return(Io&21)===0?(o.baseState&&(o.baseState=!1,Ma=!0),o.memoizedState=h):(Ns(h,c)||(h=ce(),cn.lanes|=h,Eo|=h,o.baseState=!0),c)}function R5(o,c){var h=St;St=h!==0&&4>h?h:4,o(!0);var x=Yp.transition;Yp.transition={};try{o(!1),c()}finally{St=h,Yp.transition=x}}function CN(){return ls().memoizedState}function $5(o,c,h){var x=Xi(o);if(h={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null},kN(o))AN(c,h);else if(h=nN(o,c,h,x),h!==null){var k=Ca();Is(h,o,x,k),IN(h,c,x)}}function L5(o,c,h){var x=Xi(o),k={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null};if(kN(o))AN(c,k);else{var M=o.alternate;if(o.lanes===0&&(M===null||M.lanes===0)&&(M=c.lastRenderedReducer,M!==null))try{var V=c.lastRenderedState,pe=M(V,h);if(k.hasEagerState=!0,k.eagerState=pe,Ns(pe,V)){var Ne=c.interleaved;Ne===null?(k.next=k,Up(c)):(k.next=Ne.next,Ne.next=k),c.interleaved=k;return}}catch{}finally{}h=nN(o,c,k,x),h!==null&&(k=Ca(),Is(h,o,x,k),IN(h,c,x))}}function kN(o){var c=o.alternate;return o===cn||c!==null&&c===cn}function AN(o,c){ed=um=!0;var h=o.pending;h===null?c.next=c:(c.next=h.next,h.next=c),o.pending=c}function IN(o,c,h){if((h&4194240)!==0){var x=c.lanes;x&=o.pendingLanes,h|=x,c.lanes=h,bt(o,h)}}var fm={readContext:os,useCallback:ua,useContext:ua,useEffect:ua,useImperativeHandle:ua,useInsertionEffect:ua,useLayoutEffect:ua,useMemo:ua,useReducer:ua,useRef:ua,useState:ua,useDebugValue:ua,useDeferredValue:ua,useTransition:ua,useMutableSource:ua,useSyncExternalStore:ua,useId:ua,unstable_isNewReconciler:!1},F5={readContext:os,useCallback:function(o,c){return zs().memoizedState=[o,c===void 0?null:c],o},useContext:os,useEffect:xN,useImperativeHandle:function(o,c,h){return h=h!=null?h.concat([o]):null,mm(4194308,4,vN.bind(null,c,o),h)},useLayoutEffect:function(o,c){return mm(4194308,4,o,c)},useInsertionEffect:function(o,c){return mm(4,2,o,c)},useMemo:function(o,c){var h=zs();return c=c===void 0?null:c,o=o(),h.memoizedState=[o,c],o},useReducer:function(o,c,h){var x=zs();return c=h!==void 0?h(c):c,x.memoizedState=x.baseState=c,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:c},x.queue=o,o=o.dispatch=$5.bind(null,cn,o),[x.memoizedState,o]},useRef:function(o){var c=zs();return o={current:o},c.memoizedState=o},useState:pN,useDebugValue:eg,useDeferredValue:function(o){return zs().memoizedState=o},useTransition:function(){var o=pN(!1),c=o[0];return o=R5.bind(null,o[1]),zs().memoizedState=o,[c,o]},useMutableSource:function(){},useSyncExternalStore:function(o,c,h){var x=cn,k=zs();if(rn){if(h===void 0)throw Error(n(407));h=h()}else{if(h=c(),Vn===null)throw Error(n(349));(Io&30)!==0||dN(x,c,h)}k.memoizedState=h;var M={value:h,getSnapshot:c};return k.queue=M,xN(mN.bind(null,x,M,o),[o]),x.flags|=2048,nd(9,uN.bind(null,x,M,h,c),void 0,null),h},useId:function(){var o=zs(),c=Vn.identifierPrefix;if(rn){var h=hi,x=mi;h=(x&~(1<<32-on(x)-1)).toString(32)+h,c=":"+c+"R"+h,h=td++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=M5++,c=":"+c+"r"+h.toString(32)+":";return o.memoizedState=c},unstable_isNewReconciler:!1},B5={readContext:os,useCallback:jN,useContext:os,useEffect:Qp,useImperativeHandle:wN,useInsertionEffect:yN,useLayoutEffect:bN,useMemo:NN,useReducer:Jp,useRef:gN,useState:function(){return Jp(rd)},useDebugValue:eg,useDeferredValue:function(o){var c=ls();return SN(c,Dn.memoizedState,o)},useTransition:function(){var o=Jp(rd)[0],c=ls().memoizedState;return[o,c]},useMutableSource:lN,useSyncExternalStore:cN,useId:CN,unstable_isNewReconciler:!1},U5={readContext:os,useCallback:jN,useContext:os,useEffect:Qp,useImperativeHandle:wN,useInsertionEffect:yN,useLayoutEffect:bN,useMemo:NN,useReducer:Zp,useRef:gN,useState:function(){return Zp(rd)},useDebugValue:eg,useDeferredValue:function(o){var c=ls();return Dn===null?c.memoizedState=o:SN(c,Dn.memoizedState,o)},useTransition:function(){var o=Zp(rd)[0],c=ls().memoizedState;return[o,c]},useMutableSource:lN,useSyncExternalStore:cN,useId:CN,unstable_isNewReconciler:!1};function Cs(o,c){if(o&&o.defaultProps){c=Y({},c),o=o.defaultProps;for(var h in o)c[h]===void 0&&(c[h]=o[h]);return c}return c}function tg(o,c,h,x){c=o.memoizedState,h=h(x,c),h=h==null?c:Y({},c,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var pm={isMounted:function(o){return(o=o._reactInternals)?Bt(o)===o:!1},enqueueSetState:function(o,c,h){o=o._reactInternals;var x=Ca(),k=Xi(o),M=pi(x,k);M.payload=c,h!=null&&(M.callback=h),c=Wi(o,M,k),c!==null&&(Is(c,o,k,x),om(c,o,k))},enqueueReplaceState:function(o,c,h){o=o._reactInternals;var x=Ca(),k=Xi(o),M=pi(x,k);M.tag=1,M.payload=c,h!=null&&(M.callback=h),c=Wi(o,M,k),c!==null&&(Is(c,o,k,x),om(c,o,k))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var h=Ca(),x=Xi(o),k=pi(h,x);k.tag=2,c!=null&&(k.callback=c),c=Wi(o,k,x),c!==null&&(Is(c,o,x,h),om(c,o,x))}};function EN(o,c,h,x,k,M,V){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(x,M,V):c.prototype&&c.prototype.isPureReactComponent?!qc(h,x)||!qc(k,M):!0}function PN(o,c,h){var x=!1,k=qi,M=c.contextType;return typeof M=="object"&&M!==null?M=os(M):(k=_a(c)?No:da.current,x=c.contextTypes,M=(x=x!=null)?jl(o,k):qi),c=new c(h,M),o.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=pm,o.stateNode=c,c._reactInternals=o,x&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=k,o.__reactInternalMemoizedMaskedChildContext=M),c}function TN(o,c,h,x){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,x),c.state!==o&&pm.enqueueReplaceState(c,c.state,null)}function rg(o,c,h,x){var k=o.stateNode;k.props=h,k.state=o.memoizedState,k.refs={},zp(o);var M=c.contextType;typeof M=="object"&&M!==null?k.context=os(M):(M=_a(c)?No:da.current,k.context=jl(o,M)),k.state=o.memoizedState,M=c.getDerivedStateFromProps,typeof M=="function"&&(tg(o,c,M,h),k.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(c=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),c!==k.state&&pm.enqueueReplaceState(k,k.state,null),lm(o,h,k,x),k.state=o.memoizedState),typeof k.componentDidMount=="function"&&(o.flags|=4194308)}function Pl(o,c){try{var h="",x=c;do h+=he(x),x=x.return;while(x);var k=h}catch(M){k=`
Error generating stack: `+M.message+`
`+M.stack}return{value:o,source:c,stack:k,digest:null}}function ng(o,c,h){return{value:o,source:null,stack:h??null,digest:c??null}}function ag(o,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var z5=typeof WeakMap=="function"?WeakMap:Map;function DN(o,c,h){h=pi(-1,h),h.tag=3,h.payload={element:null};var x=c.value;return h.callback=function(){jm||(jm=!0,bg=x),ag(o,c)},h}function ON(o,c,h){h=pi(-1,h),h.tag=3;var x=o.type.getDerivedStateFromError;if(typeof x=="function"){var k=c.value;h.payload=function(){return x(k)},h.callback=function(){ag(o,c)}}var M=o.stateNode;return M!==null&&typeof M.componentDidCatch=="function"&&(h.callback=function(){ag(o,c),typeof x!="function"&&(Ki===null?Ki=new Set([this]):Ki.add(this));var V=c.stack;this.componentDidCatch(c.value,{componentStack:V!==null?V:""})}),h}function _N(o,c,h){var x=o.pingCache;if(x===null){x=o.pingCache=new z5;var k=new Set;x.set(c,k)}else k=x.get(c),k===void 0&&(k=new Set,x.set(c,k));k.has(h)||(k.add(h),o=r_.bind(null,o,c,h),c.then(o,o))}function MN(o){do{var c;if((c=o.tag===13)&&(c=o.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return o;o=o.return}while(o!==null);return null}function RN(o,c,h,x,k){return(o.mode&1)===0?(o===c?o.flags|=65536:(o.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=pi(-1,1),c.tag=2,Wi(h,c,1))),h.lanes|=1),o):(o.flags|=65536,o.lanes=k,o)}var q5=A.ReactCurrentOwner,Ma=!1;function Sa(o,c,h,x){c.child=o===null?rN(c,null,h,x):kl(c,o.child,h,x)}function $N(o,c,h,x,k){h=h.render;var M=c.ref;return Il(c,k),x=Gp(o,c,h,x,M,k),h=Xp(),o!==null&&!Ma?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~k,gi(o,c,k)):(rn&&h&&Dp(c),c.flags|=1,Sa(o,c,x,k),c.child)}function LN(o,c,h,x,k){if(o===null){var M=h.type;return typeof M=="function"&&!kg(M)&&M.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=M,FN(o,c,M,x,k)):(o=Im(h.type,null,x,c,c.mode,k),o.ref=c.ref,o.return=c,c.child=o)}if(M=o.child,(o.lanes&k)===0){var V=M.memoizedProps;if(h=h.compare,h=h!==null?h:qc,h(V,x)&&o.ref===c.ref)return gi(o,c,k)}return c.flags|=1,o=Zi(M,x),o.ref=c.ref,o.return=c,c.child=o}function FN(o,c,h,x,k){if(o!==null){var M=o.memoizedProps;if(qc(M,x)&&o.ref===c.ref)if(Ma=!1,c.pendingProps=x=M,(o.lanes&k)!==0)(o.flags&131072)!==0&&(Ma=!0);else return c.lanes=o.lanes,gi(o,c,k)}return sg(o,c,h,x,k)}function BN(o,c,h){var x=c.pendingProps,k=x.children,M=o!==null?o.memoizedState:null;if(x.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kr(Dl,Xa),Xa|=h;else{if((h&1073741824)===0)return o=M!==null?M.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:o,cachePool:null,transitions:null},c.updateQueue=null,Kr(Dl,Xa),Xa|=o,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=M!==null?M.baseLanes:h,Kr(Dl,Xa),Xa|=x}else M!==null?(x=M.baseLanes|h,c.memoizedState=null):x=h,Kr(Dl,Xa),Xa|=x;return Sa(o,c,k,h),c.child}function UN(o,c){var h=c.ref;(o===null&&h!==null||o!==null&&o.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function sg(o,c,h,x,k){var M=_a(h)?No:da.current;return M=jl(c,M),Il(c,k),h=Gp(o,c,h,x,M,k),x=Xp(),o!==null&&!Ma?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~k,gi(o,c,k)):(rn&&x&&Dp(c),c.flags|=1,Sa(o,c,h,k),c.child)}function zN(o,c,h,x,k){if(_a(h)){var M=!0;Qu(c)}else M=!1;if(Il(c,k),c.stateNode===null)xm(o,c),PN(c,h,x),rg(c,h,x,k),x=!0;else if(o===null){var V=c.stateNode,pe=c.memoizedProps;V.props=pe;var Ne=V.context,He=h.contextType;typeof He=="object"&&He!==null?He=os(He):(He=_a(h)?No:da.current,He=jl(c,He));var ft=h.getDerivedStateFromProps,pt=typeof ft=="function"||typeof V.getSnapshotBeforeUpdate=="function";pt||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(pe!==x||Ne!==He)&&TN(c,V,x,He),Vi=!1;var mt=c.memoizedState;V.state=mt,lm(c,x,V,k),Ne=c.memoizedState,pe!==x||mt!==Ne||Oa.current||Vi?(typeof ft=="function"&&(tg(c,h,ft,x),Ne=c.memoizedState),(pe=Vi||EN(c,h,pe,x,mt,Ne,He))?(pt||typeof V.UNSAFE_componentWillMount!="function"&&typeof V.componentWillMount!="function"||(typeof V.componentWillMount=="function"&&V.componentWillMount(),typeof V.UNSAFE_componentWillMount=="function"&&V.UNSAFE_componentWillMount()),typeof V.componentDidMount=="function"&&(c.flags|=4194308)):(typeof V.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Ne),V.props=x,V.state=Ne,V.context=He,x=pe):(typeof V.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{V=c.stateNode,aN(o,c),pe=c.memoizedProps,He=c.type===c.elementType?pe:Cs(c.type,pe),V.props=He,pt=c.pendingProps,mt=V.context,Ne=h.contextType,typeof Ne=="object"&&Ne!==null?Ne=os(Ne):(Ne=_a(h)?No:da.current,Ne=jl(c,Ne));var At=h.getDerivedStateFromProps;(ft=typeof At=="function"||typeof V.getSnapshotBeforeUpdate=="function")||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(pe!==pt||mt!==Ne)&&TN(c,V,x,Ne),Vi=!1,mt=c.memoizedState,V.state=mt,lm(c,x,V,k);var Tt=c.memoizedState;pe!==pt||mt!==Tt||Oa.current||Vi?(typeof At=="function"&&(tg(c,h,At,x),Tt=c.memoizedState),(He=Vi||EN(c,h,He,x,mt,Tt,Ne)||!1)?(ft||typeof V.UNSAFE_componentWillUpdate!="function"&&typeof V.componentWillUpdate!="function"||(typeof V.componentWillUpdate=="function"&&V.componentWillUpdate(x,Tt,Ne),typeof V.UNSAFE_componentWillUpdate=="function"&&V.UNSAFE_componentWillUpdate(x,Tt,Ne)),typeof V.componentDidUpdate=="function"&&(c.flags|=4),typeof V.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof V.componentDidUpdate!="function"||pe===o.memoizedProps&&mt===o.memoizedState||(c.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||pe===o.memoizedProps&&mt===o.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Tt),V.props=x,V.state=Tt,V.context=Ne,x=He):(typeof V.componentDidUpdate!="function"||pe===o.memoizedProps&&mt===o.memoizedState||(c.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||pe===o.memoizedProps&&mt===o.memoizedState||(c.flags|=1024),x=!1)}return ig(o,c,h,x,M,k)}function ig(o,c,h,x,k,M){UN(o,c);var V=(c.flags&128)!==0;if(!x&&!V)return k&&Yj(c,h,!1),gi(o,c,M);x=c.stateNode,q5.current=c;var pe=V&&typeof h.getDerivedStateFromError!="function"?null:x.render();return c.flags|=1,o!==null&&V?(c.child=kl(c,o.child,null,M),c.child=kl(c,null,pe,M)):Sa(o,c,pe,M),c.memoizedState=x.state,k&&Yj(c,h,!0),c.child}function qN(o){var c=o.stateNode;c.pendingContext?Vj(o,c.pendingContext,c.pendingContext!==c.context):c.context&&Vj(o,c.context,!1),qp(o,c.containerInfo)}function HN(o,c,h,x,k){return Cl(),Rp(k),c.flags|=256,Sa(o,c,h,x),c.child}var og={dehydrated:null,treeContext:null,retryLane:0};function lg(o){return{baseLanes:o,cachePool:null,transitions:null}}function VN(o,c,h){var x=c.pendingProps,k=ln.current,M=!1,V=(c.flags&128)!==0,pe;if((pe=V)||(pe=o!==null&&o.memoizedState===null?!1:(k&2)!==0),pe?(M=!0,c.flags&=-129):(o===null||o.memoizedState!==null)&&(k|=1),Kr(ln,k&1),o===null)return Mp(c),o=c.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((c.mode&1)===0?c.lanes=1:o.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(V=x.children,o=x.fallback,M?(x=c.mode,M=c.child,V={mode:"hidden",children:V},(x&1)===0&&M!==null?(M.childLanes=0,M.pendingProps=V):M=Em(V,x,0,null),o=Oo(o,x,h,null),M.return=c,o.return=c,M.sibling=o,c.child=M,c.child.memoizedState=lg(h),c.memoizedState=og,o):cg(c,V));if(k=o.memoizedState,k!==null&&(pe=k.dehydrated,pe!==null))return H5(o,c,V,x,pe,k,h);if(M){M=x.fallback,V=c.mode,k=o.child,pe=k.sibling;var Ne={mode:"hidden",children:x.children};return(V&1)===0&&c.child!==k?(x=c.child,x.childLanes=0,x.pendingProps=Ne,c.deletions=null):(x=Zi(k,Ne),x.subtreeFlags=k.subtreeFlags&14680064),pe!==null?M=Zi(pe,M):(M=Oo(M,V,h,null),M.flags|=2),M.return=c,x.return=c,x.sibling=M,c.child=x,x=M,M=c.child,V=o.child.memoizedState,V=V===null?lg(h):{baseLanes:V.baseLanes|h,cachePool:null,transitions:V.transitions},M.memoizedState=V,M.childLanes=o.childLanes&~h,c.memoizedState=og,x}return M=o.child,o=M.sibling,x=Zi(M,{mode:"visible",children:x.children}),(c.mode&1)===0&&(x.lanes=h),x.return=c,x.sibling=null,o!==null&&(h=c.deletions,h===null?(c.deletions=[o],c.flags|=16):h.push(o)),c.child=x,c.memoizedState=null,x}function cg(o,c){return c=Em({mode:"visible",children:c},o.mode,0,null),c.return=o,o.child=c}function gm(o,c,h,x){return x!==null&&Rp(x),kl(c,o.child,null,h),o=cg(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function H5(o,c,h,x,k,M,V){if(h)return c.flags&256?(c.flags&=-257,x=ng(Error(n(422))),gm(o,c,V,x)):c.memoizedState!==null?(c.child=o.child,c.flags|=128,null):(M=x.fallback,k=c.mode,x=Em({mode:"visible",children:x.children},k,0,null),M=Oo(M,k,V,null),M.flags|=2,x.return=c,M.return=c,x.sibling=M,c.child=x,(c.mode&1)!==0&&kl(c,o.child,null,V),c.child.memoizedState=lg(V),c.memoizedState=og,M);if((c.mode&1)===0)return gm(o,c,V,null);if(k.data==="$!"){if(x=k.nextSibling&&k.nextSibling.dataset,x)var pe=x.dgst;return x=pe,M=Error(n(419)),x=ng(M,x,void 0),gm(o,c,V,x)}if(pe=(V&o.childLanes)!==0,Ma||pe){if(x=Vn,x!==null){switch(V&-V){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(x.suspendedLanes|V))!==0?0:k,k!==0&&k!==M.retryLane&&(M.retryLane=k,fi(o,k),Is(x,o,k,-1))}return Cg(),x=ng(Error(n(421))),gm(o,c,V,x)}return k.data==="$?"?(c.flags|=128,c.child=o.child,c=n_.bind(null,o),k._reactRetry=c,null):(o=M.treeContext,Ga=Ui(k.nextSibling),Ka=c,rn=!0,Ss=null,o!==null&&(ss[is++]=mi,ss[is++]=hi,ss[is++]=So,mi=o.id,hi=o.overflow,So=c),c=cg(c,x.children),c.flags|=4096,c)}function WN(o,c,h){o.lanes|=c;var x=o.alternate;x!==null&&(x.lanes|=c),Bp(o.return,c,h)}function dg(o,c,h,x,k){var M=o.memoizedState;M===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:k}:(M.isBackwards=c,M.rendering=null,M.renderingStartTime=0,M.last=x,M.tail=h,M.tailMode=k)}function YN(o,c,h){var x=c.pendingProps,k=x.revealOrder,M=x.tail;if(Sa(o,c,x.children,h),x=ln.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&WN(o,h,c);else if(o.tag===19)WN(o,h,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}x&=1}if(Kr(ln,x),(c.mode&1)===0)c.memoizedState=null;else switch(k){case"forwards":for(h=c.child,k=null;h!==null;)o=h.alternate,o!==null&&cm(o)===null&&(k=h),h=h.sibling;h=k,h===null?(k=c.child,c.child=null):(k=h.sibling,h.sibling=null),dg(c,!1,k,h,M);break;case"backwards":for(h=null,k=c.child,c.child=null;k!==null;){if(o=k.alternate,o!==null&&cm(o)===null){c.child=k;break}o=k.sibling,k.sibling=h,h=k,k=o}dg(c,!0,h,null,M);break;case"together":dg(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function xm(o,c){(c.mode&1)===0&&o!==null&&(o.alternate=null,c.alternate=null,c.flags|=2)}function gi(o,c,h){if(o!==null&&(c.dependencies=o.dependencies),Eo|=c.lanes,(h&c.childLanes)===0)return null;if(o!==null&&c.child!==o.child)throw Error(n(153));if(c.child!==null){for(o=c.child,h=Zi(o,o.pendingProps),c.child=h,h.return=c;o.sibling!==null;)o=o.sibling,h=h.sibling=Zi(o,o.pendingProps),h.return=c;h.sibling=null}return c.child}function V5(o,c,h){switch(c.tag){case 3:qN(c),Cl();break;case 5:oN(c);break;case 1:_a(c.type)&&Qu(c);break;case 4:qp(c,c.stateNode.containerInfo);break;case 10:var x=c.type._context,k=c.memoizedProps.value;Kr(sm,x._currentValue),x._currentValue=k;break;case 13:if(x=c.memoizedState,x!==null)return x.dehydrated!==null?(Kr(ln,ln.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?VN(o,c,h):(Kr(ln,ln.current&1),o=gi(o,c,h),o!==null?o.sibling:null);Kr(ln,ln.current&1);break;case 19:if(x=(h&c.childLanes)!==0,(o.flags&128)!==0){if(x)return YN(o,c,h);c.flags|=128}if(k=c.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),Kr(ln,ln.current),x)break;return null;case 22:case 23:return c.lanes=0,BN(o,c,h)}return gi(o,c,h)}var KN,ug,GN,XN;KN=function(o,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)o.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},ug=function(){},GN=function(o,c,h,x){var k=o.memoizedProps;if(k!==x){o=c.stateNode,Ao(Us.current);var M=null;switch(h){case"input":k=Ie(o,k),x=Ie(o,x),M=[];break;case"select":k=Y({},k,{value:void 0}),x=Y({},x,{value:void 0}),M=[];break;case"textarea":k=kt(o,k),x=kt(o,x),M=[];break;default:typeof k.onClick!="function"&&typeof x.onClick=="function"&&(o.onclick=Xu)}Ot(h,x);var V;h=null;for(He in k)if(!x.hasOwnProperty(He)&&k.hasOwnProperty(He)&&k[He]!=null)if(He==="style"){var pe=k[He];for(V in pe)pe.hasOwnProperty(V)&&(h||(h={}),h[V]="")}else He!=="dangerouslySetInnerHTML"&&He!=="children"&&He!=="suppressContentEditableWarning"&&He!=="suppressHydrationWarning"&&He!=="autoFocus"&&(s.hasOwnProperty(He)?M||(M=[]):(M=M||[]).push(He,null));for(He in x){var Ne=x[He];if(pe=k?.[He],x.hasOwnProperty(He)&&Ne!==pe&&(Ne!=null||pe!=null))if(He==="style")if(pe){for(V in pe)!pe.hasOwnProperty(V)||Ne&&Ne.hasOwnProperty(V)||(h||(h={}),h[V]="");for(V in Ne)Ne.hasOwnProperty(V)&&pe[V]!==Ne[V]&&(h||(h={}),h[V]=Ne[V])}else h||(M||(M=[]),M.push(He,h)),h=Ne;else He==="dangerouslySetInnerHTML"?(Ne=Ne?Ne.__html:void 0,pe=pe?pe.__html:void 0,Ne!=null&&pe!==Ne&&(M=M||[]).push(He,Ne)):He==="children"?typeof Ne!="string"&&typeof Ne!="number"||(M=M||[]).push(He,""+Ne):He!=="suppressContentEditableWarning"&&He!=="suppressHydrationWarning"&&(s.hasOwnProperty(He)?(Ne!=null&&He==="onScroll"&&Zr("scroll",o),M||pe===Ne||(M=[])):(M=M||[]).push(He,Ne))}h&&(M=M||[]).push("style",h);var He=M;(c.updateQueue=He)&&(c.flags|=4)}},XN=function(o,c,h,x){h!==x&&(c.flags|=4)};function ad(o,c){if(!rn)switch(o.tailMode){case"hidden":c=o.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:x.sibling=null}}function ma(o){var c=o.alternate!==null&&o.alternate.child===o.child,h=0,x=0;if(c)for(var k=o.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags&14680064,x|=k.flags&14680064,k.return=o,k=k.sibling;else for(k=o.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags,x|=k.flags,k.return=o,k=k.sibling;return o.subtreeFlags|=x,o.childLanes=h,c}function W5(o,c,h){var x=c.pendingProps;switch(Op(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ma(c),null;case 1:return _a(c.type)&&Zu(),ma(c),null;case 3:return x=c.stateNode,El(),Qr(Oa),Qr(da),Wp(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(o===null||o.child===null)&&(nm(c)?c.flags|=4:o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ss!==null&&(jg(Ss),Ss=null))),ug(o,c),ma(c),null;case 5:Hp(c);var k=Ao(Qc.current);if(h=c.type,o!==null&&c.stateNode!=null)GN(o,c,h,x,k),o.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!x){if(c.stateNode===null)throw Error(n(166));return ma(c),null}if(o=Ao(Us.current),nm(c)){x=c.stateNode,h=c.type;var M=c.memoizedProps;switch(x[Bs]=c,x[Kc]=M,o=(c.mode&1)!==0,h){case"dialog":Zr("cancel",x),Zr("close",x);break;case"iframe":case"object":case"embed":Zr("load",x);break;case"video":case"audio":for(k=0;k<Vc.length;k++)Zr(Vc[k],x);break;case"source":Zr("error",x);break;case"img":case"image":case"link":Zr("error",x),Zr("load",x);break;case"details":Zr("toggle",x);break;case"input":je(x,M),Zr("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!M.multiple},Zr("invalid",x);break;case"textarea":Oe(x,M),Zr("invalid",x)}Ot(h,M),k=null;for(var V in M)if(M.hasOwnProperty(V)){var pe=M[V];V==="children"?typeof pe=="string"?x.textContent!==pe&&(M.suppressHydrationWarning!==!0&&Gu(x.textContent,pe,o),k=["children",pe]):typeof pe=="number"&&x.textContent!==""+pe&&(M.suppressHydrationWarning!==!0&&Gu(x.textContent,pe,o),k=["children",""+pe]):s.hasOwnProperty(V)&&pe!=null&&V==="onScroll"&&Zr("scroll",x)}switch(h){case"input":Te(x),et(x,M,!0);break;case"textarea":Te(x),Mt(x);break;case"select":case"option":break;default:typeof M.onClick=="function"&&(x.onclick=Xu)}x=k,c.updateQueue=x,x!==null&&(c.flags|=4)}else{V=k.nodeType===9?k:k.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=rr(h)),o==="http://www.w3.org/1999/xhtml"?h==="script"?(o=V.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof x.is=="string"?o=V.createElement(h,{is:x.is}):(o=V.createElement(h),h==="select"&&(V=o,x.multiple?V.multiple=!0:x.size&&(V.size=x.size))):o=V.createElementNS(o,h),o[Bs]=c,o[Kc]=x,KN(o,c,!1,!1),c.stateNode=o;e:{switch(V=vt(h,x),h){case"dialog":Zr("cancel",o),Zr("close",o),k=x;break;case"iframe":case"object":case"embed":Zr("load",o),k=x;break;case"video":case"audio":for(k=0;k<Vc.length;k++)Zr(Vc[k],o);k=x;break;case"source":Zr("error",o),k=x;break;case"img":case"image":case"link":Zr("error",o),Zr("load",o),k=x;break;case"details":Zr("toggle",o),k=x;break;case"input":je(o,x),k=Ie(o,x),Zr("invalid",o);break;case"option":k=x;break;case"select":o._wrapperState={wasMultiple:!!x.multiple},k=Y({},x,{value:void 0}),Zr("invalid",o);break;case"textarea":Oe(o,x),k=kt(o,x),Zr("invalid",o);break;default:k=x}Ot(h,k),pe=k;for(M in pe)if(pe.hasOwnProperty(M)){var Ne=pe[M];M==="style"?gt(o,Ne):M==="dangerouslySetInnerHTML"?(Ne=Ne?Ne.__html:void 0,Ne!=null&&or(o,Ne)):M==="children"?typeof Ne=="string"?(h!=="textarea"||Ne!=="")&&ke(o,Ne):typeof Ne=="number"&&ke(o,""+Ne):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(s.hasOwnProperty(M)?Ne!=null&&M==="onScroll"&&Zr("scroll",o):Ne!=null&&T(o,M,Ne,V))}switch(h){case"input":Te(o),et(o,x,!1);break;case"textarea":Te(o),Mt(o);break;case"option":x.value!=null&&o.setAttribute("value",""+re(x.value));break;case"select":o.multiple=!!x.multiple,M=x.value,M!=null?Lt(o,!!x.multiple,M,!1):x.defaultValue!=null&&Lt(o,!!x.multiple,x.defaultValue,!0);break;default:typeof k.onClick=="function"&&(o.onclick=Xu)}switch(h){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return ma(c),null;case 6:if(o&&c.stateNode!=null)XN(o,c,o.memoizedProps,x);else{if(typeof x!="string"&&c.stateNode===null)throw Error(n(166));if(h=Ao(Qc.current),Ao(Us.current),nm(c)){if(x=c.stateNode,h=c.memoizedProps,x[Bs]=c,(M=x.nodeValue!==h)&&(o=Ka,o!==null))switch(o.tag){case 3:Gu(x.nodeValue,h,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Gu(x.nodeValue,h,(o.mode&1)!==0)}M&&(c.flags|=4)}else x=(h.nodeType===9?h:h.ownerDocument).createTextNode(x),x[Bs]=c,c.stateNode=x}return ma(c),null;case 13:if(Qr(ln),x=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(rn&&Ga!==null&&(c.mode&1)!==0&&(c.flags&128)===0)Qj(),Cl(),c.flags|=98560,M=!1;else if(M=nm(c),x!==null&&x.dehydrated!==null){if(o===null){if(!M)throw Error(n(318));if(M=c.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(n(317));M[Bs]=c}else Cl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;ma(c),M=!1}else Ss!==null&&(jg(Ss),Ss=null),M=!0;if(!M)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(x=x!==null,x!==(o!==null&&o.memoizedState!==null)&&x&&(c.child.flags|=8192,(c.mode&1)!==0&&(o===null||(ln.current&1)!==0?On===0&&(On=3):Cg())),c.updateQueue!==null&&(c.flags|=4),ma(c),null);case 4:return El(),ug(o,c),o===null&&Wc(c.stateNode.containerInfo),ma(c),null;case 10:return Fp(c.type._context),ma(c),null;case 17:return _a(c.type)&&Zu(),ma(c),null;case 19:if(Qr(ln),M=c.memoizedState,M===null)return ma(c),null;if(x=(c.flags&128)!==0,V=M.rendering,V===null)if(x)ad(M,!1);else{if(On!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(V=cm(o),V!==null){for(c.flags|=128,ad(M,!1),x=V.updateQueue,x!==null&&(c.updateQueue=x,c.flags|=4),c.subtreeFlags=0,x=h,h=c.child;h!==null;)M=h,o=x,M.flags&=14680066,V=M.alternate,V===null?(M.childLanes=0,M.lanes=o,M.child=null,M.subtreeFlags=0,M.memoizedProps=null,M.memoizedState=null,M.updateQueue=null,M.dependencies=null,M.stateNode=null):(M.childLanes=V.childLanes,M.lanes=V.lanes,M.child=V.child,M.subtreeFlags=0,M.deletions=null,M.memoizedProps=V.memoizedProps,M.memoizedState=V.memoizedState,M.updateQueue=V.updateQueue,M.type=V.type,o=V.dependencies,M.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),h=h.sibling;return Kr(ln,ln.current&1|2),c.child}o=o.sibling}M.tail!==null&&er()>Ol&&(c.flags|=128,x=!0,ad(M,!1),c.lanes=4194304)}else{if(!x)if(o=cm(V),o!==null){if(c.flags|=128,x=!0,h=o.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),ad(M,!0),M.tail===null&&M.tailMode==="hidden"&&!V.alternate&&!rn)return ma(c),null}else 2*er()-M.renderingStartTime>Ol&&h!==1073741824&&(c.flags|=128,x=!0,ad(M,!1),c.lanes=4194304);M.isBackwards?(V.sibling=c.child,c.child=V):(h=M.last,h!==null?h.sibling=V:c.child=V,M.last=V)}return M.tail!==null?(c=M.tail,M.rendering=c,M.tail=c.sibling,M.renderingStartTime=er(),c.sibling=null,h=ln.current,Kr(ln,x?h&1|2:h&1),c):(ma(c),null);case 22:case 23:return Sg(),x=c.memoizedState!==null,o!==null&&o.memoizedState!==null!==x&&(c.flags|=8192),x&&(c.mode&1)!==0?(Xa&1073741824)!==0&&(ma(c),c.subtreeFlags&6&&(c.flags|=8192)):ma(c),null;case 24:return null;case 25:return null}throw Error(n(156,c.tag))}function Y5(o,c){switch(Op(c),c.tag){case 1:return _a(c.type)&&Zu(),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return El(),Qr(Oa),Qr(da),Wp(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 5:return Hp(c),null;case 13:if(Qr(ln),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(n(340));Cl()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return Qr(ln),null;case 4:return El(),null;case 10:return Fp(c.type._context),null;case 22:case 23:return Sg(),null;case 24:return null;default:return null}}var ym=!1,ha=!1,K5=typeof WeakSet=="function"?WeakSet:Set,It=null;function Tl(o,c){var h=o.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(x){hn(o,c,x)}else h.current=null}function mg(o,c,h){try{h()}catch(x){hn(o,c,x)}}var JN=!1;function G5(o,c){if(Sp=ur,o=Ej(),gp(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var k=x.anchorOffset,M=x.focusNode;x=x.focusOffset;try{h.nodeType,M.nodeType}catch{h=null;break e}var V=0,pe=-1,Ne=-1,He=0,ft=0,pt=o,mt=null;t:for(;;){for(var At;pt!==h||k!==0&&pt.nodeType!==3||(pe=V+k),pt!==M||x!==0&&pt.nodeType!==3||(Ne=V+x),pt.nodeType===3&&(V+=pt.nodeValue.length),(At=pt.firstChild)!==null;)mt=pt,pt=At;for(;;){if(pt===o)break t;if(mt===h&&++He===k&&(pe=V),mt===M&&++ft===x&&(Ne=V),(At=pt.nextSibling)!==null)break;pt=mt,mt=pt.parentNode}pt=At}h=pe===-1||Ne===-1?null:{start:pe,end:Ne}}else h=null}h=h||{start:0,end:0}}else h=null;for(Cp={focusedElem:o,selectionRange:h},ur=!1,It=c;It!==null;)if(c=It,o=c.child,(c.subtreeFlags&1028)!==0&&o!==null)o.return=c,It=o;else for(;It!==null;){c=It;try{var Tt=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Tt!==null){var Rt=Tt.memoizedProps,bn=Tt.memoizedState,Me=c.stateNode,Ce=Me.getSnapshotBeforeUpdate(c.elementType===c.type?Rt:Cs(c.type,Rt),bn);Me.__reactInternalSnapshotBeforeUpdate=Ce}break;case 3:var Be=c.stateNode.containerInfo;Be.nodeType===1?Be.textContent="":Be.nodeType===9&&Be.documentElement&&Be.removeChild(Be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(wt){hn(c,c.return,wt)}if(o=c.sibling,o!==null){o.return=c.return,It=o;break}It=c.return}return Tt=JN,JN=!1,Tt}function sd(o,c,h){var x=c.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var k=x=x.next;do{if((k.tag&o)===o){var M=k.destroy;k.destroy=void 0,M!==void 0&&mg(c,h,M)}k=k.next}while(k!==x)}}function bm(o,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&o)===o){var x=h.create;h.destroy=x()}h=h.next}while(h!==c)}}function hg(o){var c=o.ref;if(c!==null){var h=o.stateNode;switch(o.tag){case 5:o=h;break;default:o=h}typeof c=="function"?c(o):c.current=o}}function ZN(o){var c=o.alternate;c!==null&&(o.alternate=null,ZN(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&(delete c[Bs],delete c[Kc],delete c[Ep],delete c[T5],delete c[D5])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function QN(o){return o.tag===5||o.tag===3||o.tag===4}function e2(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||QN(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function fg(o,c,h){var x=o.tag;if(x===5||x===6)o=o.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(o,c):h.insertBefore(o,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(o,h)):(c=h,c.appendChild(o)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Xu));else if(x!==4&&(o=o.child,o!==null))for(fg(o,c,h),o=o.sibling;o!==null;)fg(o,c,h),o=o.sibling}function pg(o,c,h){var x=o.tag;if(x===5||x===6)o=o.stateNode,c?h.insertBefore(o,c):h.appendChild(o);else if(x!==4&&(o=o.child,o!==null))for(pg(o,c,h),o=o.sibling;o!==null;)pg(o,c,h),o=o.sibling}var ra=null,ks=!1;function Yi(o,c,h){for(h=h.child;h!==null;)t2(o,c,h),h=h.sibling}function t2(o,c,h){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(Fn,h)}catch{}switch(h.tag){case 5:ha||Tl(h,c);case 6:var x=ra,k=ks;ra=null,Yi(o,c,h),ra=x,ks=k,ra!==null&&(ks?(o=ra,h=h.stateNode,o.nodeType===8?o.parentNode.removeChild(h):o.removeChild(h)):ra.removeChild(h.stateNode));break;case 18:ra!==null&&(ks?(o=ra,h=h.stateNode,o.nodeType===8?Ip(o.parentNode,h):o.nodeType===1&&Ip(o,h),Jt(o)):Ip(ra,h.stateNode));break;case 4:x=ra,k=ks,ra=h.stateNode.containerInfo,ks=!0,Yi(o,c,h),ra=x,ks=k;break;case 0:case 11:case 14:case 15:if(!ha&&(x=h.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){k=x=x.next;do{var M=k,V=M.destroy;M=M.tag,V!==void 0&&((M&2)!==0||(M&4)!==0)&&mg(h,c,V),k=k.next}while(k!==x)}Yi(o,c,h);break;case 1:if(!ha&&(Tl(h,c),x=h.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=h.memoizedProps,x.state=h.memoizedState,x.componentWillUnmount()}catch(pe){hn(h,c,pe)}Yi(o,c,h);break;case 21:Yi(o,c,h);break;case 22:h.mode&1?(ha=(x=ha)||h.memoizedState!==null,Yi(o,c,h),ha=x):Yi(o,c,h);break;default:Yi(o,c,h)}}function r2(o){var c=o.updateQueue;if(c!==null){o.updateQueue=null;var h=o.stateNode;h===null&&(h=o.stateNode=new K5),c.forEach(function(x){var k=a_.bind(null,o,x);h.has(x)||(h.add(x),x.then(k,k))})}}function As(o,c){var h=c.deletions;if(h!==null)for(var x=0;x<h.length;x++){var k=h[x];try{var M=o,V=c,pe=V;e:for(;pe!==null;){switch(pe.tag){case 5:ra=pe.stateNode,ks=!1;break e;case 3:ra=pe.stateNode.containerInfo,ks=!0;break e;case 4:ra=pe.stateNode.containerInfo,ks=!0;break e}pe=pe.return}if(ra===null)throw Error(n(160));t2(M,V,k),ra=null,ks=!1;var Ne=k.alternate;Ne!==null&&(Ne.return=null),k.return=null}catch(He){hn(k,c,He)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)n2(c,o),c=c.sibling}function n2(o,c){var h=o.alternate,x=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(As(c,o),qs(o),x&4){try{sd(3,o,o.return),bm(3,o)}catch(Rt){hn(o,o.return,Rt)}try{sd(5,o,o.return)}catch(Rt){hn(o,o.return,Rt)}}break;case 1:As(c,o),qs(o),x&512&&h!==null&&Tl(h,h.return);break;case 5:if(As(c,o),qs(o),x&512&&h!==null&&Tl(h,h.return),o.flags&32){var k=o.stateNode;try{ke(k,"")}catch(Rt){hn(o,o.return,Rt)}}if(x&4&&(k=o.stateNode,k!=null)){var M=o.memoizedProps,V=h!==null?h.memoizedProps:M,pe=o.type,Ne=o.updateQueue;if(o.updateQueue=null,Ne!==null)try{pe==="input"&&M.type==="radio"&&M.name!=null&&oe(k,M),vt(pe,V);var He=vt(pe,M);for(V=0;V<Ne.length;V+=2){var ft=Ne[V],pt=Ne[V+1];ft==="style"?gt(k,pt):ft==="dangerouslySetInnerHTML"?or(k,pt):ft==="children"?ke(k,pt):T(k,ft,pt,He)}switch(pe){case"input":$e(k,M);break;case"textarea":Nt(k,M);break;case"select":var mt=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!M.multiple;var At=M.value;At!=null?Lt(k,!!M.multiple,At,!1):mt!==!!M.multiple&&(M.defaultValue!=null?Lt(k,!!M.multiple,M.defaultValue,!0):Lt(k,!!M.multiple,M.multiple?[]:"",!1))}k[Kc]=M}catch(Rt){hn(o,o.return,Rt)}}break;case 6:if(As(c,o),qs(o),x&4){if(o.stateNode===null)throw Error(n(162));k=o.stateNode,M=o.memoizedProps;try{k.nodeValue=M}catch(Rt){hn(o,o.return,Rt)}}break;case 3:if(As(c,o),qs(o),x&4&&h!==null&&h.memoizedState.isDehydrated)try{Jt(c.containerInfo)}catch(Rt){hn(o,o.return,Rt)}break;case 4:As(c,o),qs(o);break;case 13:As(c,o),qs(o),k=o.child,k.flags&8192&&(M=k.memoizedState!==null,k.stateNode.isHidden=M,!M||k.alternate!==null&&k.alternate.memoizedState!==null||(yg=er())),x&4&&r2(o);break;case 22:if(ft=h!==null&&h.memoizedState!==null,o.mode&1?(ha=(He=ha)||ft,As(c,o),ha=He):As(c,o),qs(o),x&8192){if(He=o.memoizedState!==null,(o.stateNode.isHidden=He)&&!ft&&(o.mode&1)!==0)for(It=o,ft=o.child;ft!==null;){for(pt=It=ft;It!==null;){switch(mt=It,At=mt.child,mt.tag){case 0:case 11:case 14:case 15:sd(4,mt,mt.return);break;case 1:Tl(mt,mt.return);var Tt=mt.stateNode;if(typeof Tt.componentWillUnmount=="function"){x=mt,h=mt.return;try{c=x,Tt.props=c.memoizedProps,Tt.state=c.memoizedState,Tt.componentWillUnmount()}catch(Rt){hn(x,h,Rt)}}break;case 5:Tl(mt,mt.return);break;case 22:if(mt.memoizedState!==null){i2(pt);continue}}At!==null?(At.return=mt,It=At):i2(pt)}ft=ft.sibling}e:for(ft=null,pt=o;;){if(pt.tag===5){if(ft===null){ft=pt;try{k=pt.stateNode,He?(M=k.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none"):(pe=pt.stateNode,Ne=pt.memoizedProps.style,V=Ne!=null&&Ne.hasOwnProperty("display")?Ne.display:null,pe.style.display=tt("display",V))}catch(Rt){hn(o,o.return,Rt)}}}else if(pt.tag===6){if(ft===null)try{pt.stateNode.nodeValue=He?"":pt.memoizedProps}catch(Rt){hn(o,o.return,Rt)}}else if((pt.tag!==22&&pt.tag!==23||pt.memoizedState===null||pt===o)&&pt.child!==null){pt.child.return=pt,pt=pt.child;continue}if(pt===o)break e;for(;pt.sibling===null;){if(pt.return===null||pt.return===o)break e;ft===pt&&(ft=null),pt=pt.return}ft===pt&&(ft=null),pt.sibling.return=pt.return,pt=pt.sibling}}break;case 19:As(c,o),qs(o),x&4&&r2(o);break;case 21:break;default:As(c,o),qs(o)}}function qs(o){var c=o.flags;if(c&2){try{e:{for(var h=o.return;h!==null;){if(QN(h)){var x=h;break e}h=h.return}throw Error(n(160))}switch(x.tag){case 5:var k=x.stateNode;x.flags&32&&(ke(k,""),x.flags&=-33);var M=e2(o);pg(o,M,k);break;case 3:case 4:var V=x.stateNode.containerInfo,pe=e2(o);fg(o,pe,V);break;default:throw Error(n(161))}}catch(Ne){hn(o,o.return,Ne)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function X5(o,c,h){It=o,a2(o)}function a2(o,c,h){for(var x=(o.mode&1)!==0;It!==null;){var k=It,M=k.child;if(k.tag===22&&x){var V=k.memoizedState!==null||ym;if(!V){var pe=k.alternate,Ne=pe!==null&&pe.memoizedState!==null||ha;pe=ym;var He=ha;if(ym=V,(ha=Ne)&&!He)for(It=k;It!==null;)V=It,Ne=V.child,V.tag===22&&V.memoizedState!==null?o2(k):Ne!==null?(Ne.return=V,It=Ne):o2(k);for(;M!==null;)It=M,a2(M),M=M.sibling;It=k,ym=pe,ha=He}s2(o)}else(k.subtreeFlags&8772)!==0&&M!==null?(M.return=k,It=M):s2(o)}}function s2(o){for(;It!==null;){var c=It;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:ha||bm(5,c);break;case 1:var x=c.stateNode;if(c.flags&4&&!ha)if(h===null)x.componentDidMount();else{var k=c.elementType===c.type?h.memoizedProps:Cs(c.type,h.memoizedProps);x.componentDidUpdate(k,h.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var M=c.updateQueue;M!==null&&iN(c,M,x);break;case 3:var V=c.updateQueue;if(V!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}iN(c,V,h)}break;case 5:var pe=c.stateNode;if(h===null&&c.flags&4){h=pe;var Ne=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":Ne.autoFocus&&h.focus();break;case"img":Ne.src&&(h.src=Ne.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var He=c.alternate;if(He!==null){var ft=He.memoizedState;if(ft!==null){var pt=ft.dehydrated;pt!==null&&Jt(pt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}ha||c.flags&512&&hg(c)}catch(mt){hn(c,c.return,mt)}}if(c===o){It=null;break}if(h=c.sibling,h!==null){h.return=c.return,It=h;break}It=c.return}}function i2(o){for(;It!==null;){var c=It;if(c===o){It=null;break}var h=c.sibling;if(h!==null){h.return=c.return,It=h;break}It=c.return}}function o2(o){for(;It!==null;){var c=It;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{bm(4,c)}catch(Ne){hn(c,h,Ne)}break;case 1:var x=c.stateNode;if(typeof x.componentDidMount=="function"){var k=c.return;try{x.componentDidMount()}catch(Ne){hn(c,k,Ne)}}var M=c.return;try{hg(c)}catch(Ne){hn(c,M,Ne)}break;case 5:var V=c.return;try{hg(c)}catch(Ne){hn(c,V,Ne)}}}catch(Ne){hn(c,c.return,Ne)}if(c===o){It=null;break}var pe=c.sibling;if(pe!==null){pe.return=c.return,It=pe;break}It=c.return}}var J5=Math.ceil,vm=A.ReactCurrentDispatcher,gg=A.ReactCurrentOwner,cs=A.ReactCurrentBatchConfig,Cr=0,Vn=null,kn=null,na=0,Xa=0,Dl=zi(0),On=0,id=null,Eo=0,wm=0,xg=0,od=null,Ra=null,yg=0,Ol=1/0,xi=null,jm=!1,bg=null,Ki=null,Nm=!1,Gi=null,Sm=0,ld=0,vg=null,Cm=-1,km=0;function Ca(){return(Cr&6)!==0?er():Cm!==-1?Cm:Cm=er()}function Xi(o){return(o.mode&1)===0?1:(Cr&2)!==0&&na!==0?na&-na:_5.transition!==null?(km===0&&(km=ce()),km):(o=St,o!==0||(o=window.event,o=o===void 0?16:un(o.type)),o)}function Is(o,c,h,x){if(50<ld)throw ld=0,vg=null,Error(n(185));De(o,h,x),((Cr&2)===0||o!==Vn)&&(o===Vn&&((Cr&2)===0&&(wm|=h),On===4&&Ji(o,na)),$a(o,x),h===1&&Cr===0&&(c.mode&1)===0&&(Ol=er()+500,em&&Hi()))}function $a(o,c){var h=o.callbackNode;q(o,c);var x=Va(o,o===Vn?na:0);if(x===0)h!==null&&Dr(h),o.callbackNode=null,o.callbackPriority=0;else if(c=x&-x,o.callbackPriority!==c){if(h!=null&&Dr(h),c===1)o.tag===0?O5(c2.bind(null,o)):Kj(c2.bind(null,o)),E5(function(){(Cr&6)===0&&Hi()}),h=null;else{switch(Kt(x)){case 1:h=xn;break;case 4:h=dn;break;case 16:h=Qn;break;case 536870912:h=jn;break;default:h=Qn}h=x2(h,l2.bind(null,o))}o.callbackPriority=c,o.callbackNode=h}}function l2(o,c){if(Cm=-1,km=0,(Cr&6)!==0)throw Error(n(327));var h=o.callbackNode;if(_l()&&o.callbackNode!==h)return null;var x=Va(o,o===Vn?na:0);if(x===0)return null;if((x&30)!==0||(x&o.expiredLanes)!==0||c)c=Am(o,x);else{c=x;var k=Cr;Cr|=2;var M=u2();(Vn!==o||na!==c)&&(xi=null,Ol=er()+500,To(o,c));do try{e_();break}catch(pe){d2(o,pe)}while(!0);Lp(),vm.current=M,Cr=k,kn!==null?c=0:(Vn=null,na=0,c=On)}if(c!==0){if(c===2&&(k=Z(o),k!==0&&(x=k,c=wg(o,k))),c===1)throw h=id,To(o,0),Ji(o,x),$a(o,er()),h;if(c===6)Ji(o,x);else{if(k=o.current.alternate,(x&30)===0&&!Z5(k)&&(c=Am(o,x),c===2&&(M=Z(o),M!==0&&(x=M,c=wg(o,M))),c===1))throw h=id,To(o,0),Ji(o,x),$a(o,er()),h;switch(o.finishedWork=k,o.finishedLanes=x,c){case 0:case 1:throw Error(n(345));case 2:Do(o,Ra,xi);break;case 3:if(Ji(o,x),(x&130023424)===x&&(c=yg+500-er(),10<c)){if(Va(o,0)!==0)break;if(k=o.suspendedLanes,(k&x)!==x){Ca(),o.pingedLanes|=o.suspendedLanes&k;break}o.timeoutHandle=Ap(Do.bind(null,o,Ra,xi),c);break}Do(o,Ra,xi);break;case 4:if(Ji(o,x),(x&4194240)===x)break;for(c=o.eventTimes,k=-1;0<x;){var V=31-on(x);M=1<<V,V=c[V],V>k&&(k=V),x&=~M}if(x=k,x=er()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*J5(x/1960))-x,10<x){o.timeoutHandle=Ap(Do.bind(null,o,Ra,xi),x);break}Do(o,Ra,xi);break;case 5:Do(o,Ra,xi);break;default:throw Error(n(329))}}}return $a(o,er()),o.callbackNode===h?l2.bind(null,o):null}function wg(o,c){var h=od;return o.current.memoizedState.isDehydrated&&(To(o,c).flags|=256),o=Am(o,c),o!==2&&(c=Ra,Ra=h,c!==null&&jg(c)),o}function jg(o){Ra===null?Ra=o:Ra.push.apply(Ra,o)}function Z5(o){for(var c=o;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var x=0;x<h.length;x++){var k=h[x],M=k.getSnapshot;k=k.value;try{if(!Ns(M(),k))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ji(o,c){for(c&=~xg,c&=~wm,o.suspendedLanes|=c,o.pingedLanes&=~c,o=o.expirationTimes;0<c;){var h=31-on(c),x=1<<h;o[h]=-1,c&=~x}}function c2(o){if((Cr&6)!==0)throw Error(n(327));_l();var c=Va(o,0);if((c&1)===0)return $a(o,er()),null;var h=Am(o,c);if(o.tag!==0&&h===2){var x=Z(o);x!==0&&(c=x,h=wg(o,x))}if(h===1)throw h=id,To(o,0),Ji(o,c),$a(o,er()),h;if(h===6)throw Error(n(345));return o.finishedWork=o.current.alternate,o.finishedLanes=c,Do(o,Ra,xi),$a(o,er()),null}function Ng(o,c){var h=Cr;Cr|=1;try{return o(c)}finally{Cr=h,Cr===0&&(Ol=er()+500,em&&Hi())}}function Po(o){Gi!==null&&Gi.tag===0&&(Cr&6)===0&&_l();var c=Cr;Cr|=1;var h=cs.transition,x=St;try{if(cs.transition=null,St=1,o)return o()}finally{St=x,cs.transition=h,Cr=c,(Cr&6)===0&&Hi()}}function Sg(){Xa=Dl.current,Qr(Dl)}function To(o,c){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;if(h!==-1&&(o.timeoutHandle=-1,I5(h)),kn!==null)for(h=kn.return;h!==null;){var x=h;switch(Op(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&Zu();break;case 3:El(),Qr(Oa),Qr(da),Wp();break;case 5:Hp(x);break;case 4:El();break;case 13:Qr(ln);break;case 19:Qr(ln);break;case 10:Fp(x.type._context);break;case 22:case 23:Sg()}h=h.return}if(Vn=o,kn=o=Zi(o.current,null),na=Xa=c,On=0,id=null,xg=wm=Eo=0,Ra=od=null,ko!==null){for(c=0;c<ko.length;c++)if(h=ko[c],x=h.interleaved,x!==null){h.interleaved=null;var k=x.next,M=h.pending;if(M!==null){var V=M.next;M.next=k,x.next=V}h.pending=x}ko=null}return o}function d2(o,c){do{var h=kn;try{if(Lp(),dm.current=fm,um){for(var x=cn.memoizedState;x!==null;){var k=x.queue;k!==null&&(k.pending=null),x=x.next}um=!1}if(Io=0,Hn=Dn=cn=null,ed=!1,td=0,gg.current=null,h===null||h.return===null){On=1,id=c,kn=null;break}e:{var M=o,V=h.return,pe=h,Ne=c;if(c=na,pe.flags|=32768,Ne!==null&&typeof Ne=="object"&&typeof Ne.then=="function"){var He=Ne,ft=pe,pt=ft.tag;if((ft.mode&1)===0&&(pt===0||pt===11||pt===15)){var mt=ft.alternate;mt?(ft.updateQueue=mt.updateQueue,ft.memoizedState=mt.memoizedState,ft.lanes=mt.lanes):(ft.updateQueue=null,ft.memoizedState=null)}var At=MN(V);if(At!==null){At.flags&=-257,RN(At,V,pe,M,c),At.mode&1&&_N(M,He,c),c=At,Ne=He;var Tt=c.updateQueue;if(Tt===null){var Rt=new Set;Rt.add(Ne),c.updateQueue=Rt}else Tt.add(Ne);break e}else{if((c&1)===0){_N(M,He,c),Cg();break e}Ne=Error(n(426))}}else if(rn&&pe.mode&1){var bn=MN(V);if(bn!==null){(bn.flags&65536)===0&&(bn.flags|=256),RN(bn,V,pe,M,c),Rp(Pl(Ne,pe));break e}}M=Ne=Pl(Ne,pe),On!==4&&(On=2),od===null?od=[M]:od.push(M),M=V;do{switch(M.tag){case 3:M.flags|=65536,c&=-c,M.lanes|=c;var Me=DN(M,Ne,c);sN(M,Me);break e;case 1:pe=Ne;var Ce=M.type,Be=M.stateNode;if((M.flags&128)===0&&(typeof Ce.getDerivedStateFromError=="function"||Be!==null&&typeof Be.componentDidCatch=="function"&&(Ki===null||!Ki.has(Be)))){M.flags|=65536,c&=-c,M.lanes|=c;var wt=ON(M,pe,c);sN(M,wt);break e}}M=M.return}while(M!==null)}h2(h)}catch(Ut){c=Ut,kn===h&&h!==null&&(kn=h=h.return);continue}break}while(!0)}function u2(){var o=vm.current;return vm.current=fm,o===null?fm:o}function Cg(){(On===0||On===3||On===2)&&(On=4),Vn===null||(Eo&268435455)===0&&(wm&268435455)===0||Ji(Vn,na)}function Am(o,c){var h=Cr;Cr|=2;var x=u2();(Vn!==o||na!==c)&&(xi=null,To(o,c));do try{Q5();break}catch(k){d2(o,k)}while(!0);if(Lp(),Cr=h,vm.current=x,kn!==null)throw Error(n(261));return Vn=null,na=0,On}function Q5(){for(;kn!==null;)m2(kn)}function e_(){for(;kn!==null&&!dr();)m2(kn)}function m2(o){var c=g2(o.alternate,o,Xa);o.memoizedProps=o.pendingProps,c===null?h2(o):kn=c,gg.current=null}function h2(o){var c=o;do{var h=c.alternate;if(o=c.return,(c.flags&32768)===0){if(h=W5(h,c,Xa),h!==null){kn=h;return}}else{if(h=Y5(h,c),h!==null){h.flags&=32767,kn=h;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{On=6,kn=null;return}}if(c=c.sibling,c!==null){kn=c;return}kn=c=o}while(c!==null);On===0&&(On=5)}function Do(o,c,h){var x=St,k=cs.transition;try{cs.transition=null,St=1,t_(o,c,h,x)}finally{cs.transition=k,St=x}return null}function t_(o,c,h,x){do _l();while(Gi!==null);if((Cr&6)!==0)throw Error(n(327));h=o.finishedWork;var k=o.finishedLanes;if(h===null)return null;if(o.finishedWork=null,o.finishedLanes=0,h===o.current)throw Error(n(177));o.callbackNode=null,o.callbackPriority=0;var M=h.lanes|h.childLanes;if(Ze(o,M),o===Vn&&(kn=Vn=null,na=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||Nm||(Nm=!0,x2(Qn,function(){return _l(),null})),M=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||M){M=cs.transition,cs.transition=null;var V=St;St=1;var pe=Cr;Cr|=4,gg.current=null,G5(o,h),n2(h,o),w5(Cp),ur=!!Sp,Cp=Sp=null,o.current=h,X5(h),Vt(),Cr=pe,St=V,cs.transition=M}else o.current=h;if(Nm&&(Nm=!1,Gi=o,Sm=k),M=o.pendingLanes,M===0&&(Ki=null),Tn(h.stateNode),$a(o,er()),c!==null)for(x=o.onRecoverableError,h=0;h<c.length;h++)k=c[h],x(k.value,{componentStack:k.stack,digest:k.digest});if(jm)throw jm=!1,o=bg,bg=null,o;return(Sm&1)!==0&&o.tag!==0&&_l(),M=o.pendingLanes,(M&1)!==0?o===vg?ld++:(ld=0,vg=o):ld=0,Hi(),null}function _l(){if(Gi!==null){var o=Kt(Sm),c=cs.transition,h=St;try{if(cs.transition=null,St=16>o?16:o,Gi===null)var x=!1;else{if(o=Gi,Gi=null,Sm=0,(Cr&6)!==0)throw Error(n(331));var k=Cr;for(Cr|=4,It=o.current;It!==null;){var M=It,V=M.child;if((It.flags&16)!==0){var pe=M.deletions;if(pe!==null){for(var Ne=0;Ne<pe.length;Ne++){var He=pe[Ne];for(It=He;It!==null;){var ft=It;switch(ft.tag){case 0:case 11:case 15:sd(8,ft,M)}var pt=ft.child;if(pt!==null)pt.return=ft,It=pt;else for(;It!==null;){ft=It;var mt=ft.sibling,At=ft.return;if(ZN(ft),ft===He){It=null;break}if(mt!==null){mt.return=At,It=mt;break}It=At}}}var Tt=M.alternate;if(Tt!==null){var Rt=Tt.child;if(Rt!==null){Tt.child=null;do{var bn=Rt.sibling;Rt.sibling=null,Rt=bn}while(Rt!==null)}}It=M}}if((M.subtreeFlags&2064)!==0&&V!==null)V.return=M,It=V;else e:for(;It!==null;){if(M=It,(M.flags&2048)!==0)switch(M.tag){case 0:case 11:case 15:sd(9,M,M.return)}var Me=M.sibling;if(Me!==null){Me.return=M.return,It=Me;break e}It=M.return}}var Ce=o.current;for(It=Ce;It!==null;){V=It;var Be=V.child;if((V.subtreeFlags&2064)!==0&&Be!==null)Be.return=V,It=Be;else e:for(V=Ce;It!==null;){if(pe=It,(pe.flags&2048)!==0)try{switch(pe.tag){case 0:case 11:case 15:bm(9,pe)}}catch(Ut){hn(pe,pe.return,Ut)}if(pe===V){It=null;break e}var wt=pe.sibling;if(wt!==null){wt.return=pe.return,It=wt;break e}It=pe.return}}if(Cr=k,Hi(),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(Fn,o)}catch{}x=!0}return x}finally{St=h,cs.transition=c}}return!1}function f2(o,c,h){c=Pl(h,c),c=DN(o,c,1),o=Wi(o,c,1),c=Ca(),o!==null&&(De(o,1,c),$a(o,c))}function hn(o,c,h){if(o.tag===3)f2(o,o,h);else for(;c!==null;){if(c.tag===3){f2(c,o,h);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ki===null||!Ki.has(x))){o=Pl(h,o),o=ON(c,o,1),c=Wi(c,o,1),o=Ca(),c!==null&&(De(c,1,o),$a(c,o));break}}c=c.return}}function r_(o,c,h){var x=o.pingCache;x!==null&&x.delete(c),c=Ca(),o.pingedLanes|=o.suspendedLanes&h,Vn===o&&(na&h)===h&&(On===4||On===3&&(na&130023424)===na&&500>er()-yg?To(o,0):xg|=h),$a(o,c)}function p2(o,c){c===0&&((o.mode&1)===0?c=1:(c=Ha,Ha<<=1,(Ha&130023424)===0&&(Ha=4194304)));var h=Ca();o=fi(o,c),o!==null&&(De(o,c,h),$a(o,h))}function n_(o){var c=o.memoizedState,h=0;c!==null&&(h=c.retryLane),p2(o,h)}function a_(o,c){var h=0;switch(o.tag){case 13:var x=o.stateNode,k=o.memoizedState;k!==null&&(h=k.retryLane);break;case 19:x=o.stateNode;break;default:throw Error(n(314))}x!==null&&x.delete(c),p2(o,h)}var g2;g2=function(o,c,h){if(o!==null)if(o.memoizedProps!==c.pendingProps||Oa.current)Ma=!0;else{if((o.lanes&h)===0&&(c.flags&128)===0)return Ma=!1,V5(o,c,h);Ma=(o.flags&131072)!==0}else Ma=!1,rn&&(c.flags&1048576)!==0&&Gj(c,rm,c.index);switch(c.lanes=0,c.tag){case 2:var x=c.type;xm(o,c),o=c.pendingProps;var k=jl(c,da.current);Il(c,h),k=Gp(null,c,x,o,k,h);var M=Xp();return c.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,_a(x)?(M=!0,Qu(c)):M=!1,c.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,zp(c),k.updater=pm,c.stateNode=k,k._reactInternals=c,rg(c,x,o,h),c=ig(null,c,x,!0,M,h)):(c.tag=0,rn&&M&&Dp(c),Sa(null,c,k,h),c=c.child),c;case 16:x=c.elementType;e:{switch(xm(o,c),o=c.pendingProps,k=x._init,x=k(x._payload),c.type=x,k=c.tag=i_(x),o=Cs(x,o),k){case 0:c=sg(null,c,x,o,h);break e;case 1:c=zN(null,c,x,o,h);break e;case 11:c=$N(null,c,x,o,h);break e;case 14:c=LN(null,c,x,Cs(x.type,o),h);break e}throw Error(n(306,x,""))}return c;case 0:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:Cs(x,k),sg(o,c,x,k,h);case 1:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:Cs(x,k),zN(o,c,x,k,h);case 3:e:{if(qN(c),o===null)throw Error(n(387));x=c.pendingProps,M=c.memoizedState,k=M.element,aN(o,c),lm(c,x,null,h);var V=c.memoizedState;if(x=V.element,M.isDehydrated)if(M={element:x,isDehydrated:!1,cache:V.cache,pendingSuspenseBoundaries:V.pendingSuspenseBoundaries,transitions:V.transitions},c.updateQueue.baseState=M,c.memoizedState=M,c.flags&256){k=Pl(Error(n(423)),c),c=HN(o,c,x,h,k);break e}else if(x!==k){k=Pl(Error(n(424)),c),c=HN(o,c,x,h,k);break e}else for(Ga=Ui(c.stateNode.containerInfo.firstChild),Ka=c,rn=!0,Ss=null,h=rN(c,null,x,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Cl(),x===k){c=gi(o,c,h);break e}Sa(o,c,x,h)}c=c.child}return c;case 5:return oN(c),o===null&&Mp(c),x=c.type,k=c.pendingProps,M=o!==null?o.memoizedProps:null,V=k.children,kp(x,k)?V=null:M!==null&&kp(x,M)&&(c.flags|=32),UN(o,c),Sa(o,c,V,h),c.child;case 6:return o===null&&Mp(c),null;case 13:return VN(o,c,h);case 4:return qp(c,c.stateNode.containerInfo),x=c.pendingProps,o===null?c.child=kl(c,null,x,h):Sa(o,c,x,h),c.child;case 11:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:Cs(x,k),$N(o,c,x,k,h);case 7:return Sa(o,c,c.pendingProps,h),c.child;case 8:return Sa(o,c,c.pendingProps.children,h),c.child;case 12:return Sa(o,c,c.pendingProps.children,h),c.child;case 10:e:{if(x=c.type._context,k=c.pendingProps,M=c.memoizedProps,V=k.value,Kr(sm,x._currentValue),x._currentValue=V,M!==null)if(Ns(M.value,V)){if(M.children===k.children&&!Oa.current){c=gi(o,c,h);break e}}else for(M=c.child,M!==null&&(M.return=c);M!==null;){var pe=M.dependencies;if(pe!==null){V=M.child;for(var Ne=pe.firstContext;Ne!==null;){if(Ne.context===x){if(M.tag===1){Ne=pi(-1,h&-h),Ne.tag=2;var He=M.updateQueue;if(He!==null){He=He.shared;var ft=He.pending;ft===null?Ne.next=Ne:(Ne.next=ft.next,ft.next=Ne),He.pending=Ne}}M.lanes|=h,Ne=M.alternate,Ne!==null&&(Ne.lanes|=h),Bp(M.return,h,c),pe.lanes|=h;break}Ne=Ne.next}}else if(M.tag===10)V=M.type===c.type?null:M.child;else if(M.tag===18){if(V=M.return,V===null)throw Error(n(341));V.lanes|=h,pe=V.alternate,pe!==null&&(pe.lanes|=h),Bp(V,h,c),V=M.sibling}else V=M.child;if(V!==null)V.return=M;else for(V=M;V!==null;){if(V===c){V=null;break}if(M=V.sibling,M!==null){M.return=V.return,V=M;break}V=V.return}M=V}Sa(o,c,k.children,h),c=c.child}return c;case 9:return k=c.type,x=c.pendingProps.children,Il(c,h),k=os(k),x=x(k),c.flags|=1,Sa(o,c,x,h),c.child;case 14:return x=c.type,k=Cs(x,c.pendingProps),k=Cs(x.type,k),LN(o,c,x,k,h);case 15:return FN(o,c,c.type,c.pendingProps,h);case 17:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:Cs(x,k),xm(o,c),c.tag=1,_a(x)?(o=!0,Qu(c)):o=!1,Il(c,h),PN(c,x,k),rg(c,x,k,h),ig(null,c,x,!0,o,h);case 19:return YN(o,c,h);case 22:return BN(o,c,h)}throw Error(n(156,c.tag))};function x2(o,c){return Ht(o,c)}function s_(o,c,h,x){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(o,c,h,x){return new s_(o,c,h,x)}function kg(o){return o=o.prototype,!(!o||!o.isReactComponent)}function i_(o){if(typeof o=="function")return kg(o)?1:0;if(o!=null){if(o=o.$$typeof,o===G)return 11;if(o===se)return 14}return 2}function Zi(o,c){var h=o.alternate;return h===null?(h=ds(o.tag,c,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=c,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&14680064,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,c=o.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h}function Im(o,c,h,x,k,M){var V=2;if(x=o,typeof o=="function")kg(o)&&(V=1);else if(typeof o=="string")V=5;else e:switch(o){case P:return Oo(h.children,k,M,c);case F:V=8,k|=8;break;case R:return o=ds(12,h,c,k|2),o.elementType=R,o.lanes=M,o;case X:return o=ds(13,h,c,k),o.elementType=X,o.lanes=M,o;case me:return o=ds(19,h,c,k),o.elementType=me,o.lanes=M,o;case W:return Em(h,k,M,c);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case $:V=10;break e;case L:V=9;break e;case G:V=11;break e;case se:V=14;break e;case ee:V=16,x=null;break e}throw Error(n(130,o==null?o:typeof o,""))}return c=ds(V,h,c,k),c.elementType=o,c.type=x,c.lanes=M,c}function Oo(o,c,h,x){return o=ds(7,o,x,c),o.lanes=h,o}function Em(o,c,h,x){return o=ds(22,o,x,c),o.elementType=W,o.lanes=h,o.stateNode={isHidden:!1},o}function Ag(o,c,h){return o=ds(6,o,null,c),o.lanes=h,o}function Ig(o,c,h){return c=ds(4,o.children!==null?o.children:[],o.key,c),c.lanes=h,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}function o_(o,c,h,x,k){this.tag=c,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fe(0),this.expirationTimes=Fe(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fe(0),this.identifierPrefix=x,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function Eg(o,c,h,x,k,M,V,pe,Ne){return o=new o_(o,c,h,pe,Ne),c===1?(c=1,M===!0&&(c|=8)):c=0,M=ds(3,null,null,c),o.current=M,M.stateNode=o,M.memoizedState={element:x,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},zp(M),o}function l_(o,c,h){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:C,key:x==null?null:""+x,children:o,containerInfo:c,implementation:h}}function y2(o){if(!o)return qi;o=o._reactInternals;e:{if(Bt(o)!==o||o.tag!==1)throw Error(n(170));var c=o;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(_a(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(n(171))}if(o.tag===1){var h=o.type;if(_a(h))return Wj(o,h,c)}return c}function b2(o,c,h,x,k,M,V,pe,Ne){return o=Eg(h,x,!0,o,k,M,V,pe,Ne),o.context=y2(null),h=o.current,x=Ca(),k=Xi(h),M=pi(x,k),M.callback=c??null,Wi(h,M,k),o.current.lanes=k,De(o,k,x),$a(o,x),o}function Pm(o,c,h,x){var k=c.current,M=Ca(),V=Xi(k);return h=y2(h),c.context===null?c.context=h:c.pendingContext=h,c=pi(M,V),c.payload={element:o},x=x===void 0?null:x,x!==null&&(c.callback=x),o=Wi(k,c,V),o!==null&&(Is(o,k,V,M),om(o,k,V)),V}function Tm(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function v2(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<c?h:c}}function Pg(o,c){v2(o,c),(o=o.alternate)&&v2(o,c)}function c_(){return null}var w2=typeof reportError=="function"?reportError:function(o){console.error(o)};function Tg(o){this._internalRoot=o}Dm.prototype.render=Tg.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(n(409));Pm(o,c,null,null)},Dm.prototype.unmount=Tg.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;Po(function(){Pm(null,o,null,null)}),c[di]=null}};function Dm(o){this._internalRoot=o}Dm.prototype.unstable_scheduleHydration=function(o){if(o){var c=ia();o={blockedOn:null,target:o,priority:c};for(var h=0;h<S.length&&c!==0&&c<S[h].priority;h++);S.splice(h,0,o),h===0&&ze(o)}};function Dg(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Om(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function j2(){}function d_(o,c,h,x,k){if(k){if(typeof x=="function"){var M=x;x=function(){var He=Tm(V);M.call(He)}}var V=b2(c,x,o,0,null,!1,!1,"",j2);return o._reactRootContainer=V,o[di]=V.current,Wc(o.nodeType===8?o.parentNode:o),Po(),V}for(;k=o.lastChild;)o.removeChild(k);if(typeof x=="function"){var pe=x;x=function(){var He=Tm(Ne);pe.call(He)}}var Ne=Eg(o,0,!1,null,null,!1,!1,"",j2);return o._reactRootContainer=Ne,o[di]=Ne.current,Wc(o.nodeType===8?o.parentNode:o),Po(function(){Pm(c,Ne,h,x)}),Ne}function _m(o,c,h,x,k){var M=h._reactRootContainer;if(M){var V=M;if(typeof k=="function"){var pe=k;k=function(){var Ne=Tm(V);pe.call(Ne)}}Pm(c,V,o,k)}else V=d_(h,c,o,k,x);return Tm(V)}ar=function(o){switch(o.tag){case 3:var c=o.stateNode;if(c.current.memoizedState.isDehydrated){var h=as(c.pendingLanes);h!==0&&(bt(c,h|1),$a(c,er()),(Cr&6)===0&&(Ol=er()+500,Hi()))}break;case 13:Po(function(){var x=fi(o,1);if(x!==null){var k=Ca();Is(x,o,1,k)}}),Pg(o,1)}},_r=function(o){if(o.tag===13){var c=fi(o,134217728);if(c!==null){var h=Ca();Is(c,o,134217728,h)}Pg(o,134217728)}},ea=function(o){if(o.tag===13){var c=Xi(o),h=fi(o,c);if(h!==null){var x=Ca();Is(h,o,c,x)}Pg(o,c)}},ia=function(){return St},Un=function(o,c){var h=St;try{return St=o,c()}finally{St=h}},Or=function(o,c,h){switch(c){case"input":if($e(o,h),c=h.name,h.type==="radio"&&c!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var x=h[c];if(x!==o&&x.form===o.form){var k=Ju(x);if(!k)throw Error(n(90));ve(x),$e(x,k)}}}break;case"textarea":Nt(o,h);break;case"select":c=h.value,c!=null&&Lt(o,!!h.multiple,c,!1)}},B=Ng,Pe=Po;var u_={usingClientEntryPoint:!1,Events:[Gc,vl,Ju,kr,b,Ng]},cd={findFiberByHostInstance:jo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},m_={bundleType:cd.bundleType,version:cd.version,rendererPackageName:cd.rendererPackageName,rendererConfig:cd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=gn(o),o===null?null:o.stateNode},findFiberByHostInstance:cd.findFiberByHostInstance||c_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mm.isDisabled&&Mm.supportsFiber)try{Fn=Mm.inject(m_),yn=Mm}catch{}}return La.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=u_,La.createPortal=function(o,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dg(c))throw Error(n(200));return l_(o,c,null,h)},La.createRoot=function(o,c){if(!Dg(o))throw Error(n(299));var h=!1,x="",k=w2;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onRecoverableError!==void 0&&(k=c.onRecoverableError)),c=Eg(o,1,!1,null,null,h,!1,x,k),o[di]=c.current,Wc(o.nodeType===8?o.parentNode:o),new Tg(c)},La.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=gn(c),o=o===null?null:o.stateNode,o},La.flushSync=function(o){return Po(o)},La.hydrate=function(o,c,h){if(!Om(c))throw Error(n(200));return _m(null,o,c,!0,h)},La.hydrateRoot=function(o,c,h){if(!Dg(o))throw Error(n(405));var x=h!=null&&h.hydratedSources||null,k=!1,M="",V=w2;if(h!=null&&(h.unstable_strictMode===!0&&(k=!0),h.identifierPrefix!==void 0&&(M=h.identifierPrefix),h.onRecoverableError!==void 0&&(V=h.onRecoverableError)),c=b2(c,null,o,1,h??null,k,!1,M,V),o[di]=c.current,Wc(o),x)for(o=0;o<x.length;o++)h=x[o],k=h._getVersion,k=k(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,k]:c.mutableSourceEagerHydrationData.push(h,k);return new Dm(c)},La.render=function(o,c,h){if(!Om(c))throw Error(n(200));return _m(null,o,c,!1,h)},La.unmountComponentAtNode=function(o){if(!Om(o))throw Error(n(40));return o._reactRootContainer?(Po(function(){_m(null,null,o,!1,function(){o._reactRootContainer=null,o[di]=null})}),!0):!1},La.unstable_batchedUpdates=Ng,La.unstable_renderSubtreeIntoContainer=function(o,c,h,x){if(!Om(h))throw Error(n(200));if(o==null||o._reactInternals===void 0)throw Error(n(38));return _m(o,c,h,!1,x)},La.version="18.3.1-next-f1338f8080-20240426",La}var P2;function w4(){if(P2)return Mg.exports;P2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Mg.exports=v_(),Mg.exports}var T2;function w_(){if(T2)return $m;T2=1;var e=w4();return $m.createRoot=e.createRoot,$m.hydrateRoot=e.hydrateRoot,$m}var j_=w_();const N_=Fr(j_);var j=Su();const xe=Fr(j),S_=f_({__proto__:null,default:xe},[j]);w4();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rd(){return Rd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Rd.apply(this,arguments)}var io;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(io||(io={}));const D2="popstate";function C_(e){e===void 0&&(e={});function t(a,s){let{pathname:i,search:l,hash:d}=a.location;return tv("",{pathname:i,search:l,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(a,s){return typeof s=="string"?s:fh(s)}return A_(t,n,null,e)}function vn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function j4(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function k_(){return Math.random().toString(36).substr(2,8)}function O2(e,t){return{usr:e.state,key:e.key,idx:t}}function tv(e,t,n,a){return n===void 0&&(n=null),Rd({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?jc(t):t,{state:n,key:t&&t.key||a||k_()})}function fh(e){let{pathname:t="/",search:n="",hash:a=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function jc(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function A_(e,t,n,a){a===void 0&&(a={});let{window:s=document.defaultView,v5Compat:i=!1}=a,l=s.history,d=io.Pop,u=null,m=p();m==null&&(m=0,l.replaceState(Rd({},l.state,{idx:m}),""));function p(){return(l.state||{idx:null}).idx}function f(){d=io.Pop;let y=p(),E=y==null?null:y-m;m=y,u&&u({action:d,location:w.location,delta:E})}function g(y,E){d=io.Push;let O=tv(w.location,y,E);m=p()+1;let T=O2(O,m),A=w.createHref(O);try{l.pushState(T,"",A)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;s.location.assign(A)}i&&u&&u({action:d,location:w.location,delta:1})}function N(y,E){d=io.Replace;let O=tv(w.location,y,E);m=p();let T=O2(O,m),A=w.createHref(O);l.replaceState(T,"",A),i&&u&&u({action:d,location:w.location,delta:0})}function v(y){let E=s.location.origin!=="null"?s.location.origin:s.location.href,O=typeof y=="string"?y:fh(y);return O=O.replace(/ $/,"%20"),vn(E,"No window.location.(origin|href) available to create URL for href: "+O),new URL(O,E)}let w={get action(){return d},get location(){return e(s,l)},listen(y){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(D2,f),u=y,()=>{s.removeEventListener(D2,f),u=null}},createHref(y){return t(s,y)},createURL:v,encodeLocation(y){let E=v(y);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:g,replace:N,go(y){return l.go(y)}};return w}var _2;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(_2||(_2={}));function I_(e,t,n){return n===void 0&&(n="/"),E_(e,t,n)}function E_(e,t,n,a){let s=typeof t=="string"?jc(t):t,i=G1(s.pathname||"/",n);if(i==null)return null;let l=N4(e);P_(l);let d=null;for(let u=0;d==null&&u<l.length;++u){let m=z_(i);d=F_(l[u],m)}return d}function N4(e,t,n,a){t===void 0&&(t=[]),n===void 0&&(n=[]),a===void 0&&(a="");let s=(i,l,d)=>{let u={relativePath:d===void 0?i.path||"":d,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};u.relativePath.startsWith("/")&&(vn(u.relativePath.startsWith(a),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(a.length));let m=lo([a,u.relativePath]),p=n.concat(u);i.children&&i.children.length>0&&(vn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),N4(i.children,t,p,m)),!(i.path==null&&!i.index)&&t.push({path:m,score:$_(m,i.index),routesMeta:p})};return e.forEach((i,l)=>{var d;if(i.path===""||!((d=i.path)!=null&&d.includes("?")))s(i,l);else for(let u of S4(i.path))s(i,l,u)}),t}function S4(e){let t=e.split("/");if(t.length===0)return[];let[n,...a]=t,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(a.length===0)return s?[i,""]:[i];let l=S4(a.join("/")),d=[];return d.push(...l.map(u=>u===""?i:[i,u].join("/"))),s&&d.push(...l),d.map(u=>e.startsWith("/")&&u===""?"/":u)}function P_(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:L_(t.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}const T_=/^:[\w-]+$/,D_=3,O_=2,__=1,M_=10,R_=-2,M2=e=>e==="*";function $_(e,t){let n=e.split("/"),a=n.length;return n.some(M2)&&(a+=R_),t&&(a+=O_),n.filter(s=>!M2(s)).reduce((s,i)=>s+(T_.test(i)?D_:i===""?__:M_),a)}function L_(e,t){return e.length===t.length&&e.slice(0,-1).every((a,s)=>a===t[s])?e[e.length-1]-t[t.length-1]:0}function F_(e,t,n){let{routesMeta:a}=e,s={},i="/",l=[];for(let d=0;d<a.length;++d){let u=a[d],m=d===a.length-1,p=i==="/"?t:t.slice(i.length)||"/",f=B_({path:u.relativePath,caseSensitive:u.caseSensitive,end:m},p),g=u.route;if(!f)return null;Object.assign(s,f.params),l.push({params:s,pathname:lo([i,f.pathname]),pathnameBase:W_(lo([i,f.pathnameBase])),route:g}),f.pathnameBase!=="/"&&(i=lo([i,f.pathnameBase]))}return l}function B_(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=U_(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),d=s.slice(1);return{params:a.reduce((m,p,f)=>{let{paramName:g,isOptional:N}=p;if(g==="*"){let w=d[f]||"";l=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const v=d[f];return N&&!v?m[g]=void 0:m[g]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:i,pathnameBase:l,pattern:e}}function U_(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),j4(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,u)=>(a.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),a]}function z_(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return j4(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function G1(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&a!=="/"?null:e.slice(n)||"/"}function q_(e,t){t===void 0&&(t="/");let{pathname:n,search:a="",hash:s=""}=typeof e=="string"?jc(e):e;return{pathname:n?n.startsWith("/")?n:H_(n,t):t,search:Y_(a),hash:K_(s)}}function H_(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Lg(e,t,n,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function V_(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function X1(e,t){let n=V_(e);return t?n.map((a,s)=>s===n.length-1?a.pathname:a.pathnameBase):n.map(a=>a.pathnameBase)}function J1(e,t,n,a){a===void 0&&(a=!1);let s;typeof e=="string"?s=jc(e):(s=Rd({},e),vn(!s.pathname||!s.pathname.includes("?"),Lg("?","pathname","search",s)),vn(!s.pathname||!s.pathname.includes("#"),Lg("#","pathname","hash",s)),vn(!s.search||!s.search.includes("#"),Lg("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,d;if(l==null)d=n;else{let f=t.length-1;if(!a&&l.startsWith("..")){let g=l.split("/");for(;g[0]==="..";)g.shift(),f-=1;s.pathname=g.join("/")}d=f>=0?t[f]:"/"}let u=q_(s,d),m=l&&l!=="/"&&l.endsWith("/"),p=(i||l===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(m||p)&&(u.pathname+="/"),u}const lo=e=>e.join("/").replace(/\/\/+/g,"/"),W_=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Y_=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,K_=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function G_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const C4=["post","put","patch","delete"];new Set(C4);const X_=["get",...C4];new Set(X_);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $d(){return $d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},$d.apply(this,arguments)}const Z1=j.createContext(null),J_=j.createContext(null),fo=j.createContext(null),ff=j.createContext(null),_i=j.createContext({outlet:null,matches:[],isDataRoute:!1}),k4=j.createContext(null);function Z_(e,t){let{relative:n}=t===void 0?{}:t;Nc()||vn(!1);let{basename:a,navigator:s}=j.useContext(fo),{hash:i,pathname:l,search:d}=I4(e,{relative:n}),u=l;return a!=="/"&&(u=l==="/"?a:lo([a,l])),s.createHref({pathname:u,search:d,hash:i})}function Nc(){return j.useContext(ff)!=null}function ni(){return Nc()||vn(!1),j.useContext(ff).location}function A4(e){j.useContext(fo).static||j.useLayoutEffect(e)}function il(){let{isDataRoute:e}=j.useContext(_i);return e?h6():Q_()}function Q_(){Nc()||vn(!1);let e=j.useContext(Z1),{basename:t,future:n,navigator:a}=j.useContext(fo),{matches:s}=j.useContext(_i),{pathname:i}=ni(),l=JSON.stringify(X1(s,n.v7_relativeSplatPath)),d=j.useRef(!1);return A4(()=>{d.current=!0}),j.useCallback(function(m,p){if(p===void 0&&(p={}),!d.current)return;if(typeof m=="number"){a.go(m);return}let f=J1(m,JSON.parse(l),i,p.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:lo([t,f.pathname])),(p.replace?a.replace:a.push)(f,p.state,p)},[t,a,l,i,e])}const e6=j.createContext(null);function t6(e){let t=j.useContext(_i).outlet;return t&&j.createElement(e6.Provider,{value:e},t)}function I4(e,t){let{relative:n}=t===void 0?{}:t,{future:a}=j.useContext(fo),{matches:s}=j.useContext(_i),{pathname:i}=ni(),l=JSON.stringify(X1(s,a.v7_relativeSplatPath));return j.useMemo(()=>J1(e,JSON.parse(l),i,n==="path"),[e,l,i,n])}function r6(e,t){return n6(e,t)}function n6(e,t,n,a){Nc()||vn(!1);let{navigator:s}=j.useContext(fo),{matches:i}=j.useContext(_i),l=i[i.length-1],d=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let m=ni(),p;if(t){var f;let y=typeof t=="string"?jc(t):t;u==="/"||(f=y.pathname)!=null&&f.startsWith(u)||vn(!1),p=y}else p=m;let g=p.pathname||"/",N=g;if(u!=="/"){let y=u.replace(/^\//,"").split("/");N="/"+g.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=I_(e,{pathname:N}),w=l6(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},d,y.params),pathname:lo([u,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:lo([u,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,a);return t&&w?j.createElement(ff.Provider,{value:{location:$d({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:io.Pop}},w):w}function a6(){let e=m6(),t=G_(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},t),n?j.createElement("pre",{style:s},n):null,null)}const s6=j.createElement(a6,null);class i6 extends j.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?j.createElement(_i.Provider,{value:this.props.routeContext},j.createElement(k4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function o6(e){let{routeContext:t,match:n,children:a}=e,s=j.useContext(Z1);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),j.createElement(_i.Provider,{value:t},a)}function l6(e,t,n,a){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),a===void 0&&(a=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=a)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let l=e,d=(s=n)==null?void 0:s.errors;if(d!=null){let p=l.findIndex(f=>f.route.id&&d?.[f.route.id]!==void 0);p>=0||vn(!1),l=l.slice(0,Math.min(l.length,p+1))}let u=!1,m=-1;if(n&&a&&a.v7_partialHydration)for(let p=0;p<l.length;p++){let f=l[p];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(m=p),f.route.id){let{loaderData:g,errors:N}=n,v=f.route.loader&&g[f.route.id]===void 0&&(!N||N[f.route.id]===void 0);if(f.route.lazy||v){u=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}return l.reduceRight((p,f,g)=>{let N,v=!1,w=null,y=null;n&&(N=d&&f.route.id?d[f.route.id]:void 0,w=f.route.errorElement||s6,u&&(m<0&&g===0?(f6("route-fallback"),v=!0,y=null):m===g&&(v=!0,y=f.route.hydrateFallbackElement||null)));let E=t.concat(l.slice(0,g+1)),O=()=>{let T;return N?T=w:v?T=y:f.route.Component?T=j.createElement(f.route.Component,null):f.route.element?T=f.route.element:T=p,j.createElement(o6,{match:f,routeContext:{outlet:p,matches:E,isDataRoute:n!=null},children:T})};return n&&(f.route.ErrorBoundary||f.route.errorElement||g===0)?j.createElement(i6,{location:n.location,revalidation:n.revalidation,component:w,error:N,children:O(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):O()},null)}var E4=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(E4||{}),P4=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(P4||{});function c6(e){let t=j.useContext(Z1);return t||vn(!1),t}function d6(e){let t=j.useContext(J_);return t||vn(!1),t}function u6(e){let t=j.useContext(_i);return t||vn(!1),t}function T4(e){let t=u6(),n=t.matches[t.matches.length-1];return n.route.id||vn(!1),n.route.id}function m6(){var e;let t=j.useContext(k4),n=d6(),a=T4();return t!==void 0?t:(e=n.errors)==null?void 0:e[a]}function h6(){let{router:e}=c6(E4.UseNavigateStable),t=T4(P4.UseNavigateStable),n=j.useRef(!1);return A4(()=>{n.current=!0}),j.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,$d({fromRouteId:t},i)))},[e,t])}const R2={};function f6(e,t,n){R2[e]||(R2[e]=!0)}function p6(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function Vs(e){let{to:t,replace:n,state:a,relative:s}=e;Nc()||vn(!1);let{future:i,static:l}=j.useContext(fo),{matches:d}=j.useContext(_i),{pathname:u}=ni(),m=il(),p=J1(t,X1(d,i.v7_relativeSplatPath),u,s==="path"),f=JSON.stringify(p);return j.useEffect(()=>m(JSON.parse(f),{replace:n,state:a,relative:s}),[m,f,s,n,a]),null}function D4(e){return t6(e.context)}function Lr(e){vn(!1)}function g6(e){let{basename:t="/",children:n=null,location:a,navigationType:s=io.Pop,navigator:i,static:l=!1,future:d}=e;Nc()&&vn(!1);let u=t.replace(/^\/*/,"/"),m=j.useMemo(()=>({basename:u,navigator:i,static:l,future:$d({v7_relativeSplatPath:!1},d)}),[u,d,i,l]);typeof a=="string"&&(a=jc(a));let{pathname:p="/",search:f="",hash:g="",state:N=null,key:v="default"}=a,w=j.useMemo(()=>{let y=G1(p,u);return y==null?null:{location:{pathname:y,search:f,hash:g,state:N,key:v},navigationType:s}},[u,p,f,g,N,v,s]);return w==null?null:j.createElement(fo.Provider,{value:m},j.createElement(ff.Provider,{children:n,value:w}))}function O4(e){let{children:t,location:n}=e;return r6(rv(t),n)}new Promise(()=>{});function rv(e,t){t===void 0&&(t=[]);let n=[];return j.Children.forEach(e,(a,s)=>{if(!j.isValidElement(a))return;let i=[...t,s];if(a.type===j.Fragment){n.push.apply(n,rv(a.props.children,i));return}a.type!==Lr&&vn(!1),!a.props.index||!a.props.children||vn(!1);let l={id:a.props.id||i.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(l.children=rv(a.props.children,i)),n.push(l)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nv(){return nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},nv.apply(this,arguments)}function x6(e,t){if(e==null)return{};var n={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function y6(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function b6(e,t){return e.button===0&&(!t||t==="_self")&&!y6(e)}const v6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],w6="6";try{window.__reactRouterVersion=w6}catch{}const j6="startTransition",$2=S_[j6];function N6(e){let{basename:t,children:n,future:a,window:s}=e,i=j.useRef();i.current==null&&(i.current=C_({window:s,v5Compat:!0}));let l=i.current,[d,u]=j.useState({action:l.action,location:l.location}),{v7_startTransition:m}=a||{},p=j.useCallback(f=>{m&&$2?$2(()=>u(f)):u(f)},[u,m]);return j.useLayoutEffect(()=>l.listen(p),[l,p]),j.useEffect(()=>p6(a),[a]),j.createElement(g6,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:l,future:a})}const S6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",C6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ph=j.forwardRef(function(t,n){let{onClick:a,relative:s,reloadDocument:i,replace:l,state:d,target:u,to:m,preventScrollReset:p,viewTransition:f}=t,g=x6(t,v6),{basename:N}=j.useContext(fo),v,w=!1;if(typeof m=="string"&&C6.test(m)&&(v=m,S6))try{let T=new URL(window.location.href),A=m.startsWith("//")?new URL(T.protocol+m):new URL(m),I=G1(A.pathname,N);A.origin===T.origin&&I!=null?m=I+A.search+A.hash:w=!0}catch{}let y=Z_(m,{relative:s}),E=k6(m,{replace:l,state:d,target:u,preventScrollReset:p,relative:s,viewTransition:f});function O(T){a&&a(T),T.defaultPrevented||E(T)}return j.createElement("a",nv({},g,{href:v||y,onClick:w||i?a:O,ref:n,target:u}))});var L2;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(L2||(L2={}));var F2;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(F2||(F2={}));function k6(e,t){let{target:n,replace:a,state:s,preventScrollReset:i,relative:l,viewTransition:d}=t===void 0?{}:t,u=il(),m=ni(),p=I4(e,{relative:l});return j.useCallback(f=>{if(b6(f,n)){f.preventDefault();let g=a!==void 0?a:fh(m)===fh(p);u(e,{replace:g,state:s,preventScrollReset:i,relative:l,viewTransition:d})}},[m,u,p,a,s,n,e,i,l,d])}const _4="https://erp-backend-kfut.onrender.com/api";async function A6(e){try{if(e.schoolCode)return await B2(e);try{return await I6(e)}catch(t){if((e.role==="admin"||e.role==="teacher"||e.role==="student"||e.role==="parent")&&e.schoolCode)return await B2(e);throw t}}catch(t){throw console.error("[LOGIN ERROR]",t),t}}async function I6(e){const t=`${_4}/auth/login`;console.log(`[LOGIN] Trying regular login for: ${e.email}`);const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,password:e.password,role:e.role})});if(!n.ok){const m=(await n.json().catch(()=>({}))).message||"Login failed";throw console.error("[REGULAR LOGIN FAIL]",m),new Error(m)}const a=await n.json(),s=String(a.user.role||"").toLowerCase(),i=a.user?.name,l=typeof i=="string"?i:i&&typeof i=="object"&&[i.firstName,i.middleName,i.lastName].filter(Boolean).join(" ").trim()||a.user.email,d={id:a.user._id||a.user.id||"",userId:a.user.userId,name:l,email:a.user.email,role:s,schoolId:a.user.schoolId,schoolName:a.user.schoolName,lastLogin:a.user.lastLogin};return console.log("[REGULAR LOGIN SUCCESS]",d),{token:a.token,user:d}}async function B2(e){if(!e.schoolCode)throw new Error("School code is required for school login");const t=`${_4}/auth/school-login`;console.log(`[LOGIN] Trying school login for: ${e.email} at school: ${e.schoolCode}`);const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:e.email,password:e.password,schoolCode:e.schoolCode,role:e.role})});if(!n.ok){const m=(await n.json().catch(()=>({}))).message||"Login failed";throw console.error("[SCHOOL LOGIN FAIL]",m),new Error(m)}const a=await n.json(),s=String(a.user.role||"").toLowerCase(),i=a.user?.name,l=typeof i=="string"?i:i&&typeof i=="object"&&[i.firstName,i.middleName,i.lastName].filter(Boolean).join(" ").trim()||a.user.email;console.log("[SCHOOL LOGIN DEBUG] Raw response data.user:",a.user),console.log("[SCHOOL LOGIN DEBUG] data.user.userId specifically:",a.user.userId),console.log("[SCHOOL LOGIN DEBUG] data.user keys:",Object.keys(a.user));const d={id:a.user._id||a.user.id||"",userId:a.user.userId,name:l,email:a.user.email,role:s,schoolId:a.user.schoolCode,schoolCode:a.user.schoolCode,schoolName:a.user.schoolCode,lastLogin:a.user.lastLogin};return console.log("[SCHOOL LOGIN SUCCESS] Mapped user:",d),console.log("[SCHOOL LOGIN SUCCESS] Mapped user.userId:",d.userId),{token:a.token,user:d}}const Id="erp.auth",M4=j.createContext(void 0);function E6(e){if(!e)return null;const t=String(e).toLowerCase().replace(/\s+/g,"").replace(/[-_]/g,"");return t==="superadmin"||t==="superadministrator"||t==="superadm"?"superadmin":t==="admin"||t==="administrator"?"admin":t==="teacher"||t==="instructor"?"teacher":t==="student"||t==="pupil"||t==="learner"?"student":t==="parent"||t==="guardian"?"parent":null}function av(e){if(!e)return{user:null,token:null,loading:!1};const t={...e};if(t.user){const n=E6(t.user.role);if(!n)return console.warn("[AUTH] Invalid role in persisted state, clearing auth"),{user:null,token:null,loading:!1};const a=t.user.name,s=typeof a=="string"?a:t.user.email||"User";let i=t.user.userId;if(!i&&t.token)try{const l=JSON.parse(atob(t.token.split(".")[1]));l.userId&&(i=l.userId,console.log("[AUTH] Extracted userId from JWT token:",i))}catch(l){console.warn("[AUTH] Failed to decode JWT token:",l)}t.user={...t.user,role:n,name:s,userId:i},console.log("[AUTH] Normalized user with userId:",t.user.userId)}return t.loading=!1,t}function P6({children:e}){const[t,n]=j.useState({user:null,token:null,loading:!0}),a=j.useCallback(d=>{localStorage.setItem(Id,JSON.stringify(d)),d.user?.schoolCode?localStorage.setItem("erp.schoolCode",d.user.schoolCode):localStorage.removeItem("erp.schoolCode")},[]);j.useEffect(()=>{console.log("[AUTH] Initializing auth context...");const d=localStorage.getItem(Id);if(d)try{const u=JSON.parse(d),m=av(u);console.log("[AUTH] Restored from localStorage:",{user:m.user?.email,role:m.user?.role,hasToken:!!m.token}),n(m),a(m)}catch(u){console.error("[AUTH] Failed to parse localStorage data:",u),n(m=>({...m,loading:!1}))}else console.log("[AUTH] No auth data in localStorage, starting fresh"),n(u=>({...u,loading:!1}))},[a]);const s=j.useCallback(async d=>{console.log("[AUTH] Login attempt:",d.email);try{const{token:u,user:m}=await A6(d),p=av({user:m,token:u,loading:!1});console.log("[AUTH] Login successful:",{user:p.user?.email,role:p.user?.role}),n(p),a(p)}catch(u){throw console.error("[AUTH] Login failed:",u),u}},[a]),i=j.useCallback(()=>{console.log("[AUTH] Logging out"),n({user:null,token:null,loading:!1}),localStorage.removeItem(Id),localStorage.removeItem("erp.schoolCode")},[]),l=j.useMemo(()=>({...t,login:s,logout:i}),[t,s,i]);return r.jsx(M4.Provider,{value:l,children:e})}function yr(){const e=j.useContext(M4);if(!e){const t=localStorage.getItem(Id);if(t)try{const n=av(JSON.parse(t));return console.warn("useAuth used outside AuthProvider, using fallback from localStorage"),{...n,loading:!1,login:async()=>{throw new Error("Cannot login outside AuthProvider")},logout:()=>{localStorage.removeItem(Id)}}}catch(n){console.error("Failed to parse auth data from localStorage",n)}throw new Error("useAuth must be used within AuthProvider")}return e}function T6(){const{user:e,token:t,loading:n}=yr(),a=ni();return n?r.jsx("div",{className:"p-6",children:"Loading"}):!t||!e?r.jsx(Vs,{to:"/login",replace:!0,state:{from:a.pathname}}):r.jsx(D4,{})}function Fg({allow:e}){const{user:t}=yr();return t?e.includes(t.role)?r.jsx(D4,{}):r.jsx(Vs,{to:"/",replace:!0}):r.jsx(Vs,{to:"/login",replace:!0})}/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),R4=(...e)=>e.filter((t,n,a)=>!!t&&a.indexOf(t)===n).join(" ");/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var O6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _6=j.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:s="",children:i,iconNode:l,...d},u)=>j.createElement("svg",{ref:u,...O6,width:t,height:t,stroke:e,strokeWidth:a?Number(n)*24/Number(t):n,className:R4("lucide",s),...d},[...l.map(([m,p])=>j.createElement(m,p)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=(e,t)=>{const n=j.forwardRef(({className:a,...s},i)=>j.createElement(_6,{ref:i,iconNode:t,className:R4(`lucide-${D6(e)}`,a),...s}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sv=Dt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=Dt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iv=Dt("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=Dt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=Dt("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ov=Dt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=Dt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $6=Dt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q1=Dt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=Dt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=Dt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lv=Dt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L6=Dt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Dt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=Dt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F6=Dt("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=Dt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=Dt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=Dt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=Dt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=Dt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Dt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=Dt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=Dt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=Dt("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tw=Dt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B6=Dt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=Dt("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U6=Dt("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=Dt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z6=Dt("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=Dt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=Dt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=Dt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H6=Dt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=Dt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=Dt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=Dt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=Dt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W6=Dt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=Dt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cv=Dt("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=Dt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=Dt("RectangleHorizontal",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=Dt("RectangleVertical",[["rect",{width:"12",height:"20",x:"6",y:"2",rx:"2",key:"1oxtiu"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=Dt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=Dt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=Dt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=Dt("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=Dt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=Dt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=Dt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z4=Dt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=Dt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=Dt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=Dt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=Dt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=Dt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=Dt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=Dt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dv=Dt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=Dt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=Dt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=Dt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function q4(e,t){return function(){return e.apply(t,arguments)}}const{toString:G6}=Object.prototype,{getPrototypeOf:rw}=Object,{iterator:vf,toStringTag:H4}=Symbol,wf=(e=>t=>{const n=G6.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Rs=e=>(e=e.toLowerCase(),t=>wf(t)===e),jf=e=>t=>typeof t===e,{isArray:Sc}=Array,Jl=jf("undefined");function Cu(e){return e!==null&&!Jl(e)&&e.constructor!==null&&!Jl(e.constructor)&&Ua(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const V4=Rs("ArrayBuffer");function X6(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&V4(e.buffer),t}const J6=jf("string"),Ua=jf("function"),W4=jf("number"),ku=e=>e!==null&&typeof e=="object",Z6=e=>e===!0||e===!1,ah=e=>{if(wf(e)!=="object")return!1;const t=rw(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(H4 in e)&&!(vf in e)},Q6=e=>{if(!ku(e)||Cu(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},eM=Rs("Date"),tM=Rs("File"),rM=Rs("Blob"),nM=Rs("FileList"),aM=e=>ku(e)&&Ua(e.pipe),sM=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ua(e.append)&&((t=wf(e))==="formdata"||t==="object"&&Ua(e.toString)&&e.toString()==="[object FormData]"))},iM=Rs("URLSearchParams"),[oM,lM,cM,dM]=["ReadableStream","Request","Response","Headers"].map(Rs),uM=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Au(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let a,s;if(typeof e!="object"&&(e=[e]),Sc(e))for(a=0,s=e.length;a<s;a++)t.call(null,e[a],a,e);else{if(Cu(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let d;for(a=0;a<l;a++)d=i[a],t.call(null,e[d],d,e)}}function Y4(e,t){if(Cu(e))return null;t=t.toLowerCase();const n=Object.keys(e);let a=n.length,s;for(;a-- >0;)if(s=n[a],t===s.toLowerCase())return s;return null}const Uo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,K4=e=>!Jl(e)&&e!==Uo;function uv(){const{caseless:e,skipUndefined:t}=K4(this)&&this||{},n={},a=(s,i)=>{const l=e&&Y4(n,i)||i;ah(n[l])&&ah(s)?n[l]=uv(n[l],s):ah(s)?n[l]=uv({},s):Sc(s)?n[l]=s.slice():(!t||!Jl(s))&&(n[l]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Au(arguments[s],a);return n}const mM=(e,t,n,{allOwnKeys:a}={})=>(Au(t,(s,i)=>{n&&Ua(s)?e[i]=q4(s,n):e[i]=s},{allOwnKeys:a}),e),hM=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),fM=(e,t,n,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},pM=(e,t,n,a)=>{let s,i,l;const d={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)l=s[i],(!a||a(l,e,t))&&!d[l]&&(t[l]=e[l],d[l]=!0);e=n!==!1&&rw(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},gM=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const a=e.indexOf(t,n);return a!==-1&&a===n},xM=e=>{if(!e)return null;if(Sc(e))return e;let t=e.length;if(!W4(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},yM=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&rw(Uint8Array)),bM=(e,t)=>{const a=(e&&e[vf]).call(e);let s;for(;(s=a.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},vM=(e,t)=>{let n;const a=[];for(;(n=e.exec(t))!==null;)a.push(n);return a},wM=Rs("HTMLFormElement"),jM=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,a,s){return a.toUpperCase()+s}),q2=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),NM=Rs("RegExp"),G4=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),a={};Au(n,(s,i)=>{let l;(l=t(s,i,e))!==!1&&(a[i]=l||s)}),Object.defineProperties(e,a)},SM=e=>{G4(e,(t,n)=>{if(Ua(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const a=e[n];if(Ua(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},CM=(e,t)=>{const n={},a=s=>{s.forEach(i=>{n[i]=!0})};return Sc(e)?a(e):a(String(e).split(t)),n},kM=()=>{},AM=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function IM(e){return!!(e&&Ua(e.append)&&e[H4]==="FormData"&&e[vf])}const EM=e=>{const t=new Array(10),n=(a,s)=>{if(ku(a)){if(t.indexOf(a)>=0)return;if(Cu(a))return a;if(!("toJSON"in a)){t[s]=a;const i=Sc(a)?[]:{};return Au(a,(l,d)=>{const u=n(l,s+1);!Jl(u)&&(i[d]=u)}),t[s]=void 0,i}}return a};return n(e,0)},PM=Rs("AsyncFunction"),TM=e=>e&&(ku(e)||Ua(e))&&Ua(e.then)&&Ua(e.catch),X4=((e,t)=>e?setImmediate:t?((n,a)=>(Uo.addEventListener("message",({source:s,data:i})=>{s===Uo&&i===n&&a.length&&a.shift()()},!1),s=>{a.push(s),Uo.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Ua(Uo.postMessage)),DM=typeof queueMicrotask<"u"?queueMicrotask.bind(Uo):typeof process<"u"&&process.nextTick||X4,OM=e=>e!=null&&Ua(e[vf]),Ye={isArray:Sc,isArrayBuffer:V4,isBuffer:Cu,isFormData:sM,isArrayBufferView:X6,isString:J6,isNumber:W4,isBoolean:Z6,isObject:ku,isPlainObject:ah,isEmptyObject:Q6,isReadableStream:oM,isRequest:lM,isResponse:cM,isHeaders:dM,isUndefined:Jl,isDate:eM,isFile:tM,isBlob:rM,isRegExp:NM,isFunction:Ua,isStream:aM,isURLSearchParams:iM,isTypedArray:yM,isFileList:nM,forEach:Au,merge:uv,extend:mM,trim:uM,stripBOM:hM,inherits:fM,toFlatObject:pM,kindOf:wf,kindOfTest:Rs,endsWith:gM,toArray:xM,forEachEntry:bM,matchAll:vM,isHTMLForm:wM,hasOwnProperty:q2,hasOwnProp:q2,reduceDescriptors:G4,freezeMethods:SM,toObjectSet:CM,toCamelCase:jM,noop:kM,toFiniteNumber:AM,findKey:Y4,global:Uo,isContextDefined:K4,isSpecCompliantForm:IM,toJSONObject:EM,isAsyncFn:PM,isThenable:TM,setImmediate:X4,asap:DM,isIterable:OM};function pr(e,t,n,a,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),a&&(this.request=a),s&&(this.response=s,this.status=s.status?s.status:null)}Ye.inherits(pr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ye.toJSONObject(this.config),code:this.code,status:this.status}}});const J4=pr.prototype,Z4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Z4[e]={value:e}});Object.defineProperties(pr,Z4);Object.defineProperty(J4,"isAxiosError",{value:!0});pr.from=(e,t,n,a,s,i)=>{const l=Object.create(J4);Ye.toFlatObject(e,l,function(p){return p!==Error.prototype},m=>m!=="isAxiosError");const d=e&&e.message?e.message:"Error",u=t==null&&e?e.code:t;return pr.call(l,d,u,n,a,s),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const _M=null;function mv(e){return Ye.isPlainObject(e)||Ye.isArray(e)}function Q4(e){return Ye.endsWith(e,"[]")?e.slice(0,-2):e}function H2(e,t,n){return e?e.concat(t).map(function(s,i){return s=Q4(s),!n&&i?"["+s+"]":s}).join(n?".":""):t}function MM(e){return Ye.isArray(e)&&!e.some(mv)}const RM=Ye.toFlatObject(Ye,{},null,function(t){return/^is[A-Z]/.test(t)});function Nf(e,t,n){if(!Ye.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Ye.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,y){return!Ye.isUndefined(y[w])});const a=n.metaTokens,s=n.visitor||p,i=n.dots,l=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&Ye.isSpecCompliantForm(t);if(!Ye.isFunction(s))throw new TypeError("visitor must be a function");function m(v){if(v===null)return"";if(Ye.isDate(v))return v.toISOString();if(Ye.isBoolean(v))return v.toString();if(!u&&Ye.isBlob(v))throw new pr("Blob is not supported. Use a Buffer instead.");return Ye.isArrayBuffer(v)||Ye.isTypedArray(v)?u&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function p(v,w,y){let E=v;if(v&&!y&&typeof v=="object"){if(Ye.endsWith(w,"{}"))w=a?w:w.slice(0,-2),v=JSON.stringify(v);else if(Ye.isArray(v)&&MM(v)||(Ye.isFileList(v)||Ye.endsWith(w,"[]"))&&(E=Ye.toArray(v)))return w=Q4(w),E.forEach(function(T,A){!(Ye.isUndefined(T)||T===null)&&t.append(l===!0?H2([w],A,i):l===null?w:w+"[]",m(T))}),!1}return mv(v)?!0:(t.append(H2(y,w,i),m(v)),!1)}const f=[],g=Object.assign(RM,{defaultVisitor:p,convertValue:m,isVisitable:mv});function N(v,w){if(!Ye.isUndefined(v)){if(f.indexOf(v)!==-1)throw Error("Circular reference detected in "+w.join("."));f.push(v),Ye.forEach(v,function(E,O){(!(Ye.isUndefined(E)||E===null)&&s.call(t,E,Ye.isString(O)?O.trim():O,w,g))===!0&&N(E,w?w.concat(O):[O])}),f.pop()}}if(!Ye.isObject(e))throw new TypeError("data must be an object");return N(e),t}function V2(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function nw(e,t){this._pairs=[],e&&Nf(e,this,t)}const eP=nw.prototype;eP.append=function(t,n){this._pairs.push([t,n])};eP.toString=function(t){const n=t?function(a){return t.call(this,a,V2)}:V2;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function $M(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function tP(e,t,n){if(!t)return e;const a=n&&n.encode||$M;Ye.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(t,n):i=Ye.isURLSearchParams(t)?t.toString():new nw(t,n).toString(a),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class W2{constructor(){this.handlers=[]}use(t,n,a){return this.handlers.push({fulfilled:t,rejected:n,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ye.forEach(this.handlers,function(a){a!==null&&t(a)})}}const rP={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},LM=typeof URLSearchParams<"u"?URLSearchParams:nw,FM=typeof FormData<"u"?FormData:null,BM=typeof Blob<"u"?Blob:null,UM={isBrowser:!0,classes:{URLSearchParams:LM,FormData:FM,Blob:BM},protocols:["http","https","file","blob","url","data"]},aw=typeof window<"u"&&typeof document<"u",hv=typeof navigator=="object"&&navigator||void 0,zM=aw&&(!hv||["ReactNative","NativeScript","NS"].indexOf(hv.product)<0),qM=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",HM=aw&&window.location.href||"http://localhost",VM=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:aw,hasStandardBrowserEnv:zM,hasStandardBrowserWebWorkerEnv:qM,navigator:hv,origin:HM},Symbol.toStringTag,{value:"Module"})),xa={...VM,...UM};function WM(e,t){return Nf(e,new xa.classes.URLSearchParams,{visitor:function(n,a,s,i){return xa.isNode&&Ye.isBuffer(n)?(this.append(a,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function YM(e){return Ye.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function KM(e){const t={},n=Object.keys(e);let a;const s=n.length;let i;for(a=0;a<s;a++)i=n[a],t[i]=e[i];return t}function nP(e){function t(n,a,s,i){let l=n[i++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),u=i>=n.length;return l=!l&&Ye.isArray(s)?s.length:l,u?(Ye.hasOwnProp(s,l)?s[l]=[s[l],a]:s[l]=a,!d):((!s[l]||!Ye.isObject(s[l]))&&(s[l]=[]),t(n,a,s[l],i)&&Ye.isArray(s[l])&&(s[l]=KM(s[l])),!d)}if(Ye.isFormData(e)&&Ye.isFunction(e.entries)){const n={};return Ye.forEachEntry(e,(a,s)=>{t(YM(a),s,n,0)}),n}return null}function GM(e,t,n){if(Ye.isString(e))try{return(t||JSON.parse)(e),Ye.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(n||JSON.stringify)(e)}const Iu={transitional:rP,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const a=n.getContentType()||"",s=a.indexOf("application/json")>-1,i=Ye.isObject(t);if(i&&Ye.isHTMLForm(t)&&(t=new FormData(t)),Ye.isFormData(t))return s?JSON.stringify(nP(t)):t;if(Ye.isArrayBuffer(t)||Ye.isBuffer(t)||Ye.isStream(t)||Ye.isFile(t)||Ye.isBlob(t)||Ye.isReadableStream(t))return t;if(Ye.isArrayBufferView(t))return t.buffer;if(Ye.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let d;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return WM(t,this.formSerializer).toString();if((d=Ye.isFileList(t))||a.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Nf(d?{"files[]":t}:t,u&&new u,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),GM(t)):t}],transformResponse:[function(t){const n=this.transitional||Iu.transitional,a=n&&n.forcedJSONParsing,s=this.responseType==="json";if(Ye.isResponse(t)||Ye.isReadableStream(t))return t;if(t&&Ye.isString(t)&&(a&&!this.responseType||s)){const l=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(d){if(l)throw d.name==="SyntaxError"?pr.from(d,pr.ERR_BAD_RESPONSE,this,null,this.response):d}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:xa.classes.FormData,Blob:xa.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ye.forEach(["delete","get","head","post","put","patch"],e=>{Iu.headers[e]={}});const XM=Ye.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),JM=e=>{const t={};let n,a,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),n=l.substring(0,s).trim().toLowerCase(),a=l.substring(s+1).trim(),!(!n||t[n]&&XM[n])&&(n==="set-cookie"?t[n]?t[n].push(a):t[n]=[a]:t[n]=t[n]?t[n]+", "+a:a)}),t},Y2=Symbol("internals");function ud(e){return e&&String(e).trim().toLowerCase()}function sh(e){return e===!1||e==null?e:Ye.isArray(e)?e.map(sh):String(e)}function ZM(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=n.exec(e);)t[a[1]]=a[2];return t}const QM=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Bg(e,t,n,a,s){if(Ye.isFunction(a))return a.call(this,t,n);if(s&&(t=n),!!Ye.isString(t)){if(Ye.isString(a))return t.indexOf(a)!==-1;if(Ye.isRegExp(a))return a.test(t)}}function eR(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,a)=>n.toUpperCase()+a)}function tR(e,t){const n=Ye.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+n,{value:function(s,i,l){return this[a].call(this,t,s,i,l)},configurable:!0})})}let za=class{constructor(t){t&&this.set(t)}set(t,n,a){const s=this;function i(d,u,m){const p=ud(u);if(!p)throw new Error("header name must be a non-empty string");const f=Ye.findKey(s,p);(!f||s[f]===void 0||m===!0||m===void 0&&s[f]!==!1)&&(s[f||u]=sh(d))}const l=(d,u)=>Ye.forEach(d,(m,p)=>i(m,p,u));if(Ye.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(Ye.isString(t)&&(t=t.trim())&&!QM(t))l(JM(t),n);else if(Ye.isObject(t)&&Ye.isIterable(t)){let d={},u,m;for(const p of t){if(!Ye.isArray(p))throw TypeError("Object iterator must return a key-value pair");d[m=p[0]]=(u=d[m])?Ye.isArray(u)?[...u,p[1]]:[u,p[1]]:p[1]}l(d,n)}else t!=null&&i(n,t,a);return this}get(t,n){if(t=ud(t),t){const a=Ye.findKey(this,t);if(a){const s=this[a];if(!n)return s;if(n===!0)return ZM(s);if(Ye.isFunction(n))return n.call(this,s,a);if(Ye.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=ud(t),t){const a=Ye.findKey(this,t);return!!(a&&this[a]!==void 0&&(!n||Bg(this,this[a],a,n)))}return!1}delete(t,n){const a=this;let s=!1;function i(l){if(l=ud(l),l){const d=Ye.findKey(a,l);d&&(!n||Bg(a,a[d],d,n))&&(delete a[d],s=!0)}}return Ye.isArray(t)?t.forEach(i):i(t),s}clear(t){const n=Object.keys(this);let a=n.length,s=!1;for(;a--;){const i=n[a];(!t||Bg(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const n=this,a={};return Ye.forEach(this,(s,i)=>{const l=Ye.findKey(a,i);if(l){n[l]=sh(s),delete n[i];return}const d=t?eR(i):String(i).trim();d!==i&&delete n[i],n[d]=sh(s),a[d]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Ye.forEach(this,(a,s)=>{a!=null&&a!==!1&&(n[s]=t&&Ye.isArray(a)?a.join(", "):a)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const a=new this(t);return n.forEach(s=>a.set(s)),a}static accessor(t){const a=(this[Y2]=this[Y2]={accessors:{}}).accessors,s=this.prototype;function i(l){const d=ud(l);a[d]||(tR(s,l),a[d]=!0)}return Ye.isArray(t)?t.forEach(i):i(t),this}};za.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ye.reduceDescriptors(za.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[n]=a}}});Ye.freezeMethods(za);function Ug(e,t){const n=this||Iu,a=t||n,s=za.from(a.headers);let i=a.data;return Ye.forEach(e,function(d){i=d.call(n,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function aP(e){return!!(e&&e.__CANCEL__)}function Cc(e,t,n){pr.call(this,e??"canceled",pr.ERR_CANCELED,t,n),this.name="CanceledError"}Ye.inherits(Cc,pr,{__CANCEL__:!0});function sP(e,t,n){const a=n.config.validateStatus;!n.status||!a||a(n.status)?e(n):t(new pr("Request failed with status code "+n.status,[pr.ERR_BAD_REQUEST,pr.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function rR(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function nR(e,t){e=e||10;const n=new Array(e),a=new Array(e);let s=0,i=0,l;return t=t!==void 0?t:1e3,function(u){const m=Date.now(),p=a[i];l||(l=m),n[s]=u,a[s]=m;let f=i,g=0;for(;f!==s;)g+=n[f++],f=f%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),m-l<t)return;const N=p&&m-p;return N?Math.round(g*1e3/N):void 0}}function aR(e,t){let n=0,a=1e3/t,s,i;const l=(m,p=Date.now())=>{n=p,s=null,i&&(clearTimeout(i),i=null),e(...m)};return[(...m)=>{const p=Date.now(),f=p-n;f>=a?l(m,p):(s=m,i||(i=setTimeout(()=>{i=null,l(s)},a-f)))},()=>s&&l(s)]}const gh=(e,t,n=3)=>{let a=0;const s=nR(50,250);return aR(i=>{const l=i.loaded,d=i.lengthComputable?i.total:void 0,u=l-a,m=s(u),p=l<=d;a=l;const f={loaded:l,total:d,progress:d?l/d:void 0,bytes:u,rate:m||void 0,estimated:m&&d&&p?(d-l)/m:void 0,event:i,lengthComputable:d!=null,[t?"download":"upload"]:!0};e(f)},n)},K2=(e,t)=>{const n=e!=null;return[a=>t[0]({lengthComputable:n,total:e,loaded:a}),t[1]]},G2=e=>(...t)=>Ye.asap(()=>e(...t)),sR=xa.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,xa.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(xa.origin),xa.navigator&&/(msie|trident)/i.test(xa.navigator.userAgent)):()=>!0,iR=xa.hasStandardBrowserEnv?{write(e,t,n,a,s,i,l){if(typeof document>"u")return;const d=[`${e}=${encodeURIComponent(t)}`];Ye.isNumber(n)&&d.push(`expires=${new Date(n).toUTCString()}`),Ye.isString(a)&&d.push(`path=${a}`),Ye.isString(s)&&d.push(`domain=${s}`),i===!0&&d.push("secure"),Ye.isString(l)&&d.push(`SameSite=${l}`),document.cookie=d.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function oR(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function lR(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function iP(e,t,n){let a=!oR(t);return e&&(a||n==!1)?lR(e,t):t}const X2=e=>e instanceof za?{...e}:e;function Qo(e,t){t=t||{};const n={};function a(m,p,f,g){return Ye.isPlainObject(m)&&Ye.isPlainObject(p)?Ye.merge.call({caseless:g},m,p):Ye.isPlainObject(p)?Ye.merge({},p):Ye.isArray(p)?p.slice():p}function s(m,p,f,g){if(Ye.isUndefined(p)){if(!Ye.isUndefined(m))return a(void 0,m,f,g)}else return a(m,p,f,g)}function i(m,p){if(!Ye.isUndefined(p))return a(void 0,p)}function l(m,p){if(Ye.isUndefined(p)){if(!Ye.isUndefined(m))return a(void 0,m)}else return a(void 0,p)}function d(m,p,f){if(f in t)return a(m,p);if(f in e)return a(void 0,m)}const u={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(m,p,f)=>s(X2(m),X2(p),f,!0)};return Ye.forEach(Object.keys({...e,...t}),function(p){const f=u[p]||s,g=f(e[p],t[p],p);Ye.isUndefined(g)&&f!==d||(n[p]=g)}),n}const oP=e=>{const t=Qo({},e);let{data:n,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:i,headers:l,auth:d}=t;if(t.headers=l=za.from(l),t.url=tP(iP(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),Ye.isFormData(n)){if(xa.hasStandardBrowserEnv||xa.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Ye.isFunction(n.getHeaders)){const u=n.getHeaders(),m=["content-type","content-length"];Object.entries(u).forEach(([p,f])=>{m.includes(p.toLowerCase())&&l.set(p,f)})}}if(xa.hasStandardBrowserEnv&&(a&&Ye.isFunction(a)&&(a=a(t)),a||a!==!1&&sR(t.url))){const u=s&&i&&iR.read(i);u&&l.set(s,u)}return t},cR=typeof XMLHttpRequest<"u",dR=cR&&function(e){return new Promise(function(n,a){const s=oP(e);let i=s.data;const l=za.from(s.headers).normalize();let{responseType:d,onUploadProgress:u,onDownloadProgress:m}=s,p,f,g,N,v;function w(){N&&N(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let y=new XMLHttpRequest;y.open(s.method.toUpperCase(),s.url,!0),y.timeout=s.timeout;function E(){if(!y)return;const T=za.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),I={data:!d||d==="text"||d==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:T,config:e,request:y};sP(function(P){n(P),w()},function(P){a(P),w()},I),y=null}"onloadend"in y?y.onloadend=E:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(E)},y.onabort=function(){y&&(a(new pr("Request aborted",pr.ECONNABORTED,e,y)),y=null)},y.onerror=function(A){const I=A&&A.message?A.message:"Network Error",C=new pr(I,pr.ERR_NETWORK,e,y);C.event=A||null,a(C),y=null},y.ontimeout=function(){let A=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const I=s.transitional||rP;s.timeoutErrorMessage&&(A=s.timeoutErrorMessage),a(new pr(A,I.clarifyTimeoutError?pr.ETIMEDOUT:pr.ECONNABORTED,e,y)),y=null},i===void 0&&l.setContentType(null),"setRequestHeader"in y&&Ye.forEach(l.toJSON(),function(A,I){y.setRequestHeader(I,A)}),Ye.isUndefined(s.withCredentials)||(y.withCredentials=!!s.withCredentials),d&&d!=="json"&&(y.responseType=s.responseType),m&&([g,v]=gh(m,!0),y.addEventListener("progress",g)),u&&y.upload&&([f,N]=gh(u),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",N)),(s.cancelToken||s.signal)&&(p=T=>{y&&(a(!T||T.type?new Cc(null,e,y):T),y.abort(),y=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const O=rR(s.url);if(O&&xa.protocols.indexOf(O)===-1){a(new pr("Unsupported protocol "+O+":",pr.ERR_BAD_REQUEST,e));return}y.send(i||null)})},uR=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let a=new AbortController,s;const i=function(m){if(!s){s=!0,d();const p=m instanceof Error?m:this.reason;a.abort(p instanceof pr?p:new Cc(p instanceof Error?p.message:p))}};let l=t&&setTimeout(()=>{l=null,i(new pr(`timeout ${t} of ms exceeded`,pr.ETIMEDOUT))},t);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(m=>{m.unsubscribe?m.unsubscribe(i):m.removeEventListener("abort",i)}),e=null)};e.forEach(m=>m.addEventListener("abort",i));const{signal:u}=a;return u.unsubscribe=()=>Ye.asap(d),u}},mR=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let a=0,s;for(;a<n;)s=a+t,yield e.slice(a,s),a=s},hR=async function*(e,t){for await(const n of fR(e))yield*mR(n,t)},fR=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:a}=await t.read();if(n)break;yield a}}finally{await t.cancel()}},J2=(e,t,n,a)=>{const s=hR(e,t);let i=0,l,d=u=>{l||(l=!0,a&&a(u))};return new ReadableStream({async pull(u){try{const{done:m,value:p}=await s.next();if(m){d(),u.close();return}let f=p.byteLength;if(n){let g=i+=f;n(g)}u.enqueue(new Uint8Array(p))}catch(m){throw d(m),m}},cancel(u){return d(u),s.return()}},{highWaterMark:2})},Z2=64*1024,{isFunction:Lm}=Ye,pR=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ye.global),{ReadableStream:Q2,TextEncoder:eS}=Ye.global,tS=(e,...t)=>{try{return!!e(...t)}catch{return!1}},gR=e=>{e=Ye.merge.call({skipUndefined:!0},pR,e);const{fetch:t,Request:n,Response:a}=e,s=t?Lm(t):typeof fetch=="function",i=Lm(n),l=Lm(a);if(!s)return!1;const d=s&&Lm(Q2),u=s&&(typeof eS=="function"?(v=>w=>v.encode(w))(new eS):async v=>new Uint8Array(await new n(v).arrayBuffer())),m=i&&d&&tS(()=>{let v=!1;const w=new n(xa.origin,{body:new Q2,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!w}),p=l&&d&&tS(()=>Ye.isReadableStream(new a("").body)),f={stream:p&&(v=>v.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!f[v]&&(f[v]=(w,y)=>{let E=w&&w[v];if(E)return E.call(w);throw new pr(`Response type '${v}' is not supported`,pr.ERR_NOT_SUPPORT,y)})});const g=async v=>{if(v==null)return 0;if(Ye.isBlob(v))return v.size;if(Ye.isSpecCompliantForm(v))return(await new n(xa.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(Ye.isArrayBufferView(v)||Ye.isArrayBuffer(v))return v.byteLength;if(Ye.isURLSearchParams(v)&&(v=v+""),Ye.isString(v))return(await u(v)).byteLength},N=async(v,w)=>{const y=Ye.toFiniteNumber(v.getContentLength());return y??g(w)};return async v=>{let{url:w,method:y,data:E,signal:O,cancelToken:T,timeout:A,onDownloadProgress:I,onUploadProgress:C,responseType:P,headers:F,withCredentials:R="same-origin",fetchOptions:$}=oP(v),L=t||fetch;P=P?(P+"").toLowerCase():"text";let G=uR([O,T&&T.toAbortSignal()],A),X=null;const me=G&&G.unsubscribe&&(()=>{G.unsubscribe()});let se;try{if(C&&m&&y!=="get"&&y!=="head"&&(se=await N(F,E))!==0){let H=new n(w,{method:"POST",body:E,duplex:"half"}),te;if(Ye.isFormData(E)&&(te=H.headers.get("content-type"))&&F.setContentType(te),H.body){const[fe,Le]=K2(se,gh(G2(C)));E=J2(H.body,Z2,fe,Le)}}Ye.isString(R)||(R=R?"include":"omit");const ee=i&&"credentials"in n.prototype,W={...$,signal:G,method:y.toUpperCase(),headers:F.normalize().toJSON(),body:E,duplex:"half",credentials:ee?R:void 0};X=i&&new n(w,W);let U=await(i?L(X,$):L(w,W));const Q=p&&(P==="stream"||P==="response");if(p&&(I||Q&&me)){const H={};["status","statusText","headers"].forEach(he=>{H[he]=U[he]});const te=Ye.toFiniteNumber(U.headers.get("content-length")),[fe,Le]=I&&K2(te,gh(G2(I),!0))||[];U=new a(J2(U.body,Z2,fe,()=>{Le&&Le(),me&&me()}),H)}P=P||"text";let Y=await f[Ye.findKey(f,P)||"text"](U,v);return!Q&&me&&me(),await new Promise((H,te)=>{sP(H,te,{data:Y,headers:za.from(U.headers),status:U.status,statusText:U.statusText,config:v,request:X})})}catch(ee){throw me&&me(),ee&&ee.name==="TypeError"&&/Load failed|fetch/i.test(ee.message)?Object.assign(new pr("Network Error",pr.ERR_NETWORK,v,X),{cause:ee.cause||ee}):pr.from(ee,ee&&ee.code,v,X)}}},xR=new Map,lP=e=>{let t=e&&e.env||{};const{fetch:n,Request:a,Response:s}=t,i=[a,s,n];let l=i.length,d=l,u,m,p=xR;for(;d--;)u=i[d],m=p.get(u),m===void 0&&p.set(u,m=d?new Map:gR(t)),p=m;return m};lP();const sw={http:_M,xhr:dR,fetch:{get:lP}};Ye.forEach(sw,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const rS=e=>`- ${e}`,yR=e=>Ye.isFunction(e)||e===null||e===!1;function bR(e,t){e=Ye.isArray(e)?e:[e];const{length:n}=e;let a,s;const i={};for(let l=0;l<n;l++){a=e[l];let d;if(s=a,!yR(a)&&(s=sw[(d=String(a)).toLowerCase()],s===void 0))throw new pr(`Unknown adapter '${d}'`);if(s&&(Ye.isFunction(s)||(s=s.get(t))))break;i[d||"#"+l]=s}if(!s){const l=Object.entries(i).map(([u,m])=>`adapter ${u} `+(m===!1?"is not supported by the environment":"is not available in the build"));let d=n?l.length>1?`since :
`+l.map(rS).join(`
`):" "+rS(l[0]):"as no adapter specified";throw new pr("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return s}const cP={getAdapter:bR,adapters:sw};function zg(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Cc(null,e)}function nS(e){return zg(e),e.headers=za.from(e.headers),e.data=Ug.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),cP.getAdapter(e.adapter||Iu.adapter,e)(e).then(function(a){return zg(e),a.data=Ug.call(e,e.transformResponse,a),a.headers=za.from(a.headers),a},function(a){return aP(a)||(zg(e),a&&a.response&&(a.response.data=Ug.call(e,e.transformResponse,a.response),a.response.headers=za.from(a.response.headers))),Promise.reject(a)})}const dP="1.13.0",Sf={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Sf[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const aS={};Sf.transitional=function(t,n,a){function s(i,l){return"[Axios v"+dP+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,d)=>{if(t===!1)throw new pr(s(l," has been removed"+(n?" in "+n:"")),pr.ERR_DEPRECATED);return n&&!aS[l]&&(aS[l]=!0,console.warn(s(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,l,d):!0}};Sf.spelling=function(t){return(n,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function vR(e,t,n){if(typeof e!="object")throw new pr("options must be an object",pr.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let s=a.length;for(;s-- >0;){const i=a[s],l=t[i];if(l){const d=e[i],u=d===void 0||l(d,i,e);if(u!==!0)throw new pr("option "+i+" must be "+u,pr.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new pr("Unknown option "+i,pr.ERR_BAD_OPTION)}}const ih={assertOptions:vR,validators:Sf},Hs=ih.validators;let Ko=class{constructor(t){this.defaults=t||{},this.interceptors={request:new W2,response:new W2}}async request(t,n){try{return await this._request(t,n)}catch(a){if(a instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Qo(this.defaults,n);const{transitional:a,paramsSerializer:s,headers:i}=n;a!==void 0&&ih.assertOptions(a,{silentJSONParsing:Hs.transitional(Hs.boolean),forcedJSONParsing:Hs.transitional(Hs.boolean),clarifyTimeoutError:Hs.transitional(Hs.boolean)},!1),s!=null&&(Ye.isFunction(s)?n.paramsSerializer={serialize:s}:ih.assertOptions(s,{encode:Hs.function,serialize:Hs.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),ih.assertOptions(n,{baseUrl:Hs.spelling("baseURL"),withXsrfToken:Hs.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=i&&Ye.merge(i.common,i[n.method]);i&&Ye.forEach(["delete","get","head","post","put","patch","common"],v=>{delete i[v]}),n.headers=za.concat(l,i);const d=[];let u=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(n)===!1||(u=u&&w.synchronous,d.unshift(w.fulfilled,w.rejected))});const m=[];this.interceptors.response.forEach(function(w){m.push(w.fulfilled,w.rejected)});let p,f=0,g;if(!u){const v=[nS.bind(this),void 0];for(v.unshift(...d),v.push(...m),g=v.length,p=Promise.resolve(n);f<g;)p=p.then(v[f++],v[f++]);return p}g=d.length;let N=n;for(;f<g;){const v=d[f++],w=d[f++];try{N=v(N)}catch(y){w.call(this,y);break}}try{p=nS.call(this,N)}catch(v){return Promise.reject(v)}for(f=0,g=m.length;f<g;)p=p.then(m[f++],m[f++]);return p}getUri(t){t=Qo(this.defaults,t);const n=iP(t.baseURL,t.url,t.allowAbsoluteUrls);return tP(n,t.params,t.paramsSerializer)}};Ye.forEach(["delete","get","head","options"],function(t){Ko.prototype[t]=function(n,a){return this.request(Qo(a||{},{method:t,url:n,data:(a||{}).data}))}});Ye.forEach(["post","put","patch"],function(t){function n(a){return function(i,l,d){return this.request(Qo(d||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}Ko.prototype[t]=n(),Ko.prototype[t+"Form"]=n(!0)});let wR=class uP{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const a=this;this.promise.then(s=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](s);a._listeners=null}),this.promise.then=s=>{let i;const l=new Promise(d=>{a.subscribe(d),i=d}).then(s);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,d){a.reason||(a.reason=new Cc(i,l,d),n(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=a=>{t.abort(a)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new uP(function(s){t=s}),cancel:t}}};function jR(e){return function(n){return e.apply(null,n)}}function NR(e){return Ye.isObject(e)&&e.isAxiosError===!0}const fv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(fv).forEach(([e,t])=>{fv[t]=e});function mP(e){const t=new Ko(e),n=q4(Ko.prototype.request,t);return Ye.extend(n,Ko.prototype,t,{allOwnKeys:!0}),Ye.extend(n,t,null,{allOwnKeys:!0}),n.create=function(s){return mP(Qo(e,s))},n}const tn=mP(Iu);tn.Axios=Ko;tn.CanceledError=Cc;tn.CancelToken=wR;tn.isCancel=aP;tn.VERSION=dP;tn.toFormData=Nf;tn.AxiosError=pr;tn.Cancel=tn.CanceledError;tn.all=function(t){return Promise.all(t)};tn.spread=jR;tn.isAxiosError=NR;tn.mergeConfig=Qo;tn.AxiosHeaders=za;tn.formToJSON=e=>nP(Ye.isHTMLForm(e)?new FormData(e):e);tn.getAdapter=cP.getAdapter;tn.HttpStatusCode=fv;tn.default=tn;const{Axios:ZQ,AxiosError:QQ,CanceledError:eee,isCancel:tee,CancelToken:ree,VERSION:nee,all:aee,Cancel:see,isAxiosError:iee,spread:oee,toFormData:lee,AxiosHeaders:cee,HttpStatusCode:dee,formToJSON:uee,getAdapter:mee,mergeConfig:hee}=tn,SR={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"https://erp-backend-kfut.onrender.com/api"},CR=import.meta&&SR&&"https://erp-backend-kfut.onrender.com/api"||"http://localhost:5050/api",ot=tn.create({baseURL:CR,headers:{"Content-Type":"application/json"}});ot.interceptors.request.use(e=>{let t=localStorage.getItem("token");if(console.log("[API] Token from localStorage (token):",t),t||(t=localStorage.getItem("authToken"),console.log("[API] Token from localStorage (authToken):",t)),!t){const s=localStorage.getItem("erp.auth");if(s)try{t=JSON.parse(s).token,console.log("[API] Token from erp.auth:",t)}catch(i){console.error("[API] Error parsing auth data:",i)}}t?(e.headers.Authorization=`Bearer ${t}`,console.log("[API] Authorization header set.")):console.warn("[API] No token found. Authorization header not set.");let n;const a=localStorage.getItem("erp.auth");if(a)try{n=JSON.parse(a).user?.schoolCode}catch(s){console.error("Error parsing auth data:",s)}return n||(n=localStorage.getItem("erp.schoolCode")),n&&(e.headers["x-school-code"]=n),e},e=>(console.error("[API] Request interceptor error:",e),Promise.reject(e)));ot.interceptors.response.use(e=>e,e=>{if(console.error("API Error:",e.config?.url,e.response?.status,e.message),e.response?.status===401){const t=e.config?.url||"";t.includes("/schools/")||t.includes("/users/")?console.warn("Auth error on school/user API. Not redirecting to prevent loop."):(console.log("Unauthorized access. Redirecting to login..."),localStorage.removeItem("token"),localStorage.removeItem("erp.auth"),setTimeout(()=>{window.location.href="/login?session=expired"},1e3))}return Promise.reject(e)});const Kn={createSchool:e=>{const t=e instanceof FormData?{headers:{"Content-Type":void 0}}:{};return ot.post("/schools",e,t)},getAllSchools:()=>ot.get("/schools"),getSchoolById:e=>(console.log(`Fetching school details for ID: ${e}`),ot.get(`/schools/${e}/info`)),updateSchool:(e,t)=>{const n=t instanceof FormData?{headers:{"Content-Type":void 0}}:{};return ot.put(`/schools/${e}`,t,n)},deleteSchool:e=>ot.delete(`/schools/${e}`),updateAccessMatrix:(e,t)=>ot.patch(`/schools/${e}/access-matrix`,{accessMatrix:t}),updateBankDetails:(e,t)=>ot.patch(`/schools/${e}/bank-details`,{bankDetails:t}),updateUserRole:(e,t,n)=>ot.put(`/schools/${e}/users/${t}`,{role:n}),updateSchoolSettings:(e,t)=>ot.put(`/schools/${e}`,{settings:t}),getSchoolStats:e=>ot.get(`/schools/${e}/stats`),getAllSchoolsStats:()=>ot.get("/schools/all-stats"),toggleSchoolStatus:e=>ot.patch(`/schools/${e}/toggle-status`)},kR={createUser:e=>ot.post("/users",e),addTeacher:e=>ot.post("/users/teachers",e),addStudent:e=>ot.post("/users/students",e),addParent:e=>ot.post("/users/parents",e),getUsers:(e,t)=>ot.get(`/schools/${e}/users`,{params:t}),getUsersByRole:(e,t)=>ot.get(`/users/role/${e}`,{params:t}),getUserById:e=>ot.get(`/users/${e}`),updateUser:(e,t)=>ot.put(`/users/${e}`,t),resetUserPassword:e=>ot.patch(`/users/${e}/reset-password`),toggleUserStatus:e=>ot.patch(`/users/${e}/toggle-status`)},qg={exportUsers:(e,t)=>ot.get(`/export-import/${e}/export`,{params:t,responseType:"blob"}),importUsers:(e,t)=>{const n=new FormData;return n.append("file",t),ot.post(`/export-import/${e}/import`,n,{headers:{"Content-Type":"multipart/form-data"}})},generateTemplate:(e,t)=>ot.get(`/export-import/${e}/template`,{params:{role:t},responseType:"blob"})},Gn={getStudents:(e,t)=>ot.get("/users/role/student",{params:t,headers:{"X-School-Code":e}}),saveResults:e=>ot.post("/results/save",e),getResults:e=>ot.get("/results",{params:e}),getResultsForTeacher:e=>ot.get("/results/teacher/view",{params:e}),updateResult:(e,t)=>ot.put(`/results/${e}`,t),freezeResults:e=>ot.post("/results/freeze",e),deleteResult:e=>ot.delete(`/results/${e}`),getResultsStats:e=>ot.get("/results/stats",{params:e})},md={getSchoolClasses:async e=>(await ot.get(`/superadmin/classes/schools/${e}/classes`)).data,addClass:async(e,t)=>(await ot.post(`/superadmin/classes/schools/${e}/classes`,t)).data,addSectionToClass:async(e,t,n)=>(await ot.post(`/superadmin/classes/schools/${e}/classes/${t}/sections`,{section:n})).data,removeSectionFromClass:async(e,t,n)=>(await ot.delete(`/superadmin/classes/schools/${e}/classes/${t}/sections`,{data:{section:n}})).data,updateClass:async(e,t,n)=>(await ot.put(`/superadmin/classes/schools/${e}/classes/${t}`,n)).data,deleteClass:async(e,t)=>(await ot.delete(`/superadmin/classes/schools/${e}/classes/${t}`)).data,getAvailableClasses:async e=>(await ot.get(`/superadmin/classes/schools/${e}/classes/available`)).data},Fm={getSchoolTests:async e=>(await ot.get(`/superadmin/tests/schools/${e}/tests`)).data,addTest:async(e,t)=>(await ot.post(`/superadmin/tests/schools/${e}/tests`,t)).data,updateTest:async(e,t,n)=>(await ot.put(`/superadmin/tests/schools/${e}/tests/${t}`,n)).data,deleteTest:async(e,t)=>(await ot.delete(`/superadmin/tests/schools/${e}/tests/${t}`)).data,getTestsByClass:async(e,t)=>(await ot.get(`/superadmin/tests/schools/${e}/tests/class/${t}`)).data},AR={getSchoolClasses:e=>{const t=localStorage.getItem("erp.auth");let n=!1;try{if(t){const s=JSON.parse(t);n=s.role==="superadmin"||s.userType==="superadmin"}}catch(s){console.error("Error parsing auth data:",s)}const a=n?`/superadmin/classes/schools/${e}/classes`:`/schools/${e}/classes`;return console.log(` [classesAPI] Using endpoint: ${a}`),ot.get(a)},getSectionsForClass:(e,t)=>{const n=localStorage.getItem("erp.auth");let a=!1;try{if(n){const i=JSON.parse(n);a=i.role==="superadmin"||i.userType==="superadmin"}}catch(i){console.error("Error parsing auth data:",i)}const s=a?`/superadmin/classes/schools/${e}/classes/${t}/sections`:`/schools/${e}/classes/${t}/sections`;return console.log(` [classesAPI] Using endpoint: ${s}`),ot.get(s)}},Ws={getNextChalanNumber:async()=>{try{return(await ot.get("/chalans/next-chalan-number")).data}catch(e){throw console.error("Error getting next chalan number:",e),e}},createFeeStructure:e=>ot.post("/fees/structures",e),getFeeStructures:e=>ot.get("/fees/structures",{params:e}),deleteFeeStructure:e=>ot.delete(`/fees/structures/${e}`),getStudentFeeRecords:e=>ot.get("/fees/records",{params:e}),getStudentFeeRecord:async e=>{if(!e)throw new Error("No student identifier provided");console.log(`Attempting to fetch fee record for identifier: ${e}`);try{const t=await ot.get(`/fees/records/${e}`);return console.log("Successfully fetched fee record:",t.data),t}catch(t){console.error("Error fetching student fee record:",t);let n=`Failed to fetch student fee record.

`;throw n+=`Tried endpoint: /fees/records/${e}

`,n+="Please check that the student exists and has fee records.",new Error(n)}},getStudentByUserId:e=>ot.get(`/users/${e}`).then(t=>({data:{data:t.data}})).catch(()=>ot.get(`/users/role/student?userId=${e}`).then(t=>{const a=(t.data?.data||[]).find(s=>s._id===e||s.userId===e||s.user_id===e);if(a)return{data:{data:a}};throw new Error("Student not found")})),getSchoolInfo:e=>ot.get(`/admin/classes/${e}/classes-sections`),downloadReceipt:e=>ot.get(`/fees/receipts/${e}`,{responseType:"blob"}),recordOfflinePayment:(e,t)=>ot.post(`/fees/records/${e}/offline-payment`,t),getFeeStats:e=>ot.get("/fees/stats",{params:e}),generateChalan:async e=>{try{const{data:{chalanNumber:t}}=await ot.get("/chalans/next-chalan-number"),n={...e,chalanNumber:t,status:"generated",generatedAt:new Date().toISOString(),schoolId:JSON.parse(localStorage.getItem("user")||"{}").schoolId};return{success:!0,data:(await ot.post("/chalans/generate",n)).data,message:"Chalan generated successfully"}}catch(t){return console.error("Error generating chalan:",t),{success:!1,error:t.response?.data?.message||t.message||"Failed to generate chalan",status:t.response?.status||500}}}},hP=j.createContext(void 0);function fP({children:e}){const{user:t,token:n}=yr(),[a,s]=j.useState(null),[i,l]=j.useState(!0),[d,u]=j.useState(!1),[m,p]=j.useState("");j.useEffect(()=>{async function v(){if(!t||!n||!t.schoolId){l(!1);return}if(t.role==="superadmin"){s({manageUsers:!0,manageSchoolSettings:!0,viewAttendance:!0,viewResults:!0,viewLeaves:!0,messageStudentsParents:!0,viewAcademicDetails:!0,viewAssignments:!0,viewFees:!0,viewReports:!0}),l(!1);return}try{console.log("[PERMISSIONS] Fetching access matrix for user:",{schoolId:t.schoolId,schoolCode:t.schoolCode});const y=t.schoolCode||localStorage.getItem("erp.schoolCode"),E=t.schoolId;if(console.log("[PERMISSIONS] School identifiers:",{schoolId:E,schoolCode:y}),y)try{console.log("[PERMISSIONS] Fetching permissions from school database via code:",y);const A=await ot.get(`/school-users/${y}/access-matrix`),I=A.data?.data||A.data;if(console.log("[PERMISSIONS] Received access matrix from school DB:",I),I&&I[t.role]){const C=I[t.role];if(console.log("[PERMISSIONS] Loaded permissions for",t.role,":",C),C){s(C),l(!1);return}}}catch(A){console.error("[PERMISSIONS] Failed to fetch from school database:",A)}let O;try{O=await Kn.getSchoolById(E)}catch(A){console.error("[PERMISSIONS] Failed to fetch school:",A);const I=t.role==="admin"?{manageUsers:!0,manageSchoolSettings:!0,viewAttendance:!0,viewResults:!0,viewLeaves:!0,messageStudentsParents:!0,viewAcademicDetails:!0,viewAssignments:!0,viewFees:!0,viewReports:!0}:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!1,viewResults:!1,viewLeaves:!1,messageStudentsParents:!1,viewAcademicDetails:!1,viewAssignments:!1,viewFees:!1,viewReports:!1};s(I),l(!1);return}const T=O.data?.school||O.data;if(console.log("[PERMISSIONS] Full school object:",T),console.log("[PERMISSIONS] Access matrix:",T?.accessMatrix),T&&T.accessMatrix){const A=T.accessMatrix[t.role];if(console.log("[PERMISSIONS] Loaded permissions for",t.role,":",A),console.log("[PERMISSIONS] Role permissions type:",typeof A),console.log("[PERMISSIONS] Role permissions values:",JSON.stringify(A)),A)s(A);else{const I=t.role==="admin"?{manageUsers:!0,manageSchoolSettings:!0,viewAttendance:!0,viewResults:!0,viewLeaves:!0,messageStudentsParents:!0,viewAcademicDetails:!0,viewAssignments:!0,viewFees:!0,viewReports:!0}:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!1,viewResults:!1,viewLeaves:!1,messageStudentsParents:!1,viewAcademicDetails:!1,viewAssignments:!1,viewFees:!1,viewReports:!1};s(I)}}else{console.warn("[PERMISSIONS] No access matrix found");const A=t.role==="admin"?{manageUsers:!0,manageSchoolSettings:!0,viewAttendance:!0,viewResults:!0,viewLeaves:!0,messageStudentsParents:!0,viewAcademicDetails:!0,viewAssignments:!0,viewFees:!0,viewReports:!0}:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!1,viewResults:!1,viewLeaves:!1,messageStudentsParents:!1,viewAcademicDetails:!1,viewAssignments:!1,viewFees:!1,viewReports:!1};s(A)}}catch(y){console.error("[PERMISSIONS] Error fetching permissions:",y);const E=t.role==="admin"?{manageUsers:!0,manageSchoolSettings:!0,viewAttendance:!0,viewResults:!0,viewLeaves:!0,messageStudentsParents:!0,viewAcademicDetails:!0,viewAssignments:!0,viewFees:!0,viewReports:!0}:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!1,viewResults:!1,viewLeaves:!1,messageStudentsParents:!1,viewAcademicDetails:!1,viewAssignments:!1,viewFees:!1,viewReports:!1};s(E)}finally{l(!1)}}v();const w=async()=>{if(console.log("[PERMISSIONS] Refreshing permissions due to access matrix update"),t&&t.schoolId&&t.role!=="superadmin")try{let y;try{const O=t.schoolCode||localStorage.getItem("erp.schoolCode");if(O){y=await ot.get(`/school-users/${O}/access-matrix`);const T=y.data?.data||y.data;if(T&&T[t.role]){const A=T[t.role];console.log("[PERMISSIONS] Refreshed permissions for",t.role,":",A),s(A||null)}return}y=await Kn.getSchoolById(t.schoolId)}catch(O){console.log("[PERMISSIONS REFRESH] Failed to fetch permissions:",O);return}const E=y.data?.school||y.data;if(E&&E.accessMatrix){const O=E.accessMatrix[t.role];console.log("[PERMISSIONS] Refreshed permissions for",t.role,":",O),s(O||null)}}catch(y){console.error("[PERMISSIONS] Error refreshing permissions:",y)}};return window.addEventListener("permission-refresh",w),()=>{window.removeEventListener("permission-refresh",w)}},[t,n]);const f=j.useCallback(v=>{if(!a)return!1;const w=a[v];return w===!0||typeof w=="string"&&w!=="false"},[a]),g=j.useCallback((v,w,y)=>{if(i){console.log("[PERMISSIONS] Still loading, allowing navigation - will check on page load"),y();return}f(v)?y():(console.log("[PERMISSIONS] Access denied to",w),p(w),u(!0))},[f,i]),N={permissions:a,loading:i,hasPermission:f,showPermissionDenied:d,setShowPermissionDenied:u,deniedPermissionName:m,setDeniedPermissionName:p,checkAndNavigate:g};return r.jsx(hP.Provider,{value:N,children:e})}function iw(){const e=j.useContext(hP);if(!e)throw new Error("usePermissions must be used within a PermissionProvider");return e}function ow({isOpen:e,onClose:t,permissionName:n}){return e?r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),r.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6 animate-fade-in",children:[r.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Ur,{className:"h-5 w-5"})}),r.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4",children:r.jsx(Fd,{className:"h-6 w-6 text-red-600"})}),r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Permission Required"}),r.jsxs("div",{className:"flex items-start space-x-2 bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:[r.jsx(sa,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),r.jsxs("p",{className:"text-sm text-gray-700 text-left",children:["You don't have permission to access ",r.jsx("strong",{children:n}),"."]})]}),r.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Access to this feature is currently disabled by the Super Admin. Please contact your Super Admin to request access. They can enable this permission from the Access Control panel."}),r.jsx("button",{onClick:t,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:"Understood"})]})]})]}):null}const IR=({children:e})=>{const[t,n]=j.useState(!1),a=ni();il();const{hasPermission:s,showPermissionDenied:i,setShowPermissionDenied:l,deniedPermissionName:d,checkAndNavigate:u}=iw(),m=[{name:"Dashboard",href:"/admin/",icon:tw},{name:"Manage Users",href:"/admin/users",icon:$n},{name:"School Settings",href:"/admin/settings",icon:yf},{name:"Academic Details",href:"/admin/academic-details",icon:Jo},{name:"Attendance",href:"/admin/attendance",icon:_s},{name:"Assignments",href:"/admin/assignments",icon:xs},{name:"Results",href:"/admin/results",icon:Q1},{name:"Leave Management",href:"/admin/leave-management",icon:an},{name:"Messages",href:"/admin/messages",icon:pf},{name:"Fees",href:"/admin/fees/structure",icon:Gl},{name:"Reports",href:"/admin/reports",icon:Pn}],p=f=>a.pathname===f;return r.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[r.jsxs("div",{className:"w-64 bg-white shadow-lg hidden lg:flex flex-col",children:[r.jsx("div",{className:"h-16 px-6 flex items-center bg-blue-600",children:r.jsx("h1",{className:"text-xl font-bold text-white",children:"ERP Admin Portal"})}),r.jsx("nav",{className:"mt-8 px-4 space-y-2",children:m.map(f=>r.jsxs(ph,{to:f.href,className:`flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors ${p(f.href)||a.pathname.startsWith(f.href+"/")?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx(f.icon,{className:"mr-3 h-5 w-5"}),f.name]},f.name))})]}),t&&r.jsx("div",{className:"fixed inset-0 z-40 bg-gray-600 bg-opacity-75 lg:hidden",onClick:()=>n(!1)}),r.jsxs("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out lg:hidden ${t?"translate-x-0":"-translate-x-full"}`,children:[r.jsxs("div",{className:"h-16 px-6 flex items-center justify-between bg-blue-600",children:[r.jsx("h1",{className:"text-xl font-bold text-white",children:"ERP Admin Portal"}),r.jsx("button",{onClick:()=>n(!1),className:"text-white hover:bg-blue-700 p-1 rounded",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsx("nav",{className:"mt-8 px-4 space-y-2",children:m.map(f=>r.jsxs(ph,{to:f.href,onClick:()=>n(!1),className:`flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors ${p(f.href)||a.pathname.startsWith(f.href+"/")?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx(f.icon,{className:"mr-3 h-5 w-5"}),f.name]},f.name))})]}),r.jsx(ow,{isOpen:i,onClose:()=>l(!1),permissionName:d}),r.jsxs("div",{className:"flex-1 flex flex-col",children:[r.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6",children:[r.jsx("button",{onClick:()=>n(!0),className:"lg:hidden text-gray-500 hover:text-gray-700 p-2 rounded-md hover:bg-gray-100",children:r.jsx(L4,{className:"h-6 w-6"})}),r.jsx("div",{className:"flex items-center space-x-2 sm:space-x-4",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"h-8 w-8 bg-blue-600 rounded-full flex items-center justify-center",children:r.jsx(Ed,{className:"h-4 w-4 text-white"})}),r.jsx("span",{className:"text-sm font-medium text-gray-700 hidden sm:inline",children:"Admin User"})]})})]})}),r.jsx("main",{className:"p-4 sm:p-6 flex-1",children:e})]})]})};function pP(e){var t,n,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=pP(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function xr(){for(var e,t,n=0,a="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=pP(e))&&(a&&(a+=" "),a+=t);return a}var Hg,sS;function qa(){if(sS)return Hg;sS=1;var e=Array.isArray;return Hg=e,Hg}var Vg,iS;function gP(){if(iS)return Vg;iS=1;var e=typeof Rm=="object"&&Rm&&Rm.Object===Object&&Rm;return Vg=e,Vg}var Wg,oS;function ai(){if(oS)return Wg;oS=1;var e=gP(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return Wg=n,Wg}var Yg,lS;function Eu(){if(lS)return Yg;lS=1;var e=ai(),t=e.Symbol;return Yg=t,Yg}var Kg,cS;function ER(){if(cS)return Kg;cS=1;var e=Eu(),t=Object.prototype,n=t.hasOwnProperty,a=t.toString,s=e?e.toStringTag:void 0;function i(l){var d=n.call(l,s),u=l[s];try{l[s]=void 0;var m=!0}catch{}var p=a.call(l);return m&&(d?l[s]=u:delete l[s]),p}return Kg=i,Kg}var Gg,dS;function PR(){if(dS)return Gg;dS=1;var e=Object.prototype,t=e.toString;function n(a){return t.call(a)}return Gg=n,Gg}var Xg,uS;function Mi(){if(uS)return Xg;uS=1;var e=Eu(),t=ER(),n=PR(),a="[object Null]",s="[object Undefined]",i=e?e.toStringTag:void 0;function l(d){return d==null?d===void 0?s:a:i&&i in Object(d)?t(d):n(d)}return Xg=l,Xg}var Jg,mS;function Ri(){if(mS)return Jg;mS=1;function e(t){return t!=null&&typeof t=="object"}return Jg=e,Jg}var Zg,hS;function kc(){if(hS)return Zg;hS=1;var e=Mi(),t=Ri(),n="[object Symbol]";function a(s){return typeof s=="symbol"||t(s)&&e(s)==n}return Zg=a,Zg}var Qg,fS;function lw(){if(fS)return Qg;fS=1;var e=qa(),t=kc(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function s(i,l){if(e(i))return!1;var d=typeof i;return d=="number"||d=="symbol"||d=="boolean"||i==null||t(i)?!0:a.test(i)||!n.test(i)||l!=null&&i in Object(l)}return Qg=s,Qg}var ex,pS;function po(){if(pS)return ex;pS=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return ex=e,ex}var tx,gS;function cw(){if(gS)return tx;gS=1;var e=Mi(),t=po(),n="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",i="[object Proxy]";function l(d){if(!t(d))return!1;var u=e(d);return u==a||u==s||u==n||u==i}return tx=l,tx}var rx,xS;function TR(){if(xS)return rx;xS=1;var e=ai(),t=e["__core-js_shared__"];return rx=t,rx}var nx,yS;function DR(){if(yS)return nx;yS=1;var e=TR(),t=(function(){var a=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""})();function n(a){return!!t&&t in a}return nx=n,nx}var ax,bS;function xP(){if(bS)return ax;bS=1;var e=Function.prototype,t=e.toString;function n(a){if(a!=null){try{return t.call(a)}catch{}try{return a+""}catch{}}return""}return ax=n,ax}var sx,vS;function OR(){if(vS)return sx;vS=1;var e=cw(),t=DR(),n=po(),a=xP(),s=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,l=Function.prototype,d=Object.prototype,u=l.toString,m=d.hasOwnProperty,p=RegExp("^"+u.call(m).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(g){if(!n(g)||t(g))return!1;var N=e(g)?p:i;return N.test(a(g))}return sx=f,sx}var ix,wS;function _R(){if(wS)return ix;wS=1;function e(t,n){return t?.[n]}return ix=e,ix}var ox,jS;function ol(){if(jS)return ox;jS=1;var e=OR(),t=_R();function n(a,s){var i=t(a,s);return e(i)?i:void 0}return ox=n,ox}var lx,NS;function Cf(){if(NS)return lx;NS=1;var e=ol(),t=e(Object,"create");return lx=t,lx}var cx,SS;function MR(){if(SS)return cx;SS=1;var e=Cf();function t(){this.__data__=e?e(null):{},this.size=0}return cx=t,cx}var dx,CS;function RR(){if(CS)return dx;CS=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return dx=e,dx}var ux,kS;function $R(){if(kS)return ux;kS=1;var e=Cf(),t="__lodash_hash_undefined__",n=Object.prototype,a=n.hasOwnProperty;function s(i){var l=this.__data__;if(e){var d=l[i];return d===t?void 0:d}return a.call(l,i)?l[i]:void 0}return ux=s,ux}var mx,AS;function LR(){if(AS)return mx;AS=1;var e=Cf(),t=Object.prototype,n=t.hasOwnProperty;function a(s){var i=this.__data__;return e?i[s]!==void 0:n.call(i,s)}return mx=a,mx}var hx,IS;function FR(){if(IS)return hx;IS=1;var e=Cf(),t="__lodash_hash_undefined__";function n(a,s){var i=this.__data__;return this.size+=this.has(a)?0:1,i[a]=e&&s===void 0?t:s,this}return hx=n,hx}var fx,ES;function BR(){if(ES)return fx;ES=1;var e=MR(),t=RR(),n=$R(),a=LR(),s=FR();function i(l){var d=-1,u=l==null?0:l.length;for(this.clear();++d<u;){var m=l[d];this.set(m[0],m[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=a,i.prototype.set=s,fx=i,fx}var px,PS;function UR(){if(PS)return px;PS=1;function e(){this.__data__=[],this.size=0}return px=e,px}var gx,TS;function dw(){if(TS)return gx;TS=1;function e(t,n){return t===n||t!==t&&n!==n}return gx=e,gx}var xx,DS;function kf(){if(DS)return xx;DS=1;var e=dw();function t(n,a){for(var s=n.length;s--;)if(e(n[s][0],a))return s;return-1}return xx=t,xx}var yx,OS;function zR(){if(OS)return yx;OS=1;var e=kf(),t=Array.prototype,n=t.splice;function a(s){var i=this.__data__,l=e(i,s);if(l<0)return!1;var d=i.length-1;return l==d?i.pop():n.call(i,l,1),--this.size,!0}return yx=a,yx}var bx,_S;function qR(){if(_S)return bx;_S=1;var e=kf();function t(n){var a=this.__data__,s=e(a,n);return s<0?void 0:a[s][1]}return bx=t,bx}var vx,MS;function HR(){if(MS)return vx;MS=1;var e=kf();function t(n){return e(this.__data__,n)>-1}return vx=t,vx}var wx,RS;function VR(){if(RS)return wx;RS=1;var e=kf();function t(n,a){var s=this.__data__,i=e(s,n);return i<0?(++this.size,s.push([n,a])):s[i][1]=a,this}return wx=t,wx}var jx,$S;function Af(){if($S)return jx;$S=1;var e=UR(),t=zR(),n=qR(),a=HR(),s=VR();function i(l){var d=-1,u=l==null?0:l.length;for(this.clear();++d<u;){var m=l[d];this.set(m[0],m[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=a,i.prototype.set=s,jx=i,jx}var Nx,LS;function uw(){if(LS)return Nx;LS=1;var e=ol(),t=ai(),n=e(t,"Map");return Nx=n,Nx}var Sx,FS;function WR(){if(FS)return Sx;FS=1;var e=BR(),t=Af(),n=uw();function a(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return Sx=a,Sx}var Cx,BS;function YR(){if(BS)return Cx;BS=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return Cx=e,Cx}var kx,US;function If(){if(US)return kx;US=1;var e=YR();function t(n,a){var s=n.__data__;return e(a)?s[typeof a=="string"?"string":"hash"]:s.map}return kx=t,kx}var Ax,zS;function KR(){if(zS)return Ax;zS=1;var e=If();function t(n){var a=e(this,n).delete(n);return this.size-=a?1:0,a}return Ax=t,Ax}var Ix,qS;function GR(){if(qS)return Ix;qS=1;var e=If();function t(n){return e(this,n).get(n)}return Ix=t,Ix}var Ex,HS;function XR(){if(HS)return Ex;HS=1;var e=If();function t(n){return e(this,n).has(n)}return Ex=t,Ex}var Px,VS;function JR(){if(VS)return Px;VS=1;var e=If();function t(n,a){var s=e(this,n),i=s.size;return s.set(n,a),this.size+=s.size==i?0:1,this}return Px=t,Px}var Tx,WS;function mw(){if(WS)return Tx;WS=1;var e=WR(),t=KR(),n=GR(),a=XR(),s=JR();function i(l){var d=-1,u=l==null?0:l.length;for(this.clear();++d<u;){var m=l[d];this.set(m[0],m[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=a,i.prototype.set=s,Tx=i,Tx}var Dx,YS;function yP(){if(YS)return Dx;YS=1;var e=mw(),t="Expected a function";function n(a,s){if(typeof a!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var i=function(){var l=arguments,d=s?s.apply(this,l):l[0],u=i.cache;if(u.has(d))return u.get(d);var m=a.apply(this,l);return i.cache=u.set(d,m)||u,m};return i.cache=new(n.Cache||e),i}return n.Cache=e,Dx=n,Dx}var Ox,KS;function ZR(){if(KS)return Ox;KS=1;var e=yP(),t=500;function n(a){var s=e(a,function(l){return i.size===t&&i.clear(),l}),i=s.cache;return s}return Ox=n,Ox}var _x,GS;function QR(){if(GS)return _x;GS=1;var e=ZR(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,a=e(function(s){var i=[];return s.charCodeAt(0)===46&&i.push(""),s.replace(t,function(l,d,u,m){i.push(u?m.replace(n,"$1"):d||l)}),i});return _x=a,_x}var Mx,XS;function hw(){if(XS)return Mx;XS=1;function e(t,n){for(var a=-1,s=t==null?0:t.length,i=Array(s);++a<s;)i[a]=n(t[a],a,t);return i}return Mx=e,Mx}var Rx,JS;function e$(){if(JS)return Rx;JS=1;var e=Eu(),t=hw(),n=qa(),a=kc(),s=e?e.prototype:void 0,i=s?s.toString:void 0;function l(d){if(typeof d=="string")return d;if(n(d))return t(d,l)+"";if(a(d))return i?i.call(d):"";var u=d+"";return u=="0"&&1/d==-1/0?"-0":u}return Rx=l,Rx}var $x,ZS;function bP(){if(ZS)return $x;ZS=1;var e=e$();function t(n){return n==null?"":e(n)}return $x=t,$x}var Lx,QS;function vP(){if(QS)return Lx;QS=1;var e=qa(),t=lw(),n=QR(),a=bP();function s(i,l){return e(i)?i:t(i,l)?[i]:n(a(i))}return Lx=s,Lx}var Fx,eC;function Ef(){if(eC)return Fx;eC=1;var e=kc();function t(n){if(typeof n=="string"||e(n))return n;var a=n+"";return a=="0"&&1/n==-1/0?"-0":a}return Fx=t,Fx}var Bx,tC;function fw(){if(tC)return Bx;tC=1;var e=vP(),t=Ef();function n(a,s){s=e(s,a);for(var i=0,l=s.length;a!=null&&i<l;)a=a[t(s[i++])];return i&&i==l?a:void 0}return Bx=n,Bx}var Ux,rC;function wP(){if(rC)return Ux;rC=1;var e=fw();function t(n,a,s){var i=n==null?void 0:e(n,a);return i===void 0?s:i}return Ux=t,Ux}var t$=wP();const ts=Fr(t$);var zx,nC;function r$(){if(nC)return zx;nC=1;function e(t){return t==null}return zx=e,zx}var n$=r$();const wr=Fr(n$);var qx,aC;function a$(){if(aC)return qx;aC=1;var e=Mi(),t=qa(),n=Ri(),a="[object String]";function s(i){return typeof i=="string"||!t(i)&&n(i)&&e(i)==a}return qx=s,qx}var s$=a$();const el=Fr(s$);var i$=cw();const lr=Fr(i$);var o$=po();const Ac=Fr(o$);var Hx={exports:{}},Rr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sC;function l$(){if(sC)return Rr;sC=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),v;v=Symbol.for("react.module.reference");function w(y){if(typeof y=="object"&&y!==null){var E=y.$$typeof;switch(E){case e:switch(y=y.type,y){case n:case s:case a:case m:case p:return y;default:switch(y=y&&y.$$typeof,y){case d:case l:case u:case g:case f:case i:return y;default:return E}}case t:return E}}}return Rr.ContextConsumer=l,Rr.ContextProvider=i,Rr.Element=e,Rr.ForwardRef=u,Rr.Fragment=n,Rr.Lazy=g,Rr.Memo=f,Rr.Portal=t,Rr.Profiler=s,Rr.StrictMode=a,Rr.Suspense=m,Rr.SuspenseList=p,Rr.isAsyncMode=function(){return!1},Rr.isConcurrentMode=function(){return!1},Rr.isContextConsumer=function(y){return w(y)===l},Rr.isContextProvider=function(y){return w(y)===i},Rr.isElement=function(y){return typeof y=="object"&&y!==null&&y.$$typeof===e},Rr.isForwardRef=function(y){return w(y)===u},Rr.isFragment=function(y){return w(y)===n},Rr.isLazy=function(y){return w(y)===g},Rr.isMemo=function(y){return w(y)===f},Rr.isPortal=function(y){return w(y)===t},Rr.isProfiler=function(y){return w(y)===s},Rr.isStrictMode=function(y){return w(y)===a},Rr.isSuspense=function(y){return w(y)===m},Rr.isSuspenseList=function(y){return w(y)===p},Rr.isValidElementType=function(y){return typeof y=="string"||typeof y=="function"||y===n||y===s||y===a||y===m||y===p||y===N||typeof y=="object"&&y!==null&&(y.$$typeof===g||y.$$typeof===f||y.$$typeof===i||y.$$typeof===l||y.$$typeof===u||y.$$typeof===v||y.getModuleId!==void 0)},Rr.typeOf=w,Rr}var iC;function c$(){return iC||(iC=1,Hx.exports=l$()),Hx.exports}var d$=c$(),Vx,oC;function jP(){if(oC)return Vx;oC=1;var e=Mi(),t=Ri(),n="[object Number]";function a(s){return typeof s=="number"||t(s)&&e(s)==n}return Vx=a,Vx}var Wx,lC;function u$(){if(lC)return Wx;lC=1;var e=jP();function t(n){return e(n)&&n!=+n}return Wx=t,Wx}var m$=u$();const Pu=Fr(m$);var h$=jP();const f$=Fr(h$);var ka=function(t){return t===0?0:t>0?1:-1},zo=function(t){return el(t)&&t.indexOf("%")===t.length-1},jt=function(t){return f$(t)&&!Pu(t)},p$=function(t){return wr(t)},Rn=function(t){return jt(t)||el(t)},g$=0,Tu=function(t){var n=++g$;return"".concat(t||"").concat(n)},Aa=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!jt(t)&&!el(t))return a;var i;if(zo(t)){var l=t.indexOf("%");i=n*parseFloat(t.slice(0,l))/100}else i=+t;return Pu(i)&&(i=a),s&&i>n&&(i=n),i},ao=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},x$=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,a={},s=0;s<n;s++)if(!a[t[s]])a[t[s]]=!0;else return!0;return!1},ro=function(t,n){return jt(t)&&jt(n)?function(a){return t+a*(n-t)}:function(){return n}};function pv(e,t,n){return!e||!e.length?null:e.find(function(a){return a&&(typeof t=="function"?t(a):ts(a,t))===n})}var y$=function(t,n){return jt(t)&&jt(n)?t-n:el(t)&&el(n)?t.localeCompare(n):t instanceof Date&&n instanceof Date?t.getTime()-n.getTime():String(t).localeCompare(String(n))};function Vl(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function gv(e){"@babel/helpers - typeof";return gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gv(e)}var b$=["viewBox","children"],v$=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],cC=["points","pathLength"],Yx={svg:b$,polygon:cC,polyline:cC},pw=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],xh=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(j.isValidElement(t)&&(a=t.props),!Ac(a))return null;var s={};return Object.keys(a).forEach(function(i){pw.includes(i)&&(s[i]=n||function(l){return a[i](a,l)})}),s},w$=function(t,n,a){return function(s){return t(n,a,s),null}},tl=function(t,n,a){if(!Ac(t)||gv(t)!=="object")return null;var s=null;return Object.keys(t).forEach(function(i){var l=t[i];pw.includes(i)&&typeof l=="function"&&(s||(s={}),s[i]=w$(l,n,a))}),s},j$=["children"],N$=["children"];function dC(e,t){if(e==null)return{};var n=S$(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function S$(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}var uC={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},ki=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},mC=null,Kx=null,gw=function e(t){if(t===mC&&Array.isArray(Kx))return Kx;var n=[];return j.Children.forEach(t,function(a){wr(a)||(d$.isFragment(a)?n=n.concat(e(a.props.children)):n.push(a))}),Kx=n,mC=t,n};function ys(e,t){var n=[],a=[];return Array.isArray(t)?a=t.map(function(s){return ki(s)}):a=[ki(t)],gw(e).forEach(function(s){var i=ts(s,"type.displayName")||ts(s,"type.name");a.indexOf(i)!==-1&&n.push(s)}),n}function Za(e,t){var n=ys(e,t);return n&&n[0]}var hC=function(t){if(!t||!t.props)return!1;var n=t.props,a=n.width,s=n.height;return!(!jt(a)||a<=0||!jt(s)||s<=0)},C$=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],k$=function(t){return t&&t.type&&el(t.type)&&C$.indexOf(t.type)>=0},A$=function(t,n,a,s){var i,l=(i=Yx?.[s])!==null&&i!==void 0?i:[];return n.startsWith("data-")||!lr(t)&&(s&&l.includes(n)||v$.includes(n))||a&&pw.includes(n)},tr=function(t,n,a){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(j.isValidElement(t)&&(s=t.props),!Ac(s))return null;var i={};return Object.keys(s).forEach(function(l){var d;A$((d=s)===null||d===void 0?void 0:d[l],l,n,a)&&(i[l]=s[l])}),i},xv=function e(t,n){if(t===n)return!0;var a=j.Children.count(t);if(a!==j.Children.count(n))return!1;if(a===0)return!0;if(a===1)return fC(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var s=0;s<a;s++){var i=t[s],l=n[s];if(Array.isArray(i)||Array.isArray(l)){if(!e(i,l))return!1}else if(!fC(i,l))return!1}return!0},fC=function(t,n){if(wr(t)&&wr(n))return!0;if(!wr(t)&&!wr(n)){var a=t.props||{},s=a.children,i=dC(a,j$),l=n.props||{},d=l.children,u=dC(l,N$);return s&&d?Vl(i,u)&&xv(s,d):!s&&!d?Vl(i,u):!1}return!1},pC=function(t,n){var a=[],s={};return gw(t).forEach(function(i,l){if(k$(i))a.push(i);else if(i){var d=ki(i.type),u=n[d]||{},m=u.handler,p=u.once;if(m&&(!p||!s[d])){var f=m(i,d,l);a.push(f),s[d]=!0}}}),a},I$=function(t){var n=t&&t.type;return n&&uC[n]?uC[n]:null},E$=function(t,n){return gw(n).indexOf(t)},P$=["children","width","height","viewBox","className","style","title","desc"];function yv(){return yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},yv.apply(this,arguments)}function T$(e,t){if(e==null)return{};var n=D$(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function D$(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function bv(e){var t=e.children,n=e.width,a=e.height,s=e.viewBox,i=e.className,l=e.style,d=e.title,u=e.desc,m=T$(e,P$),p=s||{width:n,height:a,x:0,y:0},f=xr("recharts-surface",i);return xe.createElement("svg",yv({},tr(m,!0,"svg"),{className:f,width:n,height:a,style:l,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height)}),xe.createElement("title",null,d),xe.createElement("desc",null,u),t)}var O$=["children","className"];function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},vv.apply(this,arguments)}function _$(e,t){if(e==null)return{};var n=M$(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function M$(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}var Br=xe.forwardRef(function(e,t){var n=e.children,a=e.className,s=_$(e,O$),i=xr("recharts-layer",a);return xe.createElement("g",vv({className:i},tr(s,!0),{ref:t}),n)}),Ms=function(t,n){for(var a=arguments.length,s=new Array(a>2?a-2:0),i=2;i<a;i++)s[i-2]=arguments[i]},Gx,gC;function R$(){if(gC)return Gx;gC=1;function e(t,n,a){var s=-1,i=t.length;n<0&&(n=-n>i?0:i+n),a=a>i?i:a,a<0&&(a+=i),i=n>a?0:a-n>>>0,n>>>=0;for(var l=Array(i);++s<i;)l[s]=t[s+n];return l}return Gx=e,Gx}var Xx,xC;function $$(){if(xC)return Xx;xC=1;var e=R$();function t(n,a,s){var i=n.length;return s=s===void 0?i:s,!a&&s>=i?n:e(n,a,s)}return Xx=t,Xx}var Jx,yC;function NP(){if(yC)return Jx;yC=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",a="\\u20d0-\\u20ff",s=t+n+a,i="\\ufe0e\\ufe0f",l="\\u200d",d=RegExp("["+l+e+s+i+"]");function u(m){return d.test(m)}return Jx=u,Jx}var Zx,bC;function L$(){if(bC)return Zx;bC=1;function e(t){return t.split("")}return Zx=e,Zx}var Qx,vC;function F$(){if(vC)return Qx;vC=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",a="\\u20d0-\\u20ff",s=t+n+a,i="\\ufe0e\\ufe0f",l="["+e+"]",d="["+s+"]",u="\\ud83c[\\udffb-\\udfff]",m="(?:"+d+"|"+u+")",p="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",g="[\\ud800-\\udbff][\\udc00-\\udfff]",N="\\u200d",v=m+"?",w="["+i+"]?",y="(?:"+N+"(?:"+[p,f,g].join("|")+")"+w+v+")*",E=w+v+y,O="(?:"+[p+d+"?",d,f,g,l].join("|")+")",T=RegExp(u+"(?="+u+")|"+O+E,"g");function A(I){return I.match(T)||[]}return Qx=A,Qx}var e0,wC;function B$(){if(wC)return e0;wC=1;var e=L$(),t=NP(),n=F$();function a(s){return t(s)?n(s):e(s)}return e0=a,e0}var t0,jC;function U$(){if(jC)return t0;jC=1;var e=$$(),t=NP(),n=B$(),a=bP();function s(i){return function(l){l=a(l);var d=t(l)?n(l):void 0,u=d?d[0]:l.charAt(0),m=d?e(d,1).join(""):l.slice(1);return u[i]()+m}}return t0=s,t0}var r0,NC;function z$(){if(NC)return r0;NC=1;var e=U$(),t=e("toUpperCase");return r0=t,r0}var q$=z$();const Pf=Fr(q$);function Xr(e){return function(){return e}}const SP=Math.cos,yh=Math.sin,$s=Math.sqrt,bh=Math.PI,Tf=2*bh,wv=Math.PI,jv=2*wv,Lo=1e-6,H$=jv-Lo;function CP(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function V$(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return CP;const n=10**t;return function(a){this._+=a[0];for(let s=1,i=a.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+a[s]}}class W${constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?CP:V$(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,a,s){this._append`Q${+t},${+n},${this._x1=+a},${this._y1=+s}`}bezierCurveTo(t,n,a,s,i,l){this._append`C${+t},${+n},${+a},${+s},${this._x1=+i},${this._y1=+l}`}arcTo(t,n,a,s,i){if(t=+t,n=+n,a=+a,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,d=this._y1,u=a-t,m=s-n,p=l-t,f=d-n,g=p*p+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(g>Lo)if(!(Math.abs(f*u-m*p)>Lo)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let N=a-l,v=s-d,w=u*u+m*m,y=N*N+v*v,E=Math.sqrt(w),O=Math.sqrt(g),T=i*Math.tan((wv-Math.acos((w+g-y)/(2*E*O)))/2),A=T/O,I=T/E;Math.abs(A-1)>Lo&&this._append`L${t+A*p},${n+A*f}`,this._append`A${i},${i},0,0,${+(f*N>p*v)},${this._x1=t+I*u},${this._y1=n+I*m}`}}arc(t,n,a,s,i,l){if(t=+t,n=+n,a=+a,l=!!l,a<0)throw new Error(`negative radius: ${a}`);let d=a*Math.cos(s),u=a*Math.sin(s),m=t+d,p=n+u,f=1^l,g=l?s-i:i-s;this._x1===null?this._append`M${m},${p}`:(Math.abs(this._x1-m)>Lo||Math.abs(this._y1-p)>Lo)&&this._append`L${m},${p}`,a&&(g<0&&(g=g%jv+jv),g>H$?this._append`A${a},${a},0,1,${f},${t-d},${n-u}A${a},${a},0,1,${f},${this._x1=m},${this._y1=p}`:g>Lo&&this._append`A${a},${a},0,${+(g>=wv)},${f},${this._x1=t+a*Math.cos(i)},${this._y1=n+a*Math.sin(i)}`)}rect(t,n,a,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${a=+a}v${+s}h${-a}Z`}toString(){return this._}}function xw(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const a=Math.floor(n);if(!(a>=0))throw new RangeError(`invalid digits: ${n}`);t=a}return e},()=>new W$(t)}function yw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kP(e){this._context=e}kP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Df(e){return new kP(e)}function AP(e){return e[0]}function IP(e){return e[1]}function EP(e,t){var n=Xr(!0),a=null,s=Df,i=null,l=xw(d);e=typeof e=="function"?e:e===void 0?AP:Xr(e),t=typeof t=="function"?t:t===void 0?IP:Xr(t);function d(u){var m,p=(u=yw(u)).length,f,g=!1,N;for(a==null&&(i=s(N=l())),m=0;m<=p;++m)!(m<p&&n(f=u[m],m,u))===g&&((g=!g)?i.lineStart():i.lineEnd()),g&&i.point(+e(f,m,u),+t(f,m,u));if(N)return i=null,N+""||null}return d.x=function(u){return arguments.length?(e=typeof u=="function"?u:Xr(+u),d):e},d.y=function(u){return arguments.length?(t=typeof u=="function"?u:Xr(+u),d):t},d.defined=function(u){return arguments.length?(n=typeof u=="function"?u:Xr(!!u),d):n},d.curve=function(u){return arguments.length?(s=u,a!=null&&(i=s(a)),d):s},d.context=function(u){return arguments.length?(u==null?a=i=null:i=s(a=u),d):a},d}function Bm(e,t,n){var a=null,s=Xr(!0),i=null,l=Df,d=null,u=xw(m);e=typeof e=="function"?e:e===void 0?AP:Xr(+e),t=typeof t=="function"?t:Xr(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?IP:Xr(+n);function m(f){var g,N,v,w=(f=yw(f)).length,y,E=!1,O,T=new Array(w),A=new Array(w);for(i==null&&(d=l(O=u())),g=0;g<=w;++g){if(!(g<w&&s(y=f[g],g,f))===E)if(E=!E)N=g,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),v=g-1;v>=N;--v)d.point(T[v],A[v]);d.lineEnd(),d.areaEnd()}E&&(T[g]=+e(y,g,f),A[g]=+t(y,g,f),d.point(a?+a(y,g,f):T[g],n?+n(y,g,f):A[g]))}if(O)return d=null,O+""||null}function p(){return EP().defined(s).curve(l).context(i)}return m.x=function(f){return arguments.length?(e=typeof f=="function"?f:Xr(+f),a=null,m):e},m.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Xr(+f),m):e},m.x1=function(f){return arguments.length?(a=f==null?null:typeof f=="function"?f:Xr(+f),m):a},m.y=function(f){return arguments.length?(t=typeof f=="function"?f:Xr(+f),n=null,m):t},m.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Xr(+f),m):t},m.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Xr(+f),m):n},m.lineX0=m.lineY0=function(){return p().x(e).y(t)},m.lineY1=function(){return p().x(e).y(n)},m.lineX1=function(){return p().x(a).y(t)},m.defined=function(f){return arguments.length?(s=typeof f=="function"?f:Xr(!!f),m):s},m.curve=function(f){return arguments.length?(l=f,i!=null&&(d=l(i)),m):l},m.context=function(f){return arguments.length?(f==null?i=d=null:d=l(i=f),m):i},m}class PP{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function Y$(e){return new PP(e,!0)}function K$(e){return new PP(e,!1)}const bw={draw(e,t){const n=$s(t/bh);e.moveTo(n,0),e.arc(0,0,n,0,Tf)}},G$={draw(e,t){const n=$s(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},TP=$s(1/3),X$=TP*2,J$={draw(e,t){const n=$s(t/X$),a=n*TP;e.moveTo(0,-n),e.lineTo(a,0),e.lineTo(0,n),e.lineTo(-a,0),e.closePath()}},Z$={draw(e,t){const n=$s(t),a=-n/2;e.rect(a,a,n,n)}},Q$=.8908130915292852,DP=yh(bh/10)/yh(7*bh/10),eL=yh(Tf/10)*DP,tL=-SP(Tf/10)*DP,rL={draw(e,t){const n=$s(t*Q$),a=eL*n,s=tL*n;e.moveTo(0,-n),e.lineTo(a,s);for(let i=1;i<5;++i){const l=Tf*i/5,d=SP(l),u=yh(l);e.lineTo(u*n,-d*n),e.lineTo(d*a-u*s,u*a+d*s)}e.closePath()}},n0=$s(3),nL={draw(e,t){const n=-$s(t/(n0*3));e.moveTo(0,n*2),e.lineTo(-n0*n,-n),e.lineTo(n0*n,-n),e.closePath()}},us=-.5,ms=$s(3)/2,Nv=1/$s(12),aL=(Nv/2+1)*3,sL={draw(e,t){const n=$s(t/aL),a=n/2,s=n*Nv,i=a,l=n*Nv+n,d=-i,u=l;e.moveTo(a,s),e.lineTo(i,l),e.lineTo(d,u),e.lineTo(us*a-ms*s,ms*a+us*s),e.lineTo(us*i-ms*l,ms*i+us*l),e.lineTo(us*d-ms*u,ms*d+us*u),e.lineTo(us*a+ms*s,us*s-ms*a),e.lineTo(us*i+ms*l,us*l-ms*i),e.lineTo(us*d+ms*u,us*u-ms*d),e.closePath()}};function iL(e,t){let n=null,a=xw(s);e=typeof e=="function"?e:Xr(e||bw),t=typeof t=="function"?t:Xr(t===void 0?64:+t);function s(){let i;if(n||(n=i=a()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return s.type=function(i){return arguments.length?(e=typeof i=="function"?i:Xr(i),s):e},s.size=function(i){return arguments.length?(t=typeof i=="function"?i:Xr(+i),s):t},s.context=function(i){return arguments.length?(n=i??null,s):n},s}function vh(){}function wh(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function OP(e){this._context=e}OP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:wh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:wh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function oL(e){return new OP(e)}function _P(e){this._context=e}_P.prototype={areaStart:vh,areaEnd:vh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:wh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function lL(e){return new _P(e)}function MP(e){this._context=e}MP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:wh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function cL(e){return new MP(e)}function RP(e){this._context=e}RP.prototype={areaStart:vh,areaEnd:vh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function dL(e){return new RP(e)}function SC(e){return e<0?-1:1}function CC(e,t,n){var a=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(a||s<0&&-0),l=(n-e._y1)/(s||a<0&&-0),d=(i*s+l*a)/(a+s);return(SC(i)+SC(l))*Math.min(Math.abs(i),Math.abs(l),.5*Math.abs(d))||0}function kC(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function a0(e,t,n){var a=e._x0,s=e._y0,i=e._x1,l=e._y1,d=(i-a)/3;e._context.bezierCurveTo(a+d,s+d*t,i-d,l-d*n,i,l)}function jh(e){this._context=e}jh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:a0(this,this._t0,kC(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,a0(this,kC(this,n=CC(this,e,t)),n);break;default:a0(this,this._t0,n=CC(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function $P(e){this._context=new LP(e)}($P.prototype=Object.create(jh.prototype)).point=function(e,t){jh.prototype.point.call(this,t,e)};function LP(e){this._context=e}LP.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,a,s,i){this._context.bezierCurveTo(t,e,a,n,i,s)}};function uL(e){return new jh(e)}function mL(e){return new $P(e)}function FP(e){this._context=e}FP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var a=AC(e),s=AC(t),i=0,l=1;l<n;++i,++l)this._context.bezierCurveTo(a[0][i],s[0][i],a[1][i],s[1][i],e[l],t[l]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function AC(e){var t,n=e.length-1,a,s=new Array(n),i=new Array(n),l=new Array(n);for(s[0]=0,i[0]=2,l[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,l[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,l[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)a=s[t]/i[t-1],i[t]-=a,l[t]-=a*l[t-1];for(s[n-1]=l[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(l[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function hL(e){return new FP(e)}function Of(e,t){this._context=e,this._t=t}Of.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function fL(e){return new Of(e,.5)}function pL(e){return new Of(e,0)}function gL(e){return new Of(e,1)}function Zl(e,t){if((l=e.length)>1)for(var n=1,a,s,i=e[t[0]],l,d=i.length;n<l;++n)for(s=i,i=e[t[n]],a=0;a<d;++a)i[a][1]+=i[a][0]=isNaN(s[a][1])?s[a][0]:s[a][1]}function Sv(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function xL(e,t){return e[t]}function yL(e){const t=[];return t.key=e,t}function bL(){var e=Xr([]),t=Sv,n=Zl,a=xL;function s(i){var l=Array.from(e.apply(this,arguments),yL),d,u=l.length,m=-1,p;for(const f of i)for(d=0,++m;d<u;++d)(l[d][m]=[0,+a(f,l[d].key,m,i)]).data=f;for(d=0,p=yw(t(l));d<u;++d)l[p[d]].index=d;return n(l,p),l}return s.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Xr(Array.from(i)),s):e},s.value=function(i){return arguments.length?(a=typeof i=="function"?i:Xr(+i),s):a},s.order=function(i){return arguments.length?(t=i==null?Sv:typeof i=="function"?i:Xr(Array.from(i)),s):t},s.offset=function(i){return arguments.length?(n=i??Zl,s):n},s}function vL(e,t){if((a=e.length)>0){for(var n,a,s=0,i=e[0].length,l;s<i;++s){for(l=n=0;n<a;++n)l+=e[n][s][1]||0;if(l)for(n=0;n<a;++n)e[n][s][1]/=l}Zl(e,t)}}function wL(e,t){if((s=e.length)>0){for(var n=0,a=e[t[0]],s,i=a.length;n<i;++n){for(var l=0,d=0;l<s;++l)d+=e[l][n][1]||0;a[n][1]+=a[n][0]=-d/2}Zl(e,t)}}function jL(e,t){if(!(!((l=e.length)>0)||!((i=(s=e[t[0]]).length)>0))){for(var n=0,a=1,s,i,l;a<i;++a){for(var d=0,u=0,m=0;d<l;++d){for(var p=e[t[d]],f=p[a][1]||0,g=p[a-1][1]||0,N=(f-g)/2,v=0;v<d;++v){var w=e[t[v]],y=w[a][1]||0,E=w[a-1][1]||0;N+=y-E}u+=f,m+=N*f}s[a-1][1]+=s[a-1][0]=n,u&&(n-=m/u)}s[a-1][1]+=s[a-1][0]=n,Zl(e,t)}}function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}var NL=["type","size","sizeType"];function Cv(){return Cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Cv.apply(this,arguments)}function IC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function EC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IC(Object(n),!0).forEach(function(a){SL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IC(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function SL(e,t,n){return t=CL(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CL(e){var t=kL(e,"string");return Bd(t)=="symbol"?t:t+""}function kL(e,t){if(Bd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(Bd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AL(e,t){if(e==null)return{};var n=IL(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function IL(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}var BP={symbolCircle:bw,symbolCross:G$,symbolDiamond:J$,symbolSquare:Z$,symbolStar:rL,symbolTriangle:nL,symbolWye:sL},EL=Math.PI/180,PL=function(t){var n="symbol".concat(Pf(t));return BP[n]||bw},TL=function(t,n,a){if(n==="area")return t;switch(a){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var s=18*EL;return 1.25*t*t*(Math.tan(s)-Math.tan(s*2)*Math.pow(Math.tan(s),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},DL=function(t,n){BP["symbol".concat(Pf(t))]=n},vw=function(t){var n=t.type,a=n===void 0?"circle":n,s=t.size,i=s===void 0?64:s,l=t.sizeType,d=l===void 0?"area":l,u=AL(t,NL),m=EC(EC({},u),{},{type:a,size:i,sizeType:d}),p=function(){var y=PL(a),E=iL().type(y).size(TL(i,d,a));return E()},f=m.className,g=m.cx,N=m.cy,v=tr(m,!0);return g===+g&&N===+N&&i===+i?xe.createElement("path",Cv({},v,{className:xr("recharts-symbols",f),transform:"translate(".concat(g,", ").concat(N,")"),d:p()})):null};vw.registerSymbol=DL;function Ql(e){"@babel/helpers - typeof";return Ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ql(e)}function kv(){return kv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},kv.apply(this,arguments)}function PC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function OL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?PC(Object(n),!0).forEach(function(a){Ud(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PC(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ML(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,zP(a.key),a)}}function RL(e,t,n){return t&&ML(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $L(e,t,n){return t=Nh(t),LL(e,UP()?Reflect.construct(t,n||[],Nh(e).constructor):t.apply(e,n))}function LL(e,t){if(t&&(Ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FL(e)}function FL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UP=function(){return!!e})()}function Nh(e){return Nh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Nh(e)}function BL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Av(e,t)}function Av(e,t){return Av=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Av(e,t)}function Ud(e,t,n){return t=zP(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zP(e){var t=UL(e,"string");return Ql(t)=="symbol"?t:t+""}function UL(e,t){if(Ql(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(Ql(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var hs=32,ww=(function(e){function t(){return _L(this,t),$L(this,t,arguments)}return BL(t,e),RL(t,[{key:"renderIcon",value:function(a){var s=this.props.inactiveColor,i=hs/2,l=hs/6,d=hs/3,u=a.inactive?s:a.color;if(a.type==="plainline")return xe.createElement("line",{strokeWidth:4,fill:"none",stroke:u,strokeDasharray:a.payload.strokeDasharray,x1:0,y1:i,x2:hs,y2:i,className:"recharts-legend-icon"});if(a.type==="line")return xe.createElement("path",{strokeWidth:4,fill:"none",stroke:u,d:"M0,".concat(i,"h").concat(d,`
            A`).concat(l,",").concat(l,",0,1,1,").concat(2*d,",").concat(i,`
            H`).concat(hs,"M").concat(2*d,",").concat(i,`
            A`).concat(l,",").concat(l,",0,1,1,").concat(d,",").concat(i),className:"recharts-legend-icon"});if(a.type==="rect")return xe.createElement("path",{stroke:"none",fill:u,d:"M0,".concat(hs/8,"h").concat(hs,"v").concat(hs*3/4,"h").concat(-hs,"z"),className:"recharts-legend-icon"});if(xe.isValidElement(a.legendIcon)){var m=OL({},a);return delete m.legendIcon,xe.cloneElement(a.legendIcon,m)}return xe.createElement(vw,{fill:u,cx:i,cy:i,size:hs,sizeType:"diameter",type:a.type})}},{key:"renderItems",value:function(){var a=this,s=this.props,i=s.payload,l=s.iconSize,d=s.layout,u=s.formatter,m=s.inactiveColor,p={x:0,y:0,width:hs,height:hs},f={display:d==="horizontal"?"inline-block":"block",marginRight:10},g={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(N,v){var w=N.formatter||u,y=xr(Ud(Ud({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",N.inactive));if(N.type==="none")return null;var E=lr(N.value)?null:N.value;Ms(!lr(N.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var O=N.inactive?m:N.color;return xe.createElement("li",kv({className:y,style:f,key:"legend-item-".concat(v)},tl(a.props,N,v)),xe.createElement(bv,{width:l,height:l,viewBox:p,style:g},a.renderIcon(N)),xe.createElement("span",{className:"recharts-legend-item-text",style:{color:O}},w?w(E,N,v):E))})}},{key:"render",value:function(){var a=this.props,s=a.payload,i=a.layout,l=a.align;if(!s||!s.length)return null;var d={padding:0,margin:0,textAlign:i==="horizontal"?l:"left"};return xe.createElement("ul",{className:"recharts-default-legend",style:d},this.renderItems())}}])})(j.PureComponent);Ud(ww,"displayName","Legend");Ud(ww,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var s0,TC;function zL(){if(TC)return s0;TC=1;var e=Af();function t(){this.__data__=new e,this.size=0}return s0=t,s0}var i0,DC;function qL(){if(DC)return i0;DC=1;function e(t){var n=this.__data__,a=n.delete(t);return this.size=n.size,a}return i0=e,i0}var o0,OC;function HL(){if(OC)return o0;OC=1;function e(t){return this.__data__.get(t)}return o0=e,o0}var l0,_C;function VL(){if(_C)return l0;_C=1;function e(t){return this.__data__.has(t)}return l0=e,l0}var c0,MC;function WL(){if(MC)return c0;MC=1;var e=Af(),t=uw(),n=mw(),a=200;function s(i,l){var d=this.__data__;if(d instanceof e){var u=d.__data__;if(!t||u.length<a-1)return u.push([i,l]),this.size=++d.size,this;d=this.__data__=new n(u)}return d.set(i,l),this.size=d.size,this}return c0=s,c0}var d0,RC;function qP(){if(RC)return d0;RC=1;var e=Af(),t=zL(),n=qL(),a=HL(),s=VL(),i=WL();function l(d){var u=this.__data__=new e(d);this.size=u.size}return l.prototype.clear=t,l.prototype.delete=n,l.prototype.get=a,l.prototype.has=s,l.prototype.set=i,d0=l,d0}var u0,$C;function YL(){if($C)return u0;$C=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return u0=t,u0}var m0,LC;function KL(){if(LC)return m0;LC=1;function e(t){return this.__data__.has(t)}return m0=e,m0}var h0,FC;function HP(){if(FC)return h0;FC=1;var e=mw(),t=YL(),n=KL();function a(s){var i=-1,l=s==null?0:s.length;for(this.__data__=new e;++i<l;)this.add(s[i])}return a.prototype.add=a.prototype.push=t,a.prototype.has=n,h0=a,h0}var f0,BC;function VP(){if(BC)return f0;BC=1;function e(t,n){for(var a=-1,s=t==null?0:t.length;++a<s;)if(n(t[a],a,t))return!0;return!1}return f0=e,f0}var p0,UC;function WP(){if(UC)return p0;UC=1;function e(t,n){return t.has(n)}return p0=e,p0}var g0,zC;function YP(){if(zC)return g0;zC=1;var e=HP(),t=VP(),n=WP(),a=1,s=2;function i(l,d,u,m,p,f){var g=u&a,N=l.length,v=d.length;if(N!=v&&!(g&&v>N))return!1;var w=f.get(l),y=f.get(d);if(w&&y)return w==d&&y==l;var E=-1,O=!0,T=u&s?new e:void 0;for(f.set(l,d),f.set(d,l);++E<N;){var A=l[E],I=d[E];if(m)var C=g?m(I,A,E,d,l,f):m(A,I,E,l,d,f);if(C!==void 0){if(C)continue;O=!1;break}if(T){if(!t(d,function(P,F){if(!n(T,F)&&(A===P||p(A,P,u,m,f)))return T.push(F)})){O=!1;break}}else if(!(A===I||p(A,I,u,m,f))){O=!1;break}}return f.delete(l),f.delete(d),O}return g0=i,g0}var x0,qC;function GL(){if(qC)return x0;qC=1;var e=ai(),t=e.Uint8Array;return x0=t,x0}var y0,HC;function XL(){if(HC)return y0;HC=1;function e(t){var n=-1,a=Array(t.size);return t.forEach(function(s,i){a[++n]=[i,s]}),a}return y0=e,y0}var b0,VC;function jw(){if(VC)return b0;VC=1;function e(t){var n=-1,a=Array(t.size);return t.forEach(function(s){a[++n]=s}),a}return b0=e,b0}var v0,WC;function JL(){if(WC)return v0;WC=1;var e=Eu(),t=GL(),n=dw(),a=YP(),s=XL(),i=jw(),l=1,d=2,u="[object Boolean]",m="[object Date]",p="[object Error]",f="[object Map]",g="[object Number]",N="[object RegExp]",v="[object Set]",w="[object String]",y="[object Symbol]",E="[object ArrayBuffer]",O="[object DataView]",T=e?e.prototype:void 0,A=T?T.valueOf:void 0;function I(C,P,F,R,$,L,G){switch(F){case O:if(C.byteLength!=P.byteLength||C.byteOffset!=P.byteOffset)return!1;C=C.buffer,P=P.buffer;case E:return!(C.byteLength!=P.byteLength||!L(new t(C),new t(P)));case u:case m:case g:return n(+C,+P);case p:return C.name==P.name&&C.message==P.message;case N:case w:return C==P+"";case f:var X=s;case v:var me=R&l;if(X||(X=i),C.size!=P.size&&!me)return!1;var se=G.get(C);if(se)return se==P;R|=d,G.set(C,P);var ee=a(X(C),X(P),R,$,L,G);return G.delete(C),ee;case y:if(A)return A.call(C)==A.call(P)}return!1}return v0=I,v0}var w0,YC;function KP(){if(YC)return w0;YC=1;function e(t,n){for(var a=-1,s=n.length,i=t.length;++a<s;)t[i+a]=n[a];return t}return w0=e,w0}var j0,KC;function ZL(){if(KC)return j0;KC=1;var e=KP(),t=qa();function n(a,s,i){var l=s(a);return t(a)?l:e(l,i(a))}return j0=n,j0}var N0,GC;function QL(){if(GC)return N0;GC=1;function e(t,n){for(var a=-1,s=t==null?0:t.length,i=0,l=[];++a<s;){var d=t[a];n(d,a,t)&&(l[i++]=d)}return l}return N0=e,N0}var S0,XC;function eF(){if(XC)return S0;XC=1;function e(){return[]}return S0=e,S0}var C0,JC;function tF(){if(JC)return C0;JC=1;var e=QL(),t=eF(),n=Object.prototype,a=n.propertyIsEnumerable,s=Object.getOwnPropertySymbols,i=s?function(l){return l==null?[]:(l=Object(l),e(s(l),function(d){return a.call(l,d)}))}:t;return C0=i,C0}var k0,ZC;function rF(){if(ZC)return k0;ZC=1;function e(t,n){for(var a=-1,s=Array(t);++a<t;)s[a]=n(a);return s}return k0=e,k0}var A0,QC;function nF(){if(QC)return A0;QC=1;var e=Mi(),t=Ri(),n="[object Arguments]";function a(s){return t(s)&&e(s)==n}return A0=a,A0}var I0,ek;function Nw(){if(ek)return I0;ek=1;var e=nF(),t=Ri(),n=Object.prototype,a=n.hasOwnProperty,s=n.propertyIsEnumerable,i=e((function(){return arguments})())?e:function(l){return t(l)&&a.call(l,"callee")&&!s.call(l,"callee")};return I0=i,I0}var Sd={exports:{}},E0,tk;function aF(){if(tk)return E0;tk=1;function e(){return!1}return E0=e,E0}Sd.exports;var rk;function GP(){return rk||(rk=1,(function(e,t){var n=ai(),a=aF(),s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,l=i&&i.exports===s,d=l?n.Buffer:void 0,u=d?d.isBuffer:void 0,m=u||a;e.exports=m})(Sd,Sd.exports)),Sd.exports}var P0,nk;function Sw(){if(nk)return P0;nk=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(a,s){var i=typeof a;return s=s??e,!!s&&(i=="number"||i!="symbol"&&t.test(a))&&a>-1&&a%1==0&&a<s}return P0=n,P0}var T0,ak;function Cw(){if(ak)return T0;ak=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return T0=t,T0}var D0,sk;function sF(){if(sk)return D0;sk=1;var e=Mi(),t=Cw(),n=Ri(),a="[object Arguments]",s="[object Array]",i="[object Boolean]",l="[object Date]",d="[object Error]",u="[object Function]",m="[object Map]",p="[object Number]",f="[object Object]",g="[object RegExp]",N="[object Set]",v="[object String]",w="[object WeakMap]",y="[object ArrayBuffer]",E="[object DataView]",O="[object Float32Array]",T="[object Float64Array]",A="[object Int8Array]",I="[object Int16Array]",C="[object Int32Array]",P="[object Uint8Array]",F="[object Uint8ClampedArray]",R="[object Uint16Array]",$="[object Uint32Array]",L={};L[O]=L[T]=L[A]=L[I]=L[C]=L[P]=L[F]=L[R]=L[$]=!0,L[a]=L[s]=L[y]=L[i]=L[E]=L[l]=L[d]=L[u]=L[m]=L[p]=L[f]=L[g]=L[N]=L[v]=L[w]=!1;function G(X){return n(X)&&t(X.length)&&!!L[e(X)]}return D0=G,D0}var O0,ik;function XP(){if(ik)return O0;ik=1;function e(t){return function(n){return t(n)}}return O0=e,O0}var Cd={exports:{}};Cd.exports;var ok;function iF(){return ok||(ok=1,(function(e,t){var n=gP(),a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===a,l=i&&n.process,d=(function(){try{var u=s&&s.require&&s.require("util").types;return u||l&&l.binding&&l.binding("util")}catch{}})();e.exports=d})(Cd,Cd.exports)),Cd.exports}var _0,lk;function JP(){if(lk)return _0;lk=1;var e=sF(),t=XP(),n=iF(),a=n&&n.isTypedArray,s=a?t(a):e;return _0=s,_0}var M0,ck;function oF(){if(ck)return M0;ck=1;var e=rF(),t=Nw(),n=qa(),a=GP(),s=Sw(),i=JP(),l=Object.prototype,d=l.hasOwnProperty;function u(m,p){var f=n(m),g=!f&&t(m),N=!f&&!g&&a(m),v=!f&&!g&&!N&&i(m),w=f||g||N||v,y=w?e(m.length,String):[],E=y.length;for(var O in m)(p||d.call(m,O))&&!(w&&(O=="length"||N&&(O=="offset"||O=="parent")||v&&(O=="buffer"||O=="byteLength"||O=="byteOffset")||s(O,E)))&&y.push(O);return y}return M0=u,M0}var R0,dk;function lF(){if(dk)return R0;dk=1;var e=Object.prototype;function t(n){var a=n&&n.constructor,s=typeof a=="function"&&a.prototype||e;return n===s}return R0=t,R0}var $0,uk;function ZP(){if(uk)return $0;uk=1;function e(t,n){return function(a){return t(n(a))}}return $0=e,$0}var L0,mk;function cF(){if(mk)return L0;mk=1;var e=ZP(),t=e(Object.keys,Object);return L0=t,L0}var F0,hk;function dF(){if(hk)return F0;hk=1;var e=lF(),t=cF(),n=Object.prototype,a=n.hasOwnProperty;function s(i){if(!e(i))return t(i);var l=[];for(var d in Object(i))a.call(i,d)&&d!="constructor"&&l.push(d);return l}return F0=s,F0}var B0,fk;function Du(){if(fk)return B0;fk=1;var e=cw(),t=Cw();function n(a){return a!=null&&t(a.length)&&!e(a)}return B0=n,B0}var U0,pk;function _f(){if(pk)return U0;pk=1;var e=oF(),t=dF(),n=Du();function a(s){return n(s)?e(s):t(s)}return U0=a,U0}var z0,gk;function uF(){if(gk)return z0;gk=1;var e=ZL(),t=tF(),n=_f();function a(s){return e(s,n,t)}return z0=a,z0}var q0,xk;function mF(){if(xk)return q0;xk=1;var e=uF(),t=1,n=Object.prototype,a=n.hasOwnProperty;function s(i,l,d,u,m,p){var f=d&t,g=e(i),N=g.length,v=e(l),w=v.length;if(N!=w&&!f)return!1;for(var y=N;y--;){var E=g[y];if(!(f?E in l:a.call(l,E)))return!1}var O=p.get(i),T=p.get(l);if(O&&T)return O==l&&T==i;var A=!0;p.set(i,l),p.set(l,i);for(var I=f;++y<N;){E=g[y];var C=i[E],P=l[E];if(u)var F=f?u(P,C,E,l,i,p):u(C,P,E,i,l,p);if(!(F===void 0?C===P||m(C,P,d,u,p):F)){A=!1;break}I||(I=E=="constructor")}if(A&&!I){var R=i.constructor,$=l.constructor;R!=$&&"constructor"in i&&"constructor"in l&&!(typeof R=="function"&&R instanceof R&&typeof $=="function"&&$ instanceof $)&&(A=!1)}return p.delete(i),p.delete(l),A}return q0=s,q0}var H0,yk;function hF(){if(yk)return H0;yk=1;var e=ol(),t=ai(),n=e(t,"DataView");return H0=n,H0}var V0,bk;function fF(){if(bk)return V0;bk=1;var e=ol(),t=ai(),n=e(t,"Promise");return V0=n,V0}var W0,vk;function QP(){if(vk)return W0;vk=1;var e=ol(),t=ai(),n=e(t,"Set");return W0=n,W0}var Y0,wk;function pF(){if(wk)return Y0;wk=1;var e=ol(),t=ai(),n=e(t,"WeakMap");return Y0=n,Y0}var K0,jk;function gF(){if(jk)return K0;jk=1;var e=hF(),t=uw(),n=fF(),a=QP(),s=pF(),i=Mi(),l=xP(),d="[object Map]",u="[object Object]",m="[object Promise]",p="[object Set]",f="[object WeakMap]",g="[object DataView]",N=l(e),v=l(t),w=l(n),y=l(a),E=l(s),O=i;return(e&&O(new e(new ArrayBuffer(1)))!=g||t&&O(new t)!=d||n&&O(n.resolve())!=m||a&&O(new a)!=p||s&&O(new s)!=f)&&(O=function(T){var A=i(T),I=A==u?T.constructor:void 0,C=I?l(I):"";if(C)switch(C){case N:return g;case v:return d;case w:return m;case y:return p;case E:return f}return A}),K0=O,K0}var G0,Nk;function xF(){if(Nk)return G0;Nk=1;var e=qP(),t=YP(),n=JL(),a=mF(),s=gF(),i=qa(),l=GP(),d=JP(),u=1,m="[object Arguments]",p="[object Array]",f="[object Object]",g=Object.prototype,N=g.hasOwnProperty;function v(w,y,E,O,T,A){var I=i(w),C=i(y),P=I?p:s(w),F=C?p:s(y);P=P==m?f:P,F=F==m?f:F;var R=P==f,$=F==f,L=P==F;if(L&&l(w)){if(!l(y))return!1;I=!0,R=!1}if(L&&!R)return A||(A=new e),I||d(w)?t(w,y,E,O,T,A):n(w,y,P,E,O,T,A);if(!(E&u)){var G=R&&N.call(w,"__wrapped__"),X=$&&N.call(y,"__wrapped__");if(G||X){var me=G?w.value():w,se=X?y.value():y;return A||(A=new e),T(me,se,E,O,A)}}return L?(A||(A=new e),a(w,y,E,O,T,A)):!1}return G0=v,G0}var X0,Sk;function kw(){if(Sk)return X0;Sk=1;var e=xF(),t=Ri();function n(a,s,i,l,d){return a===s?!0:a==null||s==null||!t(a)&&!t(s)?a!==a&&s!==s:e(a,s,i,l,n,d)}return X0=n,X0}var J0,Ck;function yF(){if(Ck)return J0;Ck=1;var e=qP(),t=kw(),n=1,a=2;function s(i,l,d,u){var m=d.length,p=m,f=!u;if(i==null)return!p;for(i=Object(i);m--;){var g=d[m];if(f&&g[2]?g[1]!==i[g[0]]:!(g[0]in i))return!1}for(;++m<p;){g=d[m];var N=g[0],v=i[N],w=g[1];if(f&&g[2]){if(v===void 0&&!(N in i))return!1}else{var y=new e;if(u)var E=u(v,w,N,i,l,y);if(!(E===void 0?t(w,v,n|a,u,y):E))return!1}}return!0}return J0=s,J0}var Z0,kk;function eT(){if(kk)return Z0;kk=1;var e=po();function t(n){return n===n&&!e(n)}return Z0=t,Z0}var Q0,Ak;function bF(){if(Ak)return Q0;Ak=1;var e=eT(),t=_f();function n(a){for(var s=t(a),i=s.length;i--;){var l=s[i],d=a[l];s[i]=[l,d,e(d)]}return s}return Q0=n,Q0}var ey,Ik;function tT(){if(Ik)return ey;Ik=1;function e(t,n){return function(a){return a==null?!1:a[t]===n&&(n!==void 0||t in Object(a))}}return ey=e,ey}var ty,Ek;function vF(){if(Ek)return ty;Ek=1;var e=yF(),t=bF(),n=tT();function a(s){var i=t(s);return i.length==1&&i[0][2]?n(i[0][0],i[0][1]):function(l){return l===s||e(l,s,i)}}return ty=a,ty}var ry,Pk;function wF(){if(Pk)return ry;Pk=1;function e(t,n){return t!=null&&n in Object(t)}return ry=e,ry}var ny,Tk;function jF(){if(Tk)return ny;Tk=1;var e=vP(),t=Nw(),n=qa(),a=Sw(),s=Cw(),i=Ef();function l(d,u,m){u=e(u,d);for(var p=-1,f=u.length,g=!1;++p<f;){var N=i(u[p]);if(!(g=d!=null&&m(d,N)))break;d=d[N]}return g||++p!=f?g:(f=d==null?0:d.length,!!f&&s(f)&&a(N,f)&&(n(d)||t(d)))}return ny=l,ny}var ay,Dk;function NF(){if(Dk)return ay;Dk=1;var e=wF(),t=jF();function n(a,s){return a!=null&&t(a,s,e)}return ay=n,ay}var sy,Ok;function SF(){if(Ok)return sy;Ok=1;var e=kw(),t=wP(),n=NF(),a=lw(),s=eT(),i=tT(),l=Ef(),d=1,u=2;function m(p,f){return a(p)&&s(f)?i(l(p),f):function(g){var N=t(g,p);return N===void 0&&N===f?n(g,p):e(f,N,d|u)}}return sy=m,sy}var iy,_k;function Ic(){if(_k)return iy;_k=1;function e(t){return t}return iy=e,iy}var oy,Mk;function CF(){if(Mk)return oy;Mk=1;function e(t){return function(n){return n?.[t]}}return oy=e,oy}var ly,Rk;function kF(){if(Rk)return ly;Rk=1;var e=fw();function t(n){return function(a){return e(a,n)}}return ly=t,ly}var cy,$k;function AF(){if($k)return cy;$k=1;var e=CF(),t=kF(),n=lw(),a=Ef();function s(i){return n(i)?e(a(i)):t(i)}return cy=s,cy}var dy,Lk;function si(){if(Lk)return dy;Lk=1;var e=vF(),t=SF(),n=Ic(),a=qa(),s=AF();function i(l){return typeof l=="function"?l:l==null?n:typeof l=="object"?a(l)?t(l[0],l[1]):e(l):s(l)}return dy=i,dy}var uy,Fk;function rT(){if(Fk)return uy;Fk=1;function e(t,n,a,s){for(var i=t.length,l=a+(s?1:-1);s?l--:++l<i;)if(n(t[l],l,t))return l;return-1}return uy=e,uy}var my,Bk;function IF(){if(Bk)return my;Bk=1;function e(t){return t!==t}return my=e,my}var hy,Uk;function EF(){if(Uk)return hy;Uk=1;function e(t,n,a){for(var s=a-1,i=t.length;++s<i;)if(t[s]===n)return s;return-1}return hy=e,hy}var fy,zk;function PF(){if(zk)return fy;zk=1;var e=rT(),t=IF(),n=EF();function a(s,i,l){return i===i?n(s,i,l):e(s,t,l)}return fy=a,fy}var py,qk;function TF(){if(qk)return py;qk=1;var e=PF();function t(n,a){var s=n==null?0:n.length;return!!s&&e(n,a,0)>-1}return py=t,py}var gy,Hk;function DF(){if(Hk)return gy;Hk=1;function e(t,n,a){for(var s=-1,i=t==null?0:t.length;++s<i;)if(a(n,t[s]))return!0;return!1}return gy=e,gy}var xy,Vk;function OF(){if(Vk)return xy;Vk=1;function e(){}return xy=e,xy}var yy,Wk;function _F(){if(Wk)return yy;Wk=1;var e=QP(),t=OF(),n=jw(),a=1/0,s=e&&1/n(new e([,-0]))[1]==a?function(i){return new e(i)}:t;return yy=s,yy}var by,Yk;function MF(){if(Yk)return by;Yk=1;var e=HP(),t=TF(),n=DF(),a=WP(),s=_F(),i=jw(),l=200;function d(u,m,p){var f=-1,g=t,N=u.length,v=!0,w=[],y=w;if(p)v=!1,g=n;else if(N>=l){var E=m?null:s(u);if(E)return i(E);v=!1,g=a,y=new e}else y=m?[]:w;e:for(;++f<N;){var O=u[f],T=m?m(O):O;if(O=p||O!==0?O:0,v&&T===T){for(var A=y.length;A--;)if(y[A]===T)continue e;m&&y.push(T),w.push(O)}else g(y,T,p)||(y!==w&&y.push(T),w.push(O))}return w}return by=d,by}var vy,Kk;function RF(){if(Kk)return vy;Kk=1;var e=si(),t=MF();function n(a,s){return a&&a.length?t(a,e(s,2)):[]}return vy=n,vy}var $F=RF();const Gk=Fr($F);function nT(e,t,n){return t===!0?Gk(e,n):lr(t)?Gk(e,t):e}function ec(e){"@babel/helpers - typeof";return ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ec(e)}var LF=["ref"];function Xk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function yi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Xk(Object(n),!0).forEach(function(a){Mf(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xk(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function FF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jk(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,sT(a.key),a)}}function BF(e,t,n){return t&&Jk(e.prototype,t),n&&Jk(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function UF(e,t,n){return t=Sh(t),zF(e,aT()?Reflect.construct(t,n||[],Sh(e).constructor):t.apply(e,n))}function zF(e,t){if(t&&(ec(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qF(e)}function qF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aT=function(){return!!e})()}function Sh(e){return Sh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Sh(e)}function HF(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Iv(e,t)}function Iv(e,t){return Iv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Iv(e,t)}function Mf(e,t,n){return t=sT(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sT(e){var t=VF(e,"string");return ec(t)=="symbol"?t:t+""}function VF(e,t){if(ec(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(ec(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function WF(e,t){if(e==null)return{};var n=YF(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function YF(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function KF(e){return e.value}function GF(e,t){if(xe.isValidElement(e))return xe.cloneElement(e,t);if(typeof e=="function")return xe.createElement(e,t);t.ref;var n=WF(t,LF);return xe.createElement(ww,n)}var Zk=1,Wl=(function(e){function t(){var n;FF(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return n=UF(this,t,[].concat(s)),Mf(n,"lastBoundingBox",{width:-1,height:-1}),n}return HF(t,e),BF(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var a=this.wrapperNode.getBoundingClientRect();return a.height=this.wrapperNode.offsetHeight,a.width=this.wrapperNode.offsetWidth,a}return null}},{key:"updateBBox",value:function(){var a=this.props.onBBoxUpdate,s=this.getBBox();s?(Math.abs(s.width-this.lastBoundingBox.width)>Zk||Math.abs(s.height-this.lastBoundingBox.height)>Zk)&&(this.lastBoundingBox.width=s.width,this.lastBoundingBox.height=s.height,a&&a(s)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,a&&a(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?yi({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(a){var s=this.props,i=s.layout,l=s.align,d=s.verticalAlign,u=s.margin,m=s.chartWidth,p=s.chartHeight,f,g;if(!a||(a.left===void 0||a.left===null)&&(a.right===void 0||a.right===null))if(l==="center"&&i==="vertical"){var N=this.getBBoxSnapshot();f={left:((m||0)-N.width)/2}}else f=l==="right"?{right:u&&u.right||0}:{left:u&&u.left||0};if(!a||(a.top===void 0||a.top===null)&&(a.bottom===void 0||a.bottom===null))if(d==="middle"){var v=this.getBBoxSnapshot();g={top:((p||0)-v.height)/2}}else g=d==="bottom"?{bottom:u&&u.bottom||0}:{top:u&&u.top||0};return yi(yi({},f),g)}},{key:"render",value:function(){var a=this,s=this.props,i=s.content,l=s.width,d=s.height,u=s.wrapperStyle,m=s.payloadUniqBy,p=s.payload,f=yi(yi({position:"absolute",width:l||"auto",height:d||"auto"},this.getDefaultPosition(u)),u);return xe.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(N){a.wrapperNode=N}},GF(i,yi(yi({},this.props),{},{payload:nT(p,m,KF)})))}}],[{key:"getWithHeight",value:function(a,s){var i=yi(yi({},this.defaultProps),a.props),l=i.layout;return l==="vertical"&&jt(a.props.height)?{height:a.props.height}:l==="horizontal"?{width:a.props.width||s}:null}}])})(j.PureComponent);Mf(Wl,"displayName","Legend");Mf(Wl,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var wy,Qk;function XF(){if(Qk)return wy;Qk=1;var e=Eu(),t=Nw(),n=qa(),a=e?e.isConcatSpreadable:void 0;function s(i){return n(i)||t(i)||!!(a&&i&&i[a])}return wy=s,wy}var jy,eA;function iT(){if(eA)return jy;eA=1;var e=KP(),t=XF();function n(a,s,i,l,d){var u=-1,m=a.length;for(i||(i=t),d||(d=[]);++u<m;){var p=a[u];s>0&&i(p)?s>1?n(p,s-1,i,l,d):e(d,p):l||(d[d.length]=p)}return d}return jy=n,jy}var Ny,tA;function JF(){if(tA)return Ny;tA=1;function e(t){return function(n,a,s){for(var i=-1,l=Object(n),d=s(n),u=d.length;u--;){var m=d[t?u:++i];if(a(l[m],m,l)===!1)break}return n}}return Ny=e,Ny}var Sy,rA;function ZF(){if(rA)return Sy;rA=1;var e=JF(),t=e();return Sy=t,Sy}var Cy,nA;function oT(){if(nA)return Cy;nA=1;var e=ZF(),t=_f();function n(a,s){return a&&e(a,s,t)}return Cy=n,Cy}var ky,aA;function QF(){if(aA)return ky;aA=1;var e=Du();function t(n,a){return function(s,i){if(s==null)return s;if(!e(s))return n(s,i);for(var l=s.length,d=a?l:-1,u=Object(s);(a?d--:++d<l)&&i(u[d],d,u)!==!1;);return s}}return ky=t,ky}var Ay,sA;function Aw(){if(sA)return Ay;sA=1;var e=oT(),t=QF(),n=t(e);return Ay=n,Ay}var Iy,iA;function lT(){if(iA)return Iy;iA=1;var e=Aw(),t=Du();function n(a,s){var i=-1,l=t(a)?Array(a.length):[];return e(a,function(d,u,m){l[++i]=s(d,u,m)}),l}return Iy=n,Iy}var Ey,oA;function eB(){if(oA)return Ey;oA=1;function e(t,n){var a=t.length;for(t.sort(n);a--;)t[a]=t[a].value;return t}return Ey=e,Ey}var Py,lA;function tB(){if(lA)return Py;lA=1;var e=kc();function t(n,a){if(n!==a){var s=n!==void 0,i=n===null,l=n===n,d=e(n),u=a!==void 0,m=a===null,p=a===a,f=e(a);if(!m&&!f&&!d&&n>a||d&&u&&p&&!m&&!f||i&&u&&p||!s&&p||!l)return 1;if(!i&&!d&&!f&&n<a||f&&s&&l&&!i&&!d||m&&s&&l||!u&&l||!p)return-1}return 0}return Py=t,Py}var Ty,cA;function rB(){if(cA)return Ty;cA=1;var e=tB();function t(n,a,s){for(var i=-1,l=n.criteria,d=a.criteria,u=l.length,m=s.length;++i<u;){var p=e(l[i],d[i]);if(p){if(i>=m)return p;var f=s[i];return p*(f=="desc"?-1:1)}}return n.index-a.index}return Ty=t,Ty}var Dy,dA;function nB(){if(dA)return Dy;dA=1;var e=hw(),t=fw(),n=si(),a=lT(),s=eB(),i=XP(),l=rB(),d=Ic(),u=qa();function m(p,f,g){f.length?f=e(f,function(w){return u(w)?function(y){return t(y,w.length===1?w[0]:w)}:w}):f=[d];var N=-1;f=e(f,i(n));var v=a(p,function(w,y,E){var O=e(f,function(T){return T(w)});return{criteria:O,index:++N,value:w}});return s(v,function(w,y){return l(w,y,g)})}return Dy=m,Dy}var Oy,uA;function aB(){if(uA)return Oy;uA=1;function e(t,n,a){switch(a.length){case 0:return t.call(n);case 1:return t.call(n,a[0]);case 2:return t.call(n,a[0],a[1]);case 3:return t.call(n,a[0],a[1],a[2])}return t.apply(n,a)}return Oy=e,Oy}var _y,mA;function sB(){if(mA)return _y;mA=1;var e=aB(),t=Math.max;function n(a,s,i){return s=t(s===void 0?a.length-1:s,0),function(){for(var l=arguments,d=-1,u=t(l.length-s,0),m=Array(u);++d<u;)m[d]=l[s+d];d=-1;for(var p=Array(s+1);++d<s;)p[d]=l[d];return p[s]=i(m),e(a,this,p)}}return _y=n,_y}var My,hA;function iB(){if(hA)return My;hA=1;function e(t){return function(){return t}}return My=e,My}var Ry,fA;function cT(){if(fA)return Ry;fA=1;var e=ol(),t=(function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}})();return Ry=t,Ry}var $y,pA;function oB(){if(pA)return $y;pA=1;var e=iB(),t=cT(),n=Ic(),a=t?function(s,i){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:n;return $y=a,$y}var Ly,gA;function lB(){if(gA)return Ly;gA=1;var e=800,t=16,n=Date.now;function a(s){var i=0,l=0;return function(){var d=n(),u=t-(d-l);if(l=d,u>0){if(++i>=e)return arguments[0]}else i=0;return s.apply(void 0,arguments)}}return Ly=a,Ly}var Fy,xA;function cB(){if(xA)return Fy;xA=1;var e=oB(),t=lB(),n=t(e);return Fy=n,Fy}var By,yA;function dB(){if(yA)return By;yA=1;var e=Ic(),t=sB(),n=cB();function a(s,i){return n(t(s,i,e),s+"")}return By=a,By}var Uy,bA;function Rf(){if(bA)return Uy;bA=1;var e=dw(),t=Du(),n=Sw(),a=po();function s(i,l,d){if(!a(d))return!1;var u=typeof l;return(u=="number"?t(d)&&n(l,d.length):u=="string"&&l in d)?e(d[l],i):!1}return Uy=s,Uy}var zy,vA;function uB(){if(vA)return zy;vA=1;var e=iT(),t=nB(),n=dB(),a=Rf(),s=n(function(i,l){if(i==null)return[];var d=l.length;return d>1&&a(i,l[0],l[1])?l=[]:d>2&&a(l[0],l[1],l[2])&&(l=[l[0]]),t(i,e(l,1),[])});return zy=s,zy}var mB=uB();const Iw=Fr(mB);function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zd(e)}function Ev(){return Ev=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ev.apply(this,arguments)}function hB(e,t){return xB(e)||gB(e,t)||pB(e,t)||fB()}function fB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pB(e,t){if(e){if(typeof e=="string")return wA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wA(e,t)}}function wA(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function gB(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function xB(e){if(Array.isArray(e))return e}function jA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function qy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jA(Object(n),!0).forEach(function(a){yB(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jA(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function yB(e,t,n){return t=bB(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bB(e){var t=vB(e,"string");return zd(t)=="symbol"?t:t+""}function vB(e,t){if(zd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(zd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wB(e){return Array.isArray(e)&&Rn(e[0])&&Rn(e[1])?e.join(" ~ "):e}var jB=function(t){var n=t.separator,a=n===void 0?" : ":n,s=t.contentStyle,i=s===void 0?{}:s,l=t.itemStyle,d=l===void 0?{}:l,u=t.labelStyle,m=u===void 0?{}:u,p=t.payload,f=t.formatter,g=t.itemSorter,N=t.wrapperClassName,v=t.labelClassName,w=t.label,y=t.labelFormatter,E=t.accessibilityLayer,O=E===void 0?!1:E,T=function(){if(p&&p.length){var G={padding:0,margin:0},X=(g?Iw(p,g):p).map(function(me,se){if(me.type==="none")return null;var ee=qy({display:"block",paddingTop:4,paddingBottom:4,color:me.color||"#000"},d),W=me.formatter||f||wB,U=me.value,Q=me.name,Y=U,H=Q;if(W&&Y!=null&&H!=null){var te=W(U,Q,me,se,p);if(Array.isArray(te)){var fe=hB(te,2);Y=fe[0],H=fe[1]}else Y=te}return xe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(se),style:ee},Rn(H)?xe.createElement("span",{className:"recharts-tooltip-item-name"},H):null,Rn(H)?xe.createElement("span",{className:"recharts-tooltip-item-separator"},a):null,xe.createElement("span",{className:"recharts-tooltip-item-value"},Y),xe.createElement("span",{className:"recharts-tooltip-item-unit"},me.unit||""))});return xe.createElement("ul",{className:"recharts-tooltip-item-list",style:G},X)}return null},A=qy({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),I=qy({margin:0},m),C=!wr(w),P=C?w:"",F=xr("recharts-default-tooltip",N),R=xr("recharts-tooltip-label",v);C&&y&&p!==void 0&&p!==null&&(P=y(w,p));var $=O?{role:"status","aria-live":"assertive"}:{};return xe.createElement("div",Ev({className:F,style:A},$),xe.createElement("p",{className:R,style:I},xe.isValidElement(P)?P:"".concat(P)),T())};function qd(e){"@babel/helpers - typeof";return qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qd(e)}function Um(e,t,n){return t=NB(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NB(e){var t=SB(e,"string");return qd(t)=="symbol"?t:t+""}function SB(e,t){if(qd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(qd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hd="recharts-tooltip-wrapper",CB={visibility:"hidden"};function kB(e){var t=e.coordinate,n=e.translateX,a=e.translateY;return xr(hd,Um(Um(Um(Um({},"".concat(hd,"-right"),jt(n)&&t&&jt(t.x)&&n>=t.x),"".concat(hd,"-left"),jt(n)&&t&&jt(t.x)&&n<t.x),"".concat(hd,"-bottom"),jt(a)&&t&&jt(t.y)&&a>=t.y),"".concat(hd,"-top"),jt(a)&&t&&jt(t.y)&&a<t.y))}function NA(e){var t=e.allowEscapeViewBox,n=e.coordinate,a=e.key,s=e.offsetTopLeft,i=e.position,l=e.reverseDirection,d=e.tooltipDimension,u=e.viewBox,m=e.viewBoxDimension;if(i&&jt(i[a]))return i[a];var p=n[a]-d-s,f=n[a]+s;if(t[a])return l[a]?p:f;if(l[a]){var g=p,N=u[a];return g<N?Math.max(f,u[a]):Math.max(p,u[a])}var v=f+d,w=u[a]+m;return v>w?Math.max(p,u[a]):Math.max(f,u[a])}function AB(e){var t=e.translateX,n=e.translateY,a=e.useTranslate3d;return{transform:a?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function IB(e){var t=e.allowEscapeViewBox,n=e.coordinate,a=e.offsetTopLeft,s=e.position,i=e.reverseDirection,l=e.tooltipBox,d=e.useTranslate3d,u=e.viewBox,m,p,f;return l.height>0&&l.width>0&&n?(p=NA({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:a,position:s,reverseDirection:i,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),f=NA({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:a,position:s,reverseDirection:i,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),m=AB({translateX:p,translateY:f,useTranslate3d:d})):m=CB,{cssProperties:m,cssClasses:kB({translateX:p,translateY:f,coordinate:n})}}function tc(e){"@babel/helpers - typeof";return tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tc(e)}function SA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function CA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SA(Object(n),!0).forEach(function(a){Tv(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SA(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function EB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PB(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,uT(a.key),a)}}function TB(e,t,n){return t&&PB(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function DB(e,t,n){return t=Ch(t),OB(e,dT()?Reflect.construct(t,n||[],Ch(e).constructor):t.apply(e,n))}function OB(e,t){if(t&&(tc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _B(e)}function _B(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dT=function(){return!!e})()}function Ch(e){return Ch=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ch(e)}function MB(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pv(e,t)}function Pv(e,t){return Pv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Pv(e,t)}function Tv(e,t,n){return t=uT(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uT(e){var t=RB(e,"string");return tc(t)=="symbol"?t:t+""}function RB(e,t){if(tc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(tc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var kA=1,$B=(function(e){function t(){var n;EB(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return n=DB(this,t,[].concat(s)),Tv(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Tv(n,"handleKeyDown",function(l){if(l.key==="Escape"){var d,u,m,p;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(d=(u=n.props.coordinate)===null||u===void 0?void 0:u.x)!==null&&d!==void 0?d:0,y:(m=(p=n.props.coordinate)===null||p===void 0?void 0:p.y)!==null&&m!==void 0?m:0}})}}),n}return MB(t,e),TB(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var a=this.wrapperNode.getBoundingClientRect();(Math.abs(a.width-this.state.lastBoundingBox.width)>kA||Math.abs(a.height-this.state.lastBoundingBox.height)>kA)&&this.setState({lastBoundingBox:{width:a.width,height:a.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var a,s;this.props.active&&this.updateBBox(),this.state.dismissed&&(((a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==this.state.dismissedAtCoordinate.x||((s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var a=this,s=this.props,i=s.active,l=s.allowEscapeViewBox,d=s.animationDuration,u=s.animationEasing,m=s.children,p=s.coordinate,f=s.hasPayload,g=s.isAnimationActive,N=s.offset,v=s.position,w=s.reverseDirection,y=s.useTranslate3d,E=s.viewBox,O=s.wrapperStyle,T=IB({allowEscapeViewBox:l,coordinate:p,offsetTopLeft:N,position:v,reverseDirection:w,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:E}),A=T.cssClasses,I=T.cssProperties,C=CA(CA({transition:g&&i?"transform ".concat(d,"ms ").concat(u):void 0},I),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},O);return xe.createElement("div",{tabIndex:-1,className:A,style:C,ref:function(F){a.wrapperNode=F}},m)}}])})(j.PureComponent),LB=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ec={isSsr:LB()};function rc(e){"@babel/helpers - typeof";return rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rc(e)}function AA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function IA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AA(Object(n),!0).forEach(function(a){Ew(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AA(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function FB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BB(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,hT(a.key),a)}}function UB(e,t,n){return t&&BB(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zB(e,t,n){return t=kh(t),qB(e,mT()?Reflect.construct(t,n||[],kh(e).constructor):t.apply(e,n))}function qB(e,t){if(t&&(rc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HB(e)}function HB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mT=function(){return!!e})()}function kh(e){return kh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},kh(e)}function VB(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dv(e,t)}function Dv(e,t){return Dv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Dv(e,t)}function Ew(e,t,n){return t=hT(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hT(e){var t=WB(e,"string");return rc(t)=="symbol"?t:t+""}function WB(e,t){if(rc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(rc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function YB(e){return e.dataKey}function KB(e,t){return xe.isValidElement(e)?xe.cloneElement(e,t):typeof e=="function"?xe.createElement(e,t):xe.createElement(jB,t)}var Qa=(function(e){function t(){return FB(this,t),zB(this,t,arguments)}return VB(t,e),UB(t,[{key:"render",value:function(){var a=this,s=this.props,i=s.active,l=s.allowEscapeViewBox,d=s.animationDuration,u=s.animationEasing,m=s.content,p=s.coordinate,f=s.filterNull,g=s.isAnimationActive,N=s.offset,v=s.payload,w=s.payloadUniqBy,y=s.position,E=s.reverseDirection,O=s.useTranslate3d,T=s.viewBox,A=s.wrapperStyle,I=v??[];f&&I.length&&(I=nT(v.filter(function(P){return P.value!=null&&(P.hide!==!0||a.props.includeHidden)}),w,YB));var C=I.length>0;return xe.createElement($B,{allowEscapeViewBox:l,animationDuration:d,animationEasing:u,isAnimationActive:g,active:i,coordinate:p,hasPayload:C,offset:N,position:y,reverseDirection:E,useTranslate3d:O,viewBox:T,wrapperStyle:A},KB(m,IA(IA({},this.props),{},{payload:I})))}}])})(j.PureComponent);Ew(Qa,"displayName","Tooltip");Ew(Qa,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ec.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Hy,EA;function GB(){if(EA)return Hy;EA=1;var e=ai(),t=function(){return e.Date.now()};return Hy=t,Hy}var Vy,PA;function XB(){if(PA)return Vy;PA=1;var e=/\s/;function t(n){for(var a=n.length;a--&&e.test(n.charAt(a)););return a}return Vy=t,Vy}var Wy,TA;function JB(){if(TA)return Wy;TA=1;var e=XB(),t=/^\s+/;function n(a){return a&&a.slice(0,e(a)+1).replace(t,"")}return Wy=n,Wy}var Yy,DA;function fT(){if(DA)return Yy;DA=1;var e=JB(),t=po(),n=kc(),a=NaN,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt;function u(m){if(typeof m=="number")return m;if(n(m))return a;if(t(m)){var p=typeof m.valueOf=="function"?m.valueOf():m;m=t(p)?p+"":p}if(typeof m!="string")return m===0?m:+m;m=e(m);var f=i.test(m);return f||l.test(m)?d(m.slice(2),f?2:8):s.test(m)?a:+m}return Yy=u,Yy}var Ky,OA;function ZB(){if(OA)return Ky;OA=1;var e=po(),t=GB(),n=fT(),a="Expected a function",s=Math.max,i=Math.min;function l(d,u,m){var p,f,g,N,v,w,y=0,E=!1,O=!1,T=!0;if(typeof d!="function")throw new TypeError(a);u=n(u)||0,e(m)&&(E=!!m.leading,O="maxWait"in m,g=O?s(n(m.maxWait)||0,u):g,T="trailing"in m?!!m.trailing:T);function A(X){var me=p,se=f;return p=f=void 0,y=X,N=d.apply(se,me),N}function I(X){return y=X,v=setTimeout(F,u),E?A(X):N}function C(X){var me=X-w,se=X-y,ee=u-me;return O?i(ee,g-se):ee}function P(X){var me=X-w,se=X-y;return w===void 0||me>=u||me<0||O&&se>=g}function F(){var X=t();if(P(X))return R(X);v=setTimeout(F,C(X))}function R(X){return v=void 0,T&&p?A(X):(p=f=void 0,N)}function $(){v!==void 0&&clearTimeout(v),y=0,p=w=f=v=void 0}function L(){return v===void 0?N:R(t())}function G(){var X=t(),me=P(X);if(p=arguments,f=this,w=X,me){if(v===void 0)return I(w);if(O)return clearTimeout(v),v=setTimeout(F,u),A(w)}return v===void 0&&(v=setTimeout(F,u)),N}return G.cancel=$,G.flush=L,G}return Ky=l,Ky}var Gy,_A;function QB(){if(_A)return Gy;_A=1;var e=ZB(),t=po(),n="Expected a function";function a(s,i,l){var d=!0,u=!0;if(typeof s!="function")throw new TypeError(n);return t(l)&&(d="leading"in l?!!l.leading:d,u="trailing"in l?!!l.trailing:u),e(s,i,{leading:d,maxWait:i,trailing:u})}return Gy=a,Gy}var e8=QB();const pT=Fr(e8);function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hd(e)}function MA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function zm(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?MA(Object(n),!0).forEach(function(a){t8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):MA(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function t8(e,t,n){return t=r8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r8(e){var t=n8(e,"string");return Hd(t)=="symbol"?t:t+""}function n8(e,t){if(Hd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(Hd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function a8(e,t){return l8(e)||o8(e,t)||i8(e,t)||s8()}function s8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i8(e,t){if(e){if(typeof e=="string")return RA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return RA(e,t)}}function RA(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function o8(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function l8(e){if(Array.isArray(e))return e}var qm=j.forwardRef(function(e,t){var n=e.aspect,a=e.initialDimension,s=a===void 0?{width:-1,height:-1}:a,i=e.width,l=i===void 0?"100%":i,d=e.height,u=d===void 0?"100%":d,m=e.minWidth,p=m===void 0?0:m,f=e.minHeight,g=e.maxHeight,N=e.children,v=e.debounce,w=v===void 0?0:v,y=e.id,E=e.className,O=e.onResize,T=e.style,A=T===void 0?{}:T,I=j.useRef(null),C=j.useRef();C.current=O,j.useImperativeHandle(t,function(){return Object.defineProperty(I.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),I.current},configurable:!0})});var P=j.useState({containerWidth:s.width,containerHeight:s.height}),F=a8(P,2),R=F[0],$=F[1],L=j.useCallback(function(X,me){$(function(se){var ee=Math.round(X),W=Math.round(me);return se.containerWidth===ee&&se.containerHeight===W?se:{containerWidth:ee,containerHeight:W}})},[]);j.useEffect(function(){var X=function(Q){var Y,H=Q[0].contentRect,te=H.width,fe=H.height;L(te,fe),(Y=C.current)===null||Y===void 0||Y.call(C,te,fe)};w>0&&(X=pT(X,w,{trailing:!0,leading:!1}));var me=new ResizeObserver(X),se=I.current.getBoundingClientRect(),ee=se.width,W=se.height;return L(ee,W),me.observe(I.current),function(){me.disconnect()}},[L,w]);var G=j.useMemo(function(){var X=R.containerWidth,me=R.containerHeight;if(X<0||me<0)return null;Ms(zo(l)||zo(u),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,l,u),Ms(!n||n>0,"The aspect(%s) must be greater than zero.",n);var se=zo(l)?X:l,ee=zo(u)?me:u;n&&n>0&&(se?ee=se/n:ee&&(se=ee*n),g&&ee>g&&(ee=g)),Ms(se>0||ee>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,se,ee,l,u,p,f,n);var W=!Array.isArray(N)&&ki(N.type).endsWith("Chart");return xe.Children.map(N,function(U){return xe.isValidElement(U)?j.cloneElement(U,zm({width:se,height:ee},W?{style:zm({height:"100%",width:"100%",maxHeight:ee,maxWidth:se},U.props.style)}:{})):U})},[n,N,u,g,f,p,R,l]);return xe.createElement("div",{id:y?"".concat(y):void 0,className:xr("recharts-responsive-container",E),style:zm(zm({},A),{},{width:l,height:u,minWidth:p,minHeight:f,maxHeight:g}),ref:I},G)}),Vd=function(t){return null};Vd.displayName="Cell";function Wd(e){"@babel/helpers - typeof";return Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wd(e)}function $A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Ov(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$A(Object(n),!0).forEach(function(a){c8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$A(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function c8(e,t,n){return t=d8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d8(e){var t=u8(e,"string");return Wd(t)=="symbol"?t:t+""}function u8(e,t){if(Wd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(Wd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ml={widthCache:{},cacheCount:0},m8=2e3,h8={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},LA="recharts_measurement_span";function f8(e){var t=Ov({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var Pd=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ec.isSsr)return{width:0,height:0};var a=f8(n),s=JSON.stringify({text:t,copyStyle:a});if(Ml.widthCache[s])return Ml.widthCache[s];try{var i=document.getElementById(LA);i||(i=document.createElement("span"),i.setAttribute("id",LA),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var l=Ov(Ov({},h8),a);Object.assign(i.style,l),i.textContent="".concat(t);var d=i.getBoundingClientRect(),u={width:d.width,height:d.height};return Ml.widthCache[s]=u,++Ml.cacheCount>m8&&(Ml.cacheCount=0,Ml.widthCache={}),u}catch{return{width:0,height:0}}},p8=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Yd(e){"@babel/helpers - typeof";return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yd(e)}function Ah(e,t){return b8(e)||y8(e,t)||x8(e,t)||g8()}function g8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x8(e,t){if(e){if(typeof e=="string")return FA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FA(e,t)}}function FA(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function y8(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function b8(e){if(Array.isArray(e))return e}function v8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,j8(a.key),a)}}function w8(e,t,n){return t&&BA(e.prototype,t),n&&BA(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function j8(e){var t=N8(e,"string");return Yd(t)=="symbol"?t:t+""}function N8(e,t){if(Yd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(Yd(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var UA=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,zA=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,S8=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,C8=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,gT={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},k8=Object.keys(gT),Fl="NaN";function A8(e,t){return e*gT[t]}var Hm=(function(){function e(t,n){v8(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!S8.test(n)&&(this.num=NaN,this.unit=""),k8.includes(n)&&(this.num=A8(t,n),this.unit="px")}return w8(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var a,s=(a=C8.exec(n))!==null&&a!==void 0?a:[],i=Ah(s,3),l=i[1],d=i[2];return new e(parseFloat(l),d??"")}}])})();function xT(e){if(e.includes(Fl))return Fl;for(var t=e;t.includes("*")||t.includes("/");){var n,a=(n=UA.exec(t))!==null&&n!==void 0?n:[],s=Ah(a,4),i=s[1],l=s[2],d=s[3],u=Hm.parse(i??""),m=Hm.parse(d??""),p=l==="*"?u.multiply(m):u.divide(m);if(p.isNaN())return Fl;t=t.replace(UA,p.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,g=(f=zA.exec(t))!==null&&f!==void 0?f:[],N=Ah(g,4),v=N[1],w=N[2],y=N[3],E=Hm.parse(v??""),O=Hm.parse(y??""),T=w==="+"?E.add(O):E.subtract(O);if(T.isNaN())return Fl;t=t.replace(zA,T.toString())}return t}var qA=/\(([^()]*)\)/;function I8(e){for(var t=e;t.includes("(");){var n=qA.exec(t),a=Ah(n,2),s=a[1];t=t.replace(qA,xT(s))}return t}function E8(e){var t=e.replace(/\s+/g,"");return t=I8(t),t=xT(t),t}function P8(e){try{return E8(e)}catch{return Fl}}function Xy(e){var t=P8(e.slice(5,-1));return t===Fl?"":t}var T8=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],D8=["dx","dy","angle","className","breakAll"];function _v(){return _v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_v.apply(this,arguments)}function HA(e,t){if(e==null)return{};var n=O8(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function O8(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function VA(e,t){return $8(e)||R8(e,t)||M8(e,t)||_8()}function _8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M8(e,t){if(e){if(typeof e=="string")return WA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WA(e,t)}}function WA(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function R8(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function $8(e){if(Array.isArray(e))return e}var yT=/[ \f\n\r\t\v\u2028\u2029]+/,bT=function(t){var n=t.children,a=t.breakAll,s=t.style;try{var i=[];wr(n)||(a?i=n.toString().split(""):i=n.toString().split(yT));var l=i.map(function(u){return{word:u,width:Pd(u,s).width}}),d=a?0:Pd("",s).width;return{wordsWithComputedWidth:l,spaceWidth:d}}catch{return null}},L8=function(t,n,a,s,i){var l=t.maxLines,d=t.children,u=t.style,m=t.breakAll,p=jt(l),f=d,g=function(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return se.reduce(function(ee,W){var U=W.word,Q=W.width,Y=ee[ee.length-1];if(Y&&(s==null||i||Y.width+Q+a<Number(s)))Y.words.push(U),Y.width+=Q+a;else{var H={words:[U],width:Q};ee.push(H)}return ee},[])},N=g(n),v=function(se){return se.reduce(function(ee,W){return ee.width>W.width?ee:W})};if(!p)return N;for(var w="",y=function(se){var ee=f.slice(0,se),W=bT({breakAll:m,style:u,children:ee+w}).wordsWithComputedWidth,U=g(W),Q=U.length>l||v(U).width>Number(s);return[Q,U]},E=0,O=f.length-1,T=0,A;E<=O&&T<=f.length-1;){var I=Math.floor((E+O)/2),C=I-1,P=y(C),F=VA(P,2),R=F[0],$=F[1],L=y(I),G=VA(L,1),X=G[0];if(!R&&!X&&(E=I+1),R&&X&&(O=I-1),!R&&X){A=$;break}T++}return A||N},YA=function(t){var n=wr(t)?[]:t.toString().split(yT);return[{words:n}]},F8=function(t){var n=t.width,a=t.scaleToFit,s=t.children,i=t.style,l=t.breakAll,d=t.maxLines;if((n||a)&&!Ec.isSsr){var u,m,p=bT({breakAll:l,children:s,style:i});if(p){var f=p.wordsWithComputedWidth,g=p.spaceWidth;u=f,m=g}else return YA(s);return L8({breakAll:l,children:s,maxLines:d,style:i},u,m,n,a)}return YA(s)},KA="#808080",rl=function(t){var n=t.x,a=n===void 0?0:n,s=t.y,i=s===void 0?0:s,l=t.lineHeight,d=l===void 0?"1em":l,u=t.capHeight,m=u===void 0?"0.71em":u,p=t.scaleToFit,f=p===void 0?!1:p,g=t.textAnchor,N=g===void 0?"start":g,v=t.verticalAnchor,w=v===void 0?"end":v,y=t.fill,E=y===void 0?KA:y,O=HA(t,T8),T=j.useMemo(function(){return F8({breakAll:O.breakAll,children:O.children,maxLines:O.maxLines,scaleToFit:f,style:O.style,width:O.width})},[O.breakAll,O.children,O.maxLines,f,O.style,O.width]),A=O.dx,I=O.dy,C=O.angle,P=O.className,F=O.breakAll,R=HA(O,D8);if(!Rn(a)||!Rn(i))return null;var $=a+(jt(A)?A:0),L=i+(jt(I)?I:0),G;switch(w){case"start":G=Xy("calc(".concat(m,")"));break;case"middle":G=Xy("calc(".concat((T.length-1)/2," * -").concat(d," + (").concat(m," / 2))"));break;default:G=Xy("calc(".concat(T.length-1," * -").concat(d,")"));break}var X=[];if(f){var me=T[0].width,se=O.width;X.push("scale(".concat((jt(se)?se/me:1)/me,")"))}return C&&X.push("rotate(".concat(C,", ").concat($,", ").concat(L,")")),X.length&&(R.transform=X.join(" ")),xe.createElement("text",_v({},tr(R,!0),{x:$,y:L,className:xr("recharts-text",P),textAnchor:N,fill:E.includes("url")?KA:E}),T.map(function(ee,W){var U=ee.words.join(F?"":" ");return xe.createElement("tspan",{x:$,dy:W===0?G:d,key:"".concat(U,"-").concat(W)},U)}))};function co(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function B8(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Pw(e){let t,n,a;e.length!==2?(t=co,n=(d,u)=>co(e(d),u),a=(d,u)=>e(d)-u):(t=e===co||e===B8?e:U8,n=e,a=e);function s(d,u,m=0,p=d.length){if(m<p){if(t(u,u)!==0)return p;do{const f=m+p>>>1;n(d[f],u)<0?m=f+1:p=f}while(m<p)}return m}function i(d,u,m=0,p=d.length){if(m<p){if(t(u,u)!==0)return p;do{const f=m+p>>>1;n(d[f],u)<=0?m=f+1:p=f}while(m<p)}return m}function l(d,u,m=0,p=d.length){const f=s(d,u,m,p-1);return f>m&&a(d[f-1],u)>-a(d[f],u)?f-1:f}return{left:s,center:l,right:i}}function U8(){return 0}function vT(e){return e===null?NaN:+e}function*z8(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const q8=Pw(co),Ou=q8.right;Pw(vT).center;class GA extends Map{constructor(t,n=W8){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[a,s]of t)this.set(a,s)}get(t){return super.get(XA(this,t))}has(t){return super.has(XA(this,t))}set(t,n){return super.set(H8(this,t),n)}delete(t){return super.delete(V8(this,t))}}function XA({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):n}function H8({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):(e.set(a,n),n)}function V8({_intern:e,_key:t},n){const a=t(n);return e.has(a)&&(n=e.get(a),e.delete(a)),n}function W8(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Y8(e=co){if(e===co)return wT;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const a=e(t,n);return a||a===0?a:(e(n,n)===0)-(e(t,t)===0)}}function wT(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const K8=Math.sqrt(50),G8=Math.sqrt(10),X8=Math.sqrt(2);function Ih(e,t,n){const a=(t-e)/Math.max(0,n),s=Math.floor(Math.log10(a)),i=a/Math.pow(10,s),l=i>=K8?10:i>=G8?5:i>=X8?2:1;let d,u,m;return s<0?(m=Math.pow(10,-s)/l,d=Math.round(e*m),u=Math.round(t*m),d/m<e&&++d,u/m>t&&--u,m=-m):(m=Math.pow(10,s)*l,d=Math.round(e/m),u=Math.round(t/m),d*m<e&&++d,u*m>t&&--u),u<d&&.5<=n&&n<2?Ih(e,t,n*2):[d,u,m]}function Mv(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const a=t<e,[s,i,l]=a?Ih(t,e,n):Ih(e,t,n);if(!(i>=s))return[];const d=i-s+1,u=new Array(d);if(a)if(l<0)for(let m=0;m<d;++m)u[m]=(i-m)/-l;else for(let m=0;m<d;++m)u[m]=(i-m)*l;else if(l<0)for(let m=0;m<d;++m)u[m]=(s+m)/-l;else for(let m=0;m<d;++m)u[m]=(s+m)*l;return u}function Rv(e,t,n){return t=+t,e=+e,n=+n,Ih(e,t,n)[2]}function $v(e,t,n){t=+t,e=+e,n=+n;const a=t<e,s=a?Rv(t,e,n):Rv(e,t,n);return(a?-1:1)*(s<0?1/-s:s)}function JA(e,t){let n;for(const a of e)a!=null&&(n<a||n===void 0&&a>=a)&&(n=a);return n}function ZA(e,t){let n;for(const a of e)a!=null&&(n>a||n===void 0&&a>=a)&&(n=a);return n}function jT(e,t,n=0,a=1/0,s){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),a=Math.floor(Math.min(e.length-1,a)),!(n<=t&&t<=a))return e;for(s=s===void 0?wT:Y8(s);a>n;){if(a-n>600){const u=a-n+1,m=t-n+1,p=Math.log(u),f=.5*Math.exp(2*p/3),g=.5*Math.sqrt(p*f*(u-f)/u)*(m-u/2<0?-1:1),N=Math.max(n,Math.floor(t-m*f/u+g)),v=Math.min(a,Math.floor(t+(u-m)*f/u+g));jT(e,t,N,v,s)}const i=e[t];let l=n,d=a;for(fd(e,n,t),s(e[a],i)>0&&fd(e,n,a);l<d;){for(fd(e,l,d),++l,--d;s(e[l],i)<0;)++l;for(;s(e[d],i)>0;)--d}s(e[n],i)===0?fd(e,n,d):(++d,fd(e,d,a)),d<=t&&(n=d+1),t<=d&&(a=d-1)}return e}function fd(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function J8(e,t,n){if(e=Float64Array.from(z8(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return ZA(e);if(t>=1)return JA(e);var a,s=(a-1)*t,i=Math.floor(s),l=JA(jT(e,i).subarray(0,i+1)),d=ZA(e.subarray(i+1));return l+(d-l)*(s-i)}}function Z8(e,t,n=vT){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+n(e[0],0,e);if(t>=1)return+n(e[a-1],a-1,e);var a,s=(a-1)*t,i=Math.floor(s),l=+n(e[i],i,e),d=+n(e[i+1],i+1,e);return l+(d-l)*(s-i)}}function Q8(e,t,n){e=+e,t=+t,n=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+n;for(var a=-1,s=Math.max(0,Math.ceil((t-e)/n))|0,i=new Array(s);++a<s;)i[a]=e+a*n;return i}function ws(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function $i(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Lv=Symbol("implicit");function Tw(){var e=new GA,t=[],n=[],a=Lv;function s(i){let l=e.get(i);if(l===void 0){if(a!==Lv)return a;e.set(i,l=t.push(i)-1)}return n[l%n.length]}return s.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new GA;for(const l of i)e.has(l)||e.set(l,t.push(l)-1);return s},s.range=function(i){return arguments.length?(n=Array.from(i),s):n.slice()},s.unknown=function(i){return arguments.length?(a=i,s):a},s.copy=function(){return Tw(t,n).unknown(a)},ws.apply(s,arguments),s}function Kd(){var e=Tw().unknown(void 0),t=e.domain,n=e.range,a=0,s=1,i,l,d=!1,u=0,m=0,p=.5;delete e.unknown;function f(){var g=t().length,N=s<a,v=N?s:a,w=N?a:s;i=(w-v)/Math.max(1,g-u+m*2),d&&(i=Math.floor(i)),v+=(w-v-i*(g-u))*p,l=i*(1-u),d&&(v=Math.round(v),l=Math.round(l));var y=Q8(g).map(function(E){return v+i*E});return n(N?y.reverse():y)}return e.domain=function(g){return arguments.length?(t(g),f()):t()},e.range=function(g){return arguments.length?([a,s]=g,a=+a,s=+s,f()):[a,s]},e.rangeRound=function(g){return[a,s]=g,a=+a,s=+s,d=!0,f()},e.bandwidth=function(){return l},e.step=function(){return i},e.round=function(g){return arguments.length?(d=!!g,f()):d},e.padding=function(g){return arguments.length?(u=Math.min(1,m=+g),f()):u},e.paddingInner=function(g){return arguments.length?(u=Math.min(1,g),f()):u},e.paddingOuter=function(g){return arguments.length?(m=+g,f()):m},e.align=function(g){return arguments.length?(p=Math.max(0,Math.min(1,g)),f()):p},e.copy=function(){return Kd(t(),[a,s]).round(d).paddingInner(u).paddingOuter(m).align(p)},ws.apply(f(),arguments)}function NT(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return NT(t())},e}function Td(){return NT(Kd.apply(null,arguments).paddingInner(1))}function Dw(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ST(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function _u(){}var Gd=.7,Eh=1/Gd,Yl="\\s*([+-]?\\d+)\\s*",Xd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",e7=/^#([0-9a-f]{3,8})$/,t7=new RegExp(`^rgb\\(${Yl},${Yl},${Yl}\\)$`),r7=new RegExp(`^rgb\\(${Xs},${Xs},${Xs}\\)$`),n7=new RegExp(`^rgba\\(${Yl},${Yl},${Yl},${Xd}\\)$`),a7=new RegExp(`^rgba\\(${Xs},${Xs},${Xs},${Xd}\\)$`),s7=new RegExp(`^hsl\\(${Xd},${Xs},${Xs}\\)$`),i7=new RegExp(`^hsla\\(${Xd},${Xs},${Xs},${Xd}\\)$`),QA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Dw(_u,Jd,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:eI,formatHex:eI,formatHex8:o7,formatHsl:l7,formatRgb:tI,toString:tI});function eI(){return this.rgb().formatHex()}function o7(){return this.rgb().formatHex8()}function l7(){return CT(this).formatHsl()}function tI(){return this.rgb().formatRgb()}function Jd(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=e7.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?rI(t):n===3?new Fa(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Vm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Vm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=t7.exec(e))?new Fa(t[1],t[2],t[3],1):(t=r7.exec(e))?new Fa(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=n7.exec(e))?Vm(t[1],t[2],t[3],t[4]):(t=a7.exec(e))?Vm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=s7.exec(e))?sI(t[1],t[2]/100,t[3]/100,1):(t=i7.exec(e))?sI(t[1],t[2]/100,t[3]/100,t[4]):QA.hasOwnProperty(e)?rI(QA[e]):e==="transparent"?new Fa(NaN,NaN,NaN,0):null}function rI(e){return new Fa(e>>16&255,e>>8&255,e&255,1)}function Vm(e,t,n,a){return a<=0&&(e=t=n=NaN),new Fa(e,t,n,a)}function c7(e){return e instanceof _u||(e=Jd(e)),e?(e=e.rgb(),new Fa(e.r,e.g,e.b,e.opacity)):new Fa}function Fv(e,t,n,a){return arguments.length===1?c7(e):new Fa(e,t,n,a??1)}function Fa(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}Dw(Fa,Fv,ST(_u,{brighter(e){return e=e==null?Eh:Math.pow(Eh,e),new Fa(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Gd:Math.pow(Gd,e),new Fa(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Fa(Go(this.r),Go(this.g),Go(this.b),Ph(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nI,formatHex:nI,formatHex8:d7,formatRgb:aI,toString:aI}));function nI(){return`#${qo(this.r)}${qo(this.g)}${qo(this.b)}`}function d7(){return`#${qo(this.r)}${qo(this.g)}${qo(this.b)}${qo((isNaN(this.opacity)?1:this.opacity)*255)}`}function aI(){const e=Ph(this.opacity);return`${e===1?"rgb(":"rgba("}${Go(this.r)}, ${Go(this.g)}, ${Go(this.b)}${e===1?")":`, ${e})`}`}function Ph(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Go(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qo(e){return e=Go(e),(e<16?"0":"")+e.toString(16)}function sI(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ds(e,t,n,a)}function CT(e){if(e instanceof Ds)return new Ds(e.h,e.s,e.l,e.opacity);if(e instanceof _u||(e=Jd(e)),!e)return new Ds;if(e instanceof Ds)return e;e=e.rgb();var t=e.r/255,n=e.g/255,a=e.b/255,s=Math.min(t,n,a),i=Math.max(t,n,a),l=NaN,d=i-s,u=(i+s)/2;return d?(t===i?l=(n-a)/d+(n<a)*6:n===i?l=(a-t)/d+2:l=(t-n)/d+4,d/=u<.5?i+s:2-i-s,l*=60):d=u>0&&u<1?0:l,new Ds(l,d,u,e.opacity)}function u7(e,t,n,a){return arguments.length===1?CT(e):new Ds(e,t,n,a??1)}function Ds(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}Dw(Ds,u7,ST(_u,{brighter(e){return e=e==null?Eh:Math.pow(Eh,e),new Ds(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Gd:Math.pow(Gd,e),new Ds(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,s=2*n-a;return new Fa(Jy(e>=240?e-240:e+120,s,a),Jy(e,s,a),Jy(e<120?e+240:e-120,s,a),this.opacity)},clamp(){return new Ds(iI(this.h),Wm(this.s),Wm(this.l),Ph(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ph(this.opacity);return`${e===1?"hsl(":"hsla("}${iI(this.h)}, ${Wm(this.s)*100}%, ${Wm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function iI(e){return e=(e||0)%360,e<0?e+360:e}function Wm(e){return Math.max(0,Math.min(1,e||0))}function Jy(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Ow=e=>()=>e;function m7(e,t){return function(n){return e+n*t}}function h7(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}function f7(e){return(e=+e)==1?kT:function(t,n){return n-t?h7(t,n,e):Ow(isNaN(t)?n:t)}}function kT(e,t){var n=t-e;return n?m7(e,n):Ow(isNaN(e)?t:e)}const oI=(function e(t){var n=f7(t);function a(s,i){var l=n((s=Fv(s)).r,(i=Fv(i)).r),d=n(s.g,i.g),u=n(s.b,i.b),m=kT(s.opacity,i.opacity);return function(p){return s.r=l(p),s.g=d(p),s.b=u(p),s.opacity=m(p),s+""}}return a.gamma=e,a})(1);function p7(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,a=t.slice(),s;return function(i){for(s=0;s<n;++s)a[s]=e[s]*(1-i)+t[s]*i;return a}}function g7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function x7(e,t){var n=t?t.length:0,a=e?Math.min(n,e.length):0,s=new Array(a),i=new Array(n),l;for(l=0;l<a;++l)s[l]=Pc(e[l],t[l]);for(;l<n;++l)i[l]=t[l];return function(d){for(l=0;l<a;++l)i[l]=s[l](d);return i}}function y7(e,t){var n=new Date;return e=+e,t=+t,function(a){return n.setTime(e*(1-a)+t*a),n}}function Th(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function b7(e,t){var n={},a={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?n[s]=Pc(e[s],t[s]):a[s]=t[s];return function(i){for(s in n)a[s]=n[s](i);return a}}var Bv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Zy=new RegExp(Bv.source,"g");function v7(e){return function(){return e}}function w7(e){return function(t){return e(t)+""}}function j7(e,t){var n=Bv.lastIndex=Zy.lastIndex=0,a,s,i,l=-1,d=[],u=[];for(e=e+"",t=t+"";(a=Bv.exec(e))&&(s=Zy.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),d[l]?d[l]+=i:d[++l]=i),(a=a[0])===(s=s[0])?d[l]?d[l]+=s:d[++l]=s:(d[++l]=null,u.push({i:l,x:Th(a,s)})),n=Zy.lastIndex;return n<t.length&&(i=t.slice(n),d[l]?d[l]+=i:d[++l]=i),d.length<2?u[0]?w7(u[0].x):v7(t):(t=u.length,function(m){for(var p=0,f;p<t;++p)d[(f=u[p]).i]=f.x(m);return d.join("")})}function Pc(e,t){var n=typeof t,a;return t==null||n==="boolean"?Ow(t):(n==="number"?Th:n==="string"?(a=Jd(t))?(t=a,oI):j7:t instanceof Jd?oI:t instanceof Date?y7:g7(t)?p7:Array.isArray(t)?x7:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?b7:Th)(e,t)}function _w(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function N7(e,t){t===void 0&&(t=e,e=Pc);for(var n=0,a=t.length-1,s=t[0],i=new Array(a<0?0:a);n<a;)i[n]=e(s,s=t[++n]);return function(l){var d=Math.max(0,Math.min(a-1,Math.floor(l*=a)));return i[d](l-d)}}function S7(e){return function(){return e}}function Dh(e){return+e}var lI=[0,1];function Ia(e){return e}function Uv(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:S7(isNaN(t)?NaN:.5)}function C7(e,t){var n;return e>t&&(n=e,e=t,t=n),function(a){return Math.max(e,Math.min(t,a))}}function k7(e,t,n){var a=e[0],s=e[1],i=t[0],l=t[1];return s<a?(a=Uv(s,a),i=n(l,i)):(a=Uv(a,s),i=n(i,l)),function(d){return i(a(d))}}function A7(e,t,n){var a=Math.min(e.length,t.length)-1,s=new Array(a),i=new Array(a),l=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<a;)s[l]=Uv(e[l],e[l+1]),i[l]=n(t[l],t[l+1]);return function(d){var u=Ou(e,d,1,a)-1;return i[u](s[u](d))}}function Mu(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function $f(){var e=lI,t=lI,n=Pc,a,s,i,l=Ia,d,u,m;function p(){var g=Math.min(e.length,t.length);return l!==Ia&&(l=C7(e[0],e[g-1])),d=g>2?A7:k7,u=m=null,f}function f(g){return g==null||isNaN(g=+g)?i:(u||(u=d(e.map(a),t,n)))(a(l(g)))}return f.invert=function(g){return l(s((m||(m=d(t,e.map(a),Th)))(g)))},f.domain=function(g){return arguments.length?(e=Array.from(g,Dh),p()):e.slice()},f.range=function(g){return arguments.length?(t=Array.from(g),p()):t.slice()},f.rangeRound=function(g){return t=Array.from(g),n=_w,p()},f.clamp=function(g){return arguments.length?(l=g?!0:Ia,p()):l!==Ia},f.interpolate=function(g){return arguments.length?(n=g,p()):n},f.unknown=function(g){return arguments.length?(i=g,f):i},function(g,N){return a=g,s=N,p()}}function Mw(){return $f()(Ia,Ia)}function I7(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Oh(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function nc(e){return e=Oh(Math.abs(e)),e?e[1]:NaN}function E7(e,t){return function(n,a){for(var s=n.length,i=[],l=0,d=e[0],u=0;s>0&&d>0&&(u+d+1>a&&(d=Math.max(1,a-u)),i.push(n.substring(s-=d,s+d)),!((u+=d+1)>a));)d=e[l=(l+1)%e.length];return i.reverse().join(t)}}function P7(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var T7=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Zd(e){if(!(t=T7.exec(e)))throw new Error("invalid format: "+e);var t;return new Rw({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Zd.prototype=Rw.prototype;function Rw(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Rw.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function D7(e){e:for(var t=e.length,n=1,a=-1,s;n<t;++n)switch(e[n]){case".":a=s=n;break;case"0":a===0&&(a=n),s=n;break;default:if(!+e[n])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(s+1):e}var AT;function O7(e,t){var n=Oh(e,t);if(!n)return e+"";var a=n[0],s=n[1],i=s-(AT=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,l=a.length;return i===l?a:i>l?a+new Array(i-l+1).join("0"):i>0?a.slice(0,i)+"."+a.slice(i):"0."+new Array(1-i).join("0")+Oh(e,Math.max(0,t+i-1))[0]}function cI(e,t){var n=Oh(e,t);if(!n)return e+"";var a=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+a:a.length>s+1?a.slice(0,s+1)+"."+a.slice(s+1):a+new Array(s-a.length+2).join("0")}const dI={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:I7,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>cI(e*100,t),r:cI,s:O7,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function uI(e){return e}var mI=Array.prototype.map,hI=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function _7(e){var t=e.grouping===void 0||e.thousands===void 0?uI:E7(mI.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?uI:P7(mI.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",d=e.minus===void 0?"":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function m(f){f=Zd(f);var g=f.fill,N=f.align,v=f.sign,w=f.symbol,y=f.zero,E=f.width,O=f.comma,T=f.precision,A=f.trim,I=f.type;I==="n"?(O=!0,I="g"):dI[I]||(T===void 0&&(T=12),A=!0,I="g"),(y||g==="0"&&N==="=")&&(y=!0,g="0",N="=");var C=w==="$"?n:w==="#"&&/[boxX]/.test(I)?"0"+I.toLowerCase():"",P=w==="$"?a:/[%p]/.test(I)?l:"",F=dI[I],R=/[defgprs%]/.test(I);T=T===void 0?6:/[gprs]/.test(I)?Math.max(1,Math.min(21,T)):Math.max(0,Math.min(20,T));function $(L){var G=C,X=P,me,se,ee;if(I==="c")X=F(L)+X,L="";else{L=+L;var W=L<0||1/L<0;if(L=isNaN(L)?u:F(Math.abs(L),T),A&&(L=D7(L)),W&&+L==0&&v!=="+"&&(W=!1),G=(W?v==="("?v:d:v==="-"||v==="("?"":v)+G,X=(I==="s"?hI[8+AT/3]:"")+X+(W&&v==="("?")":""),R){for(me=-1,se=L.length;++me<se;)if(ee=L.charCodeAt(me),48>ee||ee>57){X=(ee===46?s+L.slice(me+1):L.slice(me))+X,L=L.slice(0,me);break}}}O&&!y&&(L=t(L,1/0));var U=G.length+L.length+X.length,Q=U<E?new Array(E-U+1).join(g):"";switch(O&&y&&(L=t(Q+L,Q.length?E-X.length:1/0),Q=""),N){case"<":L=G+L+X+Q;break;case"=":L=G+Q+L+X;break;case"^":L=Q.slice(0,U=Q.length>>1)+G+L+X+Q.slice(U);break;default:L=Q+G+L+X;break}return i(L)}return $.toString=function(){return f+""},$}function p(f,g){var N=m((f=Zd(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(nc(g)/3)))*3,w=Math.pow(10,-v),y=hI[8+v/3];return function(E){return N(w*E)+y}}return{format:m,formatPrefix:p}}var Ym,$w,IT;M7({thousands:",",grouping:[3],currency:["$",""]});function M7(e){return Ym=_7(e),$w=Ym.format,IT=Ym.formatPrefix,Ym}function R7(e){return Math.max(0,-nc(Math.abs(e)))}function $7(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(nc(t)/3)))*3-nc(Math.abs(e)))}function L7(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,nc(t)-nc(e))+1}function ET(e,t,n,a){var s=$v(e,t,n),i;switch(a=Zd(a??",f"),a.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(i=$7(s,l))&&(a.precision=i),IT(a,l)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(i=L7(s,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=i-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(i=R7(s))&&(a.precision=i-(a.type==="%")*2);break}}return $w(a)}function go(e){var t=e.domain;return e.ticks=function(n){var a=t();return Mv(a[0],a[a.length-1],n??10)},e.tickFormat=function(n,a){var s=t();return ET(s[0],s[s.length-1],n??10,a)},e.nice=function(n){n==null&&(n=10);var a=t(),s=0,i=a.length-1,l=a[s],d=a[i],u,m,p=10;for(d<l&&(m=l,l=d,d=m,m=s,s=i,i=m);p-- >0;){if(m=Rv(l,d,n),m===u)return a[s]=l,a[i]=d,t(a);if(m>0)l=Math.floor(l/m)*m,d=Math.ceil(d/m)*m;else if(m<0)l=Math.ceil(l*m)/m,d=Math.floor(d*m)/m;else break;u=m}return e},e}function _h(){var e=Mw();return e.copy=function(){return Mu(e,_h())},ws.apply(e,arguments),go(e)}function PT(e){var t;function n(a){return a==null||isNaN(a=+a)?t:a}return n.invert=n,n.domain=n.range=function(a){return arguments.length?(e=Array.from(a,Dh),n):e.slice()},n.unknown=function(a){return arguments.length?(t=a,n):t},n.copy=function(){return PT(e).unknown(t)},e=arguments.length?Array.from(e,Dh):[0,1],go(n)}function TT(e,t){e=e.slice();var n=0,a=e.length-1,s=e[n],i=e[a],l;return i<s&&(l=n,n=a,a=l,l=s,s=i,i=l),e[n]=t.floor(s),e[a]=t.ceil(i),e}function fI(e){return Math.log(e)}function pI(e){return Math.exp(e)}function F7(e){return-Math.log(-e)}function B7(e){return-Math.exp(-e)}function U7(e){return isFinite(e)?+("1e"+e):e<0?0:e}function z7(e){return e===10?U7:e===Math.E?Math.exp:t=>Math.pow(e,t)}function q7(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function gI(e){return(t,n)=>-e(-t,n)}function Lw(e){const t=e(fI,pI),n=t.domain;let a=10,s,i;function l(){return s=q7(a),i=z7(a),n()[0]<0?(s=gI(s),i=gI(i),e(F7,B7)):e(fI,pI),t}return t.base=function(d){return arguments.length?(a=+d,l()):a},t.domain=function(d){return arguments.length?(n(d),l()):n()},t.ticks=d=>{const u=n();let m=u[0],p=u[u.length-1];const f=p<m;f&&([m,p]=[p,m]);let g=s(m),N=s(p),v,w;const y=d==null?10:+d;let E=[];if(!(a%1)&&N-g<y){if(g=Math.floor(g),N=Math.ceil(N),m>0){for(;g<=N;++g)for(v=1;v<a;++v)if(w=g<0?v/i(-g):v*i(g),!(w<m)){if(w>p)break;E.push(w)}}else for(;g<=N;++g)for(v=a-1;v>=1;--v)if(w=g>0?v/i(-g):v*i(g),!(w<m)){if(w>p)break;E.push(w)}E.length*2<y&&(E=Mv(m,p,y))}else E=Mv(g,N,Math.min(N-g,y)).map(i);return f?E.reverse():E},t.tickFormat=(d,u)=>{if(d==null&&(d=10),u==null&&(u=a===10?"s":","),typeof u!="function"&&(!(a%1)&&(u=Zd(u)).precision==null&&(u.trim=!0),u=$w(u)),d===1/0)return u;const m=Math.max(1,a*d/t.ticks().length);return p=>{let f=p/i(Math.round(s(p)));return f*a<a-.5&&(f*=a),f<=m?u(p):""}},t.nice=()=>n(TT(n(),{floor:d=>i(Math.floor(s(d))),ceil:d=>i(Math.ceil(s(d)))})),t}function DT(){const e=Lw($f()).domain([1,10]);return e.copy=()=>Mu(e,DT()).base(e.base()),ws.apply(e,arguments),e}function xI(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function yI(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Fw(e){var t=1,n=e(xI(t),yI(t));return n.constant=function(a){return arguments.length?e(xI(t=+a),yI(t)):t},go(n)}function OT(){var e=Fw($f());return e.copy=function(){return Mu(e,OT()).constant(e.constant())},ws.apply(e,arguments)}function bI(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function H7(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function V7(e){return e<0?-e*e:e*e}function Bw(e){var t=e(Ia,Ia),n=1;function a(){return n===1?e(Ia,Ia):n===.5?e(H7,V7):e(bI(n),bI(1/n))}return t.exponent=function(s){return arguments.length?(n=+s,a()):n},go(t)}function Uw(){var e=Bw($f());return e.copy=function(){return Mu(e,Uw()).exponent(e.exponent())},ws.apply(e,arguments),e}function W7(){return Uw.apply(null,arguments).exponent(.5)}function vI(e){return Math.sign(e)*e*e}function Y7(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function _T(){var e=Mw(),t=[0,1],n=!1,a;function s(i){var l=Y7(e(i));return isNaN(l)?a:n?Math.round(l):l}return s.invert=function(i){return e.invert(vI(i))},s.domain=function(i){return arguments.length?(e.domain(i),s):e.domain()},s.range=function(i){return arguments.length?(e.range((t=Array.from(i,Dh)).map(vI)),s):t.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(n=!!i,s):n},s.clamp=function(i){return arguments.length?(e.clamp(i),s):e.clamp()},s.unknown=function(i){return arguments.length?(a=i,s):a},s.copy=function(){return _T(e.domain(),t).round(n).clamp(e.clamp()).unknown(a)},ws.apply(s,arguments),go(s)}function MT(){var e=[],t=[],n=[],a;function s(){var l=0,d=Math.max(1,t.length);for(n=new Array(d-1);++l<d;)n[l-1]=Z8(e,l/d);return i}function i(l){return l==null||isNaN(l=+l)?a:t[Ou(n,l)]}return i.invertExtent=function(l){var d=t.indexOf(l);return d<0?[NaN,NaN]:[d>0?n[d-1]:e[0],d<n.length?n[d]:e[e.length-1]]},i.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let d of l)d!=null&&!isNaN(d=+d)&&e.push(d);return e.sort(co),s()},i.range=function(l){return arguments.length?(t=Array.from(l),s()):t.slice()},i.unknown=function(l){return arguments.length?(a=l,i):a},i.quantiles=function(){return n.slice()},i.copy=function(){return MT().domain(e).range(t).unknown(a)},ws.apply(i,arguments)}function RT(){var e=0,t=1,n=1,a=[.5],s=[0,1],i;function l(u){return u!=null&&u<=u?s[Ou(a,u,0,n)]:i}function d(){var u=-1;for(a=new Array(n);++u<n;)a[u]=((u+1)*t-(u-n)*e)/(n+1);return l}return l.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,d()):[e,t]},l.range=function(u){return arguments.length?(n=(s=Array.from(u)).length-1,d()):s.slice()},l.invertExtent=function(u){var m=s.indexOf(u);return m<0?[NaN,NaN]:m<1?[e,a[0]]:m>=n?[a[n-1],t]:[a[m-1],a[m]]},l.unknown=function(u){return arguments.length&&(i=u),l},l.thresholds=function(){return a.slice()},l.copy=function(){return RT().domain([e,t]).range(s).unknown(i)},ws.apply(go(l),arguments)}function $T(){var e=[.5],t=[0,1],n,a=1;function s(i){return i!=null&&i<=i?t[Ou(e,i,0,a)]:n}return s.domain=function(i){return arguments.length?(e=Array.from(i),a=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(i){return arguments.length?(t=Array.from(i),a=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(i){var l=t.indexOf(i);return[e[l-1],e[l]]},s.unknown=function(i){return arguments.length?(n=i,s):n},s.copy=function(){return $T().domain(e).range(t).unknown(n)},ws.apply(s,arguments)}const Qy=new Date,eb=new Date;function Ln(e,t,n,a){function s(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=i=>(e(i=new Date(+i)),i),s.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),s.round=i=>{const l=s(i),d=s.ceil(i);return i-l<d-i?l:d},s.offset=(i,l)=>(t(i=new Date(+i),l==null?1:Math.floor(l)),i),s.range=(i,l,d)=>{const u=[];if(i=s.ceil(i),d=d==null?1:Math.floor(d),!(i<l)||!(d>0))return u;let m;do u.push(m=new Date(+i)),t(i,d),e(i);while(m<i&&i<l);return u},s.filter=i=>Ln(l=>{if(l>=l)for(;e(l),!i(l);)l.setTime(l-1)},(l,d)=>{if(l>=l)if(d<0)for(;++d<=0;)for(;t(l,-1),!i(l););else for(;--d>=0;)for(;t(l,1),!i(l););}),n&&(s.count=(i,l)=>(Qy.setTime(+i),eb.setTime(+l),e(Qy),e(eb),Math.floor(n(Qy,eb))),s.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(a?l=>a(l)%i===0:l=>s.count(0,l)%i===0):s)),s}const Mh=Ln(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Mh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ln(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Mh);Mh.range;const ji=1e3,gs=ji*60,Ni=gs*60,Ei=Ni*24,zw=Ei*7,wI=Ei*30,tb=Ei*365,Ho=Ln(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ji)},(e,t)=>(t-e)/ji,e=>e.getUTCSeconds());Ho.range;const qw=Ln(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ji)},(e,t)=>{e.setTime(+e+t*gs)},(e,t)=>(t-e)/gs,e=>e.getMinutes());qw.range;const Hw=Ln(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*gs)},(e,t)=>(t-e)/gs,e=>e.getUTCMinutes());Hw.range;const Vw=Ln(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ji-e.getMinutes()*gs)},(e,t)=>{e.setTime(+e+t*Ni)},(e,t)=>(t-e)/Ni,e=>e.getHours());Vw.range;const Ww=Ln(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ni)},(e,t)=>(t-e)/Ni,e=>e.getUTCHours());Ww.range;const Ru=Ln(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*gs)/Ei,e=>e.getDate()-1);Ru.range;const Lf=Ln(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ei,e=>e.getUTCDate()-1);Lf.range;const LT=Ln(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ei,e=>Math.floor(e/Ei));LT.range;function ll(e){return Ln(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*gs)/zw)}const Ff=ll(0),Rh=ll(1),K7=ll(2),G7=ll(3),ac=ll(4),X7=ll(5),J7=ll(6);Ff.range;Rh.range;K7.range;G7.range;ac.range;X7.range;J7.range;function cl(e){return Ln(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/zw)}const Bf=cl(0),$h=cl(1),Z7=cl(2),Q7=cl(3),sc=cl(4),e9=cl(5),t9=cl(6);Bf.range;$h.range;Z7.range;Q7.range;sc.range;e9.range;t9.range;const Yw=Ln(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Yw.range;const Kw=Ln(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Kw.range;const Pi=Ln(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Pi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ln(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Pi.range;const Ti=Ln(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ti.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ln(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Ti.range;function FT(e,t,n,a,s,i){const l=[[Ho,1,ji],[Ho,5,5*ji],[Ho,15,15*ji],[Ho,30,30*ji],[i,1,gs],[i,5,5*gs],[i,15,15*gs],[i,30,30*gs],[s,1,Ni],[s,3,3*Ni],[s,6,6*Ni],[s,12,12*Ni],[a,1,Ei],[a,2,2*Ei],[n,1,zw],[t,1,wI],[t,3,3*wI],[e,1,tb]];function d(m,p,f){const g=p<m;g&&([m,p]=[p,m]);const N=f&&typeof f.range=="function"?f:u(m,p,f),v=N?N.range(m,+p+1):[];return g?v.reverse():v}function u(m,p,f){const g=Math.abs(p-m)/f,N=Pw(([,,y])=>y).right(l,g);if(N===l.length)return e.every($v(m/tb,p/tb,f));if(N===0)return Mh.every(Math.max($v(m,p,f),1));const[v,w]=l[g/l[N-1][2]<l[N][2]/g?N-1:N];return v.every(w)}return[d,u]}const[r9,n9]=FT(Ti,Kw,Bf,LT,Ww,Hw),[a9,s9]=FT(Pi,Yw,Ff,Ru,Vw,qw);function rb(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function nb(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function pd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function i9(e){var t=e.dateTime,n=e.date,a=e.time,s=e.periods,i=e.days,l=e.shortDays,d=e.months,u=e.shortMonths,m=gd(s),p=xd(s),f=gd(i),g=xd(i),N=gd(l),v=xd(l),w=gd(d),y=xd(d),E=gd(u),O=xd(u),T={a:W,A:U,b:Q,B:Y,c:null,d:AI,e:AI,f:E9,g:F9,G:U9,H:k9,I:A9,j:I9,L:BT,m:P9,M:T9,p:H,q:te,Q:PI,s:TI,S:D9,u:O9,U:_9,V:M9,w:R9,W:$9,x:null,X:null,y:L9,Y:B9,Z:z9,"%":EI},A={a:fe,A:Le,b:he,B:K,c:null,d:II,e:II,f:W9,g:rU,G:aU,H:q9,I:H9,j:V9,L:zT,m:Y9,M:K9,p:be,q:re,Q:PI,s:TI,S:G9,u:X9,U:J9,V:Z9,w:Q9,W:eU,x:null,X:null,y:tU,Y:nU,Z:sU,"%":EI},I={a:$,A:L,b:G,B:X,c:me,d:CI,e:CI,f:j9,g:SI,G:NI,H:kI,I:kI,j:y9,L:w9,m:x9,M:b9,p:R,q:g9,Q:S9,s:C9,S:v9,u:u9,U:m9,V:h9,w:d9,W:f9,x:se,X:ee,y:SI,Y:NI,Z:p9,"%":N9};T.x=C(n,T),T.X=C(a,T),T.c=C(t,T),A.x=C(n,A),A.X=C(a,A),A.c=C(t,A);function C(ie,ne){return function(Te){var ve=[],We=-1,Ie=0,je=ie.length,oe,$e,et;for(Te instanceof Date||(Te=new Date(+Te));++We<je;)ie.charCodeAt(We)===37&&(ve.push(ie.slice(Ie,We)),($e=jI[oe=ie.charAt(++We)])!=null?oe=ie.charAt(++We):$e=oe==="e"?" ":"0",(et=ne[oe])&&(oe=et(Te,$e)),ve.push(oe),Ie=We+1);return ve.push(ie.slice(Ie,We)),ve.join("")}}function P(ie,ne){return function(Te){var ve=pd(1900,void 0,1),We=F(ve,ie,Te+="",0),Ie,je;if(We!=Te.length)return null;if("Q"in ve)return new Date(ve.Q);if("s"in ve)return new Date(ve.s*1e3+("L"in ve?ve.L:0));if(ne&&!("Z"in ve)&&(ve.Z=0),"p"in ve&&(ve.H=ve.H%12+ve.p*12),ve.m===void 0&&(ve.m="q"in ve?ve.q:0),"V"in ve){if(ve.V<1||ve.V>53)return null;"w"in ve||(ve.w=1),"Z"in ve?(Ie=nb(pd(ve.y,0,1)),je=Ie.getUTCDay(),Ie=je>4||je===0?$h.ceil(Ie):$h(Ie),Ie=Lf.offset(Ie,(ve.V-1)*7),ve.y=Ie.getUTCFullYear(),ve.m=Ie.getUTCMonth(),ve.d=Ie.getUTCDate()+(ve.w+6)%7):(Ie=rb(pd(ve.y,0,1)),je=Ie.getDay(),Ie=je>4||je===0?Rh.ceil(Ie):Rh(Ie),Ie=Ru.offset(Ie,(ve.V-1)*7),ve.y=Ie.getFullYear(),ve.m=Ie.getMonth(),ve.d=Ie.getDate()+(ve.w+6)%7)}else("W"in ve||"U"in ve)&&("w"in ve||(ve.w="u"in ve?ve.u%7:"W"in ve?1:0),je="Z"in ve?nb(pd(ve.y,0,1)).getUTCDay():rb(pd(ve.y,0,1)).getDay(),ve.m=0,ve.d="W"in ve?(ve.w+6)%7+ve.W*7-(je+5)%7:ve.w+ve.U*7-(je+6)%7);return"Z"in ve?(ve.H+=ve.Z/100|0,ve.M+=ve.Z%100,nb(ve)):rb(ve)}}function F(ie,ne,Te,ve){for(var We=0,Ie=ne.length,je=Te.length,oe,$e;We<Ie;){if(ve>=je)return-1;if(oe=ne.charCodeAt(We++),oe===37){if(oe=ne.charAt(We++),$e=I[oe in jI?ne.charAt(We++):oe],!$e||(ve=$e(ie,Te,ve))<0)return-1}else if(oe!=Te.charCodeAt(ve++))return-1}return ve}function R(ie,ne,Te){var ve=m.exec(ne.slice(Te));return ve?(ie.p=p.get(ve[0].toLowerCase()),Te+ve[0].length):-1}function $(ie,ne,Te){var ve=N.exec(ne.slice(Te));return ve?(ie.w=v.get(ve[0].toLowerCase()),Te+ve[0].length):-1}function L(ie,ne,Te){var ve=f.exec(ne.slice(Te));return ve?(ie.w=g.get(ve[0].toLowerCase()),Te+ve[0].length):-1}function G(ie,ne,Te){var ve=E.exec(ne.slice(Te));return ve?(ie.m=O.get(ve[0].toLowerCase()),Te+ve[0].length):-1}function X(ie,ne,Te){var ve=w.exec(ne.slice(Te));return ve?(ie.m=y.get(ve[0].toLowerCase()),Te+ve[0].length):-1}function me(ie,ne,Te){return F(ie,t,ne,Te)}function se(ie,ne,Te){return F(ie,n,ne,Te)}function ee(ie,ne,Te){return F(ie,a,ne,Te)}function W(ie){return l[ie.getDay()]}function U(ie){return i[ie.getDay()]}function Q(ie){return u[ie.getMonth()]}function Y(ie){return d[ie.getMonth()]}function H(ie){return s[+(ie.getHours()>=12)]}function te(ie){return 1+~~(ie.getMonth()/3)}function fe(ie){return l[ie.getUTCDay()]}function Le(ie){return i[ie.getUTCDay()]}function he(ie){return u[ie.getUTCMonth()]}function K(ie){return d[ie.getUTCMonth()]}function be(ie){return s[+(ie.getUTCHours()>=12)]}function re(ie){return 1+~~(ie.getUTCMonth()/3)}return{format:function(ie){var ne=C(ie+="",T);return ne.toString=function(){return ie},ne},parse:function(ie){var ne=P(ie+="",!1);return ne.toString=function(){return ie},ne},utcFormat:function(ie){var ne=C(ie+="",A);return ne.toString=function(){return ie},ne},utcParse:function(ie){var ne=P(ie+="",!0);return ne.toString=function(){return ie},ne}}}var jI={"-":"",_:" ",0:"0"},Zn=/^\s*\d+/,o9=/^%/,l9=/[\\^$*+?|[\]().{}]/g;function Tr(e,t,n){var a=e<0?"-":"",s=(a?-e:e)+"",i=s.length;return a+(i<n?new Array(n-i+1).join(t)+s:s)}function c9(e){return e.replace(l9,"\\$&")}function gd(e){return new RegExp("^(?:"+e.map(c9).join("|")+")","i")}function xd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function d9(e,t,n){var a=Zn.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function u9(e,t,n){var a=Zn.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function m9(e,t,n){var a=Zn.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function h9(e,t,n){var a=Zn.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function f9(e,t,n){var a=Zn.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function NI(e,t,n){var a=Zn.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function SI(e,t,n){var a=Zn.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function p9(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function g9(e,t,n){var a=Zn.exec(t.slice(n,n+1));return a?(e.q=a[0]*3-3,n+a[0].length):-1}function x9(e,t,n){var a=Zn.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function CI(e,t,n){var a=Zn.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function y9(e,t,n){var a=Zn.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function kI(e,t,n){var a=Zn.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function b9(e,t,n){var a=Zn.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function v9(e,t,n){var a=Zn.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function w9(e,t,n){var a=Zn.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function j9(e,t,n){var a=Zn.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function N9(e,t,n){var a=o9.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function S9(e,t,n){var a=Zn.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function C9(e,t,n){var a=Zn.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function AI(e,t){return Tr(e.getDate(),t,2)}function k9(e,t){return Tr(e.getHours(),t,2)}function A9(e,t){return Tr(e.getHours()%12||12,t,2)}function I9(e,t){return Tr(1+Ru.count(Pi(e),e),t,3)}function BT(e,t){return Tr(e.getMilliseconds(),t,3)}function E9(e,t){return BT(e,t)+"000"}function P9(e,t){return Tr(e.getMonth()+1,t,2)}function T9(e,t){return Tr(e.getMinutes(),t,2)}function D9(e,t){return Tr(e.getSeconds(),t,2)}function O9(e){var t=e.getDay();return t===0?7:t}function _9(e,t){return Tr(Ff.count(Pi(e)-1,e),t,2)}function UT(e){var t=e.getDay();return t>=4||t===0?ac(e):ac.ceil(e)}function M9(e,t){return e=UT(e),Tr(ac.count(Pi(e),e)+(Pi(e).getDay()===4),t,2)}function R9(e){return e.getDay()}function $9(e,t){return Tr(Rh.count(Pi(e)-1,e),t,2)}function L9(e,t){return Tr(e.getFullYear()%100,t,2)}function F9(e,t){return e=UT(e),Tr(e.getFullYear()%100,t,2)}function B9(e,t){return Tr(e.getFullYear()%1e4,t,4)}function U9(e,t){var n=e.getDay();return e=n>=4||n===0?ac(e):ac.ceil(e),Tr(e.getFullYear()%1e4,t,4)}function z9(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Tr(t/60|0,"0",2)+Tr(t%60,"0",2)}function II(e,t){return Tr(e.getUTCDate(),t,2)}function q9(e,t){return Tr(e.getUTCHours(),t,2)}function H9(e,t){return Tr(e.getUTCHours()%12||12,t,2)}function V9(e,t){return Tr(1+Lf.count(Ti(e),e),t,3)}function zT(e,t){return Tr(e.getUTCMilliseconds(),t,3)}function W9(e,t){return zT(e,t)+"000"}function Y9(e,t){return Tr(e.getUTCMonth()+1,t,2)}function K9(e,t){return Tr(e.getUTCMinutes(),t,2)}function G9(e,t){return Tr(e.getUTCSeconds(),t,2)}function X9(e){var t=e.getUTCDay();return t===0?7:t}function J9(e,t){return Tr(Bf.count(Ti(e)-1,e),t,2)}function qT(e){var t=e.getUTCDay();return t>=4||t===0?sc(e):sc.ceil(e)}function Z9(e,t){return e=qT(e),Tr(sc.count(Ti(e),e)+(Ti(e).getUTCDay()===4),t,2)}function Q9(e){return e.getUTCDay()}function eU(e,t){return Tr($h.count(Ti(e)-1,e),t,2)}function tU(e,t){return Tr(e.getUTCFullYear()%100,t,2)}function rU(e,t){return e=qT(e),Tr(e.getUTCFullYear()%100,t,2)}function nU(e,t){return Tr(e.getUTCFullYear()%1e4,t,4)}function aU(e,t){var n=e.getUTCDay();return e=n>=4||n===0?sc(e):sc.ceil(e),Tr(e.getUTCFullYear()%1e4,t,4)}function sU(){return"+0000"}function EI(){return"%"}function PI(e){return+e}function TI(e){return Math.floor(+e/1e3)}var Rl,HT,VT;iU({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function iU(e){return Rl=i9(e),HT=Rl.format,Rl.parse,VT=Rl.utcFormat,Rl.utcParse,Rl}function oU(e){return new Date(e)}function lU(e){return e instanceof Date?+e:+new Date(+e)}function Gw(e,t,n,a,s,i,l,d,u,m){var p=Mw(),f=p.invert,g=p.domain,N=m(".%L"),v=m(":%S"),w=m("%I:%M"),y=m("%I %p"),E=m("%a %d"),O=m("%b %d"),T=m("%B"),A=m("%Y");function I(C){return(u(C)<C?N:d(C)<C?v:l(C)<C?w:i(C)<C?y:a(C)<C?s(C)<C?E:O:n(C)<C?T:A)(C)}return p.invert=function(C){return new Date(f(C))},p.domain=function(C){return arguments.length?g(Array.from(C,lU)):g().map(oU)},p.ticks=function(C){var P=g();return e(P[0],P[P.length-1],C??10)},p.tickFormat=function(C,P){return P==null?I:m(P)},p.nice=function(C){var P=g();return(!C||typeof C.range!="function")&&(C=t(P[0],P[P.length-1],C??10)),C?g(TT(P,C)):p},p.copy=function(){return Mu(p,Gw(e,t,n,a,s,i,l,d,u,m))},p}function cU(){return ws.apply(Gw(a9,s9,Pi,Yw,Ff,Ru,Vw,qw,Ho,HT).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function dU(){return ws.apply(Gw(r9,n9,Ti,Kw,Bf,Lf,Ww,Hw,Ho,VT).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Uf(){var e=0,t=1,n,a,s,i,l=Ia,d=!1,u;function m(f){return f==null||isNaN(f=+f)?u:l(s===0?.5:(f=(i(f)-n)*s,d?Math.max(0,Math.min(1,f)):f))}m.domain=function(f){return arguments.length?([e,t]=f,n=i(e=+e),a=i(t=+t),s=n===a?0:1/(a-n),m):[e,t]},m.clamp=function(f){return arguments.length?(d=!!f,m):d},m.interpolator=function(f){return arguments.length?(l=f,m):l};function p(f){return function(g){var N,v;return arguments.length?([N,v]=g,l=f(N,v),m):[l(0),l(1)]}}return m.range=p(Pc),m.rangeRound=p(_w),m.unknown=function(f){return arguments.length?(u=f,m):u},function(f){return i=f,n=f(e),a=f(t),s=n===a?0:1/(a-n),m}}function xo(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function WT(){var e=go(Uf()(Ia));return e.copy=function(){return xo(e,WT())},$i.apply(e,arguments)}function YT(){var e=Lw(Uf()).domain([1,10]);return e.copy=function(){return xo(e,YT()).base(e.base())},$i.apply(e,arguments)}function KT(){var e=Fw(Uf());return e.copy=function(){return xo(e,KT()).constant(e.constant())},$i.apply(e,arguments)}function Xw(){var e=Bw(Uf());return e.copy=function(){return xo(e,Xw()).exponent(e.exponent())},$i.apply(e,arguments)}function uU(){return Xw.apply(null,arguments).exponent(.5)}function GT(){var e=[],t=Ia;function n(a){if(a!=null&&!isNaN(a=+a))return t((Ou(e,a,1)-1)/(e.length-1))}return n.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(co),n},n.interpolator=function(a){return arguments.length?(t=a,n):t},n.range=function(){return e.map((a,s)=>t(s/(e.length-1)))},n.quantiles=function(a){return Array.from({length:a+1},(s,i)=>J8(e,i/a))},n.copy=function(){return GT(t).domain(e)},$i.apply(n,arguments)}function zf(){var e=0,t=.5,n=1,a=1,s,i,l,d,u,m=Ia,p,f=!1,g;function N(w){return isNaN(w=+w)?g:(w=.5+((w=+p(w))-i)*(a*w<a*i?d:u),m(f?Math.max(0,Math.min(1,w)):w))}N.domain=function(w){return arguments.length?([e,t,n]=w,s=p(e=+e),i=p(t=+t),l=p(n=+n),d=s===i?0:.5/(i-s),u=i===l?0:.5/(l-i),a=i<s?-1:1,N):[e,t,n]},N.clamp=function(w){return arguments.length?(f=!!w,N):f},N.interpolator=function(w){return arguments.length?(m=w,N):m};function v(w){return function(y){var E,O,T;return arguments.length?([E,O,T]=y,m=N7(w,[E,O,T]),N):[m(0),m(.5),m(1)]}}return N.range=v(Pc),N.rangeRound=v(_w),N.unknown=function(w){return arguments.length?(g=w,N):g},function(w){return p=w,s=w(e),i=w(t),l=w(n),d=s===i?0:.5/(i-s),u=i===l?0:.5/(l-i),a=i<s?-1:1,N}}function XT(){var e=go(zf()(Ia));return e.copy=function(){return xo(e,XT())},$i.apply(e,arguments)}function JT(){var e=Lw(zf()).domain([.1,1,10]);return e.copy=function(){return xo(e,JT()).base(e.base())},$i.apply(e,arguments)}function ZT(){var e=Fw(zf());return e.copy=function(){return xo(e,ZT()).constant(e.constant())},$i.apply(e,arguments)}function Jw(){var e=Bw(zf());return e.copy=function(){return xo(e,Jw()).exponent(e.exponent())},$i.apply(e,arguments)}function mU(){return Jw.apply(null,arguments).exponent(.5)}const DI=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Kd,scaleDiverging:XT,scaleDivergingLog:JT,scaleDivergingPow:Jw,scaleDivergingSqrt:mU,scaleDivergingSymlog:ZT,scaleIdentity:PT,scaleImplicit:Lv,scaleLinear:_h,scaleLog:DT,scaleOrdinal:Tw,scalePoint:Td,scalePow:Uw,scaleQuantile:MT,scaleQuantize:RT,scaleRadial:_T,scaleSequential:WT,scaleSequentialLog:YT,scaleSequentialPow:Xw,scaleSequentialQuantile:GT,scaleSequentialSqrt:uU,scaleSequentialSymlog:KT,scaleSqrt:W7,scaleSymlog:OT,scaleThreshold:$T,scaleTime:cU,scaleUtc:dU,tickFormat:ET},Symbol.toStringTag,{value:"Module"}));var ab,OI;function qf(){if(OI)return ab;OI=1;var e=kc();function t(n,a,s){for(var i=-1,l=n.length;++i<l;){var d=n[i],u=a(d);if(u!=null&&(m===void 0?u===u&&!e(u):s(u,m)))var m=u,p=d}return p}return ab=t,ab}var sb,_I;function QT(){if(_I)return sb;_I=1;function e(t,n){return t>n}return sb=e,sb}var ib,MI;function hU(){if(MI)return ib;MI=1;var e=qf(),t=QT(),n=Ic();function a(s){return s&&s.length?e(s,n,t):void 0}return ib=a,ib}var fU=hU();const Hf=Fr(fU);var ob,RI;function eD(){if(RI)return ob;RI=1;function e(t,n){return t<n}return ob=e,ob}var lb,$I;function pU(){if($I)return lb;$I=1;var e=qf(),t=eD(),n=Ic();function a(s){return s&&s.length?e(s,n,t):void 0}return lb=a,lb}var gU=pU();const Vf=Fr(gU);var cb,LI;function xU(){if(LI)return cb;LI=1;var e=hw(),t=si(),n=lT(),a=qa();function s(i,l){var d=a(i)?e:n;return d(i,t(l,3))}return cb=s,cb}var db,FI;function yU(){if(FI)return db;FI=1;var e=iT(),t=xU();function n(a,s){return e(t(a,s),1)}return db=n,db}var bU=yU();const vU=Fr(bU);var ub,BI;function wU(){if(BI)return ub;BI=1;var e=kw();function t(n,a){return e(n,a)}return ub=t,ub}var jU=wU();const Wf=Fr(jU);var Tc=1e9,NU={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Qw,nn=!0,vs="[DecimalError] ",Xo=vs+"Invalid argument: ",Zw=vs+"Exponent out of range: ",Dc=Math.floor,Fo=Math.pow,SU=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,es,Xn=1e7,en=7,tD=9007199254740991,Lh=Dc(tD/en),Et={};Et.absoluteValue=Et.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Et.comparedTo=Et.cmp=function(e){var t,n,a,s,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(a=i.d.length,s=e.d.length,t=0,n=a<s?a:s;t<n;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return a===s?0:a>s^i.s<0?1:-1};Et.decimalPlaces=Et.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*en;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};Et.dividedBy=Et.div=function(e){return Ai(this,new this.constructor(e))};Et.dividedToIntegerBy=Et.idiv=function(e){var t=this,n=t.constructor;return Yr(Ai(t,new n(e),0,1),n.precision)};Et.equals=Et.eq=function(e){return!this.cmp(e)};Et.exponent=function(){return En(this)};Et.greaterThan=Et.gt=function(e){return this.cmp(e)>0};Et.greaterThanOrEqualTo=Et.gte=function(e){return this.cmp(e)>=0};Et.isInteger=Et.isint=function(){return this.e>this.d.length-2};Et.isNegative=Et.isneg=function(){return this.s<0};Et.isPositive=Et.ispos=function(){return this.s>0};Et.isZero=function(){return this.s===0};Et.lessThan=Et.lt=function(e){return this.cmp(e)<0};Et.lessThanOrEqualTo=Et.lte=function(e){return this.cmp(e)<1};Et.logarithm=Et.log=function(e){var t,n=this,a=n.constructor,s=a.precision,i=s+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(es))throw Error(vs+"NaN");if(n.s<1)throw Error(vs+(n.s?"NaN":"-Infinity"));return n.eq(es)?new a(0):(nn=!1,t=Ai(Qd(n,i),Qd(e,i),i),nn=!0,Yr(t,s))};Et.minus=Et.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aD(t,e):rD(t,(e.s=-e.s,e))};Et.modulo=Et.mod=function(e){var t,n=this,a=n.constructor,s=a.precision;if(e=new a(e),!e.s)throw Error(vs+"NaN");return n.s?(nn=!1,t=Ai(n,e,0,1).times(e),nn=!0,n.minus(t)):Yr(new a(n),s)};Et.naturalExponential=Et.exp=function(){return nD(this)};Et.naturalLogarithm=Et.ln=function(){return Qd(this)};Et.negated=Et.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Et.plus=Et.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?rD(t,e):aD(t,(e.s=-e.s,e))};Et.precision=Et.sd=function(e){var t,n,a,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Xo+e);if(t=En(s)+1,a=s.d.length-1,n=a*en+1,a=s.d[a],a){for(;a%10==0;a/=10)n--;for(a=s.d[0];a>=10;a/=10)n++}return e&&t>n?t:n};Et.squareRoot=Et.sqrt=function(){var e,t,n,a,s,i,l,d=this,u=d.constructor;if(d.s<1){if(!d.s)return new u(0);throw Error(vs+"NaN")}for(e=En(d),nn=!1,s=Math.sqrt(+d),s==0||s==1/0?(t=Ys(d.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=Dc((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new u(t)):a=new u(s.toString()),n=u.precision,s=l=n+3;;)if(i=a,a=i.plus(Ai(d,i,l+2)).times(.5),Ys(i.d).slice(0,l)===(t=Ys(a.d)).slice(0,l)){if(t=t.slice(l-3,l+1),s==l&&t=="4999"){if(Yr(i,n+1,0),i.times(i).eq(d)){a=i;break}}else if(t!="9999")break;l+=4}return nn=!0,Yr(a,n)};Et.times=Et.mul=function(e){var t,n,a,s,i,l,d,u,m,p=this,f=p.constructor,g=p.d,N=(e=new f(e)).d;if(!p.s||!e.s)return new f(0);for(e.s*=p.s,n=p.e+e.e,u=g.length,m=N.length,u<m&&(i=g,g=N,N=i,l=u,u=m,m=l),i=[],l=u+m,a=l;a--;)i.push(0);for(a=m;--a>=0;){for(t=0,s=u+a;s>a;)d=i[s]+N[a]*g[s-a-1]+t,i[s--]=d%Xn|0,t=d/Xn|0;i[s]=(i[s]+t)%Xn|0}for(;!i[--l];)i.pop();return t?++n:i.shift(),e.d=i,e.e=n,nn?Yr(e,f.precision):e};Et.toDecimalPlaces=Et.todp=function(e,t){var n=this,a=n.constructor;return n=new a(n),e===void 0?n:(ei(e,0,Tc),t===void 0?t=a.rounding:ei(t,0,8),Yr(n,e+En(n)+1,t))};Et.toExponential=function(e,t){var n,a=this,s=a.constructor;return e===void 0?n=nl(a,!0):(ei(e,0,Tc),t===void 0?t=s.rounding:ei(t,0,8),a=Yr(new s(a),e+1,t),n=nl(a,!0,e+1)),n};Et.toFixed=function(e,t){var n,a,s=this,i=s.constructor;return e===void 0?nl(s):(ei(e,0,Tc),t===void 0?t=i.rounding:ei(t,0,8),a=Yr(new i(s),e+En(s)+1,t),n=nl(a.abs(),!1,e+En(a)+1),s.isneg()&&!s.isZero()?"-"+n:n)};Et.toInteger=Et.toint=function(){var e=this,t=e.constructor;return Yr(new t(e),En(e)+1,t.rounding)};Et.toNumber=function(){return+this};Et.toPower=Et.pow=function(e){var t,n,a,s,i,l,d=this,u=d.constructor,m=12,p=+(e=new u(e));if(!e.s)return new u(es);if(d=new u(d),!d.s){if(e.s<1)throw Error(vs+"Infinity");return d}if(d.eq(es))return d;if(a=u.precision,e.eq(es))return Yr(d,a);if(t=e.e,n=e.d.length-1,l=t>=n,i=d.s,l){if((n=p<0?-p:p)<=tD){for(s=new u(es),t=Math.ceil(a/en+4),nn=!1;n%2&&(s=s.times(d),zI(s.d,t)),n=Dc(n/2),n!==0;)d=d.times(d),zI(d.d,t);return nn=!0,e.s<0?new u(es).div(s):Yr(s,a)}}else if(i<0)throw Error(vs+"NaN");return i=i<0&&e.d[Math.max(t,n)]&1?-1:1,d.s=1,nn=!1,s=e.times(Qd(d,a+m)),nn=!0,s=nD(s),s.s=i,s};Et.toPrecision=function(e,t){var n,a,s=this,i=s.constructor;return e===void 0?(n=En(s),a=nl(s,n<=i.toExpNeg||n>=i.toExpPos)):(ei(e,1,Tc),t===void 0?t=i.rounding:ei(t,0,8),s=Yr(new i(s),e,t),n=En(s),a=nl(s,e<=n||n<=i.toExpNeg,e)),a};Et.toSignificantDigits=Et.tosd=function(e,t){var n=this,a=n.constructor;return e===void 0?(e=a.precision,t=a.rounding):(ei(e,1,Tc),t===void 0?t=a.rounding:ei(t,0,8)),Yr(new a(n),e,t)};Et.toString=Et.valueOf=Et.val=Et.toJSON=Et[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=En(e),n=e.constructor;return nl(e,t<=n.toExpNeg||t>=n.toExpPos)};function rD(e,t){var n,a,s,i,l,d,u,m,p=e.constructor,f=p.precision;if(!e.s||!t.s)return t.s||(t=new p(e)),nn?Yr(t,f):t;if(u=e.d,m=t.d,l=e.e,s=t.e,u=u.slice(),i=l-s,i){for(i<0?(a=u,i=-i,d=m.length):(a=m,s=l,d=u.length),l=Math.ceil(f/en),d=l>d?l+1:d+1,i>d&&(i=d,a.length=1),a.reverse();i--;)a.push(0);a.reverse()}for(d=u.length,i=m.length,d-i<0&&(i=d,a=m,m=u,u=a),n=0;i;)n=(u[--i]=u[i]+m[i]+n)/Xn|0,u[i]%=Xn;for(n&&(u.unshift(n),++s),d=u.length;u[--d]==0;)u.pop();return t.d=u,t.e=s,nn?Yr(t,f):t}function ei(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Xo+e)}function Ys(e){var t,n,a,s=e.length-1,i="",l=e[0];if(s>0){for(i+=l,t=1;t<s;t++)a=e[t]+"",n=en-a.length,n&&(i+=no(n)),i+=a;l=e[t],a=l+"",n=en-a.length,n&&(i+=no(n))}else if(l===0)return"0";for(;l%10===0;)l/=10;return i+l}var Ai=(function(){function e(a,s){var i,l=0,d=a.length;for(a=a.slice();d--;)i=a[d]*s+l,a[d]=i%Xn|0,l=i/Xn|0;return l&&a.unshift(l),a}function t(a,s,i,l){var d,u;if(i!=l)u=i>l?1:-1;else for(d=u=0;d<i;d++)if(a[d]!=s[d]){u=a[d]>s[d]?1:-1;break}return u}function n(a,s,i){for(var l=0;i--;)a[i]-=l,l=a[i]<s[i]?1:0,a[i]=l*Xn+a[i]-s[i];for(;!a[0]&&a.length>1;)a.shift()}return function(a,s,i,l){var d,u,m,p,f,g,N,v,w,y,E,O,T,A,I,C,P,F,R=a.constructor,$=a.s==s.s?1:-1,L=a.d,G=s.d;if(!a.s)return new R(a);if(!s.s)throw Error(vs+"Division by zero");for(u=a.e-s.e,P=G.length,I=L.length,N=new R($),v=N.d=[],m=0;G[m]==(L[m]||0);)++m;if(G[m]>(L[m]||0)&&--u,i==null?O=i=R.precision:l?O=i+(En(a)-En(s))+1:O=i,O<0)return new R(0);if(O=O/en+2|0,m=0,P==1)for(p=0,G=G[0],O++;(m<I||p)&&O--;m++)T=p*Xn+(L[m]||0),v[m]=T/G|0,p=T%G|0;else{for(p=Xn/(G[0]+1)|0,p>1&&(G=e(G,p),L=e(L,p),P=G.length,I=L.length),A=P,w=L.slice(0,P),y=w.length;y<P;)w[y++]=0;F=G.slice(),F.unshift(0),C=G[0],G[1]>=Xn/2&&++C;do p=0,d=t(G,w,P,y),d<0?(E=w[0],P!=y&&(E=E*Xn+(w[1]||0)),p=E/C|0,p>1?(p>=Xn&&(p=Xn-1),f=e(G,p),g=f.length,y=w.length,d=t(f,w,g,y),d==1&&(p--,n(f,P<g?F:G,g))):(p==0&&(d=p=1),f=G.slice()),g=f.length,g<y&&f.unshift(0),n(w,f,y),d==-1&&(y=w.length,d=t(G,w,P,y),d<1&&(p++,n(w,P<y?F:G,y))),y=w.length):d===0&&(p++,w=[0]),v[m++]=p,d&&w[0]?w[y++]=L[A]||0:(w=[L[A]],y=1);while((A++<I||w[0]!==void 0)&&O--)}return v[0]||v.shift(),N.e=u,Yr(N,l?i+En(N)+1:i)}})();function nD(e,t){var n,a,s,i,l,d,u=0,m=0,p=e.constructor,f=p.precision;if(En(e)>16)throw Error(Zw+En(e));if(!e.s)return new p(es);for(nn=!1,d=f,l=new p(.03125);e.abs().gte(.1);)e=e.times(l),m+=5;for(a=Math.log(Fo(2,m))/Math.LN10*2+5|0,d+=a,n=s=i=new p(es),p.precision=d;;){if(s=Yr(s.times(e),d),n=n.times(++u),l=i.plus(Ai(s,n,d)),Ys(l.d).slice(0,d)===Ys(i.d).slice(0,d)){for(;m--;)i=Yr(i.times(i),d);return p.precision=f,t==null?(nn=!0,Yr(i,f)):i}i=l}}function En(e){for(var t=e.e*en,n=e.d[0];n>=10;n/=10)t++;return t}function mb(e,t,n){if(t>e.LN10.sd())throw nn=!0,n&&(e.precision=n),Error(vs+"LN10 precision limit exceeded");return Yr(new e(e.LN10),t)}function no(e){for(var t="";e--;)t+="0";return t}function Qd(e,t){var n,a,s,i,l,d,u,m,p,f=1,g=10,N=e,v=N.d,w=N.constructor,y=w.precision;if(N.s<1)throw Error(vs+(N.s?"NaN":"-Infinity"));if(N.eq(es))return new w(0);if(t==null?(nn=!1,m=y):m=t,N.eq(10))return t==null&&(nn=!0),mb(w,m);if(m+=g,w.precision=m,n=Ys(v),a=n.charAt(0),i=En(N),Math.abs(i)<15e14){for(;a<7&&a!=1||a==1&&n.charAt(1)>3;)N=N.times(e),n=Ys(N.d),a=n.charAt(0),f++;i=En(N),a>1?(N=new w("0."+n),i++):N=new w(a+"."+n.slice(1))}else return u=mb(w,m+2,y).times(i+""),N=Qd(new w(a+"."+n.slice(1)),m-g).plus(u),w.precision=y,t==null?(nn=!0,Yr(N,y)):N;for(d=l=N=Ai(N.minus(es),N.plus(es),m),p=Yr(N.times(N),m),s=3;;){if(l=Yr(l.times(p),m),u=d.plus(Ai(l,new w(s),m)),Ys(u.d).slice(0,m)===Ys(d.d).slice(0,m))return d=d.times(2),i!==0&&(d=d.plus(mb(w,m+2,y).times(i+""))),d=Ai(d,new w(f),m),w.precision=y,t==null?(nn=!0,Yr(d,y)):d;d=u,s+=2}}function UI(e,t){var n,a,s;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(n<0&&(n=a),n+=+t.slice(a+1),t=t.substring(0,a)):n<0&&(n=t.length),a=0;t.charCodeAt(a)===48;)++a;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(a,s),t){if(s-=a,n=n-a-1,e.e=Dc(n/en),e.d=[],a=(n+1)%en,n<0&&(a+=en),a<s){for(a&&e.d.push(+t.slice(0,a)),s-=en;a<s;)e.d.push(+t.slice(a,a+=en));t=t.slice(a),a=en-t.length}else a-=s;for(;a--;)t+="0";if(e.d.push(+t),nn&&(e.e>Lh||e.e<-Lh))throw Error(Zw+n)}else e.s=0,e.e=0,e.d=[0];return e}function Yr(e,t,n){var a,s,i,l,d,u,m,p,f=e.d;for(l=1,i=f[0];i>=10;i/=10)l++;if(a=t-l,a<0)a+=en,s=t,m=f[p=0];else{if(p=Math.ceil((a+1)/en),i=f.length,p>=i)return e;for(m=i=f[p],l=1;i>=10;i/=10)l++;a%=en,s=a-en+l}if(n!==void 0&&(i=Fo(10,l-s-1),d=m/i%10|0,u=t<0||f[p+1]!==void 0||m%i,u=n<4?(d||u)&&(n==0||n==(e.s<0?3:2)):d>5||d==5&&(n==4||u||n==6&&(a>0?s>0?m/Fo(10,l-s):0:f[p-1])%10&1||n==(e.s<0?8:7))),t<1||!f[0])return u?(i=En(e),f.length=1,t=t-i-1,f[0]=Fo(10,(en-t%en)%en),e.e=Dc(-t/en)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(a==0?(f.length=p,i=1,p--):(f.length=p+1,i=Fo(10,en-a),f[p]=s>0?(m/Fo(10,l-s)%Fo(10,s)|0)*i:0),u)for(;;)if(p==0){(f[0]+=i)==Xn&&(f[0]=1,++e.e);break}else{if(f[p]+=i,f[p]!=Xn)break;f[p--]=0,i=1}for(a=f.length;f[--a]===0;)f.pop();if(nn&&(e.e>Lh||e.e<-Lh))throw Error(Zw+En(e));return e}function aD(e,t){var n,a,s,i,l,d,u,m,p,f,g=e.constructor,N=g.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new g(e),nn?Yr(t,N):t;if(u=e.d,f=t.d,a=t.e,m=e.e,u=u.slice(),l=m-a,l){for(p=l<0,p?(n=u,l=-l,d=f.length):(n=f,a=m,d=u.length),s=Math.max(Math.ceil(N/en),d)+2,l>s&&(l=s,n.length=1),n.reverse(),s=l;s--;)n.push(0);n.reverse()}else{for(s=u.length,d=f.length,p=s<d,p&&(d=s),s=0;s<d;s++)if(u[s]!=f[s]){p=u[s]<f[s];break}l=0}for(p&&(n=u,u=f,f=n,t.s=-t.s),d=u.length,s=f.length-d;s>0;--s)u[d++]=0;for(s=f.length;s>l;){if(u[--s]<f[s]){for(i=s;i&&u[--i]===0;)u[i]=Xn-1;--u[i],u[s]+=Xn}u[s]-=f[s]}for(;u[--d]===0;)u.pop();for(;u[0]===0;u.shift())--a;return u[0]?(t.d=u,t.e=a,nn?Yr(t,N):t):new g(0)}function nl(e,t,n){var a,s=En(e),i=Ys(e.d),l=i.length;return t?(n&&(a=n-l)>0?i=i.charAt(0)+"."+i.slice(1)+no(a):l>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(s<0?"e":"e+")+s):s<0?(i="0."+no(-s-1)+i,n&&(a=n-l)>0&&(i+=no(a))):s>=l?(i+=no(s+1-l),n&&(a=n-s-1)>0&&(i=i+"."+no(a))):((a=s+1)<l&&(i=i.slice(0,a)+"."+i.slice(a)),n&&(a=n-l)>0&&(s+1===l&&(i+="."),i+=no(a))),e.s<0?"-"+i:i}function zI(e,t){if(e.length>t)return e.length=t,!0}function sD(e){var t,n,a;function s(i){var l=this;if(!(l instanceof s))return new s(i);if(l.constructor=s,i instanceof s){l.s=i.s,l.e=i.e,l.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Xo+i);if(i>0)l.s=1;else if(i<0)i=-i,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(i===~~i&&i<1e7){l.e=0,l.d=[i];return}return UI(l,i.toString())}else if(typeof i!="string")throw Error(Xo+i);if(i.charCodeAt(0)===45?(i=i.slice(1),l.s=-1):l.s=1,SU.test(i))UI(l,i);else throw Error(Xo+i)}if(s.prototype=Et,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=sD,s.config=s.set=CU,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(n=a[t++])||(e[n]=this[n]);return s.config(e),s}function CU(e){if(!e||typeof e!="object")throw Error(vs+"Object expected");var t,n,a,s=["precision",1,Tc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((a=e[n=s[t]])!==void 0)if(Dc(a)===a&&a>=s[t+1]&&a<=s[t+2])this[n]=a;else throw Error(Xo+n+": "+a);if((a=e[n="LN10"])!==void 0)if(a==Math.LN10)this[n]=new this(a);else throw Error(Xo+n+": "+a);return this}var Qw=sD(NU);es=new Qw(1);const Vr=Qw;function kU(e){return PU(e)||EU(e)||IU(e)||AU()}function AU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IU(e,t){if(e){if(typeof e=="string")return zv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zv(e,t)}}function EU(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function PU(e){if(Array.isArray(e))return zv(e)}function zv(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var TU=function(t){return t},iD={},oD=function(t){return t===iD},qI=function(t){return function n(){return arguments.length===0||arguments.length===1&&oD(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},DU=function e(t,n){return t===1?n:qI(function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];var l=s.filter(function(d){return d!==iD}).length;return l>=t?n.apply(void 0,s):e(t-l,qI(function(){for(var d=arguments.length,u=new Array(d),m=0;m<d;m++)u[m]=arguments[m];var p=s.map(function(f){return oD(f)?u.shift():f});return n.apply(void 0,kU(p).concat(u))}))})},Yf=function(t){return DU(t.length,t)},qv=function(t,n){for(var a=[],s=t;s<n;++s)a[s-t]=s;return a},OU=Yf(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),_U=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];if(!n.length)return TU;var s=n.reverse(),i=s[0],l=s.slice(1);return function(){return l.reduce(function(d,u){return u(d)},i.apply(void 0,arguments))}},Hv=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},lD=function(t){var n=null,a=null;return function(){for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return n&&i.every(function(d,u){return d===n[u]})||(n=i,a=t.apply(void 0,i)),a}};function MU(e){var t;return e===0?t=1:t=Math.floor(new Vr(e).abs().log(10).toNumber())+1,t}function RU(e,t,n){for(var a=new Vr(e),s=0,i=[];a.lt(t)&&s<1e5;)i.push(a.toNumber()),a=a.add(n),s++;return i}var $U=Yf(function(e,t,n){var a=+e,s=+t;return a+n*(s-a)}),LU=Yf(function(e,t,n){var a=t-+e;return a=a||1/0,(n-e)/a}),FU=Yf(function(e,t,n){var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(n-e)/a))});const Kf={rangeStep:RU,getDigitCount:MU,interpolateNumber:$U,uninterpolateNumber:LU,uninterpolateTruncation:FU};function Vv(e){return zU(e)||UU(e)||cD(e)||BU()}function BU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UU(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function zU(e){if(Array.isArray(e))return Wv(e)}function eu(e,t){return VU(e)||HU(e,t)||cD(e,t)||qU()}function qU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cD(e,t){if(e){if(typeof e=="string")return Wv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wv(e,t)}}function Wv(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function HU(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],a=!0,s=!1,i=void 0;try{for(var l=e[Symbol.iterator](),d;!(a=(d=l.next()).done)&&(n.push(d.value),!(t&&n.length===t));a=!0);}catch(u){s=!0,i=u}finally{try{!a&&l.return!=null&&l.return()}finally{if(s)throw i}}return n}}function VU(e){if(Array.isArray(e))return e}function dD(e){var t=eu(e,2),n=t[0],a=t[1],s=n,i=a;return n>a&&(s=a,i=n),[s,i]}function uD(e,t,n){if(e.lte(0))return new Vr(0);var a=Kf.getDigitCount(e.toNumber()),s=new Vr(10).pow(a),i=e.div(s),l=a!==1?.05:.1,d=new Vr(Math.ceil(i.div(l).toNumber())).add(n).mul(l),u=d.mul(s);return t?u:new Vr(Math.ceil(u))}function WU(e,t,n){var a=1,s=new Vr(e);if(!s.isint()&&n){var i=Math.abs(e);i<1?(a=new Vr(10).pow(Kf.getDigitCount(e)-1),s=new Vr(Math.floor(s.div(a).toNumber())).mul(a)):i>1&&(s=new Vr(Math.floor(e)))}else e===0?s=new Vr(Math.floor((t-1)/2)):n||(s=new Vr(Math.floor(e)));var l=Math.floor((t-1)/2),d=_U(OU(function(u){return s.add(new Vr(u-l).mul(a)).toNumber()}),qv);return d(0,t)}function mD(e,t,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Vr(0),tickMin:new Vr(0),tickMax:new Vr(0)};var i=uD(new Vr(t).sub(e).div(n-1),a,s),l;e<=0&&t>=0?l=new Vr(0):(l=new Vr(e).add(t).div(2),l=l.sub(new Vr(l).mod(i)));var d=Math.ceil(l.sub(e).div(i).toNumber()),u=Math.ceil(new Vr(t).sub(l).div(i).toNumber()),m=d+u+1;return m>n?mD(e,t,n,a,s+1):(m<n&&(u=t>0?u+(n-m):u,d=t>0?d:d+(n-m)),{step:i,tickMin:l.sub(new Vr(d).mul(i)),tickMax:l.add(new Vr(u).mul(i))})}function YU(e){var t=eu(e,2),n=t[0],a=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=Math.max(s,2),d=dD([n,a]),u=eu(d,2),m=u[0],p=u[1];if(m===-1/0||p===1/0){var f=p===1/0?[m].concat(Vv(qv(0,s-1).map(function(){return 1/0}))):[].concat(Vv(qv(0,s-1).map(function(){return-1/0})),[p]);return n>a?Hv(f):f}if(m===p)return WU(m,s,i);var g=mD(m,p,l,i),N=g.step,v=g.tickMin,w=g.tickMax,y=Kf.rangeStep(v,w.add(new Vr(.1).mul(N)),N);return n>a?Hv(y):y}function KU(e,t){var n=eu(e,2),a=n[0],s=n[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=dD([a,s]),d=eu(l,2),u=d[0],m=d[1];if(u===-1/0||m===1/0)return[a,s];if(u===m)return[u];var p=Math.max(t,2),f=uD(new Vr(m).sub(u).div(p-1),i,0),g=[].concat(Vv(Kf.rangeStep(new Vr(u),new Vr(m).sub(new Vr(.99).mul(f)),f)),[m]);return a>s?Hv(g):g}var GU=lD(YU),XU=lD(KU),JU="Invariant failed";function al(e,t){throw new Error(JU)}var ZU=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function ic(e){"@babel/helpers - typeof";return ic=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ic(e)}function Fh(){return Fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Fh.apply(this,arguments)}function QU(e,t){return nz(e)||rz(e,t)||tz(e,t)||ez()}function ez(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tz(e,t){if(e){if(typeof e=="string")return HI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HI(e,t)}}function HI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function rz(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function nz(e){if(Array.isArray(e))return e}function az(e,t){if(e==null)return{};var n=sz(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function sz(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function iz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oz(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,pD(a.key),a)}}function lz(e,t,n){return t&&oz(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cz(e,t,n){return t=Bh(t),dz(e,hD()?Reflect.construct(t,n||[],Bh(e).constructor):t.apply(e,n))}function dz(e,t){if(t&&(ic(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uz(e)}function uz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hD=function(){return!!e})()}function Bh(e){return Bh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Bh(e)}function mz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yv(e,t)}function Yv(e,t){return Yv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Yv(e,t)}function fD(e,t,n){return t=pD(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pD(e){var t=hz(e,"string");return ic(t)=="symbol"?t:t+""}function hz(e,t){if(ic(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(ic(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Gf=(function(e){function t(){return iz(this,t),cz(this,t,arguments)}return mz(t,e),lz(t,[{key:"render",value:function(){var a=this.props,s=a.offset,i=a.layout,l=a.width,d=a.dataKey,u=a.data,m=a.dataPointFormatter,p=a.xAxis,f=a.yAxis,g=az(a,ZU),N=tr(g,!1);this.props.direction==="x"&&p.type!=="number"&&al();var v=u.map(function(w){var y=m(w,d),E=y.x,O=y.y,T=y.value,A=y.errorVal;if(!A)return null;var I=[],C,P;if(Array.isArray(A)){var F=QU(A,2);C=F[0],P=F[1]}else C=P=A;if(i==="vertical"){var R=p.scale,$=O+s,L=$+l,G=$-l,X=R(T-C),me=R(T+P);I.push({x1:me,y1:L,x2:me,y2:G}),I.push({x1:X,y1:$,x2:me,y2:$}),I.push({x1:X,y1:L,x2:X,y2:G})}else if(i==="horizontal"){var se=f.scale,ee=E+s,W=ee-l,U=ee+l,Q=se(T-C),Y=se(T+P);I.push({x1:W,y1:Y,x2:U,y2:Y}),I.push({x1:ee,y1:Q,x2:ee,y2:Y}),I.push({x1:W,y1:Q,x2:U,y2:Q})}return xe.createElement(Br,Fh({className:"recharts-errorBar",key:"bar-".concat(I.map(function(H){return"".concat(H.x1,"-").concat(H.x2,"-").concat(H.y1,"-").concat(H.y2)}))},N),I.map(function(H){return xe.createElement("line",Fh({},H,{key:"line-".concat(H.x1,"-").concat(H.x2,"-").concat(H.y1,"-").concat(H.y2)}))}))});return xe.createElement(Br,{className:"recharts-errorBars"},v)}}])})(xe.Component);fD(Gf,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});fD(Gf,"displayName","ErrorBar");function tu(e){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function VI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function _o(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VI(Object(n),!0).forEach(function(a){fz(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VI(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function fz(e,t,n){return t=pz(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pz(e){var t=gz(e,"string");return tu(t)=="symbol"?t:t+""}function gz(e,t){if(tu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(tu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gD=function(t){var n=t.children,a=t.formattedGraphicalItems,s=t.legendWidth,i=t.legendContent,l=Za(n,Wl);if(!l)return null;var d=Wl.defaultProps,u=d!==void 0?_o(_o({},d),l.props):{},m;return l.props&&l.props.payload?m=l.props&&l.props.payload:i==="children"?m=(a||[]).reduce(function(p,f){var g=f.item,N=f.props,v=N.sectors||N.data||[];return p.concat(v.map(function(w){return{type:l.props.iconType||g.props.legendType,value:w.name,color:w.fill,payload:w}}))},[]):m=(a||[]).map(function(p){var f=p.item,g=f.type.defaultProps,N=g!==void 0?_o(_o({},g),f.props):{},v=N.dataKey,w=N.name,y=N.legendType,E=N.hide;return{inactive:E,dataKey:v,type:u.iconType||y||"square",color:ej(f),value:w||v,payload:N}}),_o(_o(_o({},u),Wl.getWithHeight(l,s)),{},{payload:m,item:l})};function ru(e){"@babel/helpers - typeof";return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}function WI(e){return vz(e)||bz(e)||yz(e)||xz()}function xz(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yz(e,t){if(e){if(typeof e=="string")return Kv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kv(e,t)}}function bz(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vz(e){if(Array.isArray(e))return Kv(e)}function Kv(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function YI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YI(Object(n),!0).forEach(function(a){Kl(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YI(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Kl(e,t,n){return t=wz(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wz(e){var t=jz(e,"string");return ru(t)=="symbol"?t:t+""}function jz(e,t){if(ru(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(ru(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(e,t,n){return wr(e)||wr(t)?n:Rn(t)?ts(e,t,n):lr(t)?t(e):n}function Dd(e,t,n,a){var s=vU(e,function(d){return ya(d,t)});if(n==="number"){var i=s.filter(function(d){return jt(d)||parseFloat(d)});return i.length?[Vf(i),Hf(i)]:[1/0,-1/0]}var l=a?s.filter(function(d){return!wr(d)}):s;return l.map(function(d){return Rn(d)||d instanceof Date?d:""})}var Nz=function(t){var n,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,l=-1,d=(n=a?.length)!==null&&n!==void 0?n:0;if(d<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var u=i.range,m=0;m<d;m++){var p=m>0?s[m-1].coordinate:s[d-1].coordinate,f=s[m].coordinate,g=m>=d-1?s[0].coordinate:s[m+1].coordinate,N=void 0;if(ka(f-p)!==ka(g-f)){var v=[];if(ka(g-f)===ka(u[1]-u[0])){N=g;var w=f+u[1]-u[0];v[0]=Math.min(w,(w+p)/2),v[1]=Math.max(w,(w+p)/2)}else{N=p;var y=g+u[1]-u[0];v[0]=Math.min(f,(y+f)/2),v[1]=Math.max(f,(y+f)/2)}var E=[Math.min(f,(N+f)/2),Math.max(f,(N+f)/2)];if(t>E[0]&&t<=E[1]||t>=v[0]&&t<=v[1]){l=s[m].index;break}}else{var O=Math.min(p,g),T=Math.max(p,g);if(t>(O+f)/2&&t<=(T+f)/2){l=s[m].index;break}}}else for(var A=0;A<d;A++)if(A===0&&t<=(a[A].coordinate+a[A+1].coordinate)/2||A>0&&A<d-1&&t>(a[A].coordinate+a[A-1].coordinate)/2&&t<=(a[A].coordinate+a[A+1].coordinate)/2||A===d-1&&t>(a[A].coordinate+a[A-1].coordinate)/2){l=a[A].index;break}return l},ej=function(t){var n,a=t,s=a.type.displayName,i=(n=t.type)!==null&&n!==void 0&&n.defaultProps?fn(fn({},t.type.defaultProps),t.props):t.props,l=i.stroke,d=i.fill,u;switch(s){case"Line":u=l;break;case"Area":case"Radar":u=l&&l!=="none"?l:d;break;default:u=d;break}return u},Sz=function(t){var n=t.barSize,a=t.totalSize,s=t.stackGroups,i=s===void 0?{}:s;if(!i)return{};for(var l={},d=Object.keys(i),u=0,m=d.length;u<m;u++)for(var p=i[d[u]].stackGroups,f=Object.keys(p),g=0,N=f.length;g<N;g++){var v=p[f[g]],w=v.items,y=v.cateAxisId,E=w.filter(function(P){return ki(P.type).indexOf("Bar")>=0});if(E&&E.length){var O=E[0].type.defaultProps,T=O!==void 0?fn(fn({},O),E[0].props):E[0].props,A=T.barSize,I=T[y];l[I]||(l[I]=[]);var C=wr(A)?n:A;l[I].push({item:E[0],stackList:E.slice(1),barSize:wr(C)?void 0:Aa(C,a,0)})}}return l},Cz=function(t){var n=t.barGap,a=t.barCategoryGap,s=t.bandSize,i=t.sizeList,l=i===void 0?[]:i,d=t.maxBarSize,u=l.length;if(u<1)return null;var m=Aa(n,s,0,!0),p,f=[];if(l[0].barSize===+l[0].barSize){var g=!1,N=s/u,v=l.reduce(function(A,I){return A+I.barSize||0},0);v+=(u-1)*m,v>=s&&(v-=(u-1)*m,m=0),v>=s&&N>0&&(g=!0,N*=.9,v=u*N);var w=(s-v)/2>>0,y={offset:w-m,size:0};p=l.reduce(function(A,I){var C={item:I.item,position:{offset:y.offset+y.size+m,size:g?N:I.barSize}},P=[].concat(WI(A),[C]);return y=P[P.length-1].position,I.stackList&&I.stackList.length&&I.stackList.forEach(function(F){P.push({item:F,position:y})}),P},f)}else{var E=Aa(a,s,0,!0);s-2*E-(u-1)*m<=0&&(m=0);var O=(s-2*E-(u-1)*m)/u;O>1&&(O>>=0);var T=d===+d?Math.min(O,d):O;p=l.reduce(function(A,I,C){var P=[].concat(WI(A),[{item:I.item,position:{offset:E+(O+m)*C+(O-T)/2,size:T}}]);return I.stackList&&I.stackList.length&&I.stackList.forEach(function(F){P.push({item:F,position:P[P.length-1].position})}),P},f)}return p},kz=function(t,n,a,s){var i=a.children,l=a.width,d=a.margin,u=l-(d.left||0)-(d.right||0),m=gD({children:i,legendWidth:u});if(m){var p=s||{},f=p.width,g=p.height,N=m.align,v=m.verticalAlign,w=m.layout;if((w==="vertical"||w==="horizontal"&&v==="middle")&&N!=="center"&&jt(t[N]))return fn(fn({},t),{},Kl({},N,t[N]+(f||0)));if((w==="horizontal"||w==="vertical"&&N==="center")&&v!=="middle"&&jt(t[v]))return fn(fn({},t),{},Kl({},v,t[v]+(g||0)))}return t},Az=function(t,n,a){return wr(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||a==="x"?n==="xAxis":a==="y"?n==="yAxis":!0},xD=function(t,n,a,s,i){var l=n.props.children,d=ys(l,Gf).filter(function(m){return Az(s,i,m.props.direction)});if(d&&d.length){var u=d.map(function(m){return m.props.dataKey});return t.reduce(function(m,p){var f=ya(p,a);if(wr(f))return m;var g=Array.isArray(f)?[Vf(f),Hf(f)]:[f,f],N=u.reduce(function(v,w){var y=ya(p,w,0),E=g[0]-Math.abs(Array.isArray(y)?y[0]:y),O=g[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(E,v[0]),Math.max(O,v[1])]},[1/0,-1/0]);return[Math.min(N[0],m[0]),Math.max(N[1],m[1])]},[1/0,-1/0])}return null},Iz=function(t,n,a,s,i){var l=n.map(function(d){return xD(t,d,a,i,s)}).filter(function(d){return!wr(d)});return l&&l.length?l.reduce(function(d,u){return[Math.min(d[0],u[0]),Math.max(d[1],u[1])]},[1/0,-1/0]):null},yD=function(t,n,a,s,i){var l=n.map(function(u){var m=u.props.dataKey;return a==="number"&&m&&xD(t,u,m,s)||Dd(t,m,a,i)});if(a==="number")return l.reduce(function(u,m){return[Math.min(u[0],m[0]),Math.max(u[1],m[1])]},[1/0,-1/0]);var d={};return l.reduce(function(u,m){for(var p=0,f=m.length;p<f;p++)d[m[p]]||(d[m[p]]=!0,u.push(m[p]));return u},[])},bD=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},vD=function(t,n,a,s){if(s)return t.map(function(u){return u.coordinate});var i,l,d=t.map(function(u){return u.coordinate===n&&(i=!0),u.coordinate===a&&(l=!0),u.coordinate});return i||d.push(n),l||d.push(a),d},Si=function(t,n,a){if(!t)return null;var s=t.scale,i=t.duplicateDomain,l=t.type,d=t.range,u=t.realScaleType==="scaleBand"?s.bandwidth()/2:2,m=(n||a)&&l==="category"&&s.bandwidth?s.bandwidth()/u:0;if(m=t.axisType==="angleAxis"&&d?.length>=2?ka(d[0]-d[1])*2*m:m,n&&(t.ticks||t.niceTicks)){var p=(t.ticks||t.niceTicks).map(function(f){var g=i?i.indexOf(f):f;return{coordinate:s(g)+m,value:f,offset:m}});return p.filter(function(f){return!Pu(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,g){return{coordinate:s(f)+m,value:f,index:g,offset:m}}):s.ticks&&!a?s.ticks(t.tickCount).map(function(f){return{coordinate:s(f)+m,value:f,offset:m}}):s.domain().map(function(f,g){return{coordinate:s(f)+m,value:i?i[f]:f,index:g,offset:m}})},hb=new WeakMap,Km=function(t,n){if(typeof n!="function")return t;hb.has(t)||hb.set(t,new WeakMap);var a=hb.get(t);if(a.has(n))return a.get(n);var s=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return a.set(n,s),s},wD=function(t,n,a){var s=t.scale,i=t.type,l=t.layout,d=t.axisType;if(s==="auto")return l==="radial"&&d==="radiusAxis"?{scale:Kd(),realScaleType:"band"}:l==="radial"&&d==="angleAxis"?{scale:_h(),realScaleType:"linear"}:i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!a)?{scale:Td(),realScaleType:"point"}:i==="category"?{scale:Kd(),realScaleType:"band"}:{scale:_h(),realScaleType:"linear"};if(el(s)){var u="scale".concat(Pf(s));return{scale:(DI[u]||Td)(),realScaleType:DI[u]?u:"point"}}return lr(s)?{scale:s}:{scale:Td(),realScaleType:"point"}},KI=1e-4,jD=function(t){var n=t.domain();if(!(!n||n.length<=2)){var a=n.length,s=t.range(),i=Math.min(s[0],s[1])-KI,l=Math.max(s[0],s[1])+KI,d=t(n[0]),u=t(n[a-1]);(d<i||d>l||u<i||u>l)&&t.domain([n[0],n[a-1]])}},Ez=function(t,n){if(!t)return null;for(var a=0,s=t.length;a<s;a++)if(t[a].item===n)return t[a].position;return null},Pz=function(t,n){if(!n||n.length!==2||!jt(n[0])||!jt(n[1]))return t;var a=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]),i=[t[0],t[1]];return(!jt(t[0])||t[0]<a)&&(i[0]=a),(!jt(t[1])||t[1]>s)&&(i[1]=s),i[0]>s&&(i[0]=s),i[1]<a&&(i[1]=a),i},Tz=function(t){var n=t.length;if(!(n<=0))for(var a=0,s=t[0].length;a<s;++a)for(var i=0,l=0,d=0;d<n;++d){var u=Pu(t[d][a][1])?t[d][a][0]:t[d][a][1];u>=0?(t[d][a][0]=i,t[d][a][1]=i+u,i=t[d][a][1]):(t[d][a][0]=l,t[d][a][1]=l+u,l=t[d][a][1])}},Dz=function(t){var n=t.length;if(!(n<=0))for(var a=0,s=t[0].length;a<s;++a)for(var i=0,l=0;l<n;++l){var d=Pu(t[l][a][1])?t[l][a][0]:t[l][a][1];d>=0?(t[l][a][0]=i,t[l][a][1]=i+d,i=t[l][a][1]):(t[l][a][0]=0,t[l][a][1]=0)}},Oz={sign:Tz,expand:vL,none:Zl,silhouette:wL,wiggle:jL,positive:Dz},_z=function(t,n,a){var s=n.map(function(d){return d.props.dataKey}),i=Oz[a],l=bL().keys(s).value(function(d,u){return+ya(d,u,0)}).order(Sv).offset(i);return l(t)},Mz=function(t,n,a,s,i,l){if(!t)return null;var d=l?n.reverse():n,u={},m=d.reduce(function(f,g){var N,v=(N=g.type)!==null&&N!==void 0&&N.defaultProps?fn(fn({},g.type.defaultProps),g.props):g.props,w=v.stackId,y=v.hide;if(y)return f;var E=v[a],O=f[E]||{hasStack:!1,stackGroups:{}};if(Rn(w)){var T=O.stackGroups[w]||{numericAxisId:a,cateAxisId:s,items:[]};T.items.push(g),O.hasStack=!0,O.stackGroups[w]=T}else O.stackGroups[Tu("_stackId_")]={numericAxisId:a,cateAxisId:s,items:[g]};return fn(fn({},f),{},Kl({},E,O))},u),p={};return Object.keys(m).reduce(function(f,g){var N=m[g];if(N.hasStack){var v={};N.stackGroups=Object.keys(N.stackGroups).reduce(function(w,y){var E=N.stackGroups[y];return fn(fn({},w),{},Kl({},y,{numericAxisId:a,cateAxisId:s,items:E.items,stackedData:_z(t,E.items,i)}))},v)}return fn(fn({},f),{},Kl({},g,N))},p)},ND=function(t,n){var a=n.realScaleType,s=n.type,i=n.tickCount,l=n.originalDomain,d=n.allowDecimals,u=a||n.scale;if(u!=="auto"&&u!=="linear")return null;if(i&&s==="number"&&l&&(l[0]==="auto"||l[1]==="auto")){var m=t.domain();if(!m.length)return null;var p=GU(m,i,d);return t.domain([Vf(p),Hf(p)]),{niceTicks:p}}if(i&&s==="number"){var f=t.domain(),g=XU(f,i,d);return{niceTicks:g}}return null},GI=function(t){var n=t.axis,a=t.ticks,s=t.offset,i=t.bandSize,l=t.entry,d=t.index;if(n.type==="category")return a[d]?a[d].coordinate+s:null;var u=ya(l,n.dataKey,n.domain[d]);return wr(u)?null:n.scale(u)-i/2+s},Rz=function(t){var n=t.numericAxis,a=n.scale.domain();if(n.type==="number"){var s=Math.min(a[0],a[1]),i=Math.max(a[0],a[1]);return s<=0&&i>=0?0:i<0?i:s}return a[0]},$z=function(t,n){var a,s=(a=t.type)!==null&&a!==void 0&&a.defaultProps?fn(fn({},t.type.defaultProps),t.props):t.props,i=s.stackId;if(Rn(i)){var l=n[i];if(l){var d=l.items.indexOf(t);return d>=0?l.stackedData[d]:null}}return null},Lz=function(t){return t.reduce(function(n,a){return[Vf(a.concat([n[0]]).filter(jt)),Hf(a.concat([n[1]]).filter(jt))]},[1/0,-1/0])},SD=function(t,n,a){return Object.keys(t).reduce(function(s,i){var l=t[i],d=l.stackedData,u=d.reduce(function(m,p){var f=Lz(p.slice(n,a+1));return[Math.min(m[0],f[0]),Math.max(m[1],f[1])]},[1/0,-1/0]);return[Math.min(u[0],s[0]),Math.max(u[1],s[1])]},[1/0,-1/0]).map(function(s){return s===1/0||s===-1/0?0:s})},XI=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,JI=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Gv=function(t,n,a){if(lr(t))return t(n,a);if(!Array.isArray(t))return n;var s=[];if(jt(t[0]))s[0]=a?t[0]:Math.min(t[0],n[0]);else if(XI.test(t[0])){var i=+XI.exec(t[0])[1];s[0]=n[0]-i}else lr(t[0])?s[0]=t[0](n[0]):s[0]=n[0];if(jt(t[1]))s[1]=a?t[1]:Math.max(t[1],n[1]);else if(JI.test(t[1])){var l=+JI.exec(t[1])[1];s[1]=n[1]+l}else lr(t[1])?s[1]=t[1](n[1]):s[1]=n[1];return s},Uh=function(t,n,a){if(t&&t.scale&&t.scale.bandwidth){var s=t.scale.bandwidth();if(!a||s>0)return s}if(t&&n&&n.length>=2){for(var i=Iw(n,function(f){return f.coordinate}),l=1/0,d=1,u=i.length;d<u;d++){var m=i[d],p=i[d-1];l=Math.min((m.coordinate||0)-(p.coordinate||0),l)}return l===1/0?0:l}return a?void 0:0},ZI=function(t,n,a){return!t||!t.length||Wf(t,ts(a,"type.defaultProps.domain"))?n:t},CD=function(t,n){var a=t.type.defaultProps?fn(fn({},t.type.defaultProps),t.props):t.props,s=a.dataKey,i=a.name,l=a.unit,d=a.formatter,u=a.tooltipType,m=a.chartType,p=a.hide;return fn(fn({},tr(t,!1)),{},{dataKey:s,unit:l,formatter:d,name:i||s,color:ej(t),value:ya(n,s),type:u,payload:n,chartType:m,hide:p})};function nu(e){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function QI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function wi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?QI(Object(n),!0).forEach(function(a){kD(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QI(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function kD(e,t,n){return t=Fz(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fz(e){var t=Bz(e,"string");return nu(t)=="symbol"?t:t+""}function Bz(e,t){if(nu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(nu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uz(e,t){return Vz(e)||Hz(e,t)||qz(e,t)||zz()}function zz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qz(e,t){if(e){if(typeof e=="string")return e3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e3(e,t)}}function e3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Hz(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function Vz(e){if(Array.isArray(e))return e}var zh=Math.PI/180,Wz=function(t){return t*180/Math.PI},Jr=function(t,n,a,s){return{x:t+Math.cos(-zh*s)*a,y:n+Math.sin(-zh*s)*a}},AD=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(n-(a.top||0)-(a.bottom||0)))/2},Yz=function(t,n,a,s,i){var l=t.width,d=t.height,u=t.startAngle,m=t.endAngle,p=Aa(t.cx,l,l/2),f=Aa(t.cy,d,d/2),g=AD(l,d,a),N=Aa(t.innerRadius,g,0),v=Aa(t.outerRadius,g,g*.8),w=Object.keys(n);return w.reduce(function(y,E){var O=n[E],T=O.domain,A=O.reversed,I;if(wr(O.range))s==="angleAxis"?I=[u,m]:s==="radiusAxis"&&(I=[N,v]),A&&(I=[I[1],I[0]]);else{I=O.range;var C=I,P=Uz(C,2);u=P[0],m=P[1]}var F=wD(O,i),R=F.realScaleType,$=F.scale;$.domain(T).range(I),jD($);var L=ND($,wi(wi({},O),{},{realScaleType:R})),G=wi(wi(wi({},O),L),{},{range:I,radius:v,realScaleType:R,scale:$,cx:p,cy:f,innerRadius:N,outerRadius:v,startAngle:u,endAngle:m});return wi(wi({},y),{},kD({},E,G))},{})},Kz=function(t,n){var a=t.x,s=t.y,i=n.x,l=n.y;return Math.sqrt(Math.pow(a-i,2)+Math.pow(s-l,2))},Gz=function(t,n){var a=t.x,s=t.y,i=n.cx,l=n.cy,d=Kz({x:a,y:s},{x:i,y:l});if(d<=0)return{radius:d};var u=(a-i)/d,m=Math.acos(u);return s>l&&(m=2*Math.PI-m),{radius:d,angle:Wz(m),angleInRadian:m}},Xz=function(t){var n=t.startAngle,a=t.endAngle,s=Math.floor(n/360),i=Math.floor(a/360),l=Math.min(s,i);return{startAngle:n-l*360,endAngle:a-l*360}},Jz=function(t,n){var a=n.startAngle,s=n.endAngle,i=Math.floor(a/360),l=Math.floor(s/360),d=Math.min(i,l);return t+d*360},t3=function(t,n){var a=t.x,s=t.y,i=Gz({x:a,y:s},n),l=i.radius,d=i.angle,u=n.innerRadius,m=n.outerRadius;if(l<u||l>m)return!1;if(l===0)return!0;var p=Xz(n),f=p.startAngle,g=p.endAngle,N=d,v;if(f<=g){for(;N>g;)N-=360;for(;N<f;)N+=360;v=N>=f&&N<=g}else{for(;N>f;)N-=360;for(;N<g;)N+=360;v=N>=g&&N<=f}return v?wi(wi({},n),{},{radius:l,angle:Jz(N,n)}):null},ID=function(t){return!j.isValidElement(t)&&!lr(t)&&typeof t!="boolean"?t.className:""};function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}var Zz=["offset"];function Qz(e){return nq(e)||rq(e)||tq(e)||eq()}function eq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tq(e,t){if(e){if(typeof e=="string")return Xv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xv(e,t)}}function rq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nq(e){if(Array.isArray(e))return Xv(e)}function Xv(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function aq(e,t){if(e==null)return{};var n=sq(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function sq(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function r3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?r3(Object(n),!0).forEach(function(a){iq(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function iq(e,t,n){return t=oq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oq(e){var t=lq(e,"string");return au(t)=="symbol"?t:t+""}function lq(e,t){if(au(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(au(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function su(){return su=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},su.apply(this,arguments)}var cq=function(t){var n=t.value,a=t.formatter,s=wr(t.children)?n:t.children;return lr(a)?a(s):s},dq=function(t,n){var a=ka(n-t),s=Math.min(Math.abs(n-t),360);return a*s},uq=function(t,n,a){var s=t.position,i=t.viewBox,l=t.offset,d=t.className,u=i,m=u.cx,p=u.cy,f=u.innerRadius,g=u.outerRadius,N=u.startAngle,v=u.endAngle,w=u.clockWise,y=(f+g)/2,E=dq(N,v),O=E>=0?1:-1,T,A;s==="insideStart"?(T=N+O*l,A=w):s==="insideEnd"?(T=v-O*l,A=!w):s==="end"&&(T=v+O*l,A=w),A=E<=0?A:!A;var I=Jr(m,p,y,T),C=Jr(m,p,y,T+(A?1:-1)*359),P="M".concat(I.x,",").concat(I.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(A?0:1,`,
    `).concat(C.x,",").concat(C.y),F=wr(t.id)?Tu("recharts-radial-line-"):t.id;return xe.createElement("text",su({},a,{dominantBaseline:"central",className:xr("recharts-radial-bar-label",d)}),xe.createElement("defs",null,xe.createElement("path",{id:F,d:P})),xe.createElement("textPath",{xlinkHref:"#".concat(F)},n))},mq=function(t){var n=t.viewBox,a=t.offset,s=t.position,i=n,l=i.cx,d=i.cy,u=i.innerRadius,m=i.outerRadius,p=i.startAngle,f=i.endAngle,g=(p+f)/2;if(s==="outside"){var N=Jr(l,d,m+a,g),v=N.x,w=N.y;return{x:v,y:w,textAnchor:v>=l?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:l,y:d,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:l,y:d,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:l,y:d,textAnchor:"middle",verticalAnchor:"end"};var y=(u+m)/2,E=Jr(l,d,y,g),O=E.x,T=E.y;return{x:O,y:T,textAnchor:"middle",verticalAnchor:"middle"}},hq=function(t){var n=t.viewBox,a=t.parentViewBox,s=t.offset,i=t.position,l=n,d=l.x,u=l.y,m=l.width,p=l.height,f=p>=0?1:-1,g=f*s,N=f>0?"end":"start",v=f>0?"start":"end",w=m>=0?1:-1,y=w*s,E=w>0?"end":"start",O=w>0?"start":"end";if(i==="top"){var T={x:d+m/2,y:u-f*s,textAnchor:"middle",verticalAnchor:N};return Mn(Mn({},T),a?{height:Math.max(u-a.y,0),width:m}:{})}if(i==="bottom"){var A={x:d+m/2,y:u+p+g,textAnchor:"middle",verticalAnchor:v};return Mn(Mn({},A),a?{height:Math.max(a.y+a.height-(u+p),0),width:m}:{})}if(i==="left"){var I={x:d-y,y:u+p/2,textAnchor:E,verticalAnchor:"middle"};return Mn(Mn({},I),a?{width:Math.max(I.x-a.x,0),height:p}:{})}if(i==="right"){var C={x:d+m+y,y:u+p/2,textAnchor:O,verticalAnchor:"middle"};return Mn(Mn({},C),a?{width:Math.max(a.x+a.width-C.x,0),height:p}:{})}var P=a?{width:m,height:p}:{};return i==="insideLeft"?Mn({x:d+y,y:u+p/2,textAnchor:O,verticalAnchor:"middle"},P):i==="insideRight"?Mn({x:d+m-y,y:u+p/2,textAnchor:E,verticalAnchor:"middle"},P):i==="insideTop"?Mn({x:d+m/2,y:u+g,textAnchor:"middle",verticalAnchor:v},P):i==="insideBottom"?Mn({x:d+m/2,y:u+p-g,textAnchor:"middle",verticalAnchor:N},P):i==="insideTopLeft"?Mn({x:d+y,y:u+g,textAnchor:O,verticalAnchor:v},P):i==="insideTopRight"?Mn({x:d+m-y,y:u+g,textAnchor:E,verticalAnchor:v},P):i==="insideBottomLeft"?Mn({x:d+y,y:u+p-g,textAnchor:O,verticalAnchor:N},P):i==="insideBottomRight"?Mn({x:d+m-y,y:u+p-g,textAnchor:E,verticalAnchor:N},P):Ac(i)&&(jt(i.x)||zo(i.x))&&(jt(i.y)||zo(i.y))?Mn({x:d+Aa(i.x,m),y:u+Aa(i.y,p),textAnchor:"end",verticalAnchor:"end"},P):Mn({x:d+m/2,y:u+p/2,textAnchor:"middle",verticalAnchor:"middle"},P)},fq=function(t){return"cx"in t&&jt(t.cx)};function Jn(e){var t=e.offset,n=t===void 0?5:t,a=aq(e,Zz),s=Mn({offset:n},a),i=s.viewBox,l=s.position,d=s.value,u=s.children,m=s.content,p=s.className,f=p===void 0?"":p,g=s.textBreakAll;if(!i||wr(d)&&wr(u)&&!j.isValidElement(m)&&!lr(m))return null;if(j.isValidElement(m))return j.cloneElement(m,s);var N;if(lr(m)){if(N=j.createElement(m,s),j.isValidElement(N))return N}else N=cq(s);var v=fq(i),w=tr(s,!0);if(v&&(l==="insideStart"||l==="insideEnd"||l==="end"))return uq(s,N,w);var y=v?mq(s):hq(s);return xe.createElement(rl,su({className:xr("recharts-label",f)},w,y,{breakAll:g}),N)}Jn.displayName="Label";var ED=function(t){var n=t.cx,a=t.cy,s=t.angle,i=t.startAngle,l=t.endAngle,d=t.r,u=t.radius,m=t.innerRadius,p=t.outerRadius,f=t.x,g=t.y,N=t.top,v=t.left,w=t.width,y=t.height,E=t.clockWise,O=t.labelViewBox;if(O)return O;if(jt(w)&&jt(y)){if(jt(f)&&jt(g))return{x:f,y:g,width:w,height:y};if(jt(N)&&jt(v))return{x:N,y:v,width:w,height:y}}return jt(f)&&jt(g)?{x:f,y:g,width:0,height:0}:jt(n)&&jt(a)?{cx:n,cy:a,startAngle:i||s||0,endAngle:l||s||0,innerRadius:m||0,outerRadius:p||u||d||0,clockWise:E}:t.viewBox?t.viewBox:{}},pq=function(t,n){return t?t===!0?xe.createElement(Jn,{key:"label-implicit",viewBox:n}):Rn(t)?xe.createElement(Jn,{key:"label-implicit",viewBox:n,value:t}):j.isValidElement(t)?t.type===Jn?j.cloneElement(t,{key:"label-implicit",viewBox:n}):xe.createElement(Jn,{key:"label-implicit",content:t,viewBox:n}):lr(t)?xe.createElement(Jn,{key:"label-implicit",content:t,viewBox:n}):Ac(t)?xe.createElement(Jn,su({viewBox:n},t,{key:"label-implicit"})):null:null},gq=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&a&&!t.label)return null;var s=t.children,i=ED(t),l=ys(s,Jn).map(function(u,m){return j.cloneElement(u,{viewBox:n||i,key:"label-".concat(m)})});if(!a)return l;var d=pq(t.label,n||i);return[d].concat(Qz(l))};Jn.parseViewBox=ED;Jn.renderCallByParent=gq;var fb,n3;function xq(){if(n3)return fb;n3=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return fb=e,fb}var yq=xq();const bq=Fr(yq);function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}var vq=["valueAccessor"],wq=["data","dataKey","clockWise","id","textBreakAll"];function jq(e){return kq(e)||Cq(e)||Sq(e)||Nq()}function Nq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sq(e,t){if(e){if(typeof e=="string")return Jv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jv(e,t)}}function Cq(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kq(e){if(Array.isArray(e))return Jv(e)}function Jv(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function qh(){return qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},qh.apply(this,arguments)}function a3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function s3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?a3(Object(n),!0).forEach(function(a){Aq(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Aq(e,t,n){return t=Iq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Iq(e){var t=Eq(e,"string");return iu(t)=="symbol"?t:t+""}function Eq(e,t){if(iu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(iu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i3(e,t){if(e==null)return{};var n=Pq(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Pq(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}var Tq=function(t){return Array.isArray(t.value)?bq(t.value):t.value};function uo(e){var t=e.valueAccessor,n=t===void 0?Tq:t,a=i3(e,vq),s=a.data,i=a.dataKey,l=a.clockWise,d=a.id,u=a.textBreakAll,m=i3(a,wq);return!s||!s.length?null:xe.createElement(Br,{className:"recharts-label-list"},s.map(function(p,f){var g=wr(i)?n(p,f):ya(p&&p.payload,i),N=wr(d)?{}:{id:"".concat(d,"-").concat(f)};return xe.createElement(Jn,qh({},tr(p,!0),m,N,{parentViewBox:p.parentViewBox,value:g,textBreakAll:u,viewBox:Jn.parseViewBox(wr(l)?p:s3(s3({},p),{},{clockWise:l})),key:"label-".concat(f),index:f}))}))}uo.displayName="LabelList";function Dq(e,t){return e?e===!0?xe.createElement(uo,{key:"labelList-implicit",data:t}):xe.isValidElement(e)||lr(e)?xe.createElement(uo,{key:"labelList-implicit",data:t,content:e}):Ac(e)?xe.createElement(uo,qh({data:t},e,{key:"labelList-implicit"})):null:null}function Oq(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var a=e.children,s=ys(a,uo).map(function(l,d){return j.cloneElement(l,{data:t,key:"labelList-".concat(d)})});if(!n)return s;var i=Dq(e.label,t);return[i].concat(jq(s))}uo.renderCallByParent=Oq;function ou(e){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Zv.apply(this,arguments)}function o3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function l3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?o3(Object(n),!0).forEach(function(a){_q(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _q(e,t,n){return t=Mq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mq(e){var t=Rq(e,"string");return ou(t)=="symbol"?t:t+""}function Rq(e,t){if(ou(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(ou(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $q=function(t,n){var a=ka(n-t),s=Math.min(Math.abs(n-t),359.999);return a*s},Gm=function(t){var n=t.cx,a=t.cy,s=t.radius,i=t.angle,l=t.sign,d=t.isExternal,u=t.cornerRadius,m=t.cornerIsExternal,p=u*(d?1:-1)+s,f=Math.asin(u/p)/zh,g=m?i:i+l*f,N=Jr(n,a,p,g),v=Jr(n,a,s,g),w=m?i-l*f:i,y=Jr(n,a,p*Math.cos(f*zh),w);return{center:N,circleTangency:v,lineTangency:y,theta:f}},PD=function(t){var n=t.cx,a=t.cy,s=t.innerRadius,i=t.outerRadius,l=t.startAngle,d=t.endAngle,u=$q(l,d),m=l+u,p=Jr(n,a,i,l),f=Jr(n,a,i,m),g="M ".concat(p.x,",").concat(p.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(u)>180),",").concat(+(l>m),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(s>0){var N=Jr(n,a,s,l),v=Jr(n,a,s,m);g+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(u)>180),",").concat(+(l<=m),`,
            `).concat(N.x,",").concat(N.y," Z")}else g+="L ".concat(n,",").concat(a," Z");return g},Lq=function(t){var n=t.cx,a=t.cy,s=t.innerRadius,i=t.outerRadius,l=t.cornerRadius,d=t.forceCornerRadius,u=t.cornerIsExternal,m=t.startAngle,p=t.endAngle,f=ka(p-m),g=Gm({cx:n,cy:a,radius:i,angle:m,sign:f,cornerRadius:l,cornerIsExternal:u}),N=g.circleTangency,v=g.lineTangency,w=g.theta,y=Gm({cx:n,cy:a,radius:i,angle:p,sign:-f,cornerRadius:l,cornerIsExternal:u}),E=y.circleTangency,O=y.lineTangency,T=y.theta,A=u?Math.abs(m-p):Math.abs(m-p)-w-T;if(A<0)return d?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(l,",").concat(l,",0,0,1,").concat(l*2,`,0
        a`).concat(l,",").concat(l,",0,0,1,").concat(-l*2,`,0
      `):PD({cx:n,cy:a,innerRadius:s,outerRadius:i,startAngle:m,endAngle:p});var I="M ".concat(v.x,",").concat(v.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(f<0),",").concat(N.x,",").concat(N.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(A>180),",").concat(+(f<0),",").concat(E.x,",").concat(E.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(f<0),",").concat(O.x,",").concat(O.y,`
  `);if(s>0){var C=Gm({cx:n,cy:a,radius:s,angle:m,sign:f,isExternal:!0,cornerRadius:l,cornerIsExternal:u}),P=C.circleTangency,F=C.lineTangency,R=C.theta,$=Gm({cx:n,cy:a,radius:s,angle:p,sign:-f,isExternal:!0,cornerRadius:l,cornerIsExternal:u}),L=$.circleTangency,G=$.lineTangency,X=$.theta,me=u?Math.abs(m-p):Math.abs(m-p)-R-X;if(me<0&&l===0)return"".concat(I,"L").concat(n,",").concat(a,"Z");I+="L".concat(G.x,",").concat(G.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(f<0),",").concat(L.x,",").concat(L.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(me>180),",").concat(+(f>0),",").concat(P.x,",").concat(P.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(f<0),",").concat(F.x,",").concat(F.y,"Z")}else I+="L".concat(n,",").concat(a,"Z");return I},Fq={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},TD=function(t){var n=l3(l3({},Fq),t),a=n.cx,s=n.cy,i=n.innerRadius,l=n.outerRadius,d=n.cornerRadius,u=n.forceCornerRadius,m=n.cornerIsExternal,p=n.startAngle,f=n.endAngle,g=n.className;if(l<i||p===f)return null;var N=xr("recharts-sector",g),v=l-i,w=Aa(d,v,0,!0),y;return w>0&&Math.abs(p-f)<360?y=Lq({cx:a,cy:s,innerRadius:i,outerRadius:l,cornerRadius:Math.min(w,v/2),forceCornerRadius:u,cornerIsExternal:m,startAngle:p,endAngle:f}):y=PD({cx:a,cy:s,innerRadius:i,outerRadius:l,startAngle:p,endAngle:f}),xe.createElement("path",Zv({},tr(n,!0),{className:N,d:y,role:"img"}))};function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function Qv(){return Qv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Qv.apply(this,arguments)}function c3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function d3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?c3(Object(n),!0).forEach(function(a){Bq(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Bq(e,t,n){return t=Uq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uq(e){var t=zq(e,"string");return lu(t)=="symbol"?t:t+""}function zq(e,t){if(lu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(lu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u3={curveBasisClosed:lL,curveBasisOpen:cL,curveBasis:oL,curveBumpX:Y$,curveBumpY:K$,curveLinearClosed:dL,curveLinear:Df,curveMonotoneX:uL,curveMonotoneY:mL,curveNatural:hL,curveStep:fL,curveStepAfter:gL,curveStepBefore:pL},Xm=function(t){return t.x===+t.x&&t.y===+t.y},yd=function(t){return t.x},bd=function(t){return t.y},qq=function(t,n){if(lr(t))return t;var a="curve".concat(Pf(t));return(a==="curveMonotone"||a==="curveBump")&&n?u3["".concat(a).concat(n==="vertical"?"Y":"X")]:u3[a]||Df},Hq=function(t){var n=t.type,a=n===void 0?"linear":n,s=t.points,i=s===void 0?[]:s,l=t.baseLine,d=t.layout,u=t.connectNulls,m=u===void 0?!1:u,p=qq(a,d),f=m?i.filter(function(w){return Xm(w)}):i,g;if(Array.isArray(l)){var N=m?l.filter(function(w){return Xm(w)}):l,v=f.map(function(w,y){return d3(d3({},w),{},{base:N[y]})});return d==="vertical"?g=Bm().y(bd).x1(yd).x0(function(w){return w.base.x}):g=Bm().x(yd).y1(bd).y0(function(w){return w.base.y}),g.defined(Xm).curve(p),g(v)}return d==="vertical"&&jt(l)?g=Bm().y(bd).x1(yd).x0(l):jt(l)?g=Bm().x(yd).y1(bd).y0(l):g=EP().x(yd).y(bd),g.defined(Xm).curve(p),g(f)},e1=function(t){var n=t.className,a=t.points,s=t.path,i=t.pathRef;if((!a||!a.length)&&!s)return null;var l=a&&a.length?Hq(t):s;return j.createElement("path",Qv({},tr(t,!1),xh(t),{className:xr("recharts-curve",n),d:l,ref:i}))},pb={exports:{}},gb,m3;function Vq(){if(m3)return gb;m3=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return gb=e,gb}var xb,h3;function Wq(){if(h3)return xb;h3=1;var e=Vq();function t(){}function n(){}return n.resetWarningCache=t,xb=function(){function a(l,d,u,m,p,f){if(f!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}a.isRequired=a;function s(){return a}var i={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:s,element:a,elementType:a,instanceOf:s,node:a,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:n,resetWarningCache:t};return i.PropTypes=i,i},xb}var f3;function Yq(){return f3||(f3=1,pb.exports=Wq()()),pb.exports}var Kq=Yq();const $r=Fr(Kq);var Gq=Object.getOwnPropertyNames,Xq=Object.getOwnPropertySymbols,Jq=Object.prototype.hasOwnProperty;function p3(e,t){return function(a,s,i){return e(a,s,i)&&t(a,s,i)}}function Jm(e){return function(n,a,s){if(!n||!a||typeof n!="object"||typeof a!="object")return e(n,a,s);var i=s.cache,l=i.get(n),d=i.get(a);if(l&&d)return l===a&&d===n;i.set(n,a),i.set(a,n);var u=e(n,a,s);return i.delete(n),i.delete(a),u}}function Zq(e){return e?.[Symbol.toStringTag]}function g3(e){return Gq(e).concat(Xq(e))}var Qq=Object.hasOwn||(function(e,t){return Jq.call(e,t)});function dl(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var eH="__v",tH="__o",rH="_owner",x3=Object.getOwnPropertyDescriptor,y3=Object.keys;function nH(e,t,n){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(!n.equals(e[a],t[a],a,a,e,t,n))return!1;return!0}function aH(e,t){return dl(e.getTime(),t.getTime())}function sH(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function iH(e,t){return e===t}function b3(e,t,n){var a=e.size;if(a!==t.size)return!1;if(!a)return!0;for(var s=new Array(a),i=e.entries(),l,d,u=0;(l=i.next())&&!l.done;){for(var m=t.entries(),p=!1,f=0;(d=m.next())&&!d.done;){if(s[f]){f++;continue}var g=l.value,N=d.value;if(n.equals(g[0],N[0],u,f,e,t,n)&&n.equals(g[1],N[1],g[0],N[0],e,t,n)){p=s[f]=!0;break}f++}if(!p)return!1;u++}return!0}var oH=dl;function lH(e,t,n){var a=y3(e),s=a.length;if(y3(t).length!==s)return!1;for(;s-- >0;)if(!DD(e,t,n,a[s]))return!1;return!0}function vd(e,t,n){var a=g3(e),s=a.length;if(g3(t).length!==s)return!1;for(var i,l,d;s-- >0;)if(i=a[s],!DD(e,t,n,i)||(l=x3(e,i),d=x3(t,i),(l||d)&&(!l||!d||l.configurable!==d.configurable||l.enumerable!==d.enumerable||l.writable!==d.writable)))return!1;return!0}function cH(e,t){return dl(e.valueOf(),t.valueOf())}function dH(e,t){return e.source===t.source&&e.flags===t.flags}function v3(e,t,n){var a=e.size;if(a!==t.size)return!1;if(!a)return!0;for(var s=new Array(a),i=e.values(),l,d;(l=i.next())&&!l.done;){for(var u=t.values(),m=!1,p=0;(d=u.next())&&!d.done;){if(!s[p]&&n.equals(l.value,d.value,l.value,d.value,e,t,n)){m=s[p]=!0;break}p++}if(!m)return!1}return!0}function uH(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function mH(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function DD(e,t,n,a){return(a===rH||a===tH||a===eH)&&(e.$$typeof||t.$$typeof)?!0:Qq(t,a)&&n.equals(e[a],t[a],a,a,e,t,n)}var hH="[object Arguments]",fH="[object Boolean]",pH="[object Date]",gH="[object Error]",xH="[object Map]",yH="[object Number]",bH="[object Object]",vH="[object RegExp]",wH="[object Set]",jH="[object String]",NH="[object URL]",SH=Array.isArray,w3=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,j3=Object.assign,CH=Object.prototype.toString.call.bind(Object.prototype.toString);function kH(e){var t=e.areArraysEqual,n=e.areDatesEqual,a=e.areErrorsEqual,s=e.areFunctionsEqual,i=e.areMapsEqual,l=e.areNumbersEqual,d=e.areObjectsEqual,u=e.arePrimitiveWrappersEqual,m=e.areRegExpsEqual,p=e.areSetsEqual,f=e.areTypedArraysEqual,g=e.areUrlsEqual,N=e.unknownTagComparators;return function(w,y,E){if(w===y)return!0;if(w==null||y==null)return!1;var O=typeof w;if(O!==typeof y)return!1;if(O!=="object")return O==="number"?l(w,y,E):O==="function"?s(w,y,E):!1;var T=w.constructor;if(T!==y.constructor)return!1;if(T===Object)return d(w,y,E);if(SH(w))return t(w,y,E);if(w3!=null&&w3(w))return f(w,y,E);if(T===Date)return n(w,y,E);if(T===RegExp)return m(w,y,E);if(T===Map)return i(w,y,E);if(T===Set)return p(w,y,E);var A=CH(w);if(A===pH)return n(w,y,E);if(A===vH)return m(w,y,E);if(A===xH)return i(w,y,E);if(A===wH)return p(w,y,E);if(A===bH)return typeof w.then!="function"&&typeof y.then!="function"&&d(w,y,E);if(A===NH)return g(w,y,E);if(A===gH)return a(w,y,E);if(A===hH)return d(w,y,E);if(A===fH||A===yH||A===jH)return u(w,y,E);if(N){var I=N[A];if(!I){var C=Zq(w);C&&(I=N[C])}if(I)return I(w,y,E)}return!1}}function AH(e){var t=e.circular,n=e.createCustomConfig,a=e.strict,s={areArraysEqual:a?vd:nH,areDatesEqual:aH,areErrorsEqual:sH,areFunctionsEqual:iH,areMapsEqual:a?p3(b3,vd):b3,areNumbersEqual:oH,areObjectsEqual:a?vd:lH,arePrimitiveWrappersEqual:cH,areRegExpsEqual:dH,areSetsEqual:a?p3(v3,vd):v3,areTypedArraysEqual:a?vd:uH,areUrlsEqual:mH,unknownTagComparators:void 0};if(n&&(s=j3({},s,n(s))),t){var i=Jm(s.areArraysEqual),l=Jm(s.areMapsEqual),d=Jm(s.areObjectsEqual),u=Jm(s.areSetsEqual);s=j3({},s,{areArraysEqual:i,areMapsEqual:l,areObjectsEqual:d,areSetsEqual:u})}return s}function IH(e){return function(t,n,a,s,i,l,d){return e(t,n,d)}}function EH(e){var t=e.circular,n=e.comparator,a=e.createState,s=e.equals,i=e.strict;if(a)return function(u,m){var p=a(),f=p.cache,g=f===void 0?t?new WeakMap:void 0:f,N=p.meta;return n(u,m,{cache:g,equals:s,meta:N,strict:i})};if(t)return function(u,m){return n(u,m,{cache:new WeakMap,equals:s,meta:void 0,strict:i})};var l={cache:void 0,equals:s,meta:void 0,strict:i};return function(u,m){return n(u,m,l)}}var PH=yo();yo({strict:!0});yo({circular:!0});yo({circular:!0,strict:!0});yo({createInternalComparator:function(){return dl}});yo({strict:!0,createInternalComparator:function(){return dl}});yo({circular:!0,createInternalComparator:function(){return dl}});yo({circular:!0,createInternalComparator:function(){return dl},strict:!0});function yo(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,a=e.createInternalComparator,s=e.createState,i=e.strict,l=i===void 0?!1:i,d=AH(e),u=kH(d),m=a?a(u):IH(u);return EH({circular:n,comparator:u,createState:s,equals:m,strict:l})}function TH(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function N3(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,a=function s(i){n<0&&(n=i),i-n>t?(e(i),n=-1):TH(s)};requestAnimationFrame(a)}function t1(e){"@babel/helpers - typeof";return t1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t1(e)}function DH(e){return RH(e)||MH(e)||_H(e)||OH()}function OH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _H(e,t){if(e){if(typeof e=="string")return S3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S3(e,t)}}function S3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function MH(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RH(e){if(Array.isArray(e))return e}function $H(){var e={},t=function(){return null},n=!1,a=function s(i){if(!n){if(Array.isArray(i)){if(!i.length)return;var l=i,d=DH(l),u=d[0],m=d.slice(1);if(typeof u=="number"){N3(s.bind(null,m),u);return}s(u),N3(s.bind(null,m));return}t1(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){n=!0},start:function(i){n=!1,a(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function C3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function k3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C3(Object(n),!0).forEach(function(a){OD(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function OD(e,t,n){return t=LH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LH(e){var t=FH(e,"string");return cu(t)==="symbol"?t:String(t)}function FH(e,t){if(cu(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(cu(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BH=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(a,s){return a.filter(function(i){return s.includes(i)})})},UH=function(t){return t},zH=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},Od=function(t,n){return Object.keys(n).reduce(function(a,s){return k3(k3({},a),{},OD({},s,t(s,n[s])))},{})},A3=function(t,n,a){return t.map(function(s){return"".concat(zH(s)," ").concat(n,"ms ").concat(a)}).join(",")};function qH(e,t){return WH(e)||VH(e,t)||_D(e,t)||HH()}function HH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VH(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function WH(e){if(Array.isArray(e))return e}function YH(e){return XH(e)||GH(e)||_D(e)||KH()}function KH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _D(e,t){if(e){if(typeof e=="string")return r1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r1(e,t)}}function GH(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XH(e){if(Array.isArray(e))return r1(e)}function r1(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Hh=1e-4,MD=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},RD=function(t,n){return t.map(function(a,s){return a*Math.pow(n,s)}).reduce(function(a,s){return a+s})},I3=function(t,n){return function(a){var s=MD(t,n);return RD(s,a)}},JH=function(t,n){return function(a){var s=MD(t,n),i=[].concat(YH(s.map(function(l,d){return l*d}).slice(1)),[0]);return RD(i,a)}},E3=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];var s=n[0],i=n[1],l=n[2],d=n[3];if(n.length===1)switch(n[0]){case"linear":s=0,i=0,l=1,d=1;break;case"ease":s=.25,i=.1,l=.25,d=1;break;case"ease-in":s=.42,i=0,l=1,d=1;break;case"ease-out":s=.42,i=0,l=.58,d=1;break;case"ease-in-out":s=0,i=0,l=.58,d=1;break;default:{var u=n[0].split("(");if(u[0]==="cubic-bezier"&&u[1].split(")")[0].split(",").length===4){var m=u[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),p=qH(m,4);s=p[0],i=p[1],l=p[2],d=p[3]}}}var f=I3(s,l),g=I3(i,d),N=JH(s,l),v=function(E){return E>1?1:E<0?0:E},w=function(E){for(var O=E>1?1:E,T=O,A=0;A<8;++A){var I=f(T)-O,C=N(T);if(Math.abs(I-O)<Hh||C<Hh)return g(T);T=v(T-I/C)}return g(T)};return w.isStepper=!1,w},ZH=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,a=n===void 0?100:n,s=t.damping,i=s===void 0?8:s,l=t.dt,d=l===void 0?17:l,u=function(p,f,g){var N=-(p-f)*a,v=g*i,w=g+(N-v)*d/1e3,y=g*d/1e3+p;return Math.abs(y-f)<Hh&&Math.abs(w)<Hh?[f,0]:[y,w]};return u.isStepper=!0,u.dt=d,u},QH=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];var s=n[0];if(typeof s=="string")switch(s){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return E3(s);case"spring":return ZH();default:if(s.split("(")[0]==="cubic-bezier")return E3(s)}return typeof s=="function"?s:null};function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function P3(e){return rV(e)||tV(e)||$D(e)||eV()}function eV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rV(e){if(Array.isArray(e))return a1(e)}function T3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function aa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?T3(Object(n),!0).forEach(function(a){n1(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function n1(e,t,n){return t=nV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nV(e){var t=aV(e,"string");return du(t)==="symbol"?t:String(t)}function aV(e,t){if(du(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(du(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sV(e,t){return lV(e)||oV(e,t)||$D(e,t)||iV()}function iV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $D(e,t){if(e){if(typeof e=="string")return a1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a1(e,t)}}function a1(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function oV(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function lV(e){if(Array.isArray(e))return e}var Vh=function(t,n,a){return t+(n-t)*a},s1=function(t){var n=t.from,a=t.to;return n!==a},cV=function e(t,n,a){var s=Od(function(i,l){if(s1(l)){var d=t(l.from,l.to,l.velocity),u=sV(d,2),m=u[0],p=u[1];return aa(aa({},l),{},{from:m,velocity:p})}return l},n);return a<1?Od(function(i,l){return s1(l)?aa(aa({},l),{},{velocity:Vh(l.velocity,s[i].velocity,a),from:Vh(l.from,s[i].from,a)}):l},n):e(t,s,a-1)};const dV=(function(e,t,n,a,s){var i=BH(e,t),l=i.reduce(function(y,E){return aa(aa({},y),{},n1({},E,[e[E],t[E]]))},{}),d=i.reduce(function(y,E){return aa(aa({},y),{},n1({},E,{from:e[E],velocity:0,to:t[E]}))},{}),u=-1,m,p,f=function(){return null},g=function(){return Od(function(E,O){return O.from},d)},N=function(){return!Object.values(d).filter(s1).length},v=function(E){m||(m=E);var O=E-m,T=O/n.dt;d=cV(n,d,T),s(aa(aa(aa({},e),t),g())),m=E,N()||(u=requestAnimationFrame(f))},w=function(E){p||(p=E);var O=(E-p)/a,T=Od(function(I,C){return Vh.apply(void 0,P3(C).concat([n(O)]))},l);if(s(aa(aa(aa({},e),t),T)),O<1)u=requestAnimationFrame(f);else{var A=Od(function(I,C){return Vh.apply(void 0,P3(C).concat([n(1)]))},l);s(aa(aa(aa({},e),t),A))}};return f=n.isStepper?v:w,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(u)}}});function oc(e){"@babel/helpers - typeof";return oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oc(e)}var uV=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function mV(e,t){if(e==null)return{};var n=hV(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function hV(e,t){if(e==null)return{};var n={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function yb(e){return xV(e)||gV(e)||pV(e)||fV()}function fV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pV(e,t){if(e){if(typeof e=="string")return i1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i1(e,t)}}function gV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xV(e){if(Array.isArray(e))return i1(e)}function i1(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function D3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Es(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?D3(Object(n),!0).forEach(function(a){kd(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function kd(e,t,n){return t=LD(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bV(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,LD(a.key),a)}}function vV(e,t,n){return t&&bV(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function LD(e){var t=wV(e,"string");return oc(t)==="symbol"?t:String(t)}function wV(e,t){if(oc(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(oc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jV(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o1(e,t)}function o1(e,t){return o1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},o1(e,t)}function NV(e){var t=SV();return function(){var a=Wh(e),s;if(t){var i=Wh(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return l1(this,s)}}function l1(e,t){if(t&&(oc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c1(e)}function c1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wh(e){return Wh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Wh(e)}var Di=(function(e){jV(n,e);var t=NV(n);function n(a,s){var i;yV(this,n),i=t.call(this,a,s);var l=i.props,d=l.isActive,u=l.attributeName,m=l.from,p=l.to,f=l.steps,g=l.children,N=l.duration;if(i.handleStyleChange=i.handleStyleChange.bind(c1(i)),i.changeStyle=i.changeStyle.bind(c1(i)),!d||N<=0)return i.state={style:{}},typeof g=="function"&&(i.state={style:p}),l1(i);if(f&&f.length)i.state={style:f[0].style};else if(m){if(typeof g=="function")return i.state={style:m},l1(i);i.state={style:u?kd({},u,m):m}}else i.state={style:{}};return i}return vV(n,[{key:"componentDidMount",value:function(){var s=this.props,i=s.isActive,l=s.canBegin;this.mounted=!0,!(!i||!l)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(s){var i=this.props,l=i.isActive,d=i.canBegin,u=i.attributeName,m=i.shouldReAnimate,p=i.to,f=i.from,g=this.state.style;if(d){if(!l){var N={style:u?kd({},u,p):p};this.state&&g&&(u&&g[u]!==p||!u&&g!==p)&&this.setState(N);return}if(!(PH(s.to,p)&&s.canBegin&&s.isActive)){var v=!s.canBegin||!s.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var w=v||m?f:s.to;if(this.state&&g){var y={style:u?kd({},u,w):w};(u&&g[u]!==w||!u&&g!==w)&&this.setState(y)}this.runAnimation(Es(Es({},this.props),{},{from:w,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),s&&s()}},{key:"handleStyleChange",value:function(s){this.changeStyle(s)}},{key:"changeStyle",value:function(s){this.mounted&&this.setState({style:s})}},{key:"runJSAnimation",value:function(s){var i=this,l=s.from,d=s.to,u=s.duration,m=s.easing,p=s.begin,f=s.onAnimationEnd,g=s.onAnimationStart,N=dV(l,d,QH(m),u,this.changeStyle),v=function(){i.stopJSAnimation=N()};this.manager.start([g,p,v,u,f])}},{key:"runStepAnimation",value:function(s){var i=this,l=s.steps,d=s.begin,u=s.onAnimationStart,m=l[0],p=m.style,f=m.duration,g=f===void 0?0:f,N=function(w,y,E){if(E===0)return w;var O=y.duration,T=y.easing,A=T===void 0?"ease":T,I=y.style,C=y.properties,P=y.onAnimationEnd,F=E>0?l[E-1]:y,R=C||Object.keys(I);if(typeof A=="function"||A==="spring")return[].concat(yb(w),[i.runJSAnimation.bind(i,{from:F.style,to:I,duration:O,easing:A}),O]);var $=A3(R,O,A),L=Es(Es(Es({},F.style),I),{},{transition:$});return[].concat(yb(w),[L,O,P]).filter(UH)};return this.manager.start([u].concat(yb(l.reduce(N,[p,Math.max(g,d)])),[s.onAnimationEnd]))}},{key:"runAnimation",value:function(s){this.manager||(this.manager=$H());var i=s.begin,l=s.duration,d=s.attributeName,u=s.to,m=s.easing,p=s.onAnimationStart,f=s.onAnimationEnd,g=s.steps,N=s.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof m=="function"||typeof N=="function"||m==="spring"){this.runJSAnimation(s);return}if(g.length>1){this.runStepAnimation(s);return}var w=d?kd({},d,u):u,y=A3(Object.keys(w),l,m);v.start([p,i,Es(Es({},w),{},{transition:y}),l,f])}},{key:"render",value:function(){var s=this.props,i=s.children;s.begin;var l=s.duration;s.attributeName,s.easing;var d=s.isActive;s.steps,s.from,s.to,s.canBegin,s.onAnimationEnd,s.shouldReAnimate,s.onAnimationReStart;var u=mV(s,uV),m=j.Children.count(i),p=this.state.style;if(typeof i=="function")return i(p);if(!d||m===0||l<=0)return i;var f=function(N){var v=N.props,w=v.style,y=w===void 0?{}:w,E=v.className,O=j.cloneElement(N,Es(Es({},u),{},{style:Es(Es({},y),p),className:E}));return O};return m===1?f(j.Children.only(i)):xe.createElement("div",null,j.Children.map(i,function(g){return f(g)}))}}]),n})(j.PureComponent);Di.displayName="Animate";Di.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Di.propTypes={from:$r.oneOfType([$r.object,$r.string]),to:$r.oneOfType([$r.object,$r.string]),attributeName:$r.string,duration:$r.number,begin:$r.number,easing:$r.oneOfType([$r.string,$r.func]),steps:$r.arrayOf($r.shape({duration:$r.number.isRequired,style:$r.object.isRequired,easing:$r.oneOfType([$r.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),$r.func]),properties:$r.arrayOf("string"),onAnimationEnd:$r.func})),children:$r.oneOfType([$r.node,$r.func]),isActive:$r.bool,canBegin:$r.bool,onAnimationEnd:$r.func,shouldReAnimate:$r.bool,onAnimationStart:$r.func,onAnimationReStart:$r.func};function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function Yh(){return Yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Yh.apply(this,arguments)}function CV(e,t){return EV(e)||IV(e,t)||AV(e,t)||kV()}function kV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AV(e,t){if(e){if(typeof e=="string")return O3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O3(e,t)}}function O3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function IV(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function EV(e){if(Array.isArray(e))return e}function _3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function M3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_3(Object(n),!0).forEach(function(a){PV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function PV(e,t,n){return t=TV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function TV(e){var t=DV(e,"string");return uu(t)=="symbol"?t:t+""}function DV(e,t){if(uu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(uu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R3=function(t,n,a,s,i){var l=Math.min(Math.abs(a)/2,Math.abs(s)/2),d=s>=0?1:-1,u=a>=0?1:-1,m=s>=0&&a>=0||s<0&&a<0?1:0,p;if(l>0&&i instanceof Array){for(var f=[0,0,0,0],g=0,N=4;g<N;g++)f[g]=i[g]>l?l:i[g];p="M".concat(t,",").concat(n+d*f[0]),f[0]>0&&(p+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(m,",").concat(t+u*f[0],",").concat(n)),p+="L ".concat(t+a-u*f[1],",").concat(n),f[1]>0&&(p+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(m,`,
        `).concat(t+a,",").concat(n+d*f[1])),p+="L ".concat(t+a,",").concat(n+s-d*f[2]),f[2]>0&&(p+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(m,`,
        `).concat(t+a-u*f[2],",").concat(n+s)),p+="L ".concat(t+u*f[3],",").concat(n+s),f[3]>0&&(p+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(m,`,
        `).concat(t,",").concat(n+s-d*f[3])),p+="Z"}else if(l>0&&i===+i&&i>0){var v=Math.min(l,i);p="M ".concat(t,",").concat(n+d*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(m,",").concat(t+u*v,",").concat(n,`
            L `).concat(t+a-u*v,",").concat(n,`
            A `).concat(v,",").concat(v,",0,0,").concat(m,",").concat(t+a,",").concat(n+d*v,`
            L `).concat(t+a,",").concat(n+s-d*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(m,",").concat(t+a-u*v,",").concat(n+s,`
            L `).concat(t+u*v,",").concat(n+s,`
            A `).concat(v,",").concat(v,",0,0,").concat(m,",").concat(t,",").concat(n+s-d*v," Z")}else p="M ".concat(t,",").concat(n," h ").concat(a," v ").concat(s," h ").concat(-a," Z");return p},OV=function(t,n){if(!t||!n)return!1;var a=t.x,s=t.y,i=n.x,l=n.y,d=n.width,u=n.height;if(Math.abs(d)>0&&Math.abs(u)>0){var m=Math.min(i,i+d),p=Math.max(i,i+d),f=Math.min(l,l+u),g=Math.max(l,l+u);return a>=m&&a<=p&&s>=f&&s<=g}return!1},_V={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},tj=function(t){var n=M3(M3({},_V),t),a=j.useRef(),s=j.useState(-1),i=CV(s,2),l=i[0],d=i[1];j.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var A=a.current.getTotalLength();A&&d(A)}catch{}},[]);var u=n.x,m=n.y,p=n.width,f=n.height,g=n.radius,N=n.className,v=n.animationEasing,w=n.animationDuration,y=n.animationBegin,E=n.isAnimationActive,O=n.isUpdateAnimationActive;if(u!==+u||m!==+m||p!==+p||f!==+f||p===0||f===0)return null;var T=xr("recharts-rectangle",N);return O?xe.createElement(Di,{canBegin:l>0,from:{width:p,height:f,x:u,y:m},to:{width:p,height:f,x:u,y:m},duration:w,animationEasing:v,isActive:O},function(A){var I=A.width,C=A.height,P=A.x,F=A.y;return xe.createElement(Di,{canBegin:l>0,from:"0px ".concat(l===-1?1:l,"px"),to:"".concat(l,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:w,isActive:E,easing:v},xe.createElement("path",Yh({},tr(n,!0),{className:T,d:R3(P,F,I,C,g),ref:a})))}):xe.createElement("path",Yh({},tr(n,!0),{className:T,d:R3(u,m,p,f,g)}))},MV=["points","className","baseLinePoints","connectNulls"];function Bl(){return Bl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Bl.apply(this,arguments)}function RV(e,t){if(e==null)return{};var n=$V(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function $V(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function $3(e){return UV(e)||BV(e)||FV(e)||LV()}function LV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FV(e,t){if(e){if(typeof e=="string")return d1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d1(e,t)}}function BV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UV(e){if(Array.isArray(e))return d1(e)}function d1(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var L3=function(t){return t&&t.x===+t.x&&t.y===+t.y},zV=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return t.forEach(function(a){L3(a)?n[n.length-1].push(a):n[n.length-1].length>0&&n.push([])}),L3(t[0])&&n[n.length-1].push(t[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},_d=function(t,n){var a=zV(t);n&&(a=[a.reduce(function(i,l){return[].concat($3(i),$3(l))},[])]);var s=a.map(function(i){return i.reduce(function(l,d,u){return"".concat(l).concat(u===0?"M":"L").concat(d.x,",").concat(d.y)},"")}).join("");return a.length===1?"".concat(s,"Z"):s},qV=function(t,n,a){var s=_d(t,a);return"".concat(s.slice(-1)==="Z"?s.slice(0,-1):s,"L").concat(_d(n.reverse(),a).slice(1))},HV=function(t){var n=t.points,a=t.className,s=t.baseLinePoints,i=t.connectNulls,l=RV(t,MV);if(!n||!n.length)return null;var d=xr("recharts-polygon",a);if(s&&s.length){var u=l.stroke&&l.stroke!=="none",m=qV(n,s,i);return xe.createElement("g",{className:d},xe.createElement("path",Bl({},tr(l,!0),{fill:m.slice(-1)==="Z"?l.fill:"none",stroke:"none",d:m})),u?xe.createElement("path",Bl({},tr(l,!0),{fill:"none",d:_d(n,i)})):null,u?xe.createElement("path",Bl({},tr(l,!0),{fill:"none",d:_d(s,i)})):null)}var p=_d(n,i);return xe.createElement("path",Bl({},tr(l,!0),{fill:p.slice(-1)==="Z"?l.fill:"none",className:d,d:p}))};function u1(){return u1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u1.apply(this,arguments)}var rj=function(t){var n=t.cx,a=t.cy,s=t.r,i=t.className,l=xr("recharts-dot",i);return n===+n&&a===+a&&s===+s?j.createElement("circle",u1({},tr(t,!1),xh(t),{className:l,cx:n,cy:a,r:s})):null};function mu(e){"@babel/helpers - typeof";return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}var VV=["x","y","top","left","width","height","className"];function m1(){return m1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},m1.apply(this,arguments)}function F3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function WV(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?F3(Object(n),!0).forEach(function(a){YV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function YV(e,t,n){return t=KV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KV(e){var t=GV(e,"string");return mu(t)=="symbol"?t:t+""}function GV(e,t){if(mu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(mu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XV(e,t){if(e==null)return{};var n=JV(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function JV(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}var ZV=function(t,n,a,s,i,l){return"M".concat(t,",").concat(i,"v").concat(s,"M").concat(l,",").concat(n,"h").concat(a)},QV=function(t){var n=t.x,a=n===void 0?0:n,s=t.y,i=s===void 0?0:s,l=t.top,d=l===void 0?0:l,u=t.left,m=u===void 0?0:u,p=t.width,f=p===void 0?0:p,g=t.height,N=g===void 0?0:g,v=t.className,w=XV(t,VV),y=WV({x:a,y:i,top:d,left:m,width:f,height:N},w);return!jt(a)||!jt(i)||!jt(f)||!jt(N)||!jt(d)||!jt(m)?null:xe.createElement("path",m1({},tr(y,!0),{className:xr("recharts-cross",v),d:ZV(a,i,f,N,d,m)}))},bb,B3;function eW(){if(B3)return bb;B3=1;var e=qf(),t=QT(),n=si();function a(s,i){return s&&s.length?e(s,n(i,2),t):void 0}return bb=a,bb}var tW=eW();const rW=Fr(tW);var vb,U3;function nW(){if(U3)return vb;U3=1;var e=qf(),t=si(),n=eD();function a(s,i){return s&&s.length?e(s,t(i,2),n):void 0}return vb=a,vb}var aW=nW();const sW=Fr(aW);var iW=["cx","cy","angle","ticks","axisLine"],oW=["ticks","tick","angle","tickFormatter","stroke"];function lc(e){"@babel/helpers - typeof";return lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lc(e)}function Md(){return Md=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Md.apply(this,arguments)}function z3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Mo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z3(Object(n),!0).forEach(function(a){Xf(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function q3(e,t){if(e==null)return{};var n=lW(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function lW(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function cW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H3(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,BD(a.key),a)}}function dW(e,t,n){return t&&H3(e.prototype,t),n&&H3(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function uW(e,t,n){return t=Kh(t),mW(e,FD()?Reflect.construct(t,n||[],Kh(e).constructor):t.apply(e,n))}function mW(e,t){if(t&&(lc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hW(e)}function hW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(FD=function(){return!!e})()}function Kh(e){return Kh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Kh(e)}function fW(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h1(e,t)}function h1(e,t){return h1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},h1(e,t)}function Xf(e,t,n){return t=BD(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BD(e){var t=pW(e,"string");return lc(t)=="symbol"?t:t+""}function pW(e,t){if(lc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(lc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Jf=(function(e){function t(){return cW(this,t),uW(this,t,arguments)}return fW(t,e),dW(t,[{key:"getTickValueCoord",value:function(a){var s=a.coordinate,i=this.props,l=i.angle,d=i.cx,u=i.cy;return Jr(d,u,s,l)}},{key:"getTickTextAnchor",value:function(){var a=this.props.orientation,s;switch(a){case"left":s="end";break;case"right":s="start";break;default:s="middle";break}return s}},{key:"getViewBox",value:function(){var a=this.props,s=a.cx,i=a.cy,l=a.angle,d=a.ticks,u=rW(d,function(p){return p.coordinate||0}),m=sW(d,function(p){return p.coordinate||0});return{cx:s,cy:i,startAngle:l,endAngle:l,innerRadius:m.coordinate||0,outerRadius:u.coordinate||0}}},{key:"renderAxisLine",value:function(){var a=this.props,s=a.cx,i=a.cy,l=a.angle,d=a.ticks,u=a.axisLine,m=q3(a,iW),p=d.reduce(function(v,w){return[Math.min(v[0],w.coordinate),Math.max(v[1],w.coordinate)]},[1/0,-1/0]),f=Jr(s,i,p[0],l),g=Jr(s,i,p[1],l),N=Mo(Mo(Mo({},tr(m,!1)),{},{fill:"none"},tr(u,!1)),{},{x1:f.x,y1:f.y,x2:g.x,y2:g.y});return xe.createElement("line",Md({className:"recharts-polar-radius-axis-line"},N))}},{key:"renderTicks",value:function(){var a=this,s=this.props,i=s.ticks,l=s.tick,d=s.angle,u=s.tickFormatter,m=s.stroke,p=q3(s,oW),f=this.getTickTextAnchor(),g=tr(p,!1),N=tr(l,!1),v=i.map(function(w,y){var E=a.getTickValueCoord(w),O=Mo(Mo(Mo(Mo({textAnchor:f,transform:"rotate(".concat(90-d,", ").concat(E.x,", ").concat(E.y,")")},g),{},{stroke:"none",fill:m},N),{},{index:y},E),{},{payload:w});return xe.createElement(Br,Md({className:xr("recharts-polar-radius-axis-tick",ID(l)),key:"tick-".concat(w.coordinate)},tl(a.props,w,y)),t.renderTickItem(l,O,u?u(w.value,y):w.value))});return xe.createElement(Br,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var a=this.props,s=a.ticks,i=a.axisLine,l=a.tick;return!s||!s.length?null:xe.createElement(Br,{className:xr("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),l&&this.renderTicks(),Jn.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(a,s,i){var l;return xe.isValidElement(a)?l=xe.cloneElement(a,s):lr(a)?l=a(s):l=xe.createElement(rl,Md({},s,{className:"recharts-polar-radius-axis-tick-value"}),i),l}}])})(j.PureComponent);Xf(Jf,"displayName","PolarRadiusAxis");Xf(Jf,"axisType","radiusAxis");Xf(Jf,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function cc(e){"@babel/helpers - typeof";return cc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cc(e)}function Bo(){return Bo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Bo.apply(this,arguments)}function V3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Ro(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?V3(Object(n),!0).forEach(function(a){Zf(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function gW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W3(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,zD(a.key),a)}}function xW(e,t,n){return t&&W3(e.prototype,t),n&&W3(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function yW(e,t,n){return t=Gh(t),bW(e,UD()?Reflect.construct(t,n||[],Gh(e).constructor):t.apply(e,n))}function bW(e,t){if(t&&(cc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vW(e)}function vW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UD=function(){return!!e})()}function Gh(e){return Gh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Gh(e)}function wW(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f1(e,t)}function f1(e,t){return f1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},f1(e,t)}function Zf(e,t,n){return t=zD(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zD(e){var t=jW(e,"string");return cc(t)=="symbol"?t:t+""}function jW(e,t){if(cc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(cc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var NW=Math.PI/180,Y3=1e-5,Qf=(function(e){function t(){return gW(this,t),yW(this,t,arguments)}return wW(t,e),xW(t,[{key:"getTickLineCoord",value:function(a){var s=this.props,i=s.cx,l=s.cy,d=s.radius,u=s.orientation,m=s.tickSize,p=m||8,f=Jr(i,l,d,a.coordinate),g=Jr(i,l,d+(u==="inner"?-1:1)*p,a.coordinate);return{x1:f.x,y1:f.y,x2:g.x,y2:g.y}}},{key:"getTickTextAnchor",value:function(a){var s=this.props.orientation,i=Math.cos(-a.coordinate*NW),l;return i>Y3?l=s==="outer"?"start":"end":i<-Y3?l=s==="outer"?"end":"start":l="middle",l}},{key:"renderAxisLine",value:function(){var a=this.props,s=a.cx,i=a.cy,l=a.radius,d=a.axisLine,u=a.axisLineType,m=Ro(Ro({},tr(this.props,!1)),{},{fill:"none"},tr(d,!1));if(u==="circle")return xe.createElement(rj,Bo({className:"recharts-polar-angle-axis-line"},m,{cx:s,cy:i,r:l}));var p=this.props.ticks,f=p.map(function(g){return Jr(s,i,l,g.coordinate)});return xe.createElement(HV,Bo({className:"recharts-polar-angle-axis-line"},m,{points:f}))}},{key:"renderTicks",value:function(){var a=this,s=this.props,i=s.ticks,l=s.tick,d=s.tickLine,u=s.tickFormatter,m=s.stroke,p=tr(this.props,!1),f=tr(l,!1),g=Ro(Ro({},p),{},{fill:"none"},tr(d,!1)),N=i.map(function(v,w){var y=a.getTickLineCoord(v),E=a.getTickTextAnchor(v),O=Ro(Ro(Ro({textAnchor:E},p),{},{stroke:"none",fill:m},f),{},{index:w,payload:v,x:y.x2,y:y.y2});return xe.createElement(Br,Bo({className:xr("recharts-polar-angle-axis-tick",ID(l)),key:"tick-".concat(v.coordinate)},tl(a.props,v,w)),d&&xe.createElement("line",Bo({className:"recharts-polar-angle-axis-tick-line"},g,y)),l&&t.renderTickItem(l,O,u?u(v.value,w):v.value))});return xe.createElement(Br,{className:"recharts-polar-angle-axis-ticks"},N)}},{key:"render",value:function(){var a=this.props,s=a.ticks,i=a.radius,l=a.axisLine;return i<=0||!s||!s.length?null:xe.createElement(Br,{className:xr("recharts-polar-angle-axis",this.props.className)},l&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(a,s,i){var l;return xe.isValidElement(a)?l=xe.cloneElement(a,s):lr(a)?l=a(s):l=xe.createElement(rl,Bo({},s,{className:"recharts-polar-angle-axis-tick-value"}),i),l}}])})(j.PureComponent);Zf(Qf,"displayName","PolarAngleAxis");Zf(Qf,"axisType","angleAxis");Zf(Qf,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var wb,K3;function SW(){if(K3)return wb;K3=1;var e=ZP(),t=e(Object.getPrototypeOf,Object);return wb=t,wb}var jb,G3;function CW(){if(G3)return jb;G3=1;var e=Mi(),t=SW(),n=Ri(),a="[object Object]",s=Function.prototype,i=Object.prototype,l=s.toString,d=i.hasOwnProperty,u=l.call(Object);function m(p){if(!n(p)||e(p)!=a)return!1;var f=t(p);if(f===null)return!0;var g=d.call(f,"constructor")&&f.constructor;return typeof g=="function"&&g instanceof g&&l.call(g)==u}return jb=m,jb}var kW=CW();const AW=Fr(kW);var Nb,X3;function IW(){if(X3)return Nb;X3=1;var e=Mi(),t=Ri(),n="[object Boolean]";function a(s){return s===!0||s===!1||t(s)&&e(s)==n}return Nb=a,Nb}var EW=IW();const PW=Fr(EW);function hu(e){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function Xh(){return Xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Xh.apply(this,arguments)}function TW(e,t){return MW(e)||_W(e,t)||OW(e,t)||DW()}function DW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OW(e,t){if(e){if(typeof e=="string")return J3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return J3(e,t)}}function J3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _W(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function MW(e){if(Array.isArray(e))return e}function Z3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Q3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Z3(Object(n),!0).forEach(function(a){RW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function RW(e,t,n){return t=$W(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $W(e){var t=LW(e,"string");return hu(t)=="symbol"?t:t+""}function LW(e,t){if(hu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(hu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eE=function(t,n,a,s,i){var l=a-s,d;return d="M ".concat(t,",").concat(n),d+="L ".concat(t+a,",").concat(n),d+="L ".concat(t+a-l/2,",").concat(n+i),d+="L ".concat(t+a-l/2-s,",").concat(n+i),d+="L ".concat(t,",").concat(n," Z"),d},FW={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},BW=function(t){var n=Q3(Q3({},FW),t),a=j.useRef(),s=j.useState(-1),i=TW(s,2),l=i[0],d=i[1];j.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var T=a.current.getTotalLength();T&&d(T)}catch{}},[]);var u=n.x,m=n.y,p=n.upperWidth,f=n.lowerWidth,g=n.height,N=n.className,v=n.animationEasing,w=n.animationDuration,y=n.animationBegin,E=n.isUpdateAnimationActive;if(u!==+u||m!==+m||p!==+p||f!==+f||g!==+g||p===0&&f===0||g===0)return null;var O=xr("recharts-trapezoid",N);return E?xe.createElement(Di,{canBegin:l>0,from:{upperWidth:0,lowerWidth:0,height:g,x:u,y:m},to:{upperWidth:p,lowerWidth:f,height:g,x:u,y:m},duration:w,animationEasing:v,isActive:E},function(T){var A=T.upperWidth,I=T.lowerWidth,C=T.height,P=T.x,F=T.y;return xe.createElement(Di,{canBegin:l>0,from:"0px ".concat(l===-1?1:l,"px"),to:"".concat(l,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:w,easing:v},xe.createElement("path",Xh({},tr(n,!0),{className:O,d:eE(P,F,A,I,C),ref:a})))}):xe.createElement("g",null,xe.createElement("path",Xh({},tr(n,!0),{className:O,d:eE(u,m,p,f,g)})))},UW=["option","shapeType","propTransformer","activeClassName","isActive"];function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function zW(e,t){if(e==null)return{};var n=qW(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function qW(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function tE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Jh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tE(Object(n),!0).forEach(function(a){HW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function HW(e,t,n){return t=VW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VW(e){var t=WW(e,"string");return fu(t)=="symbol"?t:t+""}function WW(e,t){if(fu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(fu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YW(e,t){return Jh(Jh({},t),e)}function KW(e,t){return e==="symbols"}function rE(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return xe.createElement(tj,n);case"trapezoid":return xe.createElement(BW,n);case"sector":return xe.createElement(TD,n);case"symbols":if(KW(t))return xe.createElement(vw,n);break;default:return null}}function GW(e){return j.isValidElement(e)?e.props:e}function qD(e){var t=e.option,n=e.shapeType,a=e.propTransformer,s=a===void 0?YW:a,i=e.activeClassName,l=i===void 0?"recharts-active-shape":i,d=e.isActive,u=zW(e,UW),m;if(j.isValidElement(t))m=j.cloneElement(t,Jh(Jh({},u),GW(t)));else if(lr(t))m=t(u);else if(AW(t)&&!PW(t)){var p=s(t,u);m=xe.createElement(rE,{shapeType:n,elementProps:p})}else{var f=u;m=xe.createElement(rE,{shapeType:n,elementProps:f})}return d?xe.createElement(Br,{className:l},m):m}function ep(e,t){return t!=null&&"trapezoids"in e.props}function tp(e,t){return t!=null&&"sectors"in e.props}function pu(e,t){return t!=null&&"points"in e.props}function XW(e,t){var n,a,s=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,i=e.y===(t==null||(a=t.labelViewBox)===null||a===void 0?void 0:a.y)||e.y===t.y;return s&&i}function JW(e,t){var n=e.endAngle===t.endAngle,a=e.startAngle===t.startAngle;return n&&a}function ZW(e,t){var n=e.x===t.x,a=e.y===t.y,s=e.z===t.z;return n&&a&&s}function QW(e,t){var n;return ep(e,t)?n=XW:tp(e,t)?n=JW:pu(e,t)&&(n=ZW),n}function eY(e,t){var n;return ep(e,t)?n="trapezoids":tp(e,t)?n="sectors":pu(e,t)&&(n="points"),n}function tY(e,t){if(ep(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(tp(e,t)){var a;return(a=t.tooltipPayload)===null||a===void 0||(a=a[0])===null||a===void 0||(a=a.payload)===null||a===void 0?void 0:a.payload}return pu(e,t)?t.payload:{}}function rY(e){var t=e.activeTooltipItem,n=e.graphicalItem,a=e.itemData,s=eY(n,t),i=tY(n,t),l=a.filter(function(u,m){var p=Wf(i,u),f=n.props[s].filter(function(v){var w=QW(n,t);return w(v,t)}),g=n.props[s].indexOf(f[f.length-1]),N=m===g;return p&&N}),d=a.indexOf(l[l.length-1]);return d}var oh;function dc(e){"@babel/helpers - typeof";return dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dc(e)}function Ul(){return Ul=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ul.apply(this,arguments)}function nE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Gr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nE(Object(n),!0).forEach(function(a){ps(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function nY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,VD(a.key),a)}}function aY(e,t,n){return t&&aE(e.prototype,t),n&&aE(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sY(e,t,n){return t=Zh(t),iY(e,HD()?Reflect.construct(t,n||[],Zh(e).constructor):t.apply(e,n))}function iY(e,t){if(t&&(dc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oY(e)}function oY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HD=function(){return!!e})()}function Zh(e){return Zh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Zh(e)}function lY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p1(e,t)}function p1(e,t){return p1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},p1(e,t)}function ps(e,t,n){return t=VD(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VD(e){var t=cY(e,"string");return dc(t)=="symbol"?t:t+""}function cY(e,t){if(dc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(dc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ti=(function(e){function t(n){var a;return nY(this,t),a=sY(this,t,[n]),ps(a,"pieRef",null),ps(a,"sectorRefs",[]),ps(a,"id",Tu("recharts-pie-")),ps(a,"handleAnimationEnd",function(){var s=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),lr(s)&&s()}),ps(a,"handleAnimationStart",function(){var s=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),lr(s)&&s()}),a.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},a}return lY(t,e),aY(t,[{key:"isActiveIndex",value:function(a){var s=this.props.activeIndex;return Array.isArray(s)?s.indexOf(a)!==-1:a===s}},{key:"hasActiveIndex",value:function(){var a=this.props.activeIndex;return Array.isArray(a)?a.length!==0:a||a===0}},{key:"renderLabels",value:function(a){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var i=this.props,l=i.label,d=i.labelLine,u=i.dataKey,m=i.valueKey,p=tr(this.props,!1),f=tr(l,!1),g=tr(d,!1),N=l&&l.offsetRadius||20,v=a.map(function(w,y){var E=(w.startAngle+w.endAngle)/2,O=Jr(w.cx,w.cy,w.outerRadius+N,E),T=Gr(Gr(Gr(Gr({},p),w),{},{stroke:"none"},f),{},{index:y,textAnchor:t.getTextAnchor(O.x,w.cx)},O),A=Gr(Gr(Gr(Gr({},p),w),{},{fill:"none",stroke:w.fill},g),{},{index:y,points:[Jr(w.cx,w.cy,w.outerRadius,E),O]}),I=u;return wr(u)&&wr(m)?I="value":wr(u)&&(I=m),xe.createElement(Br,{key:"label-".concat(w.startAngle,"-").concat(w.endAngle,"-").concat(w.midAngle,"-").concat(y)},d&&t.renderLabelLineItem(d,A,"line"),t.renderLabelItem(l,T,ya(w,I)))});return xe.createElement(Br,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(a){var s=this,i=this.props,l=i.activeShape,d=i.blendStroke,u=i.inactiveShape;return a.map(function(m,p){if(m?.startAngle===0&&m?.endAngle===0&&a.length!==1)return null;var f=s.isActiveIndex(p),g=u&&s.hasActiveIndex()?u:null,N=f?l:g,v=Gr(Gr({},m),{},{stroke:d?m.fill:m.stroke,tabIndex:-1});return xe.createElement(Br,Ul({ref:function(y){y&&!s.sectorRefs.includes(y)&&s.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},tl(s.props,m,p),{key:"sector-".concat(m?.startAngle,"-").concat(m?.endAngle,"-").concat(m.midAngle,"-").concat(p)}),xe.createElement(qD,Ul({option:N,isActive:f,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var a=this,s=this.props,i=s.sectors,l=s.isAnimationActive,d=s.animationBegin,u=s.animationDuration,m=s.animationEasing,p=s.animationId,f=this.state,g=f.prevSectors,N=f.prevIsAnimationActive;return xe.createElement(Di,{begin:d,duration:u,isActive:l,easing:m,from:{t:0},to:{t:1},key:"pie-".concat(p,"-").concat(N),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var w=v.t,y=[],E=i&&i[0],O=E.startAngle;return i.forEach(function(T,A){var I=g&&g[A],C=A>0?ts(T,"paddingAngle",0):0;if(I){var P=ro(I.endAngle-I.startAngle,T.endAngle-T.startAngle),F=Gr(Gr({},T),{},{startAngle:O+C,endAngle:O+P(w)+C});y.push(F),O=F.endAngle}else{var R=T.endAngle,$=T.startAngle,L=ro(0,R-$),G=L(w),X=Gr(Gr({},T),{},{startAngle:O+C,endAngle:O+G+C});y.push(X),O=X.endAngle}}),xe.createElement(Br,null,a.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(a){var s=this;a.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var l=++s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[l].focus(),s.setState({sectorToFocus:l});break}case"ArrowRight":{var d=--s.state.sectorToFocus<0?s.sectorRefs.length-1:s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[d].focus(),s.setState({sectorToFocus:d});break}case"Escape":{s.sectorRefs[s.state.sectorToFocus].blur(),s.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var a=this.props,s=a.sectors,i=a.isAnimationActive,l=this.state.prevSectors;return i&&s&&s.length&&(!l||!Wf(l,s))?this.renderSectorsWithAnimation():this.renderSectorsStatically(s)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var a=this,s=this.props,i=s.hide,l=s.sectors,d=s.className,u=s.label,m=s.cx,p=s.cy,f=s.innerRadius,g=s.outerRadius,N=s.isAnimationActive,v=this.state.isAnimationFinished;if(i||!l||!l.length||!jt(m)||!jt(p)||!jt(f)||!jt(g))return null;var w=xr("recharts-pie",d);return xe.createElement(Br,{tabIndex:this.props.rootTabIndex,className:w,ref:function(E){a.pieRef=E}},this.renderSectors(),u&&this.renderLabels(l),Jn.renderCallByParent(this.props,null,!1),(!N||v)&&uo.renderCallByParent(this.props,l,!1))}}],[{key:"getDerivedStateFromProps",value:function(a,s){return s.prevIsAnimationActive!==a.isAnimationActive?{prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:[],isAnimationFinished:!0}:a.isAnimationActive&&a.animationId!==s.prevAnimationId?{prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:s.curSectors,isAnimationFinished:!0}:a.sectors!==s.curSectors?{curSectors:a.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(a,s){return a>s?"start":a<s?"end":"middle"}},{key:"renderLabelLineItem",value:function(a,s,i){if(xe.isValidElement(a))return xe.cloneElement(a,s);if(lr(a))return a(s);var l=xr("recharts-pie-label-line",typeof a!="boolean"?a.className:"");return xe.createElement(e1,Ul({},s,{key:i,type:"linear",className:l}))}},{key:"renderLabelItem",value:function(a,s,i){if(xe.isValidElement(a))return xe.cloneElement(a,s);var l=i;if(lr(a)&&(l=a(s),xe.isValidElement(l)))return l;var d=xr("recharts-pie-label-text",typeof a!="boolean"&&!lr(a)?a.className:"");return xe.createElement(rl,Ul({},s,{alignmentBaseline:"middle",className:d}),l)}}])})(j.PureComponent);oh=ti;ps(ti,"displayName","Pie");ps(ti,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Ec.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});ps(ti,"parseDeltaAngle",function(e,t){var n=ka(t-e),a=Math.min(Math.abs(t-e),360);return n*a});ps(ti,"getRealPieData",function(e){var t=e.data,n=e.children,a=tr(e,!1),s=ys(n,Vd);return t&&t.length?t.map(function(i,l){return Gr(Gr(Gr({payload:i},a),i),s&&s[l]&&s[l].props)}):s&&s.length?s.map(function(i){return Gr(Gr({},a),i.props)}):[]});ps(ti,"parseCoordinateOfPie",function(e,t){var n=t.top,a=t.left,s=t.width,i=t.height,l=AD(s,i),d=a+Aa(e.cx,s,s/2),u=n+Aa(e.cy,i,i/2),m=Aa(e.innerRadius,l,0),p=Aa(e.outerRadius,l,l*.8),f=e.maxRadius||Math.sqrt(s*s+i*i)/2;return{cx:d,cy:u,innerRadius:m,outerRadius:p,maxRadius:f}});ps(ti,"getComposedData",function(e){var t=e.item,n=e.offset,a=t.type.defaultProps!==void 0?Gr(Gr({},t.type.defaultProps),t.props):t.props,s=oh.getRealPieData(a);if(!s||!s.length)return null;var i=a.cornerRadius,l=a.startAngle,d=a.endAngle,u=a.paddingAngle,m=a.dataKey,p=a.nameKey,f=a.valueKey,g=a.tooltipType,N=Math.abs(a.minAngle),v=oh.parseCoordinateOfPie(a,n),w=oh.parseDeltaAngle(l,d),y=Math.abs(w),E=m;wr(m)&&wr(f)?(Ms(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),E="value"):wr(m)&&(Ms(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),E=f);var O=s.filter(function(F){return ya(F,E,0)!==0}).length,T=(y>=360?O:O-1)*u,A=y-O*N-T,I=s.reduce(function(F,R){var $=ya(R,E,0);return F+(jt($)?$:0)},0),C;if(I>0){var P;C=s.map(function(F,R){var $=ya(F,E,0),L=ya(F,p,R),G=(jt($)?$:0)/I,X;R?X=P.endAngle+ka(w)*u*($!==0?1:0):X=l;var me=X+ka(w)*(($!==0?N:0)+G*A),se=(X+me)/2,ee=(v.innerRadius+v.outerRadius)/2,W=[{name:L,value:$,payload:F,dataKey:E,type:g}],U=Jr(v.cx,v.cy,ee,se);return P=Gr(Gr(Gr({percent:G,cornerRadius:i,name:L,tooltipPayload:W,midAngle:se,middleRadius:ee,tooltipPosition:U},F),v),{},{value:ya(F,E),startAngle:X,endAngle:me,payload:F,paddingAngle:ka(w)*u}),P})}return Gr(Gr({},v),{},{sectors:C,data:s})});var Sb,sE;function dY(){if(sE)return Sb;sE=1;var e=Math.ceil,t=Math.max;function n(a,s,i,l){for(var d=-1,u=t(e((s-a)/(i||1)),0),m=Array(u);u--;)m[l?u:++d]=a,a+=i;return m}return Sb=n,Sb}var Cb,iE;function WD(){if(iE)return Cb;iE=1;var e=fT(),t=1/0,n=17976931348623157e292;function a(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var i=s<0?-1:1;return i*n}return s===s?s:0}return Cb=a,Cb}var kb,oE;function uY(){if(oE)return kb;oE=1;var e=dY(),t=Rf(),n=WD();function a(s){return function(i,l,d){return d&&typeof d!="number"&&t(i,l,d)&&(l=d=void 0),i=n(i),l===void 0?(l=i,i=0):l=n(l),d=d===void 0?i<l?1:-1:n(d),e(i,l,d,s)}}return kb=a,kb}var Ab,lE;function mY(){if(lE)return Ab;lE=1;var e=uY(),t=e();return Ab=t,Ab}var hY=mY();const Qh=Fr(hY);function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function cE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function dE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cE(Object(n),!0).forEach(function(a){YD(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function YD(e,t,n){return t=fY(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fY(e){var t=pY(e,"string");return gu(t)=="symbol"?t:t+""}function pY(e,t){if(gu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(gu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gY=["Webkit","Moz","O","ms"],xY=function(t,n){var a=t.replace(/(\w)/,function(i){return i.toUpperCase()}),s=gY.reduce(function(i,l){return dE(dE({},i),{},YD({},l+a,n))},{});return s[t]=n,s};function uc(e){"@babel/helpers - typeof";return uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uc(e)}function ef(){return ef=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ef.apply(this,arguments)}function uE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Ib(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uE(Object(n),!0).forEach(function(a){Ja(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function yY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,GD(a.key),a)}}function bY(e,t,n){return t&&mE(e.prototype,t),n&&mE(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vY(e,t,n){return t=tf(t),wY(e,KD()?Reflect.construct(t,n||[],tf(e).constructor):t.apply(e,n))}function wY(e,t){if(t&&(uc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jY(e)}function jY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KD=function(){return!!e})()}function tf(e){return tf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},tf(e)}function NY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g1(e,t)}function g1(e,t){return g1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},g1(e,t)}function Ja(e,t,n){return t=GD(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GD(e){var t=SY(e,"string");return uc(t)=="symbol"?t:t+""}function SY(e,t){if(uc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(uc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var CY=function(t){var n=t.data,a=t.startIndex,s=t.endIndex,i=t.x,l=t.width,d=t.travellerWidth;if(!n||!n.length)return{};var u=n.length,m=Td().domain(Qh(0,u)).range([i,i+l-d]),p=m.domain().map(function(f){return m(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:m(a),endX:m(s),scale:m,scaleValues:p}},hE=function(t){return t.changedTouches&&!!t.changedTouches.length},mc=(function(e){function t(n){var a;return yY(this,t),a=vY(this,t,[n]),Ja(a,"handleDrag",function(s){a.leaveTimer&&(clearTimeout(a.leaveTimer),a.leaveTimer=null),a.state.isTravellerMoving?a.handleTravellerMove(s):a.state.isSlideMoving&&a.handleSlideDrag(s)}),Ja(a,"handleTouchMove",function(s){s.changedTouches!=null&&s.changedTouches.length>0&&a.handleDrag(s.changedTouches[0])}),Ja(a,"handleDragEnd",function(){a.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var s=a.props,i=s.endIndex,l=s.onDragEnd,d=s.startIndex;l?.({endIndex:i,startIndex:d})}),a.detachDragEndListener()}),Ja(a,"handleLeaveWrapper",function(){(a.state.isTravellerMoving||a.state.isSlideMoving)&&(a.leaveTimer=window.setTimeout(a.handleDragEnd,a.props.leaveTimeOut))}),Ja(a,"handleEnterSlideOrTraveller",function(){a.setState({isTextActive:!0})}),Ja(a,"handleLeaveSlideOrTraveller",function(){a.setState({isTextActive:!1})}),Ja(a,"handleSlideDragStart",function(s){var i=hE(s)?s.changedTouches[0]:s;a.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),a.attachDragEndListener()}),a.travellerDragStartHandlers={startX:a.handleTravellerDragStart.bind(a,"startX"),endX:a.handleTravellerDragStart.bind(a,"endX")},a.state={},a}return NY(t,e),bY(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(a){var s=a.startX,i=a.endX,l=this.state.scaleValues,d=this.props,u=d.gap,m=d.data,p=m.length-1,f=Math.min(s,i),g=Math.max(s,i),N=t.getIndexInRange(l,f),v=t.getIndexInRange(l,g);return{startIndex:N-N%u,endIndex:v===p?p:v-v%u}}},{key:"getTextOfTick",value:function(a){var s=this.props,i=s.data,l=s.tickFormatter,d=s.dataKey,u=ya(i[a],d,a);return lr(l)?l(u,a):u}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(a){var s=this.state,i=s.slideMoveStartX,l=s.startX,d=s.endX,u=this.props,m=u.x,p=u.width,f=u.travellerWidth,g=u.startIndex,N=u.endIndex,v=u.onChange,w=a.pageX-i;w>0?w=Math.min(w,m+p-f-d,m+p-f-l):w<0&&(w=Math.max(w,m-l,m-d));var y=this.getIndex({startX:l+w,endX:d+w});(y.startIndex!==g||y.endIndex!==N)&&v&&v(y),this.setState({startX:l+w,endX:d+w,slideMoveStartX:a.pageX})}},{key:"handleTravellerDragStart",value:function(a,s){var i=hE(s)?s.changedTouches[0]:s;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:a,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(a){var s=this.state,i=s.brushMoveStartX,l=s.movingTravellerId,d=s.endX,u=s.startX,m=this.state[l],p=this.props,f=p.x,g=p.width,N=p.travellerWidth,v=p.onChange,w=p.gap,y=p.data,E={startX:this.state.startX,endX:this.state.endX},O=a.pageX-i;O>0?O=Math.min(O,f+g-N-m):O<0&&(O=Math.max(O,f-m)),E[l]=m+O;var T=this.getIndex(E),A=T.startIndex,I=T.endIndex,C=function(){var F=y.length-1;return l==="startX"&&(d>u?A%w===0:I%w===0)||d<u&&I===F||l==="endX"&&(d>u?I%w===0:A%w===0)||d>u&&I===F};this.setState(Ja(Ja({},l,m+O),"brushMoveStartX",a.pageX),function(){v&&C()&&v(T)})}},{key:"handleTravellerMoveKeyboard",value:function(a,s){var i=this,l=this.state,d=l.scaleValues,u=l.startX,m=l.endX,p=this.state[s],f=d.indexOf(p);if(f!==-1){var g=f+a;if(!(g===-1||g>=d.length)){var N=d[g];s==="startX"&&N>=m||s==="endX"&&N<=u||this.setState(Ja({},s,N),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var a=this.props,s=a.x,i=a.y,l=a.width,d=a.height,u=a.fill,m=a.stroke;return xe.createElement("rect",{stroke:m,fill:u,x:s,y:i,width:l,height:d})}},{key:"renderPanorama",value:function(){var a=this.props,s=a.x,i=a.y,l=a.width,d=a.height,u=a.data,m=a.children,p=a.padding,f=j.Children.only(m);return f?xe.cloneElement(f,{x:s,y:i,width:l,height:d,margin:p,compact:!0,data:u}):null}},{key:"renderTravellerLayer",value:function(a,s){var i,l,d=this,u=this.props,m=u.y,p=u.travellerWidth,f=u.height,g=u.traveller,N=u.ariaLabel,v=u.data,w=u.startIndex,y=u.endIndex,E=Math.max(a,this.props.x),O=Ib(Ib({},tr(this.props,!1)),{},{x:E,y:m,width:p,height:f}),T=N||"Min value: ".concat((i=v[w])===null||i===void 0?void 0:i.name,", Max value: ").concat((l=v[y])===null||l===void 0?void 0:l.name);return xe.createElement(Br,{tabIndex:0,role:"slider","aria-label":T,"aria-valuenow":a,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[s],onTouchStart:this.travellerDragStartHandlers[s],onKeyDown:function(I){["ArrowLeft","ArrowRight"].includes(I.key)&&(I.preventDefault(),I.stopPropagation(),d.handleTravellerMoveKeyboard(I.key==="ArrowRight"?1:-1,s))},onFocus:function(){d.setState({isTravellerFocused:!0})},onBlur:function(){d.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(g,O))}},{key:"renderSlide",value:function(a,s){var i=this.props,l=i.y,d=i.height,u=i.stroke,m=i.travellerWidth,p=Math.min(a,s)+m,f=Math.max(Math.abs(s-a)-m,0);return xe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:u,fillOpacity:.2,x:p,y:l,width:f,height:d})}},{key:"renderText",value:function(){var a=this.props,s=a.startIndex,i=a.endIndex,l=a.y,d=a.height,u=a.travellerWidth,m=a.stroke,p=this.state,f=p.startX,g=p.endX,N=5,v={pointerEvents:"none",fill:m};return xe.createElement(Br,{className:"recharts-brush-texts"},xe.createElement(rl,ef({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,g)-N,y:l+d/2},v),this.getTextOfTick(s)),xe.createElement(rl,ef({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,g)+u+N,y:l+d/2},v),this.getTextOfTick(i)))}},{key:"render",value:function(){var a=this.props,s=a.data,i=a.className,l=a.children,d=a.x,u=a.y,m=a.width,p=a.height,f=a.alwaysShowText,g=this.state,N=g.startX,v=g.endX,w=g.isTextActive,y=g.isSlideMoving,E=g.isTravellerMoving,O=g.isTravellerFocused;if(!s||!s.length||!jt(d)||!jt(u)||!jt(m)||!jt(p)||m<=0||p<=0)return null;var T=xr("recharts-brush",i),A=xe.Children.count(l)===1,I=xY("userSelect","none");return xe.createElement(Br,{className:T,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:I},this.renderBackground(),A&&this.renderPanorama(),this.renderSlide(N,v),this.renderTravellerLayer(N,"startX"),this.renderTravellerLayer(v,"endX"),(w||y||E||O||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(a){var s=a.x,i=a.y,l=a.width,d=a.height,u=a.stroke,m=Math.floor(i+d/2)-1;return xe.createElement(xe.Fragment,null,xe.createElement("rect",{x:s,y:i,width:l,height:d,fill:u,stroke:"none"}),xe.createElement("line",{x1:s+1,y1:m,x2:s+l-1,y2:m,fill:"none",stroke:"#fff"}),xe.createElement("line",{x1:s+1,y1:m+2,x2:s+l-1,y2:m+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(a,s){var i;return xe.isValidElement(a)?i=xe.cloneElement(a,s):lr(a)?i=a(s):i=t.renderDefaultTraveller(s),i}},{key:"getDerivedStateFromProps",value:function(a,s){var i=a.data,l=a.width,d=a.x,u=a.travellerWidth,m=a.updateId,p=a.startIndex,f=a.endIndex;if(i!==s.prevData||m!==s.prevUpdateId)return Ib({prevData:i,prevTravellerWidth:u,prevUpdateId:m,prevX:d,prevWidth:l},i&&i.length?CY({data:i,width:l,x:d,travellerWidth:u,startIndex:p,endIndex:f}):{scale:null,scaleValues:null});if(s.scale&&(l!==s.prevWidth||d!==s.prevX||u!==s.prevTravellerWidth)){s.scale.range([d,d+l-u]);var g=s.scale.domain().map(function(N){return s.scale(N)});return{prevData:i,prevTravellerWidth:u,prevUpdateId:m,prevX:d,prevWidth:l,startX:s.scale(a.startIndex),endX:s.scale(a.endIndex),scaleValues:g}}return null}},{key:"getIndexInRange",value:function(a,s){for(var i=a.length,l=0,d=i-1;d-l>1;){var u=Math.floor((l+d)/2);a[u]>s?d=u:l=u}return s>=a[d]?d:l}}])})(j.PureComponent);Ja(mc,"displayName","Brush");Ja(mc,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Eb,fE;function kY(){if(fE)return Eb;fE=1;var e=Aw();function t(n,a){var s;return e(n,function(i,l,d){return s=a(i,l,d),!s}),!!s}return Eb=t,Eb}var Pb,pE;function AY(){if(pE)return Pb;pE=1;var e=VP(),t=si(),n=kY(),a=qa(),s=Rf();function i(l,d,u){var m=a(l)?e:n;return u&&s(l,d,u)&&(d=void 0),m(l,t(d,3))}return Pb=i,Pb}var IY=AY();const EY=Fr(IY);var Js=function(t,n){var a=t.alwaysShow,s=t.ifOverflow;return a&&(s="extendDomain"),s===n},Tb,gE;function PY(){if(gE)return Tb;gE=1;var e=cT();function t(n,a,s){a=="__proto__"&&e?e(n,a,{configurable:!0,enumerable:!0,value:s,writable:!0}):n[a]=s}return Tb=t,Tb}var Db,xE;function TY(){if(xE)return Db;xE=1;var e=PY(),t=oT(),n=si();function a(s,i){var l={};return i=n(i,3),t(s,function(d,u,m){e(l,u,i(d,u,m))}),l}return Db=a,Db}var DY=TY();const OY=Fr(DY);var Ob,yE;function _Y(){if(yE)return Ob;yE=1;function e(t,n){for(var a=-1,s=t==null?0:t.length;++a<s;)if(!n(t[a],a,t))return!1;return!0}return Ob=e,Ob}var _b,bE;function MY(){if(bE)return _b;bE=1;var e=Aw();function t(n,a){var s=!0;return e(n,function(i,l,d){return s=!!a(i,l,d),s}),s}return _b=t,_b}var Mb,vE;function RY(){if(vE)return Mb;vE=1;var e=_Y(),t=MY(),n=si(),a=qa(),s=Rf();function i(l,d,u){var m=a(l)?e:t;return u&&s(l,d,u)&&(d=void 0),m(l,n(d,3))}return Mb=i,Mb}var $Y=RY();const XD=Fr($Y);var LY=["x","y"];function xu(e){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xu(e)}function x1(){return x1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},x1.apply(this,arguments)}function wE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function wd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wE(Object(n),!0).forEach(function(a){FY(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function FY(e,t,n){return t=BY(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BY(e){var t=UY(e,"string");return xu(t)=="symbol"?t:t+""}function UY(e,t){if(xu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(xu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zY(e,t){if(e==null)return{};var n=qY(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function qY(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function HY(e,t){var n=e.x,a=e.y,s=zY(e,LY),i="".concat(n),l=parseInt(i,10),d="".concat(a),u=parseInt(d,10),m="".concat(t.height||s.height),p=parseInt(m,10),f="".concat(t.width||s.width),g=parseInt(f,10);return wd(wd(wd(wd(wd({},t),s),l?{x:l}:{}),u?{y:u}:{}),{},{height:p,width:g,name:t.name,radius:t.radius})}function jE(e){return xe.createElement(qD,x1({shapeType:"rectangle",propTransformer:HY,activeClassName:"recharts-active-bar"},e))}var VY=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(a,s){if(typeof t=="number")return t;var i=jt(a)||p$(a);return i?t(a,s):(i||al(),n)}},WY=["value","background"],JD;function hc(e){"@babel/helpers - typeof";return hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hc(e)}function YY(e,t){if(e==null)return{};var n=KY(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function KY(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function rf(){return rf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},rf.apply(this,arguments)}function NE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function An(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NE(Object(n),!0).forEach(function(a){oo(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function GY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,QD(a.key),a)}}function XY(e,t,n){return t&&SE(e.prototype,t),n&&SE(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function JY(e,t,n){return t=nf(t),ZY(e,ZD()?Reflect.construct(t,n||[],nf(e).constructor):t.apply(e,n))}function ZY(e,t){if(t&&(hc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QY(e)}function QY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZD=function(){return!!e})()}function nf(e){return nf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},nf(e)}function eK(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y1(e,t)}function y1(e,t){return y1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},y1(e,t)}function oo(e,t,n){return t=QD(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QD(e){var t=tK(e,"string");return hc(t)=="symbol"?t:t+""}function tK(e,t){if(hc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(hc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ho=(function(e){function t(){var n;GY(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return n=JY(this,t,[].concat(s)),oo(n,"state",{isAnimationFinished:!1}),oo(n,"id",Tu("recharts-bar-")),oo(n,"handleAnimationEnd",function(){var l=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),l&&l()}),oo(n,"handleAnimationStart",function(){var l=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),l&&l()}),n}return eK(t,e),XY(t,[{key:"renderRectanglesStatically",value:function(a){var s=this,i=this.props,l=i.shape,d=i.dataKey,u=i.activeIndex,m=i.activeBar,p=tr(this.props,!1);return a&&a.map(function(f,g){var N=g===u,v=N?m:l,w=An(An(An({},p),f),{},{isActive:N,option:v,index:g,dataKey:d,onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd});return xe.createElement(Br,rf({className:"recharts-bar-rectangle"},tl(s.props,f,g),{key:"rectangle-".concat(f?.x,"-").concat(f?.y,"-").concat(f?.value,"-").concat(g)}),xe.createElement(jE,w))})}},{key:"renderRectanglesWithAnimation",value:function(){var a=this,s=this.props,i=s.data,l=s.layout,d=s.isAnimationActive,u=s.animationBegin,m=s.animationDuration,p=s.animationEasing,f=s.animationId,g=this.state.prevData;return xe.createElement(Di,{begin:u,duration:m,isActive:d,easing:p,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(N){var v=N.t,w=i.map(function(y,E){var O=g&&g[E];if(O){var T=ro(O.x,y.x),A=ro(O.y,y.y),I=ro(O.width,y.width),C=ro(O.height,y.height);return An(An({},y),{},{x:T(v),y:A(v),width:I(v),height:C(v)})}if(l==="horizontal"){var P=ro(0,y.height),F=P(v);return An(An({},y),{},{y:y.y+y.height-F,height:F})}var R=ro(0,y.width),$=R(v);return An(An({},y),{},{width:$})});return xe.createElement(Br,null,a.renderRectanglesStatically(w))})}},{key:"renderRectangles",value:function(){var a=this.props,s=a.data,i=a.isAnimationActive,l=this.state.prevData;return i&&s&&s.length&&(!l||!Wf(l,s))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(s)}},{key:"renderBackground",value:function(){var a=this,s=this.props,i=s.data,l=s.dataKey,d=s.activeIndex,u=tr(this.props.background,!1);return i.map(function(m,p){m.value;var f=m.background,g=YY(m,WY);if(!f)return null;var N=An(An(An(An(An({},g),{},{fill:"#eee"},f),u),tl(a.props,m,p)),{},{onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd,dataKey:l,index:p,className:"recharts-bar-background-rectangle"});return xe.createElement(jE,rf({key:"background-bar-".concat(p),option:a.props.background,isActive:p===d},N))})}},{key:"renderErrorBar",value:function(a,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,l=i.data,d=i.xAxis,u=i.yAxis,m=i.layout,p=i.children,f=ys(p,Gf);if(!f)return null;var g=m==="vertical"?l[0].height/2:l[0].width/2,N=function(y,E){var O=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:O,errorVal:ya(y,E)}},v={clipPath:a?"url(#clipPath-".concat(s,")"):null};return xe.createElement(Br,v,f.map(function(w){return xe.cloneElement(w,{key:"error-bar-".concat(s,"-").concat(w.props.dataKey),data:l,xAxis:d,yAxis:u,layout:m,offset:g,dataPointFormatter:N})}))}},{key:"render",value:function(){var a=this.props,s=a.hide,i=a.data,l=a.className,d=a.xAxis,u=a.yAxis,m=a.left,p=a.top,f=a.width,g=a.height,N=a.isAnimationActive,v=a.background,w=a.id;if(s||!i||!i.length)return null;var y=this.state.isAnimationFinished,E=xr("recharts-bar",l),O=d&&d.allowDataOverflow,T=u&&u.allowDataOverflow,A=O||T,I=wr(w)?this.id:w;return xe.createElement(Br,{className:E},O||T?xe.createElement("defs",null,xe.createElement("clipPath",{id:"clipPath-".concat(I)},xe.createElement("rect",{x:O?m:m-f/2,y:T?p:p-g/2,width:O?f:f*2,height:T?g:g*2}))):null,xe.createElement(Br,{className:"recharts-bar-rectangles",clipPath:A?"url(#clipPath-".concat(I,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(A,I),(!N||y)&&uo.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(a,s){return a.animationId!==s.prevAnimationId?{prevAnimationId:a.animationId,curData:a.data,prevData:s.curData}:a.data!==s.curData?{curData:a.data}:null}}])})(j.PureComponent);JD=ho;oo(ho,"displayName","Bar");oo(ho,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Ec.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});oo(ho,"getComposedData",function(e){var t=e.props,n=e.item,a=e.barPosition,s=e.bandSize,i=e.xAxis,l=e.yAxis,d=e.xAxisTicks,u=e.yAxisTicks,m=e.stackedData,p=e.dataStartIndex,f=e.displayedData,g=e.offset,N=Ez(a,n);if(!N)return null;var v=t.layout,w=n.type.defaultProps,y=w!==void 0?An(An({},w),n.props):n.props,E=y.dataKey,O=y.children,T=y.minPointSize,A=v==="horizontal"?l:i,I=m?A.scale.domain():null,C=Rz({numericAxis:A}),P=ys(O,Vd),F=f.map(function(R,$){var L,G,X,me,se,ee;m?L=Pz(m[p+$],I):(L=ya(R,E),Array.isArray(L)||(L=[C,L]));var W=VY(T,JD.defaultProps.minPointSize)(L[1],$);if(v==="horizontal"){var U,Q=[l.scale(L[0]),l.scale(L[1])],Y=Q[0],H=Q[1];G=GI({axis:i,ticks:d,bandSize:s,offset:N.offset,entry:R,index:$}),X=(U=H??Y)!==null&&U!==void 0?U:void 0,me=N.size;var te=Y-H;if(se=Number.isNaN(te)?0:te,ee={x:G,y:l.y,width:me,height:l.height},Math.abs(W)>0&&Math.abs(se)<Math.abs(W)){var fe=ka(se||W)*(Math.abs(W)-Math.abs(se));X-=fe,se+=fe}}else{var Le=[i.scale(L[0]),i.scale(L[1])],he=Le[0],K=Le[1];if(G=he,X=GI({axis:l,ticks:u,bandSize:s,offset:N.offset,entry:R,index:$}),me=K-he,se=N.size,ee={x:i.x,y:X,width:i.width,height:se},Math.abs(W)>0&&Math.abs(me)<Math.abs(W)){var be=ka(me||W)*(Math.abs(W)-Math.abs(me));me+=be}}return An(An(An({},R),{},{x:G,y:X,width:me,height:se,value:m?L:L[1],payload:R,background:ee},P&&P[$]&&P[$].props),{},{tooltipPayload:[CD(n,R)],tooltipPosition:{x:G+me/2,y:X+se/2}})});return An({data:F,layout:v},g)});function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function rK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,eO(a.key),a)}}function nK(e,t,n){return t&&CE(e.prototype,t),n&&CE(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Ps(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kE(Object(n),!0).forEach(function(a){rp(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function rp(e,t,n){return t=eO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eO(e){var t=aK(e,"string");return yu(t)=="symbol"?t:t+""}function aK(e,t){if(yu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(yu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sK=function(t,n,a,s,i){var l=t.width,d=t.height,u=t.layout,m=t.children,p=Object.keys(n),f={left:a.left,leftMirror:a.left,right:l-a.right,rightMirror:l-a.right,top:a.top,topMirror:a.top,bottom:d-a.bottom,bottomMirror:d-a.bottom},g=!!Za(m,ho);return p.reduce(function(N,v){var w=n[v],y=w.orientation,E=w.domain,O=w.padding,T=O===void 0?{}:O,A=w.mirror,I=w.reversed,C="".concat(y).concat(A?"Mirror":""),P,F,R,$,L;if(w.type==="number"&&(w.padding==="gap"||w.padding==="no-gap")){var G=E[1]-E[0],X=1/0,me=w.categoricalDomain.sort(y$);if(me.forEach(function(Le,he){he>0&&(X=Math.min((Le||0)-(me[he-1]||0),X))}),Number.isFinite(X)){var se=X/G,ee=w.layout==="vertical"?a.height:a.width;if(w.padding==="gap"&&(P=se*ee/2),w.padding==="no-gap"){var W=Aa(t.barCategoryGap,se*ee),U=se*ee/2;P=U-W-(U-W)/ee*W}}}s==="xAxis"?F=[a.left+(T.left||0)+(P||0),a.left+a.width-(T.right||0)-(P||0)]:s==="yAxis"?F=u==="horizontal"?[a.top+a.height-(T.bottom||0),a.top+(T.top||0)]:[a.top+(T.top||0)+(P||0),a.top+a.height-(T.bottom||0)-(P||0)]:F=w.range,I&&(F=[F[1],F[0]]);var Q=wD(w,i,g),Y=Q.scale,H=Q.realScaleType;Y.domain(E).range(F),jD(Y);var te=ND(Y,Ps(Ps({},w),{},{realScaleType:H}));s==="xAxis"?(L=y==="top"&&!A||y==="bottom"&&A,R=a.left,$=f[C]-L*w.height):s==="yAxis"&&(L=y==="left"&&!A||y==="right"&&A,R=f[C]-L*w.width,$=a.top);var fe=Ps(Ps(Ps({},w),te),{},{realScaleType:H,x:R,y:$,scale:Y,width:s==="xAxis"?a.width:w.width,height:s==="yAxis"?a.height:w.height});return fe.bandSize=Uh(fe,te),!w.hide&&s==="xAxis"?f[C]+=(L?-1:1)*fe.height:w.hide||(f[C]+=(L?-1:1)*fe.width),Ps(Ps({},N),{},rp({},v,fe))},{})},tO=function(t,n){var a=t.x,s=t.y,i=n.x,l=n.y;return{x:Math.min(a,i),y:Math.min(s,l),width:Math.abs(i-a),height:Math.abs(l-s)}},iK=function(t){var n=t.x1,a=t.y1,s=t.x2,i=t.y2;return tO({x:n,y:a},{x:s,y:i})},rO=(function(){function e(t){rK(this,e),this.scale=t}return nK(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.bandAware,i=a.position;if(n!==void 0){if(i)switch(i){case"start":return this.scale(n);case"middle":{var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+l}case"end":{var d=this.bandwidth?this.bandwidth():0;return this.scale(n)+d}default:return this.scale(n)}if(s){var u=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+u}return this.scale(n)}}},{key:"isInRange",value:function(n){var a=this.range(),s=a[0],i=a[a.length-1];return s<=i?n>=s&&n<=i:n>=i&&n<=s}}],[{key:"create",value:function(n){return new e(n)}}])})();rp(rO,"EPS",1e-4);var nj=function(t){var n=Object.keys(t).reduce(function(a,s){return Ps(Ps({},a),{},rp({},s,rO.create(t[s])))},{});return Ps(Ps({},n),{},{apply:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=i.bandAware,d=i.position;return OY(s,function(u,m){return n[m].apply(u,{bandAware:l,position:d})})},isInRange:function(s){return XD(s,function(i,l){return n[l].isInRange(i)})}})};function oK(e){return(e%180+180)%180}var lK=function(t){var n=t.width,a=t.height,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=oK(s),l=i*Math.PI/180,d=Math.atan(a/n),u=l>d&&l<Math.PI-d?a/Math.sin(l):n/Math.cos(l);return Math.abs(u)},Rb,AE;function cK(){if(AE)return Rb;AE=1;var e=si(),t=Du(),n=_f();function a(s){return function(i,l,d){var u=Object(i);if(!t(i)){var m=e(l,3);i=n(i),l=function(f){return m(u[f],f,u)}}var p=s(i,l,d);return p>-1?u[m?i[p]:p]:void 0}}return Rb=a,Rb}var $b,IE;function dK(){if(IE)return $b;IE=1;var e=WD();function t(n){var a=e(n),s=a%1;return a===a?s?a-s:a:0}return $b=t,$b}var Lb,EE;function uK(){if(EE)return Lb;EE=1;var e=rT(),t=si(),n=dK(),a=Math.max;function s(i,l,d){var u=i==null?0:i.length;if(!u)return-1;var m=d==null?0:n(d);return m<0&&(m=a(u+m,0)),e(i,t(l,3),m)}return Lb=s,Lb}var Fb,PE;function mK(){if(PE)return Fb;PE=1;var e=cK(),t=uK(),n=e(t);return Fb=n,Fb}var hK=mK();const fK=Fr(hK);var pK=yP();const gK=Fr(pK);var xK=gK(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),aj=j.createContext(void 0),sj=j.createContext(void 0),nO=j.createContext(void 0),aO=j.createContext({}),sO=j.createContext(void 0),iO=j.createContext(0),oO=j.createContext(0),TE=function(t){var n=t.state,a=n.xAxisMap,s=n.yAxisMap,i=n.offset,l=t.clipPathId,d=t.children,u=t.width,m=t.height,p=xK(i);return xe.createElement(aj.Provider,{value:a},xe.createElement(sj.Provider,{value:s},xe.createElement(aO.Provider,{value:i},xe.createElement(nO.Provider,{value:p},xe.createElement(sO.Provider,{value:l},xe.createElement(iO.Provider,{value:m},xe.createElement(oO.Provider,{value:u},d)))))))},yK=function(){return j.useContext(sO)},lO=function(t){var n=j.useContext(aj);n==null&&al();var a=n[t];return a==null&&al(),a},bK=function(){var t=j.useContext(aj);return ao(t)},vK=function(){var t=j.useContext(sj),n=fK(t,function(a){return XD(a.domain,Number.isFinite)});return n||ao(t)},cO=function(t){var n=j.useContext(sj);n==null&&al();var a=n[t];return a==null&&al(),a},wK=function(){var t=j.useContext(nO);return t},jK=function(){return j.useContext(aO)},ij=function(){return j.useContext(oO)},oj=function(){return j.useContext(iO)};function fc(e){"@babel/helpers - typeof";return fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fc(e)}function NK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SK(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,uO(a.key),a)}}function CK(e,t,n){return t&&SK(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kK(e,t,n){return t=af(t),AK(e,dO()?Reflect.construct(t,n||[],af(e).constructor):t.apply(e,n))}function AK(e,t){if(t&&(fc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IK(e)}function IK(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dO=function(){return!!e})()}function af(e){return af=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},af(e)}function EK(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b1(e,t)}function b1(e,t){return b1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},b1(e,t)}function DE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function OE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?DE(Object(n),!0).forEach(function(a){lj(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function lj(e,t,n){return t=uO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uO(e){var t=PK(e,"string");return fc(t)=="symbol"?t:t+""}function PK(e,t){if(fc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(fc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function TK(e,t){return MK(e)||_K(e,t)||OK(e,t)||DK()}function DK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OK(e,t){if(e){if(typeof e=="string")return _E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _E(e,t)}}function _E(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _K(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function MK(e){if(Array.isArray(e))return e}function v1(){return v1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},v1.apply(this,arguments)}var RK=function(t,n){var a;return xe.isValidElement(t)?a=xe.cloneElement(t,n):lr(t)?a=t(n):a=xe.createElement("line",v1({},n,{className:"recharts-reference-line-line"})),a},$K=function(t,n,a,s,i,l,d,u,m){var p=i.x,f=i.y,g=i.width,N=i.height;if(a){var v=m.y,w=t.y.apply(v,{position:l});if(Js(m,"discard")&&!t.y.isInRange(w))return null;var y=[{x:p+g,y:w},{x:p,y:w}];return u==="left"?y.reverse():y}if(n){var E=m.x,O=t.x.apply(E,{position:l});if(Js(m,"discard")&&!t.x.isInRange(O))return null;var T=[{x:O,y:f+N},{x:O,y:f}];return d==="top"?T.reverse():T}if(s){var A=m.segment,I=A.map(function(C){return t.apply(C,{position:l})});return Js(m,"discard")&&EY(I,function(C){return!t.isInRange(C)})?null:I}return null};function LK(e){var t=e.x,n=e.y,a=e.segment,s=e.xAxisId,i=e.yAxisId,l=e.shape,d=e.className,u=e.alwaysShow,m=yK(),p=lO(s),f=cO(i),g=wK();if(!m||!g)return null;Ms(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var N=nj({x:p.scale,y:f.scale}),v=Rn(t),w=Rn(n),y=a&&a.length===2,E=$K(N,v,w,y,g,e.position,p.orientation,f.orientation,e);if(!E)return null;var O=TK(E,2),T=O[0],A=T.x,I=T.y,C=O[1],P=C.x,F=C.y,R=Js(e,"hidden")?"url(#".concat(m,")"):void 0,$=OE(OE({clipPath:R},tr(e,!0)),{},{x1:A,y1:I,x2:P,y2:F});return xe.createElement(Br,{className:xr("recharts-reference-line",d)},RK(l,$),Jn.renderCallByParent(e,iK({x1:A,y1:I,x2:P,y2:F})))}var cj=(function(e){function t(){return NK(this,t),kK(this,t,arguments)}return EK(t,e),CK(t,[{key:"render",value:function(){return xe.createElement(LK,this.props)}}])})(xe.Component);lj(cj,"displayName","ReferenceLine");lj(cj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function w1(){return w1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},w1.apply(this,arguments)}function pc(e){"@babel/helpers - typeof";return pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pc(e)}function ME(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function RE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ME(Object(n),!0).forEach(function(a){np(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ME(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function FK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BK(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,hO(a.key),a)}}function UK(e,t,n){return t&&BK(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zK(e,t,n){return t=sf(t),qK(e,mO()?Reflect.construct(t,n||[],sf(e).constructor):t.apply(e,n))}function qK(e,t){if(t&&(pc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HK(e)}function HK(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mO=function(){return!!e})()}function sf(e){return sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},sf(e)}function VK(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j1(e,t)}function j1(e,t){return j1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},j1(e,t)}function np(e,t,n){return t=hO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hO(e){var t=WK(e,"string");return pc(t)=="symbol"?t:t+""}function WK(e,t){if(pc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(pc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var YK=function(t){var n=t.x,a=t.y,s=t.xAxis,i=t.yAxis,l=nj({x:s.scale,y:i.scale}),d=l.apply({x:n,y:a},{bandAware:!0});return Js(t,"discard")&&!l.isInRange(d)?null:d},ap=(function(e){function t(){return FK(this,t),zK(this,t,arguments)}return VK(t,e),UK(t,[{key:"render",value:function(){var a=this.props,s=a.x,i=a.y,l=a.r,d=a.alwaysShow,u=a.clipPathId,m=Rn(s),p=Rn(i);if(Ms(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!m||!p)return null;var f=YK(this.props);if(!f)return null;var g=f.x,N=f.y,v=this.props,w=v.shape,y=v.className,E=Js(this.props,"hidden")?"url(#".concat(u,")"):void 0,O=RE(RE({clipPath:E},tr(this.props,!0)),{},{cx:g,cy:N});return xe.createElement(Br,{className:xr("recharts-reference-dot",y)},t.renderDot(w,O),Jn.renderCallByParent(this.props,{x:g-l,y:N-l,width:2*l,height:2*l}))}}])})(xe.Component);np(ap,"displayName","ReferenceDot");np(ap,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});np(ap,"renderDot",function(e,t){var n;return xe.isValidElement(e)?n=xe.cloneElement(e,t):lr(e)?n=e(t):n=xe.createElement(rj,w1({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function N1(){return N1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},N1.apply(this,arguments)}function gc(e){"@babel/helpers - typeof";return gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gc(e)}function $E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function LE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$E(Object(n),!0).forEach(function(a){sp(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$E(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function KK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GK(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,pO(a.key),a)}}function XK(e,t,n){return t&&GK(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function JK(e,t,n){return t=of(t),ZK(e,fO()?Reflect.construct(t,n||[],of(e).constructor):t.apply(e,n))}function ZK(e,t){if(t&&(gc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QK(e)}function QK(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fO=function(){return!!e})()}function of(e){return of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},of(e)}function eG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S1(e,t)}function S1(e,t){return S1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},S1(e,t)}function sp(e,t,n){return t=pO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pO(e){var t=tG(e,"string");return gc(t)=="symbol"?t:t+""}function tG(e,t){if(gc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(gc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var rG=function(t,n,a,s,i){var l=i.x1,d=i.x2,u=i.y1,m=i.y2,p=i.xAxis,f=i.yAxis;if(!p||!f)return null;var g=nj({x:p.scale,y:f.scale}),N={x:t?g.x.apply(l,{position:"start"}):g.x.rangeMin,y:a?g.y.apply(u,{position:"start"}):g.y.rangeMin},v={x:n?g.x.apply(d,{position:"end"}):g.x.rangeMax,y:s?g.y.apply(m,{position:"end"}):g.y.rangeMax};return Js(i,"discard")&&(!g.isInRange(N)||!g.isInRange(v))?null:tO(N,v)},ip=(function(e){function t(){return KK(this,t),JK(this,t,arguments)}return eG(t,e),XK(t,[{key:"render",value:function(){var a=this.props,s=a.x1,i=a.x2,l=a.y1,d=a.y2,u=a.className,m=a.alwaysShow,p=a.clipPathId;Ms(m===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Rn(s),g=Rn(i),N=Rn(l),v=Rn(d),w=this.props.shape;if(!f&&!g&&!N&&!v&&!w)return null;var y=rG(f,g,N,v,this.props);if(!y&&!w)return null;var E=Js(this.props,"hidden")?"url(#".concat(p,")"):void 0;return xe.createElement(Br,{className:xr("recharts-reference-area",u)},t.renderRect(w,LE(LE({clipPath:E},tr(this.props,!0)),y)),Jn.renderCallByParent(this.props,y))}}])})(xe.Component);sp(ip,"displayName","ReferenceArea");sp(ip,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});sp(ip,"renderRect",function(e,t){var n;return xe.isValidElement(e)?n=xe.cloneElement(e,t):lr(e)?n=e(t):n=xe.createElement(tj,N1({},t,{className:"recharts-reference-area-rect"})),n});function gO(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var a=[],s=0;s<e.length;s+=t)a.push(e[s]);return a}function nG(e,t,n){var a={width:e.width+t.width,height:e.height+t.height};return lK(a,n)}function aG(e,t,n){var a=n==="width",s=e.x,i=e.y,l=e.width,d=e.height;return t===1?{start:a?s:i,end:a?s+l:i+d}:{start:a?s+l:i+d,end:a?s:i}}function lf(e,t,n,a,s){if(e*t<e*a||e*t>e*s)return!1;var i=n();return e*(t-e*i/2-a)>=0&&e*(t+e*i/2-s)<=0}function sG(e,t){return gO(e,t+1)}function iG(e,t,n,a,s){for(var i=(a||[]).slice(),l=t.start,d=t.end,u=0,m=1,p=l,f=function(){var v=a?.[u];if(v===void 0)return{v:gO(a,m)};var w=u,y,E=function(){return y===void 0&&(y=n(v,w)),y},O=v.coordinate,T=u===0||lf(e,O,E,p,d);T||(u=0,p=l,m+=1),T&&(p=O+e*(E()/2+s),u+=m)},g;m<=i.length;)if(g=f(),g)return g.v;return[]}function bu(e){"@babel/helpers - typeof";return bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(e)}function FE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function fa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FE(Object(n),!0).forEach(function(a){oG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function oG(e,t,n){return t=lG(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lG(e){var t=cG(e,"string");return bu(t)=="symbol"?t:t+""}function cG(e,t){if(bu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(bu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dG(e,t,n,a,s){for(var i=(a||[]).slice(),l=i.length,d=t.start,u=t.end,m=function(g){var N=i[g],v,w=function(){return v===void 0&&(v=n(N,g)),v};if(g===l-1){var y=e*(N.coordinate+e*w()/2-u);i[g]=N=fa(fa({},N),{},{tickCoord:y>0?N.coordinate-y*e:N.coordinate})}else i[g]=N=fa(fa({},N),{},{tickCoord:N.coordinate});var E=lf(e,N.tickCoord,w,d,u);E&&(u=N.tickCoord-e*(w()/2+s),i[g]=fa(fa({},N),{},{isShow:!0}))},p=l-1;p>=0;p--)m(p);return i}function uG(e,t,n,a,s,i){var l=(a||[]).slice(),d=l.length,u=t.start,m=t.end;if(i){var p=a[d-1],f=n(p,d-1),g=e*(p.coordinate+e*f/2-m);l[d-1]=p=fa(fa({},p),{},{tickCoord:g>0?p.coordinate-g*e:p.coordinate});var N=lf(e,p.tickCoord,function(){return f},u,m);N&&(m=p.tickCoord-e*(f/2+s),l[d-1]=fa(fa({},p),{},{isShow:!0}))}for(var v=i?d-1:d,w=function(O){var T=l[O],A,I=function(){return A===void 0&&(A=n(T,O)),A};if(O===0){var C=e*(T.coordinate-e*I()/2-u);l[O]=T=fa(fa({},T),{},{tickCoord:C<0?T.coordinate-C*e:T.coordinate})}else l[O]=T=fa(fa({},T),{},{tickCoord:T.coordinate});var P=lf(e,T.tickCoord,I,u,m);P&&(u=T.tickCoord+e*(I()/2+s),l[O]=fa(fa({},T),{},{isShow:!0}))},y=0;y<v;y++)w(y);return l}function dj(e,t,n){var a=e.tick,s=e.ticks,i=e.viewBox,l=e.minTickGap,d=e.orientation,u=e.interval,m=e.tickFormatter,p=e.unit,f=e.angle;if(!s||!s.length||!a)return[];if(jt(u)||Ec.isSsr)return sG(s,typeof u=="number"&&jt(u)?u:0);var g=[],N=d==="top"||d==="bottom"?"width":"height",v=p&&N==="width"?Pd(p,{fontSize:t,letterSpacing:n}):{width:0,height:0},w=function(T,A){var I=lr(m)?m(T.value,A):T.value;return N==="width"?nG(Pd(I,{fontSize:t,letterSpacing:n}),v,f):Pd(I,{fontSize:t,letterSpacing:n})[N]},y=s.length>=2?ka(s[1].coordinate-s[0].coordinate):1,E=aG(i,y,N);return u==="equidistantPreserveStart"?iG(y,E,w,s,l):(u==="preserveStart"||u==="preserveStartEnd"?g=uG(y,E,w,s,l,u==="preserveStartEnd"):g=dG(y,E,w,s,l),g.filter(function(O){return O.isShow}))}var mG=["viewBox"],hG=["viewBox"],fG=["ticks"];function xc(e){"@babel/helpers - typeof";return xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xc(e)}function zl(){return zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},zl.apply(this,arguments)}function BE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function _n(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?BE(Object(n),!0).forEach(function(a){uj(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Bb(e,t){if(e==null)return{};var n=pG(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function pG(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function gG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,yO(a.key),a)}}function xG(e,t,n){return t&&UE(e.prototype,t),n&&UE(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function yG(e,t,n){return t=cf(t),bG(e,xO()?Reflect.construct(t,n||[],cf(e).constructor):t.apply(e,n))}function bG(e,t){if(t&&(xc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vG(e)}function vG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xO=function(){return!!e})()}function cf(e){return cf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},cf(e)}function wG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C1(e,t)}function C1(e,t){return C1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},C1(e,t)}function uj(e,t,n){return t=yO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yO(e){var t=jG(e,"string");return xc(t)=="symbol"?t:t+""}function jG(e,t){if(xc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(xc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Oc=(function(e){function t(n){var a;return gG(this,t),a=yG(this,t,[n]),a.state={fontSize:"",letterSpacing:""},a}return wG(t,e),xG(t,[{key:"shouldComponentUpdate",value:function(a,s){var i=a.viewBox,l=Bb(a,mG),d=this.props,u=d.viewBox,m=Bb(d,hG);return!Vl(i,u)||!Vl(l,m)||!Vl(s,this.state)}},{key:"componentDidMount",value:function(){var a=this.layerReference;if(a){var s=a.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];s&&this.setState({fontSize:window.getComputedStyle(s).fontSize,letterSpacing:window.getComputedStyle(s).letterSpacing})}}},{key:"getTickLineCoord",value:function(a){var s=this.props,i=s.x,l=s.y,d=s.width,u=s.height,m=s.orientation,p=s.tickSize,f=s.mirror,g=s.tickMargin,N,v,w,y,E,O,T=f?-1:1,A=a.tickSize||p,I=jt(a.tickCoord)?a.tickCoord:a.coordinate;switch(m){case"top":N=v=a.coordinate,y=l+ +!f*u,w=y-T*A,O=w-T*g,E=I;break;case"left":w=y=a.coordinate,v=i+ +!f*d,N=v-T*A,E=N-T*g,O=I;break;case"right":w=y=a.coordinate,v=i+ +f*d,N=v+T*A,E=N+T*g,O=I;break;default:N=v=a.coordinate,y=l+ +f*u,w=y+T*A,O=w+T*g,E=I;break}return{line:{x1:N,y1:w,x2:v,y2:y},tick:{x:E,y:O}}}},{key:"getTickTextAnchor",value:function(){var a=this.props,s=a.orientation,i=a.mirror,l;switch(s){case"left":l=i?"start":"end";break;case"right":l=i?"end":"start";break;default:l="middle";break}return l}},{key:"getTickVerticalAnchor",value:function(){var a=this.props,s=a.orientation,i=a.mirror,l="end";switch(s){case"left":case"right":l="middle";break;case"top":l=i?"start":"end";break;default:l=i?"end":"start";break}return l}},{key:"renderAxisLine",value:function(){var a=this.props,s=a.x,i=a.y,l=a.width,d=a.height,u=a.orientation,m=a.mirror,p=a.axisLine,f=_n(_n(_n({},tr(this.props,!1)),tr(p,!1)),{},{fill:"none"});if(u==="top"||u==="bottom"){var g=+(u==="top"&&!m||u==="bottom"&&m);f=_n(_n({},f),{},{x1:s,y1:i+g*d,x2:s+l,y2:i+g*d})}else{var N=+(u==="left"&&!m||u==="right"&&m);f=_n(_n({},f),{},{x1:s+N*l,y1:i,x2:s+N*l,y2:i+d})}return xe.createElement("line",zl({},f,{className:xr("recharts-cartesian-axis-line",ts(p,"className"))}))}},{key:"renderTicks",value:function(a,s,i){var l=this,d=this.props,u=d.tickLine,m=d.stroke,p=d.tick,f=d.tickFormatter,g=d.unit,N=dj(_n(_n({},this.props),{},{ticks:a}),s,i),v=this.getTickTextAnchor(),w=this.getTickVerticalAnchor(),y=tr(this.props,!1),E=tr(p,!1),O=_n(_n({},y),{},{fill:"none"},tr(u,!1)),T=N.map(function(A,I){var C=l.getTickLineCoord(A),P=C.line,F=C.tick,R=_n(_n(_n(_n({textAnchor:v,verticalAnchor:w},y),{},{stroke:"none",fill:m},E),F),{},{index:I,payload:A,visibleTicksCount:N.length,tickFormatter:f});return xe.createElement(Br,zl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(A.value,"-").concat(A.coordinate,"-").concat(A.tickCoord)},tl(l.props,A,I)),u&&xe.createElement("line",zl({},O,P,{className:xr("recharts-cartesian-axis-tick-line",ts(u,"className"))})),p&&t.renderTickItem(p,R,"".concat(lr(f)?f(A.value,I):A.value).concat(g||"")))});return xe.createElement("g",{className:"recharts-cartesian-axis-ticks"},T)}},{key:"render",value:function(){var a=this,s=this.props,i=s.axisLine,l=s.width,d=s.height,u=s.ticksGenerator,m=s.className,p=s.hide;if(p)return null;var f=this.props,g=f.ticks,N=Bb(f,fG),v=g;return lr(u)&&(v=g&&g.length>0?u(this.props):u(N)),l<=0||d<=0||!v||!v.length?null:xe.createElement(Br,{className:xr("recharts-cartesian-axis",m),ref:function(y){a.layerReference=y}},i&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),Jn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(a,s,i){var l,d=xr(s.className,"recharts-cartesian-axis-tick-value");return xe.isValidElement(a)?l=xe.cloneElement(a,_n(_n({},s),{},{className:d})):lr(a)?l=a(_n(_n({},s),{},{className:d})):l=xe.createElement(rl,zl({},s,{className:"recharts-cartesian-axis-tick-value"}),i),l}}])})(j.Component);uj(Oc,"displayName","CartesianAxis");uj(Oc,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var NG=["x1","y1","x2","y2","key"],SG=["offset"];function sl(e){"@babel/helpers - typeof";return sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sl(e)}function zE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function ga(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zE(Object(n),!0).forEach(function(a){CG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function CG(e,t,n){return t=kG(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kG(e){var t=AG(e,"string");return sl(t)=="symbol"?t:t+""}function AG(e,t){if(sl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(sl(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vo(){return Vo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Vo.apply(this,arguments)}function qE(e,t){if(e==null)return{};var n=IG(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function IG(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}var EG=function(t){var n=t.fill;if(!n||n==="none")return null;var a=t.fillOpacity,s=t.x,i=t.y,l=t.width,d=t.height,u=t.ry;return xe.createElement("rect",{x:s,y:i,ry:u,width:l,height:d,stroke:"none",fill:n,fillOpacity:a,className:"recharts-cartesian-grid-bg"})};function bO(e,t){var n;if(xe.isValidElement(e))n=xe.cloneElement(e,t);else if(lr(e))n=e(t);else{var a=t.x1,s=t.y1,i=t.x2,l=t.y2,d=t.key,u=qE(t,NG),m=tr(u,!1);m.offset;var p=qE(m,SG);n=xe.createElement("line",Vo({},p,{x1:a,y1:s,x2:i,y2:l,fill:"none",key:d}))}return n}function PG(e){var t=e.x,n=e.width,a=e.horizontal,s=a===void 0?!0:a,i=e.horizontalPoints;if(!s||!i||!i.length)return null;var l=i.map(function(d,u){var m=ga(ga({},e),{},{x1:t,y1:d,x2:t+n,y2:d,key:"line-".concat(u),index:u});return bO(s,m)});return xe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function TG(e){var t=e.y,n=e.height,a=e.vertical,s=a===void 0?!0:a,i=e.verticalPoints;if(!s||!i||!i.length)return null;var l=i.map(function(d,u){var m=ga(ga({},e),{},{x1:d,y1:t,x2:d,y2:t+n,key:"line-".concat(u),index:u});return bO(s,m)});return xe.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function DG(e){var t=e.horizontalFill,n=e.fillOpacity,a=e.x,s=e.y,i=e.width,l=e.height,d=e.horizontalPoints,u=e.horizontal,m=u===void 0?!0:u;if(!m||!t||!t.length)return null;var p=d.map(function(g){return Math.round(g+s-s)}).sort(function(g,N){return g-N});s!==p[0]&&p.unshift(0);var f=p.map(function(g,N){var v=!p[N+1],w=v?s+l-g:p[N+1]-g;if(w<=0)return null;var y=N%t.length;return xe.createElement("rect",{key:"react-".concat(N),y:g,x:a,height:w,width:i,stroke:"none",fill:t[y],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return xe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function OG(e){var t=e.vertical,n=t===void 0?!0:t,a=e.verticalFill,s=e.fillOpacity,i=e.x,l=e.y,d=e.width,u=e.height,m=e.verticalPoints;if(!n||!a||!a.length)return null;var p=m.map(function(g){return Math.round(g+i-i)}).sort(function(g,N){return g-N});i!==p[0]&&p.unshift(0);var f=p.map(function(g,N){var v=!p[N+1],w=v?i+d-g:p[N+1]-g;if(w<=0)return null;var y=N%a.length;return xe.createElement("rect",{key:"react-".concat(N),x:g,y:l,width:w,height:u,stroke:"none",fill:a[y],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return xe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var _G=function(t,n){var a=t.xAxis,s=t.width,i=t.height,l=t.offset;return vD(dj(ga(ga(ga({},Oc.defaultProps),a),{},{ticks:Si(a,!0),viewBox:{x:0,y:0,width:s,height:i}})),l.left,l.left+l.width,n)},MG=function(t,n){var a=t.yAxis,s=t.width,i=t.height,l=t.offset;return vD(dj(ga(ga(ga({},Oc.defaultProps),a),{},{ticks:Si(a,!0),viewBox:{x:0,y:0,width:s,height:i}})),l.top,l.top+l.height,n)},$l={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function k1(e){var t,n,a,s,i,l,d=ij(),u=oj(),m=jK(),p=ga(ga({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:$l.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:$l.fill,horizontal:(a=e.horizontal)!==null&&a!==void 0?a:$l.horizontal,horizontalFill:(s=e.horizontalFill)!==null&&s!==void 0?s:$l.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:$l.vertical,verticalFill:(l=e.verticalFill)!==null&&l!==void 0?l:$l.verticalFill,x:jt(e.x)?e.x:m.left,y:jt(e.y)?e.y:m.top,width:jt(e.width)?e.width:m.width,height:jt(e.height)?e.height:m.height}),f=p.x,g=p.y,N=p.width,v=p.height,w=p.syncWithTicks,y=p.horizontalValues,E=p.verticalValues,O=bK(),T=vK();if(!jt(N)||N<=0||!jt(v)||v<=0||!jt(f)||f!==+f||!jt(g)||g!==+g)return null;var A=p.verticalCoordinatesGenerator||_G,I=p.horizontalCoordinatesGenerator||MG,C=p.horizontalPoints,P=p.verticalPoints;if((!C||!C.length)&&lr(I)){var F=y&&y.length,R=I({yAxis:T?ga(ga({},T),{},{ticks:F?y:T.ticks}):void 0,width:d,height:u,offset:m},F?!0:w);Ms(Array.isArray(R),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(sl(R),"]")),Array.isArray(R)&&(C=R)}if((!P||!P.length)&&lr(A)){var $=E&&E.length,L=A({xAxis:O?ga(ga({},O),{},{ticks:$?E:O.ticks}):void 0,width:d,height:u,offset:m},$?!0:w);Ms(Array.isArray(L),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(sl(L),"]")),Array.isArray(L)&&(P=L)}return xe.createElement("g",{className:"recharts-cartesian-grid"},xe.createElement(EG,{fill:p.fill,fillOpacity:p.fillOpacity,x:p.x,y:p.y,width:p.width,height:p.height,ry:p.ry}),xe.createElement(PG,Vo({},p,{offset:m,horizontalPoints:C,xAxis:O,yAxis:T})),xe.createElement(TG,Vo({},p,{offset:m,verticalPoints:P,xAxis:O,yAxis:T})),xe.createElement(DG,Vo({},p,{horizontalPoints:C})),xe.createElement(OG,Vo({},p,{verticalPoints:P})))}k1.displayName="CartesianGrid";function yc(e){"@babel/helpers - typeof";return yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yc(e)}function RG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $G(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,jO(a.key),a)}}function LG(e,t,n){return t&&$G(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function FG(e,t,n){return t=df(t),BG(e,vO()?Reflect.construct(t,n||[],df(e).constructor):t.apply(e,n))}function BG(e,t){if(t&&(yc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UG(e)}function UG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vO=function(){return!!e})()}function df(e){return df=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},df(e)}function zG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A1(e,t)}function A1(e,t){return A1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},A1(e,t)}function wO(e,t,n){return t=jO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jO(e){var t=qG(e,"string");return yc(t)=="symbol"?t:t+""}function qG(e,t){if(yc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(yc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function I1(){return I1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},I1.apply(this,arguments)}function HG(e){var t=e.xAxisId,n=ij(),a=oj(),s=lO(t);return s==null?null:j.createElement(Oc,I1({},s,{className:xr("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return Si(l,!0)}}))}var vu=(function(e){function t(){return RG(this,t),FG(this,t,arguments)}return zG(t,e),LG(t,[{key:"render",value:function(){return j.createElement(HG,this.props)}}])})(j.Component);wO(vu,"displayName","XAxis");wO(vu,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function bc(e){"@babel/helpers - typeof";return bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bc(e)}function VG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WG(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,CO(a.key),a)}}function YG(e,t,n){return t&&WG(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function KG(e,t,n){return t=uf(t),GG(e,NO()?Reflect.construct(t,n||[],uf(e).constructor):t.apply(e,n))}function GG(e,t){if(t&&(bc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XG(e)}function XG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NO=function(){return!!e})()}function uf(e){return uf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},uf(e)}function JG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E1(e,t)}function E1(e,t){return E1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},E1(e,t)}function SO(e,t,n){return t=CO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CO(e){var t=ZG(e,"string");return bc(t)=="symbol"?t:t+""}function ZG(e,t){if(bc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(bc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function P1(){return P1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},P1.apply(this,arguments)}var QG=function(t){var n=t.yAxisId,a=ij(),s=oj(),i=cO(n);return i==null?null:j.createElement(Oc,P1({},i,{className:xr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:a,height:s},ticksGenerator:function(d){return Si(d,!0)}}))},wu=(function(e){function t(){return VG(this,t),KG(this,t,arguments)}return JG(t,e),YG(t,[{key:"render",value:function(){return j.createElement(QG,this.props)}}])})(j.Component);SO(wu,"displayName","YAxis");SO(wu,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function HE(e){return nX(e)||rX(e)||tX(e)||eX()}function eX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tX(e,t){if(e){if(typeof e=="string")return T1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T1(e,t)}}function rX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nX(e){if(Array.isArray(e))return T1(e)}function T1(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var D1=function(t,n,a,s,i){var l=ys(t,cj),d=ys(t,ap),u=[].concat(HE(l),HE(d)),m=ys(t,ip),p="".concat(s,"Id"),f=s[0],g=n;if(u.length&&(g=u.reduce(function(w,y){if(y.props[p]===a&&Js(y.props,"extendDomain")&&jt(y.props[f])){var E=y.props[f];return[Math.min(w[0],E),Math.max(w[1],E)]}return w},g)),m.length){var N="".concat(f,"1"),v="".concat(f,"2");g=m.reduce(function(w,y){if(y.props[p]===a&&Js(y.props,"extendDomain")&&jt(y.props[N])&&jt(y.props[v])){var E=y.props[N],O=y.props[v];return[Math.min(w[0],E,O),Math.max(w[1],E,O)]}return w},g)}return i&&i.length&&(g=i.reduce(function(w,y){return jt(y)?[Math.min(w[0],y),Math.max(w[1],y)]:w},g)),g},Ub={exports:{}},VE;function aX(){return VE||(VE=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function s(u,m,p){this.fn=u,this.context=m,this.once=p||!1}function i(u,m,p,f,g){if(typeof p!="function")throw new TypeError("The listener must be a function");var N=new s(p,f||u,g),v=n?n+m:m;return u._events[v]?u._events[v].fn?u._events[v]=[u._events[v],N]:u._events[v].push(N):(u._events[v]=N,u._eventsCount++),u}function l(u,m){--u._eventsCount===0?u._events=new a:delete u._events[m]}function d(){this._events=new a,this._eventsCount=0}d.prototype.eventNames=function(){var m=[],p,f;if(this._eventsCount===0)return m;for(f in p=this._events)t.call(p,f)&&m.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(p)):m},d.prototype.listeners=function(m){var p=n?n+m:m,f=this._events[p];if(!f)return[];if(f.fn)return[f.fn];for(var g=0,N=f.length,v=new Array(N);g<N;g++)v[g]=f[g].fn;return v},d.prototype.listenerCount=function(m){var p=n?n+m:m,f=this._events[p];return f?f.fn?1:f.length:0},d.prototype.emit=function(m,p,f,g,N,v){var w=n?n+m:m;if(!this._events[w])return!1;var y=this._events[w],E=arguments.length,O,T;if(y.fn){switch(y.once&&this.removeListener(m,y.fn,void 0,!0),E){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,p),!0;case 3:return y.fn.call(y.context,p,f),!0;case 4:return y.fn.call(y.context,p,f,g),!0;case 5:return y.fn.call(y.context,p,f,g,N),!0;case 6:return y.fn.call(y.context,p,f,g,N,v),!0}for(T=1,O=new Array(E-1);T<E;T++)O[T-1]=arguments[T];y.fn.apply(y.context,O)}else{var A=y.length,I;for(T=0;T<A;T++)switch(y[T].once&&this.removeListener(m,y[T].fn,void 0,!0),E){case 1:y[T].fn.call(y[T].context);break;case 2:y[T].fn.call(y[T].context,p);break;case 3:y[T].fn.call(y[T].context,p,f);break;case 4:y[T].fn.call(y[T].context,p,f,g);break;default:if(!O)for(I=1,O=new Array(E-1);I<E;I++)O[I-1]=arguments[I];y[T].fn.apply(y[T].context,O)}}return!0},d.prototype.on=function(m,p,f){return i(this,m,p,f,!1)},d.prototype.once=function(m,p,f){return i(this,m,p,f,!0)},d.prototype.removeListener=function(m,p,f,g){var N=n?n+m:m;if(!this._events[N])return this;if(!p)return l(this,N),this;var v=this._events[N];if(v.fn)v.fn===p&&(!g||v.once)&&(!f||v.context===f)&&l(this,N);else{for(var w=0,y=[],E=v.length;w<E;w++)(v[w].fn!==p||g&&!v[w].once||f&&v[w].context!==f)&&y.push(v[w]);y.length?this._events[N]=y.length===1?y[0]:y:l(this,N)}return this},d.prototype.removeAllListeners=function(m){var p;return m?(p=n?n+m:m,this._events[p]&&l(this,p)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=n,d.EventEmitter=d,e.exports=d})(Ub)),Ub.exports}var sX=aX();const iX=Fr(sX);var zb=new iX,qb="recharts.syncMouseEvents";function ju(e){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function oX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lX(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,kO(a.key),a)}}function cX(e,t,n){return t&&lX(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hb(e,t,n){return t=kO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kO(e){var t=dX(e,"string");return ju(t)=="symbol"?t:t+""}function dX(e,t){if(ju(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(ju(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var uX=(function(){function e(){oX(this,e),Hb(this,"activeIndex",0),Hb(this,"coordinateList",[]),Hb(this,"layout","horizontal")}return cX(e,[{key:"setDetails",value:function(n){var a,s=n.coordinateList,i=s===void 0?null:s,l=n.container,d=l===void 0?null:l,u=n.layout,m=u===void 0?null:u,p=n.offset,f=p===void 0?null:p,g=n.mouseHandlerCallback,N=g===void 0?null:g;this.coordinateList=(a=i??this.coordinateList)!==null&&a!==void 0?a:[],this.container=d??this.container,this.layout=m??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=N??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,a;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var s=this.container.getBoundingClientRect(),i=s.x,l=s.y,d=s.height,u=this.coordinateList[this.activeIndex].coordinate,m=((n=window)===null||n===void 0?void 0:n.scrollX)||0,p=((a=window)===null||a===void 0?void 0:a.scrollY)||0,f=i+u+m,g=l+this.offset.top+d/2+p;this.mouseHandlerCallback({pageX:f,pageY:g})}}}])})();function mX(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var a=e?.[0],s=e?.[1];if(a&&s&&jt(a)&&jt(s))return!0}return!1}function hX(e,t,n,a){var s=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-s,width:e==="horizontal"?a:n.width-1,height:e==="horizontal"?n.height-1:a}}function AO(e){var t=e.cx,n=e.cy,a=e.radius,s=e.startAngle,i=e.endAngle,l=Jr(t,n,a,s),d=Jr(t,n,a,i);return{points:[l,d],cx:t,cy:n,radius:a,startAngle:s,endAngle:i}}function fX(e,t,n){var a,s,i,l;if(e==="horizontal")a=t.x,i=a,s=n.top,l=n.top+n.height;else if(e==="vertical")s=t.y,l=s,a=n.left,i=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var d=t.cx,u=t.cy,m=t.innerRadius,p=t.outerRadius,f=t.angle,g=Jr(d,u,m,f),N=Jr(d,u,p,f);a=g.x,s=g.y,i=N.x,l=N.y}else return AO(t);return[{x:a,y:s},{x:i,y:l}]}function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}function WE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function Zm(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WE(Object(n),!0).forEach(function(a){pX(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function pX(e,t,n){return t=gX(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gX(e){var t=xX(e,"string");return Nu(t)=="symbol"?t:t+""}function xX(e,t){if(Nu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(Nu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yX(e){var t,n,a=e.element,s=e.tooltipEventType,i=e.isActive,l=e.activeCoordinate,d=e.activePayload,u=e.offset,m=e.activeTooltipIndex,p=e.tooltipAxisBandSize,f=e.layout,g=e.chartName,N=(t=a.props.cursor)!==null&&t!==void 0?t:(n=a.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!a||!N||!i||!l||g!=="ScatterChart"&&s!=="axis")return null;var v,w=e1;if(g==="ScatterChart")v=l,w=QV;else if(g==="BarChart")v=hX(f,l,u,p),w=tj;else if(f==="radial"){var y=AO(l),E=y.cx,O=y.cy,T=y.radius,A=y.startAngle,I=y.endAngle;v={cx:E,cy:O,startAngle:A,endAngle:I,innerRadius:T,outerRadius:T},w=TD}else v={points:fX(f,l,u)},w=e1;var C=Zm(Zm(Zm(Zm({stroke:"#ccc",pointerEvents:"none"},u),v),tr(N,!1)),{},{payload:d,payloadIndex:m,className:xr("recharts-tooltip-cursor",N.className)});return j.isValidElement(N)?j.cloneElement(N,C):j.createElement(w,C)}var bX=["item"],vX=["children","className","width","height","style","compact","title","desc"];function vc(e){"@babel/helpers - typeof";return vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vc(e)}function ql(){return ql=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ql.apply(this,arguments)}function YE(e,t){return NX(e)||jX(e,t)||EO(e,t)||wX()}function wX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jX(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var a,s,i,l,d=[],u=!0,m=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(u=(a=i.call(n)).done)&&(d.push(a.value),d.length!==t);u=!0);}catch(p){m=!0,s=p}finally{try{if(!u&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(m)throw s}}return d}}function NX(e){if(Array.isArray(e))return e}function KE(e,t){if(e==null)return{};var n=SX(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function SX(e,t){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}function CX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kX(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,PO(a.key),a)}}function AX(e,t,n){return t&&kX(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function IX(e,t,n){return t=mf(t),EX(e,IO()?Reflect.construct(t,n||[],mf(e).constructor):t.apply(e,n))}function EX(e,t){if(t&&(vc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PX(e)}function PX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IO=function(){return!!e})()}function mf(e){return mf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},mf(e)}function TX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O1(e,t)}function O1(e,t){return O1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},O1(e,t)}function wc(e){return _X(e)||OX(e)||EO(e)||DX()}function DX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EO(e,t){if(e){if(typeof e=="string")return _1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _1(e,t)}}function OX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _X(e){if(Array.isArray(e))return _1(e)}function _1(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function GE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GE(Object(n),!0).forEach(function(a){Qt(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Qt(e,t,n){return t=PO(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PO(e){var t=MX(e,"string");return vc(t)=="symbol"?t:t+""}function MX(e,t){if(vc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(vc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RX={xAxis:["bottom","top"],yAxis:["left","right"]},$X={width:"100%",height:"100%"},TO={x:0,y:0};function Qm(e){return e}var LX=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},FX=function(t,n,a,s){var i=n.find(function(p){return p&&p.index===a});if(i){if(t==="horizontal")return{x:i.coordinate,y:s.y};if(t==="vertical")return{x:s.x,y:i.coordinate};if(t==="centric"){var l=i.coordinate,d=s.radius;return nt(nt(nt({},s),Jr(s.cx,s.cy,d,l)),{},{angle:l,radius:d})}var u=i.coordinate,m=s.angle;return nt(nt(nt({},s),Jr(s.cx,s.cy,u,m)),{},{angle:m,radius:u})}return TO},op=function(t,n){var a=n.graphicalItems,s=n.dataStartIndex,i=n.dataEndIndex,l=(a??[]).reduce(function(d,u){var m=u.props.data;return m&&m.length?[].concat(wc(d),wc(m)):d},[]);return l.length>0?l:t&&t.length&&jt(s)&&jt(i)?t.slice(s,i+1):[]};function DO(e){return e==="number"?[0,"auto"]:void 0}var M1=function(t,n,a,s){var i=t.graphicalItems,l=t.tooltipAxis,d=op(n,t);return a<0||!i||!i.length||a>=d.length?null:i.reduce(function(u,m){var p,f=(p=m.props.data)!==null&&p!==void 0?p:n;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=a&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var g;if(l.dataKey&&!l.allowDuplicatedCategory){var N=f===void 0?d:f;g=pv(N,l.dataKey,s)}else g=f&&f[a]||d[a];return g?[].concat(wc(u),[CD(m,g)]):u},[])},XE=function(t,n,a,s){var i=s||{x:t.chartX,y:t.chartY},l=LX(i,a),d=t.orderedTooltipTicks,u=t.tooltipAxis,m=t.tooltipTicks,p=Nz(l,d,m,u);if(p>=0&&m){var f=m[p]&&m[p].value,g=M1(t,n,p,f),N=FX(a,d,p,i);return{activeTooltipIndex:p,activeLabel:f,activePayload:g,activeCoordinate:N}}return null},BX=function(t,n){var a=n.axes,s=n.graphicalItems,i=n.axisType,l=n.axisIdKey,d=n.stackGroups,u=n.dataStartIndex,m=n.dataEndIndex,p=t.layout,f=t.children,g=t.stackOffset,N=bD(p,i);return a.reduce(function(v,w){var y,E=w.type.defaultProps!==void 0?nt(nt({},w.type.defaultProps),w.props):w.props,O=E.type,T=E.dataKey,A=E.allowDataOverflow,I=E.allowDuplicatedCategory,C=E.scale,P=E.ticks,F=E.includeHidden,R=E[l];if(v[R])return v;var $=op(t.data,{graphicalItems:s.filter(function(te){var fe,Le=l in te.props?te.props[l]:(fe=te.type.defaultProps)===null||fe===void 0?void 0:fe[l];return Le===R}),dataStartIndex:u,dataEndIndex:m}),L=$.length,G,X,me;mX(E.domain,A,O)&&(G=Gv(E.domain,null,A),N&&(O==="number"||C!=="auto")&&(me=Dd($,T,"category")));var se=DO(O);if(!G||G.length===0){var ee,W=(ee=E.domain)!==null&&ee!==void 0?ee:se;if(T){if(G=Dd($,T,O),O==="category"&&N){var U=x$(G);I&&U?(X=G,G=Qh(0,L)):I||(G=ZI(W,G,w).reduce(function(te,fe){return te.indexOf(fe)>=0?te:[].concat(wc(te),[fe])},[]))}else if(O==="category")I?G=G.filter(function(te){return te!==""&&!wr(te)}):G=ZI(W,G,w).reduce(function(te,fe){return te.indexOf(fe)>=0||fe===""||wr(fe)?te:[].concat(wc(te),[fe])},[]);else if(O==="number"){var Q=Iz($,s.filter(function(te){var fe,Le,he=l in te.props?te.props[l]:(fe=te.type.defaultProps)===null||fe===void 0?void 0:fe[l],K="hide"in te.props?te.props.hide:(Le=te.type.defaultProps)===null||Le===void 0?void 0:Le.hide;return he===R&&(F||!K)}),T,i,p);Q&&(G=Q)}N&&(O==="number"||C!=="auto")&&(me=Dd($,T,"category"))}else N?G=Qh(0,L):d&&d[R]&&d[R].hasStack&&O==="number"?G=g==="expand"?[0,1]:SD(d[R].stackGroups,u,m):G=yD($,s.filter(function(te){var fe=l in te.props?te.props[l]:te.type.defaultProps[l],Le="hide"in te.props?te.props.hide:te.type.defaultProps.hide;return fe===R&&(F||!Le)}),O,p,!0);if(O==="number")G=D1(f,G,R,i,P),W&&(G=Gv(W,G,A));else if(O==="category"&&W){var Y=W,H=G.every(function(te){return Y.indexOf(te)>=0});H&&(G=Y)}}return nt(nt({},v),{},Qt({},R,nt(nt({},E),{},{axisType:i,domain:G,categoricalDomain:me,duplicateDomain:X,originalDomain:(y=E.domain)!==null&&y!==void 0?y:se,isCategorical:N,layout:p})))},{})},UX=function(t,n){var a=n.graphicalItems,s=n.Axis,i=n.axisType,l=n.axisIdKey,d=n.stackGroups,u=n.dataStartIndex,m=n.dataEndIndex,p=t.layout,f=t.children,g=op(t.data,{graphicalItems:a,dataStartIndex:u,dataEndIndex:m}),N=g.length,v=bD(p,i),w=-1;return a.reduce(function(y,E){var O=E.type.defaultProps!==void 0?nt(nt({},E.type.defaultProps),E.props):E.props,T=O[l],A=DO("number");if(!y[T]){w++;var I;return v?I=Qh(0,N):d&&d[T]&&d[T].hasStack?(I=SD(d[T].stackGroups,u,m),I=D1(f,I,T,i)):(I=Gv(A,yD(g,a.filter(function(C){var P,F,R=l in C.props?C.props[l]:(P=C.type.defaultProps)===null||P===void 0?void 0:P[l],$="hide"in C.props?C.props.hide:(F=C.type.defaultProps)===null||F===void 0?void 0:F.hide;return R===T&&!$}),"number",p),s.defaultProps.allowDataOverflow),I=D1(f,I,T,i)),nt(nt({},y),{},Qt({},T,nt(nt({axisType:i},s.defaultProps),{},{hide:!0,orientation:ts(RX,"".concat(i,".").concat(w%2),null),domain:I,originalDomain:A,isCategorical:v,layout:p})))}return y},{})},zX=function(t,n){var a=n.axisType,s=a===void 0?"xAxis":a,i=n.AxisComp,l=n.graphicalItems,d=n.stackGroups,u=n.dataStartIndex,m=n.dataEndIndex,p=t.children,f="".concat(s,"Id"),g=ys(p,i),N={};return g&&g.length?N=BX(t,{axes:g,graphicalItems:l,axisType:s,axisIdKey:f,stackGroups:d,dataStartIndex:u,dataEndIndex:m}):l&&l.length&&(N=UX(t,{Axis:i,graphicalItems:l,axisType:s,axisIdKey:f,stackGroups:d,dataStartIndex:u,dataEndIndex:m})),N},qX=function(t){var n=ao(t),a=Si(n,!1,!0);return{tooltipTicks:a,orderedTooltipTicks:Iw(a,function(s){return s.coordinate}),tooltipAxis:n,tooltipAxisBandSize:Uh(n,a)}},JE=function(t){var n=t.children,a=t.defaultShowTooltip,s=Za(n,mc),i=0,l=0;return t.data&&t.data.length!==0&&(l=t.data.length-1),s&&s.props&&(s.props.startIndex>=0&&(i=s.props.startIndex),s.props.endIndex>=0&&(l=s.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:l,activeTooltipIndex:-1,isTooltipActive:!!a}},HX=function(t){return!t||!t.length?!1:t.some(function(n){var a=ki(n&&n.type);return a&&a.indexOf("Bar")>=0})},ZE=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},VX=function(t,n){var a=t.props,s=t.graphicalItems,i=t.xAxisMap,l=i===void 0?{}:i,d=t.yAxisMap,u=d===void 0?{}:d,m=a.width,p=a.height,f=a.children,g=a.margin||{},N=Za(f,mc),v=Za(f,Wl),w=Object.keys(u).reduce(function(I,C){var P=u[C],F=P.orientation;return!P.mirror&&!P.hide?nt(nt({},I),{},Qt({},F,I[F]+P.width)):I},{left:g.left||0,right:g.right||0}),y=Object.keys(l).reduce(function(I,C){var P=l[C],F=P.orientation;return!P.mirror&&!P.hide?nt(nt({},I),{},Qt({},F,ts(I,"".concat(F))+P.height)):I},{top:g.top||0,bottom:g.bottom||0}),E=nt(nt({},y),w),O=E.bottom;N&&(E.bottom+=N.props.height||mc.defaultProps.height),v&&n&&(E=kz(E,s,a,n));var T=m-E.left-E.right,A=p-E.top-E.bottom;return nt(nt({brushBottom:O},E),{},{width:Math.max(T,0),height:Math.max(A,0)})},WX=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},OO=function(t){var n=t.chartName,a=t.GraphicalChild,s=t.defaultTooltipEventType,i=s===void 0?"axis":s,l=t.validateTooltipEventTypes,d=l===void 0?["axis"]:l,u=t.axisComponents,m=t.legendContent,p=t.formatAxisMap,f=t.defaultProps,g=function(E,O){var T=O.graphicalItems,A=O.stackGroups,I=O.offset,C=O.updateId,P=O.dataStartIndex,F=O.dataEndIndex,R=E.barSize,$=E.layout,L=E.barGap,G=E.barCategoryGap,X=E.maxBarSize,me=ZE($),se=me.numericAxisName,ee=me.cateAxisName,W=HX(T),U=[];return T.forEach(function(Q,Y){var H=op(E.data,{graphicalItems:[Q],dataStartIndex:P,dataEndIndex:F}),te=Q.type.defaultProps!==void 0?nt(nt({},Q.type.defaultProps),Q.props):Q.props,fe=te.dataKey,Le=te.maxBarSize,he=te["".concat(se,"Id")],K=te["".concat(ee,"Id")],be={},re=u.reduce(function(Lt,kt){var Oe=O["".concat(kt.axisType,"Map")],Nt=te["".concat(kt.axisType,"Id")];Oe&&Oe[Nt]||kt.axisType==="zAxis"||al();var Mt=Oe[Nt];return nt(nt({},Lt),{},Qt(Qt({},kt.axisType,Mt),"".concat(kt.axisType,"Ticks"),Si(Mt)))},be),ie=re[ee],ne=re["".concat(ee,"Ticks")],Te=A&&A[he]&&A[he].hasStack&&$z(Q,A[he].stackGroups),ve=ki(Q.type).indexOf("Bar")>=0,We=Uh(ie,ne),Ie=[],je=W&&Sz({barSize:R,stackGroups:A,totalSize:WX(re,ee)});if(ve){var oe,$e,et=wr(Le)?X:Le,lt=(oe=($e=Uh(ie,ne,!0))!==null&&$e!==void 0?$e:et)!==null&&oe!==void 0?oe:0;Ie=Cz({barGap:L,barCategoryGap:G,bandSize:lt!==We?lt:We,sizeList:je[K],maxBarSize:et}),lt!==We&&(Ie=Ie.map(function(Lt){return nt(nt({},Lt),{},{position:nt(nt({},Lt.position),{},{offset:Lt.position.offset-lt/2})})}))}var rt=Q&&Q.type&&Q.type.getComposedData;rt&&U.push({props:nt(nt({},rt(nt(nt({},re),{},{displayedData:H,props:E,dataKey:fe,item:Q,bandSize:We,barPosition:Ie,offset:I,stackedData:Te,layout:$,dataStartIndex:P,dataEndIndex:F}))),{},Qt(Qt(Qt({key:Q.key||"item-".concat(Y)},se,re[se]),ee,re[ee]),"animationId",C)),childIndex:E$(Q,E.children),item:Q})}),U},N=function(E,O){var T=E.props,A=E.dataStartIndex,I=E.dataEndIndex,C=E.updateId;if(!hC({props:T}))return null;var P=T.children,F=T.layout,R=T.stackOffset,$=T.data,L=T.reverseStackOrder,G=ZE(F),X=G.numericAxisName,me=G.cateAxisName,se=ys(P,a),ee=Mz($,se,"".concat(X,"Id"),"".concat(me,"Id"),R,L),W=u.reduce(function(te,fe){var Le="".concat(fe.axisType,"Map");return nt(nt({},te),{},Qt({},Le,zX(T,nt(nt({},fe),{},{graphicalItems:se,stackGroups:fe.axisType===X&&ee,dataStartIndex:A,dataEndIndex:I}))))},{}),U=VX(nt(nt({},W),{},{props:T,graphicalItems:se}),O?.legendBBox);Object.keys(W).forEach(function(te){W[te]=p(T,W[te],U,te.replace("Map",""),n)});var Q=W["".concat(me,"Map")],Y=qX(Q),H=g(T,nt(nt({},W),{},{dataStartIndex:A,dataEndIndex:I,updateId:C,graphicalItems:se,stackGroups:ee,offset:U}));return nt(nt({formattedGraphicalItems:H,graphicalItems:se,offset:U,stackGroups:ee},Y),W)},v=(function(y){function E(O){var T,A,I;return CX(this,E),I=IX(this,E,[O]),Qt(I,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Qt(I,"accessibilityManager",new uX),Qt(I,"handleLegendBBoxUpdate",function(C){if(C){var P=I.state,F=P.dataStartIndex,R=P.dataEndIndex,$=P.updateId;I.setState(nt({legendBBox:C},N({props:I.props,dataStartIndex:F,dataEndIndex:R,updateId:$},nt(nt({},I.state),{},{legendBBox:C}))))}}),Qt(I,"handleReceiveSyncEvent",function(C,P,F){if(I.props.syncId===C){if(F===I.eventEmitterSymbol&&typeof I.props.syncMethod!="function")return;I.applySyncEvent(P)}}),Qt(I,"handleBrushChange",function(C){var P=C.startIndex,F=C.endIndex;if(P!==I.state.dataStartIndex||F!==I.state.dataEndIndex){var R=I.state.updateId;I.setState(function(){return nt({dataStartIndex:P,dataEndIndex:F},N({props:I.props,dataStartIndex:P,dataEndIndex:F,updateId:R},I.state))}),I.triggerSyncEvent({dataStartIndex:P,dataEndIndex:F})}}),Qt(I,"handleMouseEnter",function(C){var P=I.getMouseInfo(C);if(P){var F=nt(nt({},P),{},{isTooltipActive:!0});I.setState(F),I.triggerSyncEvent(F);var R=I.props.onMouseEnter;lr(R)&&R(F,C)}}),Qt(I,"triggeredAfterMouseMove",function(C){var P=I.getMouseInfo(C),F=P?nt(nt({},P),{},{isTooltipActive:!0}):{isTooltipActive:!1};I.setState(F),I.triggerSyncEvent(F);var R=I.props.onMouseMove;lr(R)&&R(F,C)}),Qt(I,"handleItemMouseEnter",function(C){I.setState(function(){return{isTooltipActive:!0,activeItem:C,activePayload:C.tooltipPayload,activeCoordinate:C.tooltipPosition||{x:C.cx,y:C.cy}}})}),Qt(I,"handleItemMouseLeave",function(){I.setState(function(){return{isTooltipActive:!1}})}),Qt(I,"handleMouseMove",function(C){C.persist(),I.throttleTriggeredAfterMouseMove(C)}),Qt(I,"handleMouseLeave",function(C){I.throttleTriggeredAfterMouseMove.cancel();var P={isTooltipActive:!1};I.setState(P),I.triggerSyncEvent(P);var F=I.props.onMouseLeave;lr(F)&&F(P,C)}),Qt(I,"handleOuterEvent",function(C){var P=I$(C),F=ts(I.props,"".concat(P));if(P&&lr(F)){var R,$;/.*touch.*/i.test(P)?$=I.getMouseInfo(C.changedTouches[0]):$=I.getMouseInfo(C),F((R=$)!==null&&R!==void 0?R:{},C)}}),Qt(I,"handleClick",function(C){var P=I.getMouseInfo(C);if(P){var F=nt(nt({},P),{},{isTooltipActive:!0});I.setState(F),I.triggerSyncEvent(F);var R=I.props.onClick;lr(R)&&R(F,C)}}),Qt(I,"handleMouseDown",function(C){var P=I.props.onMouseDown;if(lr(P)){var F=I.getMouseInfo(C);P(F,C)}}),Qt(I,"handleMouseUp",function(C){var P=I.props.onMouseUp;if(lr(P)){var F=I.getMouseInfo(C);P(F,C)}}),Qt(I,"handleTouchMove",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&I.throttleTriggeredAfterMouseMove(C.changedTouches[0])}),Qt(I,"handleTouchStart",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&I.handleMouseDown(C.changedTouches[0])}),Qt(I,"handleTouchEnd",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&I.handleMouseUp(C.changedTouches[0])}),Qt(I,"handleDoubleClick",function(C){var P=I.props.onDoubleClick;if(lr(P)){var F=I.getMouseInfo(C);P(F,C)}}),Qt(I,"handleContextMenu",function(C){var P=I.props.onContextMenu;if(lr(P)){var F=I.getMouseInfo(C);P(F,C)}}),Qt(I,"triggerSyncEvent",function(C){I.props.syncId!==void 0&&zb.emit(qb,I.props.syncId,C,I.eventEmitterSymbol)}),Qt(I,"applySyncEvent",function(C){var P=I.props,F=P.layout,R=P.syncMethod,$=I.state.updateId,L=C.dataStartIndex,G=C.dataEndIndex;if(C.dataStartIndex!==void 0||C.dataEndIndex!==void 0)I.setState(nt({dataStartIndex:L,dataEndIndex:G},N({props:I.props,dataStartIndex:L,dataEndIndex:G,updateId:$},I.state)));else if(C.activeTooltipIndex!==void 0){var X=C.chartX,me=C.chartY,se=C.activeTooltipIndex,ee=I.state,W=ee.offset,U=ee.tooltipTicks;if(!W)return;if(typeof R=="function")se=R(U,C);else if(R==="value"){se=-1;for(var Q=0;Q<U.length;Q++)if(U[Q].value===C.activeLabel){se=Q;break}}var Y=nt(nt({},W),{},{x:W.left,y:W.top}),H=Math.min(X,Y.x+Y.width),te=Math.min(me,Y.y+Y.height),fe=U[se]&&U[se].value,Le=M1(I.state,I.props.data,se),he=U[se]?{x:F==="horizontal"?U[se].coordinate:H,y:F==="horizontal"?te:U[se].coordinate}:TO;I.setState(nt(nt({},C),{},{activeLabel:fe,activeCoordinate:he,activePayload:Le,activeTooltipIndex:se}))}else I.setState(C)}),Qt(I,"renderCursor",function(C){var P,F=I.state,R=F.isTooltipActive,$=F.activeCoordinate,L=F.activePayload,G=F.offset,X=F.activeTooltipIndex,me=F.tooltipAxisBandSize,se=I.getTooltipEventType(),ee=(P=C.props.active)!==null&&P!==void 0?P:R,W=I.props.layout,U=C.key||"_recharts-cursor";return xe.createElement(yX,{key:U,activeCoordinate:$,activePayload:L,activeTooltipIndex:X,chartName:n,element:C,isActive:ee,layout:W,offset:G,tooltipAxisBandSize:me,tooltipEventType:se})}),Qt(I,"renderPolarAxis",function(C,P,F){var R=ts(C,"type.axisType"),$=ts(I.state,"".concat(R,"Map")),L=C.type.defaultProps,G=L!==void 0?nt(nt({},L),C.props):C.props,X=$&&$[G["".concat(R,"Id")]];return j.cloneElement(C,nt(nt({},X),{},{className:xr(R,X.className),key:C.key||"".concat(P,"-").concat(F),ticks:Si(X,!0)}))}),Qt(I,"renderPolarGrid",function(C){var P=C.props,F=P.radialLines,R=P.polarAngles,$=P.polarRadius,L=I.state,G=L.radiusAxisMap,X=L.angleAxisMap,me=ao(G),se=ao(X),ee=se.cx,W=se.cy,U=se.innerRadius,Q=se.outerRadius;return j.cloneElement(C,{polarAngles:Array.isArray(R)?R:Si(se,!0).map(function(Y){return Y.coordinate}),polarRadius:Array.isArray($)?$:Si(me,!0).map(function(Y){return Y.coordinate}),cx:ee,cy:W,innerRadius:U,outerRadius:Q,key:C.key||"polar-grid",radialLines:F})}),Qt(I,"renderLegend",function(){var C=I.state.formattedGraphicalItems,P=I.props,F=P.children,R=P.width,$=P.height,L=I.props.margin||{},G=R-(L.left||0)-(L.right||0),X=gD({children:F,formattedGraphicalItems:C,legendWidth:G,legendContent:m});if(!X)return null;var me=X.item,se=KE(X,bX);return j.cloneElement(me,nt(nt({},se),{},{chartWidth:R,chartHeight:$,margin:L,onBBoxUpdate:I.handleLegendBBoxUpdate}))}),Qt(I,"renderTooltip",function(){var C,P=I.props,F=P.children,R=P.accessibilityLayer,$=Za(F,Qa);if(!$)return null;var L=I.state,G=L.isTooltipActive,X=L.activeCoordinate,me=L.activePayload,se=L.activeLabel,ee=L.offset,W=(C=$.props.active)!==null&&C!==void 0?C:G;return j.cloneElement($,{viewBox:nt(nt({},ee),{},{x:ee.left,y:ee.top}),active:W,label:se,payload:W?me:[],coordinate:X,accessibilityLayer:R})}),Qt(I,"renderBrush",function(C){var P=I.props,F=P.margin,R=P.data,$=I.state,L=$.offset,G=$.dataStartIndex,X=$.dataEndIndex,me=$.updateId;return j.cloneElement(C,{key:C.key||"_recharts-brush",onChange:Km(I.handleBrushChange,C.props.onChange),data:R,x:jt(C.props.x)?C.props.x:L.left,y:jt(C.props.y)?C.props.y:L.top+L.height+L.brushBottom-(F.bottom||0),width:jt(C.props.width)?C.props.width:L.width,startIndex:G,endIndex:X,updateId:"brush-".concat(me)})}),Qt(I,"renderReferenceElement",function(C,P,F){if(!C)return null;var R=I,$=R.clipPathId,L=I.state,G=L.xAxisMap,X=L.yAxisMap,me=L.offset,se=C.type.defaultProps||{},ee=C.props,W=ee.xAxisId,U=W===void 0?se.xAxisId:W,Q=ee.yAxisId,Y=Q===void 0?se.yAxisId:Q;return j.cloneElement(C,{key:C.key||"".concat(P,"-").concat(F),xAxis:G[U],yAxis:X[Y],viewBox:{x:me.left,y:me.top,width:me.width,height:me.height},clipPathId:$})}),Qt(I,"renderActivePoints",function(C){var P=C.item,F=C.activePoint,R=C.basePoint,$=C.childIndex,L=C.isRange,G=[],X=P.props.key,me=P.item.type.defaultProps!==void 0?nt(nt({},P.item.type.defaultProps),P.item.props):P.item.props,se=me.activeDot,ee=me.dataKey,W=nt(nt({index:$,dataKey:ee,cx:F.x,cy:F.y,r:4,fill:ej(P.item),strokeWidth:2,stroke:"#fff",payload:F.payload,value:F.value},tr(se,!1)),xh(se));return G.push(E.renderActiveDot(se,W,"".concat(X,"-activePoint-").concat($))),R?G.push(E.renderActiveDot(se,nt(nt({},W),{},{cx:R.x,cy:R.y}),"".concat(X,"-basePoint-").concat($))):L&&G.push(null),G}),Qt(I,"renderGraphicChild",function(C,P,F){var R=I.filterFormatItem(C,P,F);if(!R)return null;var $=I.getTooltipEventType(),L=I.state,G=L.isTooltipActive,X=L.tooltipAxis,me=L.activeTooltipIndex,se=L.activeLabel,ee=I.props.children,W=Za(ee,Qa),U=R.props,Q=U.points,Y=U.isRange,H=U.baseLine,te=R.item.type.defaultProps!==void 0?nt(nt({},R.item.type.defaultProps),R.item.props):R.item.props,fe=te.activeDot,Le=te.hide,he=te.activeBar,K=te.activeShape,be=!!(!Le&&G&&W&&(fe||he||K)),re={};$!=="axis"&&W&&W.props.trigger==="click"?re={onClick:Km(I.handleItemMouseEnter,C.props.onClick)}:$!=="axis"&&(re={onMouseLeave:Km(I.handleItemMouseLeave,C.props.onMouseLeave),onMouseEnter:Km(I.handleItemMouseEnter,C.props.onMouseEnter)});var ie=j.cloneElement(C,nt(nt({},R.props),re));function ne(kt){return typeof X.dataKey=="function"?X.dataKey(kt.payload):null}if(be)if(me>=0){var Te,ve;if(X.dataKey&&!X.allowDuplicatedCategory){var We=typeof X.dataKey=="function"?ne:"payload.".concat(X.dataKey.toString());Te=pv(Q,We,se),ve=Y&&H&&pv(H,We,se)}else Te=Q?.[me],ve=Y&&H&&H[me];if(K||he){var Ie=C.props.activeIndex!==void 0?C.props.activeIndex:me;return[j.cloneElement(C,nt(nt(nt({},R.props),re),{},{activeIndex:Ie})),null,null]}if(!wr(Te))return[ie].concat(wc(I.renderActivePoints({item:R,activePoint:Te,basePoint:ve,childIndex:me,isRange:Y})))}else{var je,oe=(je=I.getItemByXY(I.state.activeCoordinate))!==null&&je!==void 0?je:{graphicalItem:ie},$e=oe.graphicalItem,et=$e.item,lt=et===void 0?C:et,rt=$e.childIndex,Lt=nt(nt(nt({},R.props),re),{},{activeIndex:rt});return[j.cloneElement(lt,Lt),null,null]}return Y?[ie,null,null]:[ie,null]}),Qt(I,"renderCustomized",function(C,P,F){return j.cloneElement(C,nt(nt({key:"recharts-customized-".concat(F)},I.props),I.state))}),Qt(I,"renderMap",{CartesianGrid:{handler:Qm,once:!0},ReferenceArea:{handler:I.renderReferenceElement},ReferenceLine:{handler:Qm},ReferenceDot:{handler:I.renderReferenceElement},XAxis:{handler:Qm},YAxis:{handler:Qm},Brush:{handler:I.renderBrush,once:!0},Bar:{handler:I.renderGraphicChild},Line:{handler:I.renderGraphicChild},Area:{handler:I.renderGraphicChild},Radar:{handler:I.renderGraphicChild},RadialBar:{handler:I.renderGraphicChild},Scatter:{handler:I.renderGraphicChild},Pie:{handler:I.renderGraphicChild},Funnel:{handler:I.renderGraphicChild},Tooltip:{handler:I.renderCursor,once:!0},PolarGrid:{handler:I.renderPolarGrid,once:!0},PolarAngleAxis:{handler:I.renderPolarAxis},PolarRadiusAxis:{handler:I.renderPolarAxis},Customized:{handler:I.renderCustomized}}),I.clipPathId="".concat((T=O.id)!==null&&T!==void 0?T:Tu("recharts"),"-clip"),I.throttleTriggeredAfterMouseMove=pT(I.triggeredAfterMouseMove,(A=O.throttleDelay)!==null&&A!==void 0?A:1e3/60),I.state={},I}return TX(E,y),AX(E,[{key:"componentDidMount",value:function(){var T,A;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(T=this.props.margin.left)!==null&&T!==void 0?T:0,top:(A=this.props.margin.top)!==null&&A!==void 0?A:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var T=this.props,A=T.children,I=T.data,C=T.height,P=T.layout,F=Za(A,Qa);if(F){var R=F.props.defaultIndex;if(!(typeof R!="number"||R<0||R>this.state.tooltipTicks.length-1)){var $=this.state.tooltipTicks[R]&&this.state.tooltipTicks[R].value,L=M1(this.state,I,R,$),G=this.state.tooltipTicks[R].coordinate,X=(this.state.offset.top+C)/2,me=P==="horizontal",se=me?{x:G,y:X}:{y:G,x:X},ee=this.state.formattedGraphicalItems.find(function(U){var Q=U.item;return Q.type.name==="Scatter"});ee&&(se=nt(nt({},se),ee.props.points[R].tooltipPosition),L=ee.props.points[R].tooltipPayload);var W={activeTooltipIndex:R,isTooltipActive:!0,activeLabel:$,activePayload:L,activeCoordinate:se};this.setState(W),this.renderCursor(F),this.accessibilityManager.setIndex(R)}}}},{key:"getSnapshotBeforeUpdate",value:function(T,A){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==A.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==T.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==T.margin){var I,C;this.accessibilityManager.setDetails({offset:{left:(I=this.props.margin.left)!==null&&I!==void 0?I:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0}})}return null}},{key:"componentDidUpdate",value:function(T){xv([Za(T.children,Qa)],[Za(this.props.children,Qa)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var T=Za(this.props.children,Qa);if(T&&typeof T.props.shared=="boolean"){var A=T.props.shared?"axis":"item";return d.indexOf(A)>=0?A:i}return i}},{key:"getMouseInfo",value:function(T){if(!this.container)return null;var A=this.container,I=A.getBoundingClientRect(),C=p8(I),P={chartX:Math.round(T.pageX-C.left),chartY:Math.round(T.pageY-C.top)},F=I.width/A.offsetWidth||1,R=this.inRange(P.chartX,P.chartY,F);if(!R)return null;var $=this.state,L=$.xAxisMap,G=$.yAxisMap,X=this.getTooltipEventType(),me=XE(this.state,this.props.data,this.props.layout,R);if(X!=="axis"&&L&&G){var se=ao(L).scale,ee=ao(G).scale,W=se&&se.invert?se.invert(P.chartX):null,U=ee&&ee.invert?ee.invert(P.chartY):null;return nt(nt({},P),{},{xValue:W,yValue:U},me)}return me?nt(nt({},P),me):null}},{key:"inRange",value:function(T,A){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=this.props.layout,P=T/I,F=A/I;if(C==="horizontal"||C==="vertical"){var R=this.state.offset,$=P>=R.left&&P<=R.left+R.width&&F>=R.top&&F<=R.top+R.height;return $?{x:P,y:F}:null}var L=this.state,G=L.angleAxisMap,X=L.radiusAxisMap;if(G&&X){var me=ao(G);return t3({x:P,y:F},me)}return null}},{key:"parseEventsOfWrapper",value:function(){var T=this.props.children,A=this.getTooltipEventType(),I=Za(T,Qa),C={};I&&A==="axis"&&(I.props.trigger==="click"?C={onClick:this.handleClick}:C={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var P=xh(this.props,this.handleOuterEvent);return nt(nt({},P),C)}},{key:"addListener",value:function(){zb.on(qb,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){zb.removeListener(qb,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(T,A,I){for(var C=this.state.formattedGraphicalItems,P=0,F=C.length;P<F;P++){var R=C[P];if(R.item===T||R.props.key===T.key||A===ki(R.item.type)&&I===R.childIndex)return R}return null}},{key:"renderClipPath",value:function(){var T=this.clipPathId,A=this.state.offset,I=A.left,C=A.top,P=A.height,F=A.width;return xe.createElement("defs",null,xe.createElement("clipPath",{id:T},xe.createElement("rect",{x:I,y:C,height:P,width:F})))}},{key:"getXScales",value:function(){var T=this.state.xAxisMap;return T?Object.entries(T).reduce(function(A,I){var C=YE(I,2),P=C[0],F=C[1];return nt(nt({},A),{},Qt({},P,F.scale))},{}):null}},{key:"getYScales",value:function(){var T=this.state.yAxisMap;return T?Object.entries(T).reduce(function(A,I){var C=YE(I,2),P=C[0],F=C[1];return nt(nt({},A),{},Qt({},P,F.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(T){var A;return(A=this.state.xAxisMap)===null||A===void 0||(A=A[T])===null||A===void 0?void 0:A.scale}},{key:"getYScaleByAxisId",value:function(T){var A;return(A=this.state.yAxisMap)===null||A===void 0||(A=A[T])===null||A===void 0?void 0:A.scale}},{key:"getItemByXY",value:function(T){var A=this.state,I=A.formattedGraphicalItems,C=A.activeItem;if(I&&I.length)for(var P=0,F=I.length;P<F;P++){var R=I[P],$=R.props,L=R.item,G=L.type.defaultProps!==void 0?nt(nt({},L.type.defaultProps),L.props):L.props,X=ki(L.type);if(X==="Bar"){var me=($.data||[]).find(function(U){return OV(T,U)});if(me)return{graphicalItem:R,payload:me}}else if(X==="RadialBar"){var se=($.data||[]).find(function(U){return t3(T,U)});if(se)return{graphicalItem:R,payload:se}}else if(ep(R,C)||tp(R,C)||pu(R,C)){var ee=rY({graphicalItem:R,activeTooltipItem:C,itemData:G.data}),W=G.activeIndex===void 0?ee:G.activeIndex;return{graphicalItem:nt(nt({},R),{},{childIndex:W}),payload:pu(R,C)?G.data[ee]:R.props.data[ee]}}}return null}},{key:"render",value:function(){var T=this;if(!hC(this))return null;var A=this.props,I=A.children,C=A.className,P=A.width,F=A.height,R=A.style,$=A.compact,L=A.title,G=A.desc,X=KE(A,vX),me=tr(X,!1);if($)return xe.createElement(TE,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},xe.createElement(bv,ql({},me,{width:P,height:F,title:L,desc:G}),this.renderClipPath(),pC(I,this.renderMap)));if(this.props.accessibilityLayer){var se,ee;me.tabIndex=(se=this.props.tabIndex)!==null&&se!==void 0?se:0,me.role=(ee=this.props.role)!==null&&ee!==void 0?ee:"application",me.onKeyDown=function(U){T.accessibilityManager.keyboardEvent(U)},me.onFocus=function(){T.accessibilityManager.focus()}}var W=this.parseEventsOfWrapper();return xe.createElement(TE,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},xe.createElement("div",ql({className:xr("recharts-wrapper",C),style:nt({position:"relative",cursor:"default",width:P,height:F},R)},W,{ref:function(Q){T.container=Q}}),xe.createElement(bv,ql({},me,{width:P,height:F,title:L,desc:G,style:$X}),this.renderClipPath(),pC(I,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])})(j.Component);Qt(v,"displayName",n),Qt(v,"defaultProps",nt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),Qt(v,"getDerivedStateFromProps",function(y,E){var O=y.dataKey,T=y.data,A=y.children,I=y.width,C=y.height,P=y.layout,F=y.stackOffset,R=y.margin,$=E.dataStartIndex,L=E.dataEndIndex;if(E.updateId===void 0){var G=JE(y);return nt(nt(nt({},G),{},{updateId:0},N(nt(nt({props:y},G),{},{updateId:0}),E)),{},{prevDataKey:O,prevData:T,prevWidth:I,prevHeight:C,prevLayout:P,prevStackOffset:F,prevMargin:R,prevChildren:A})}if(O!==E.prevDataKey||T!==E.prevData||I!==E.prevWidth||C!==E.prevHeight||P!==E.prevLayout||F!==E.prevStackOffset||!Vl(R,E.prevMargin)){var X=JE(y),me={chartX:E.chartX,chartY:E.chartY,isTooltipActive:E.isTooltipActive},se=nt(nt({},XE(E,T,P)),{},{updateId:E.updateId+1}),ee=nt(nt(nt({},X),me),se);return nt(nt(nt({},ee),N(nt({props:y},ee),E)),{},{prevDataKey:O,prevData:T,prevWidth:I,prevHeight:C,prevLayout:P,prevStackOffset:F,prevMargin:R,prevChildren:A})}if(!xv(A,E.prevChildren)){var W,U,Q,Y,H=Za(A,mc),te=H&&(W=(U=H.props)===null||U===void 0?void 0:U.startIndex)!==null&&W!==void 0?W:$,fe=H&&(Q=(Y=H.props)===null||Y===void 0?void 0:Y.endIndex)!==null&&Q!==void 0?Q:L,Le=te!==$||fe!==L,he=!wr(T),K=he&&!Le?E.updateId:E.updateId+1;return nt(nt({updateId:K},N(nt(nt({props:y},E),{},{updateId:K,dataStartIndex:te,dataEndIndex:fe}),E)),{},{prevChildren:A,dataStartIndex:te,dataEndIndex:fe})}return null}),Qt(v,"renderActiveDot",function(y,E,O){var T;return j.isValidElement(y)?T=j.cloneElement(y,E):lr(y)?T=y(E):T=xe.createElement(rj,E),xe.createElement(Br,{className:"recharts-active-dot",key:O},T)});var w=j.forwardRef(function(E,O){return xe.createElement(v,ql({},E,{ref:O}))});return w.displayName=v.displayName,w},QE=OO({chartName:"BarChart",GraphicalChild:ho,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:vu},{axisType:"yAxis",AxisComp:wu}],formatAxisMap:sK}),e4=OO({chartName:"PieChart",GraphicalChild:ti,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Qf},{axisType:"radiusAxis",AxisComp:Jf}],formatAxisMap:Yz,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const YX="https://erp-backend-kfut.onrender.com/api",zt=tn.create({baseURL:YX,headers:{"Content-Type":"application/json"}});zt.interceptors.request.use(e=>{let t,n;const a=localStorage.getItem("erp.auth");if(a)try{const s=JSON.parse(a);t=s.token,n=s.user?.schoolCode}catch(s){console.error("Error parsing auth data:",s)}return n||(n=localStorage.getItem("erp.schoolCode")),t||(t=localStorage.getItem("token")),t&&(e.headers.Authorization=`Bearer ${t}`),n&&(e.headers["x-school-code"]=n),e});const pa={addUser:async(e,t,n)=>{try{return(await zt.post(`/school-users/${e}/users`,t,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}})).data}catch(a){throw new Error(a.response?.data?.message||"Failed to add user")}},getAllUsers:async(e,t)=>{try{console.log(` Calling API: GET /school-users/${e}/users`),console.log(` Using token: ${t?t.substring(0,20)+"...":"MISSING"}`);const n=await zt.get(`/school-users/${e}/users`,{headers:{Authorization:`Bearer ${t}`}});return console.log(" API Response:",n),n.data||{}}catch(n){console.error(" API Error Details:",{message:n.message,status:n.response?.status,statusText:n.response?.statusText,data:n.response?.data,url:n.config?.url,headers:n.config?.headers});const a=n.response?.data?.message||n.message||"Failed to fetch users";throw new Error(a)}},getUsersByRole:async(e,t,n)=>{try{return(await zt.get(`/school-users/${e}/users/role/${t}`,{headers:{Authorization:`Bearer ${n}`}})).data}catch(a){throw new Error(a.response?.data?.message||"Failed to fetch users")}},getUser:async(e,t,n)=>{try{return(await zt.get(`/school-users/${e}/users/${t}`,{headers:{Authorization:`Bearer ${n}`}})).data}catch(a){throw new Error(a.response?.data?.message||"Failed to fetch user")}},updateUser:async(e,t,n,a)=>{try{return(await zt.put(`/school-users/${e}/users/${t}`,n,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})).data}catch(s){throw new Error(s.response?.data?.message||"Failed to update user")}},resetPassword:async(e,t,n)=>{try{return(await zt.post(`/school-users/${e}/users/${t}/reset-password`,{},{headers:{Authorization:`Bearer ${n}`}})).data}catch(a){throw new Error(a.response?.data?.message||"Failed to reset password")}},changePassword:async(e,t,n,a)=>{try{return(await zt.post(`/school-users/${e}/users/${t}/change-password`,{newPassword:n},{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})).data}catch(s){throw new Error(s.response?.data?.message||"Failed to change password")}},toggleStatus:async(e,t,n,a)=>{try{return(await zt.patch(`/school-users/${e}/users/${t}/status`,{isActive:n},{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})).data}catch(s){throw new Error(s.response?.data?.message||"Failed to update user status")}},getSchoolUsers:async()=>{try{const e=await zt.get("/users/role/student");return e.data.data||e.data||[]}catch(e){throw console.error("Error fetching school users:",e),new Error(e.response?.data?.message||"Failed to fetch school users")}},deleteUser:async(e,t,n)=>{try{return(await zt.delete(`/school-users/${e}/users/${t}`,{headers:{Authorization:`Bearer ${n}`}})).data}catch(a){throw new Error(a.response?.data?.message||"Failed to delete user")}},getAccessMatrix:async(e,t)=>{try{return(await zt.get(`/school-users/${e}/access-matrix`,{headers:{Authorization:`Bearer ${t}`}})).data}catch(n){throw new Error(n.response?.data?.message||"Failed to fetch access matrix")}},updateAccessMatrix:async(e,t,n)=>{try{return(await zt.put(`/school-users/${e}/access-matrix`,{matrix:t},{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}})).data}catch(a){throw new Error(a.response?.data?.message||"Failed to update access matrix")}},importUsers:async(e,t,n,a)=>{try{const s=new FormData;return s.append("file",t),s.append("role",n),await zt.post(`/school-users/${e}/import/users`,s,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"multipart/form-data"}})}catch(s){throw s.response?s.response.data:new Error("Import failed: An unknown error occurred")}},verifyAdminAndGetPasswords:async(e,t,n,a)=>{try{return(await zt.post(`/school-users/${e}/verify-admin-password`,{adminPassword:t,teacherUserId:n},{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})).data}catch(s){throw new Error(s.response?.data?.message||"Failed to verify password")}}},ri=Object.create(null);ri.open="0";ri.close="1";ri.ping="2";ri.pong="3";ri.message="4";ri.upgrade="5";ri.noop="6";const lh=Object.create(null);Object.keys(ri).forEach(e=>{lh[ri[e]]=e});const R1={type:"error",data:"parser error"},_O=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",MO=typeof ArrayBuffer=="function",RO=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,mj=({type:e,data:t},n,a)=>_O&&t instanceof Blob?n?a(t):t4(t,a):MO&&(t instanceof ArrayBuffer||RO(t))?n?a(t):t4(new Blob([t]),a):a(ri[e]+(t||"")),t4=(e,t)=>{const n=new FileReader;return n.onload=function(){const a=n.result.split(",")[1];t("b"+(a||""))},n.readAsDataURL(e)};function r4(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Vb;function KX(e,t){if(_O&&e.data instanceof Blob)return e.data.arrayBuffer().then(r4).then(t);if(MO&&(e.data instanceof ArrayBuffer||RO(e.data)))return t(r4(e.data));mj(e,!1,n=>{Vb||(Vb=new TextEncoder),t(Vb.encode(n))})}const n4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ad=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<n4.length;e++)Ad[n4.charCodeAt(e)]=e;const GX=e=>{let t=e.length*.75,n=e.length,a,s=0,i,l,d,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const m=new ArrayBuffer(t),p=new Uint8Array(m);for(a=0;a<n;a+=4)i=Ad[e.charCodeAt(a)],l=Ad[e.charCodeAt(a+1)],d=Ad[e.charCodeAt(a+2)],u=Ad[e.charCodeAt(a+3)],p[s++]=i<<2|l>>4,p[s++]=(l&15)<<4|d>>2,p[s++]=(d&3)<<6|u&63;return m},XX=typeof ArrayBuffer=="function",hj=(e,t)=>{if(typeof e!="string")return{type:"message",data:$O(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:JX(e.substring(1),t)}:lh[n]?e.length>1?{type:lh[n],data:e.substring(1)}:{type:lh[n]}:R1},JX=(e,t)=>{if(XX){const n=GX(e);return $O(n,t)}else return{base64:!0,data:e}},$O=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},LO="",ZX=(e,t)=>{const n=e.length,a=new Array(n);let s=0;e.forEach((i,l)=>{mj(i,!1,d=>{a[l]=d,++s===n&&t(a.join(LO))})})},QX=(e,t)=>{const n=e.split(LO),a=[];for(let s=0;s<n.length;s++){const i=hj(n[s],t);if(a.push(i),i.type==="error")break}return a};function eJ(){return new TransformStream({transform(e,t){KX(e,n=>{const a=n.length;let s;if(a<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,a);else if(a<65536){s=new Uint8Array(3);const i=new DataView(s.buffer);i.setUint8(0,126),i.setUint16(1,a)}else{s=new Uint8Array(9);const i=new DataView(s.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(a))}e.data&&typeof e.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(n)})}})}let Wb;function eh(e){return e.reduce((t,n)=>t+n.length,0)}function th(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let a=0;for(let s=0;s<t;s++)n[s]=e[0][a++],a===e[0].length&&(e.shift(),a=0);return e.length&&a<e[0].length&&(e[0]=e[0].slice(a)),n}function tJ(e,t){Wb||(Wb=new TextDecoder);const n=[];let a=0,s=-1,i=!1;return new TransformStream({transform(l,d){for(n.push(l);;){if(a===0){if(eh(n)<1)break;const u=th(n,1);i=(u[0]&128)===128,s=u[0]&127,s<126?a=3:s===126?a=1:a=2}else if(a===1){if(eh(n)<2)break;const u=th(n,2);s=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),a=3}else if(a===2){if(eh(n)<8)break;const u=th(n,8),m=new DataView(u.buffer,u.byteOffset,u.length),p=m.getUint32(0);if(p>Math.pow(2,21)-1){d.enqueue(R1);break}s=p*Math.pow(2,32)+m.getUint32(4),a=3}else{if(eh(n)<s)break;const u=th(n,s);d.enqueue(hj(i?u:Wb.decode(u),t)),a=0}if(s===0||s>e){d.enqueue(R1);break}}}})}const FO=4;function In(e){if(e)return rJ(e)}function rJ(e){for(var t in In.prototype)e[t]=In.prototype[t];return e}In.prototype.on=In.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};In.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};In.prototype.off=In.prototype.removeListener=In.prototype.removeAllListeners=In.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var a,s=0;s<n.length;s++)if(a=n[s],a===t||a.fn===t){n.splice(s,1);break}return n.length===0&&delete this._callbacks["$"+e],this};In.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(n){n=n.slice(0);for(var a=0,s=n.length;a<s;++a)n[a].apply(this,t)}return this};In.prototype.emitReserved=In.prototype.emit;In.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};In.prototype.hasListeners=function(e){return!!this.listeners(e).length};const lp=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),fs=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),nJ="arraybuffer";function BO(e,...t){return t.reduce((n,a)=>(e.hasOwnProperty(a)&&(n[a]=e[a]),n),{})}const aJ=fs.setTimeout,sJ=fs.clearTimeout;function cp(e,t){t.useNativeTimers?(e.setTimeoutFn=aJ.bind(fs),e.clearTimeoutFn=sJ.bind(fs)):(e.setTimeoutFn=fs.setTimeout.bind(fs),e.clearTimeoutFn=fs.clearTimeout.bind(fs))}const iJ=1.33;function oJ(e){return typeof e=="string"?lJ(e):Math.ceil((e.byteLength||e.size)*iJ)}function lJ(e){let t=0,n=0;for(let a=0,s=e.length;a<s;a++)t=e.charCodeAt(a),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(a++,n+=4);return n}function UO(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function cJ(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function dJ(e){let t={},n=e.split("&");for(let a=0,s=n.length;a<s;a++){let i=n[a].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class uJ extends Error{constructor(t,n,a){super(t),this.description=n,this.context=a,this.type="TransportError"}}class fj extends In{constructor(t){super(),this.writable=!1,cp(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,a){return super.emitReserved("error",new uJ(t,n,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=hj(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=cJ(t);return n.length?"?"+n:""}}class mJ extends fj{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let a=0;this._polling&&(a++,this.once("pollComplete",function(){--a||n()})),this.writable||(a++,this.once("drain",function(){--a||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};QX(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,ZX(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=UO()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let zO=!1;try{zO=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const hJ=zO;function fJ(){}class pJ extends mJ{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let a=location.port;a||(a=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||a!==t.port}}doWrite(t,n){const a=this.request({method:"POST",data:t});a.on("success",n),a.on("error",(s,i)=>{this.onError("xhr post error",s,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,a)=>{this.onError("xhr poll error",n,a)}),this.pollXhr=t}}class Zs extends In{constructor(t,n,a){super(),this.createRequest=t,cp(this,a),this._opts=a,this._method=a.method||"GET",this._uri=n,this._data=a.data!==void 0?a.data:null,this._create()}_create(){var t;const n=BO(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const a=this._xhr=this.createRequest(n);try{a.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&a.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{a.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(a),"withCredentials"in a&&(a.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(a.timeout=this._opts.requestTimeout),a.onreadystatechange=()=>{var s;a.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(a.getResponseHeader("set-cookie"))),a.readyState===4&&(a.status===200||a.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof a.status=="number"?a.status:0)},0))},a.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=Zs.requestsCount++,Zs.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=fJ,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Zs.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Zs.requestsCount=0;Zs.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",a4);else if(typeof addEventListener=="function"){const e="onpagehide"in fs?"pagehide":"unload";addEventListener(e,a4,!1)}}function a4(){for(let e in Zs.requests)Zs.requests.hasOwnProperty(e)&&Zs.requests[e].abort()}const gJ=(function(){const e=qO({xdomain:!1});return e&&e.responseType!==null})();class xJ extends pJ{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=gJ&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Zs(qO,this.uri(),t)}}function qO(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||hJ))return new XMLHttpRequest}catch{}if(!t)try{return new fs[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const HO=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class yJ extends fj{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,a=HO?{}:BO(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(a.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,a)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const a=t[n],s=n===t.length-1;mj(a,this.supportsBinary,i=>{try{this.doWrite(a,i)}catch{}s&&lp(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=UO()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const Yb=fs.WebSocket||fs.MozWebSocket;class bJ extends yJ{createSocket(t,n,a){return HO?new Yb(t,n,a):n?new Yb(t,n):new Yb(t)}doWrite(t,n){this.ws.send(n)}}class vJ extends fj{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=tJ(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=t.readable.pipeThrough(n).getReader(),s=eJ();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const i=()=>{a.read().then(({done:d,value:u})=>{d||(this.onPacket(u),i())}).catch(d=>{})};i();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const a=t[n],s=n===t.length-1;this._writer.write(a).then(()=>{s&&lp(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const wJ={websocket:bJ,webtransport:vJ,polling:xJ},jJ=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,NJ=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function $1(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),a=e.indexOf("]");n!=-1&&a!=-1&&(e=e.substring(0,n)+e.substring(n,a).replace(/:/g,";")+e.substring(a,e.length));let s=jJ.exec(e||""),i={},l=14;for(;l--;)i[NJ[l]]=s[l]||"";return n!=-1&&a!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=SJ(i,i.path),i.queryKey=CJ(i,i.query),i}function SJ(e,t){const n=/\/{2,9}/g,a=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&a.splice(0,1),t.slice(-1)=="/"&&a.splice(a.length-1,1),a}function CJ(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,s,i){s&&(n[s]=i)}),n}const L1=typeof addEventListener=="function"&&typeof removeEventListener=="function",ch=[];L1&&addEventListener("offline",()=>{ch.forEach(e=>e())},!1);class mo extends In{constructor(t,n){if(super(),this.binaryType=nJ,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const a=$1(t);n.hostname=a.host,n.secure=a.protocol==="https"||a.protocol==="wss",n.port=a.port,a.query&&(n.query=a.query)}else n.host&&(n.hostname=$1(n.host).host);cp(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(a=>{const s=a.prototype.name;this.transports.push(s),this._transportsByName[s]=a}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=dJ(this.opts.query)),L1&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ch.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=FO,n.transport=t,this.id&&(n.sid=this.id);const a=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](a)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&mo.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",mo.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let a=0;a<this.writeBuffer.length;a++){const s=this.writeBuffer[a].data;if(s&&(n+=oJ(s)),a>0&&n>this._maxPayload)return this.writeBuffer.slice(0,a);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,lp(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,a){return this._sendPacket("message",t,n,a),this}send(t,n,a){return this._sendPacket("message",t,n,a),this}_sendPacket(t,n,a,s){if(typeof n=="function"&&(s=n,n=void 0),typeof a=="function"&&(s=a,a=null),this.readyState==="closing"||this.readyState==="closed")return;a=a||{},a.compress=a.compress!==!1;const i={type:t,data:n,options:a};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},a=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():t()}):this.upgrading?a():t()),this}_onError(t){if(mo.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),L1&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const a=ch.indexOf(this._offlineEventListener);a!==-1&&ch.splice(a,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}mo.protocol=FO;class kJ extends mo{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),a=!1;mo.priorWebsocketSuccess=!1;const s=()=>{a||(n.send([{type:"ping",data:"probe"}]),n.once("packet",f=>{if(!a)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;mo.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{a||this.readyState!=="closed"&&(p(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const g=new Error("probe error");g.transport=n.name,this.emitReserved("upgradeError",g)}}))};function i(){a||(a=!0,p(),n.close(),n=null)}const l=f=>{const g=new Error("probe error: "+f);g.transport=n.name,i(),this.emitReserved("upgradeError",g)};function d(){l("transport closed")}function u(){l("socket closed")}function m(f){n&&f.name!==n.name&&i()}const p=()=>{n.removeListener("open",s),n.removeListener("error",l),n.removeListener("close",d),this.off("close",u),this.off("upgrading",m)};n.once("open",s),n.once("error",l),n.once("close",d),this.once("close",u),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{a||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let a=0;a<t.length;a++)~this.transports.indexOf(t[a])&&n.push(t[a]);return n}}let AJ=class extends kJ{constructor(t,n={}){const a=typeof t=="object"?t:n;(!a.transports||a.transports&&typeof a.transports[0]=="string")&&(a.transports=(a.transports||["polling","websocket","webtransport"]).map(s=>wJ[s]).filter(s=>!!s)),super(t,a)}};function IJ(e,t="",n){let a=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),a=$1(e)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const i=a.host.indexOf(":")!==-1?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+i+":"+a.port+t,a.href=a.protocol+"://"+i+(n&&n.port===a.port?"":":"+a.port),a}const EJ=typeof ArrayBuffer=="function",PJ=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,VO=Object.prototype.toString,TJ=typeof Blob=="function"||typeof Blob<"u"&&VO.call(Blob)==="[object BlobConstructor]",DJ=typeof File=="function"||typeof File<"u"&&VO.call(File)==="[object FileConstructor]";function pj(e){return EJ&&(e instanceof ArrayBuffer||PJ(e))||TJ&&e instanceof Blob||DJ&&e instanceof File}function dh(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,a=e.length;n<a;n++)if(dh(e[n]))return!0;return!1}if(pj(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return dh(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&dh(e[n]))return!0;return!1}function OJ(e){const t=[],n=e.data,a=e;return a.data=F1(n,t),a.attachments=t.length,{packet:a,buffers:t}}function F1(e,t){if(!e)return e;if(pj(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let a=0;a<e.length;a++)n[a]=F1(e[a],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=F1(e[a],t));return n}return e}function _J(e,t){return e.data=B1(e.data,t),delete e.attachments,e}function B1(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=B1(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=B1(e[n],t));return e}const MJ=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],RJ=5;var jr;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(jr||(jr={}));class $J{constructor(t){this.replacer=t}encode(t){return(t.type===jr.EVENT||t.type===jr.ACK)&&dh(t)?this.encodeAsBinary({type:t.type===jr.EVENT?jr.BINARY_EVENT:jr.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===jr.BINARY_EVENT||t.type===jr.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=OJ(t),a=this.encodeAsString(n.packet),s=n.buffers;return s.unshift(a),s}}function s4(e){return Object.prototype.toString.call(e)==="[object Object]"}class gj extends In{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const a=n.type===jr.BINARY_EVENT;a||n.type===jr.BINARY_ACK?(n.type=a?jr.EVENT:jr.ACK,this.reconstructor=new LJ(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(pj(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const a={type:Number(t.charAt(0))};if(jr[a.type]===void 0)throw new Error("unknown packet type "+a.type);if(a.type===jr.BINARY_EVENT||a.type===jr.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const l=t.substring(i,n);if(l!=Number(l)||t.charAt(n)!=="-")throw new Error("Illegal attachments");a.attachments=Number(l)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););a.nsp=t.substring(i,n)}else a.nsp="/";const s=t.charAt(n+1);if(s!==""&&Number(s)==s){const i=n+1;for(;++n;){const l=t.charAt(n);if(l==null||Number(l)!=l){--n;break}if(n===t.length)break}a.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(gj.isPayloadValid(a.type,i))a.data=i;else throw new Error("invalid payload")}return a}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case jr.CONNECT:return s4(n);case jr.DISCONNECT:return n===void 0;case jr.CONNECT_ERROR:return typeof n=="string"||s4(n);case jr.EVENT:case jr.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&MJ.indexOf(n[0])===-1);case jr.ACK:case jr.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class LJ{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=_J(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const FJ=Object.freeze(Object.defineProperty({__proto__:null,Decoder:gj,Encoder:$J,get PacketType(){return jr},protocol:RJ},Symbol.toStringTag,{value:"Module"}));function Ts(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const BJ=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class WO extends In{constructor(t,n,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Ts(t,"open",this.onopen.bind(this)),Ts(t,"packet",this.onpacket.bind(this)),Ts(t,"error",this.onerror.bind(this)),Ts(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var a,s,i;if(BJ.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const l={type:jr.EVENT,data:n};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const p=this.ids++,f=n.pop();this._registerAckCallback(p,f),l.id=p}const d=(s=(a=this.io.engine)===null||a===void 0?void 0:a.transport)===null||s===void 0?void 0:s.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!d||(u?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(t,n){var a;const s=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(s===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let d=0;d<this.sendBuffer.length;d++)this.sendBuffer[d].id===t&&this.sendBuffer.splice(d,1);n.call(this,new Error("operation has timed out"))},s),l=(...d)=>{this.io.clearTimeoutFn(i),n.apply(this,d)};l.withError=!0,this.acks[t]=l}emitWithAck(t,...n){return new Promise((a,s)=>{const i=(l,d)=>l?s(l):a(d);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...i)=>a!==this._queue[0]?void 0:(s!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(s)):(this._queue.shift(),n&&n(null,...i)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:jr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(a=>String(a.id)===t)){const a=this.acks[t];delete this.acks[t],a.withError&&a.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case jr.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case jr.EVENT:case jr.BINARY_EVENT:this.onevent(t);break;case jr.ACK:case jr.BINARY_ACK:this.onack(t);break;case jr.DISCONNECT:this.ondisconnect();break;case jr.CONNECT_ERROR:this.destroy();const a=new Error(t.data.message);a.data=t.data.data,this.emitReserved("connect_error",a);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const a of n)a.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let a=!1;return function(...s){a||(a=!0,n.packet({type:jr.ACK,id:t,data:s}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:jr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let a=0;a<n.length;a++)if(t===n[a])return n.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let a=0;a<n.length;a++)if(t===n[a])return n.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const a of n)a.apply(this,t.data)}}}function _c(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}_c.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=(Math.floor(t*10)&1)==0?e-n:e+n}return Math.min(e,this.max)|0};_c.prototype.reset=function(){this.attempts=0};_c.prototype.setMin=function(e){this.ms=e};_c.prototype.setMax=function(e){this.max=e};_c.prototype.setJitter=function(e){this.jitter=e};class U1 extends In{constructor(t,n){var a;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,cp(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((a=n.randomizationFactor)!==null&&a!==void 0?a:.5),this.backoff=new _c({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const s=n.parser||FJ;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new AJ(this.uri,this.opts);const n=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;const s=Ts(n,"open",function(){a.onopen(),t&&t()}),i=d=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",d),t?t(d):this.maybeReconnectOnOpen()},l=Ts(n,"error",i);if(this._timeout!==!1){const d=this._timeout,u=this.setTimeoutFn(()=>{s(),i(new Error("timeout")),n.close()},d);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(s),this.subs.push(l),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Ts(t,"ping",this.onping.bind(this)),Ts(t,"data",this.ondata.bind(this)),Ts(t,"error",this.onerror.bind(this)),Ts(t,"close",this.onclose.bind(this)),Ts(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){lp(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let a=this.nsps[t];return a?this._autoConnect&&!a.active&&a.connect():(a=new WO(this,t,n),this.nsps[t]=a),a}_destroy(t){const n=Object.keys(this.nsps);for(const a of n)if(this.nsps[a].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let a=0;a<n.length;a++)this.engine.write(n[a],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var a;this.cleanup(),(a=this.engine)===null||a===void 0||a.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const a=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},n);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const jd={};function uh(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=IJ(e,t.path||"/socket.io"),a=n.source,s=n.id,i=n.path,l=jd[s]&&i in jd[s].nsps,d=t.forceNew||t["force new connection"]||t.multiplex===!1||l;let u;return d?u=new U1(a,t):(jd[s]||(jd[s]=new U1(a,t)),u=jd[s]),n.query&&!t.query&&(t.query=n.queryKey),u.socket(n.path,t)}Object.assign(uh,{Manager:U1,Socket:WO,io:uh,connect:uh});let UJ={data:""},zJ=e=>{if(typeof window=="object"){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||UJ},qJ=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,HJ=/\/\*[^]*?\*\/|  +/g,i4=/\n+/g,so=(e,t)=>{let n="",a="",s="";for(let i in e){let l=e[i];i[0]=="@"?i[1]=="i"?n=i+" "+l+";":a+=i[1]=="f"?so(l,i):i+"{"+so(l,i[1]=="k"?"":t)+"}":typeof l=="object"?a+=so(l,t?t.replace(/([^,])+/g,d=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,d):d?d+" "+u:u)):i):l!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=so.p?so.p(i,l):i+":"+l+";")}return n+(t&&s?t+"{"+s+"}":s)+a},bi={},YO=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+YO(e[n]);return t}return e},VJ=(e,t,n,a,s)=>{let i=YO(e),l=bi[i]||(bi[i]=(u=>{let m=0,p=11;for(;m<u.length;)p=101*p+u.charCodeAt(m++)>>>0;return"go"+p})(i));if(!bi[l]){let u=i!==e?e:(m=>{let p,f,g=[{}];for(;p=qJ.exec(m.replace(HJ,""));)p[4]?g.shift():p[3]?(f=p[3].replace(i4," ").trim(),g.unshift(g[0][f]=g[0][f]||{})):g[0][p[1]]=p[2].replace(i4," ").trim();return g[0]})(e);bi[l]=so(s?{["@keyframes "+l]:u}:u,n?"":"."+l)}let d=n&&bi.g?bi.g:null;return n&&(bi.g=bi[l]),((u,m,p,f)=>{f?m.data=m.data.replace(f,u):m.data.indexOf(u)===-1&&(m.data=p?u+m.data:m.data+u)})(bi[l],t,a,d),l},WJ=(e,t,n)=>e.reduce((a,s,i)=>{let l=t[i];if(l&&l.call){let d=l(n),u=d&&d.props&&d.props.className||/^go/.test(d)&&d;l=u?"."+u:d&&typeof d=="object"?d.props?"":so(d,""):d===!1?"":d}return a+s+(l??"")},"");function dp(e){let t=this||{},n=e.call?e(t.p):e;return VJ(n.unshift?n.raw?WJ(n,[].slice.call(arguments,1),t.p):n.reduce((a,s)=>Object.assign(a,s&&s.call?s(t.p):s),{}):n,zJ(t.target),t.g,t.o,t.k)}let KO,z1,q1;dp.bind({g:1});let Oi=dp.bind({k:1});function YJ(e,t,n,a){so.p=t,KO=e,z1=n,q1=a}function bo(e,t){let n=this||{};return function(){let a=arguments;function s(i,l){let d=Object.assign({},i),u=d.className||s.className;n.p=Object.assign({theme:z1&&z1()},d),n.o=/ *go\d+/.test(u),d.className=dp.apply(n,a)+(u?" "+u:"");let m=e;return e[0]&&(m=d.as||e,delete d.as),q1&&m[0]&&q1(d),KO(m,d)}return s}}var KJ=e=>typeof e=="function",hf=(e,t)=>KJ(e)?e(t):e,GJ=(()=>{let e=0;return()=>(++e).toString()})(),GO=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),XJ=20,xj="default",XO=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:a}=t;return XO(e,{type:e.toasts.find(l=>l.id===a.id)?1:0,toast:a});case 3:let{toastId:s}=t;return{...e,toasts:e.toasts.map(l=>l.id===s||s===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+i}))}}},mh=[],JO={toasts:[],pausedAt:void 0,settings:{toastLimit:XJ}},Ks={},ZO=(e,t=xj)=>{Ks[t]=XO(Ks[t]||JO,e),mh.forEach(([n,a])=>{n===t&&a(Ks[t])})},QO=e=>Object.keys(Ks).forEach(t=>ZO(e,t)),JJ=e=>Object.keys(Ks).find(t=>Ks[t].toasts.some(n=>n.id===e)),up=(e=xj)=>t=>{ZO(t,e)},ZJ={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},QJ=(e={},t=xj)=>{let[n,a]=j.useState(Ks[t]||JO),s=j.useRef(Ks[t]);j.useEffect(()=>(s.current!==Ks[t]&&a(Ks[t]),mh.push([t,a]),()=>{let l=mh.findIndex(([d])=>d===t);l>-1&&mh.splice(l,1)}),[t]);let i=n.toasts.map(l=>{var d,u,m;return{...e,...e[l.type],...l,removeDelay:l.removeDelay||((d=e[l.type])==null?void 0:d.removeDelay)||e?.removeDelay,duration:l.duration||((u=e[l.type])==null?void 0:u.duration)||e?.duration||ZJ[l.type],style:{...e.style,...(m=e[l.type])==null?void 0:m.style,...l.style}}});return{...n,toasts:i}},eZ=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:n?.id||GJ()}),$u=e=>(t,n)=>{let a=eZ(t,e,n);return up(a.toasterId||JJ(a.id))({type:2,toast:a}),a.id},ge=(e,t)=>$u("blank")(e,t);ge.error=$u("error");ge.success=$u("success");ge.loading=$u("loading");ge.custom=$u("custom");ge.dismiss=(e,t)=>{let n={type:3,toastId:e};t?up(t)(n):QO(n)};ge.dismissAll=e=>ge.dismiss(void 0,e);ge.remove=(e,t)=>{let n={type:4,toastId:e};t?up(t)(n):QO(n)};ge.removeAll=e=>ge.remove(void 0,e);ge.promise=(e,t,n)=>{let a=ge.loading(t.loading,{...n,...n?.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let i=t.success?hf(t.success,s):void 0;return i?ge.success(i,{id:a,...n,...n?.success}):ge.dismiss(a),s}).catch(s=>{let i=t.error?hf(t.error,s):void 0;i?ge.error(i,{id:a,...n,...n?.error}):ge.dismiss(a)}),e};var tZ=1e3,rZ=(e,t="default")=>{let{toasts:n,pausedAt:a}=QJ(e,t),s=j.useRef(new Map).current,i=j.useCallback((f,g=tZ)=>{if(s.has(f))return;let N=setTimeout(()=>{s.delete(f),l({type:4,toastId:f})},g);s.set(f,N)},[]);j.useEffect(()=>{if(a)return;let f=Date.now(),g=n.map(N=>{if(N.duration===1/0)return;let v=(N.duration||0)+N.pauseDuration-(f-N.createdAt);if(v<0){N.visible&&ge.dismiss(N.id);return}return setTimeout(()=>ge.dismiss(N.id,t),v)});return()=>{g.forEach(N=>N&&clearTimeout(N))}},[n,a,t]);let l=j.useCallback(up(t),[t]),d=j.useCallback(()=>{l({type:5,time:Date.now()})},[l]),u=j.useCallback((f,g)=>{l({type:1,toast:{id:f,height:g}})},[l]),m=j.useCallback(()=>{a&&l({type:6,time:Date.now()})},[a,l]),p=j.useCallback((f,g)=>{let{reverseOrder:N=!1,gutter:v=8,defaultPosition:w}=g||{},y=n.filter(T=>(T.position||w)===(f.position||w)&&T.height),E=y.findIndex(T=>T.id===f.id),O=y.filter((T,A)=>A<E&&T.visible).length;return y.filter(T=>T.visible).slice(...N?[O+1]:[0,O]).reduce((T,A)=>T+(A.height||0)+v,0)},[n]);return j.useEffect(()=>{n.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let g=s.get(f.id);g&&(clearTimeout(g),s.delete(f.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:u,startPause:d,endPause:m,calculateOffset:p}}},nZ=Oi`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,aZ=Oi`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,sZ=Oi`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,iZ=bo("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${nZ} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${aZ} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${sZ} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,oZ=Oi`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,lZ=bo("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${oZ} 1s linear infinite;
`,cZ=Oi`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,dZ=Oi`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,uZ=bo("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${cZ} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${dZ} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,mZ=bo("div")`
  position: absolute;
`,hZ=bo("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,fZ=Oi`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,pZ=bo("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${fZ} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,gZ=({toast:e})=>{let{icon:t,type:n,iconTheme:a}=e;return t!==void 0?typeof t=="string"?j.createElement(pZ,null,t):t:n==="blank"?null:j.createElement(hZ,null,j.createElement(lZ,{...a}),n!=="loading"&&j.createElement(mZ,null,n==="error"?j.createElement(iZ,{...a}):j.createElement(uZ,{...a})))},xZ=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,yZ=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,bZ="0%{opacity:0;} 100%{opacity:1;}",vZ="0%{opacity:1;} 100%{opacity:0;}",wZ=bo("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,jZ=bo("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,NZ=(e,t)=>{let n=e.includes("top")?1:-1,[a,s]=GO()?[bZ,vZ]:[xZ(n),yZ(n)];return{animation:t?`${Oi(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Oi(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},SZ=j.memo(({toast:e,position:t,style:n,children:a})=>{let s=e.height?NZ(e.position||t||"top-center",e.visible):{opacity:0},i=j.createElement(gZ,{toast:e}),l=j.createElement(jZ,{...e.ariaProps},hf(e.message,e));return j.createElement(wZ,{className:e.className,style:{...s,...n,...e.style}},typeof a=="function"?a({icon:i,message:l}):j.createElement(j.Fragment,null,i,l))});YJ(j.createElement);var CZ=({id:e,className:t,style:n,onHeightUpdate:a,children:s})=>{let i=j.useCallback(l=>{if(l){let d=()=>{let u=l.getBoundingClientRect().height;a(e,u)};d(),new MutationObserver(d).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,a]);return j.createElement("div",{ref:i,className:t,style:n},s)},kZ=(e,t)=>{let n=e.includes("top"),a=n?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:GO()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...a,...s}},AZ=dp`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,rh=16,IZ=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:a,children:s,toasterId:i,containerStyle:l,containerClassName:d})=>{let{toasts:u,handlers:m}=rZ(n,i);return j.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:rh,left:rh,right:rh,bottom:rh,pointerEvents:"none",...l},className:d,onMouseEnter:m.startPause,onMouseLeave:m.endPause},u.map(p=>{let f=p.position||t,g=m.calculateOffset(p,{reverseOrder:e,gutter:a,defaultPosition:t}),N=kZ(f,g);return j.createElement(CZ,{id:p.id,key:p.id,onHeightUpdate:m.updateHeight,className:p.visible?AZ:"",style:N},p.type==="custom"?hf(p.message,p):s?s(p):j.createElement(SZ,{toast:p,position:f}))}))},_t=ge;const EZ=()=>{const{user:e,token:t,logout:n}=yr(),[a,s]=j.useState(null),[i,l]=j.useState([]),[d,u]=j.useState(!0),[m,p]=j.useState(null),[f,g]=j.useState(null),[N,v]=j.useState(!1),[w,y]=j.useState("0.0%"),[E,O]=j.useState([]),[T,A]=j.useState({present:0,absent:0}),[I,C]=j.useState({present:0,absent:0}),[P,F]=j.useState({present:0,absent:0}),[R,$]=j.useState([]),[L,G]=j.useState([]),X=j.useRef(null),[me,se]=j.useState(!0),ee=()=>{if(t)return t;try{const K=localStorage.getItem("erp.auth");if(K)return JSON.parse(K).token}catch(K){console.warn("Failed to parse auth data from localStorage:",K)}return localStorage.getItem("token")||sessionStorage.getItem("token")};j.useEffect(()=>{if((async()=>{try{u(!0),p(null);const be={user:e,schoolIdentifier:e?.schoolId||e?.schoolCode,token:!!ee(),timestamp:new Date().toISOString()};console.log(" Starting fetchSchoolAndUsers with debug info:",be),g(be);const re=e?.schoolId||e?.schoolCode;if(!re)throw new Error("No school identifier found. Please log out and log back in to refresh your school association.");if(re){const ie=ee();if(!ie)throw new Error("No authentication token found. Please log in again.");try{console.log(" Fetching school details from school_info collection");try{const ne=await ot.get("/schools/database/school-info");console.log(" School response from school_info:",ne);const Te=ne.data?.data||ne.data;console.log(" Extracted school data:",Te),s(Te),be.schoolFetch={success:!0,source:"school_info",schoolName:Te?.name}}catch(ne){console.warn(" Failed to fetch from school_info, trying main database:",ne.message);const Te=await ot.get(`/schools/${re}/info`);console.log(" School response from main database:",Te);const ve=Te.data?.data||Te.data;console.log(" Extracted school data (fallback):",ve),s(ve),be.schoolFetch={success:!0,source:"main_database",schoolName:ve?.name}}}catch(ne){console.error(" Error fetching school:",ne),console.error(" Error details:",ne.response?.data),be.schoolFetch={success:!1,error:ne.message,status:ne.response?.status,data:ne.response?.data}}try{const ne=e?.schoolCode||"P";console.log(" Fetching users for school code:",ne);const Te=await pa.getAllUsers(ne,ie);console.log(" Users response:",Te);let ve=[];if(Te&&Te.data&&Array.isArray(Te.data))ve=Te.data;else if(Te&&typeof Te=="object"){const Ie=["admin","teacher","student","parent"];for(const je of Ie)Te[je]&&Array.isArray(Te[je])&&ve.push(...Te[je].map(oe=>({...oe,role:je})))}const We=ve.map(Ie=>{const je={...Ie};return je.name&&typeof je.name=="object"&&(je.name=je.name.displayName||((je.name.firstName||"")+" "+(je.name.lastName||"")).trim()||je.email),je});l(We),be.usersFetch={success:!0,totalUsers:ve.length,breakdown:ve.reduce((Ie,je)=>(Ie[je.role]=(Ie[je.role]||0)+1,Ie),{})}}catch(ne){throw console.error(" Error fetching users:",ne),be.usersFetch={success:!1,error:ne.message,status:ne.response?.status,data:ne.response?.data},ne}g({...be})}else console.log("  User object:",e),be.noSchoolInfo=!0,e?.role==="superadmin"?(p(null),s(null),l([]),be.superadminMode=!0):(p("No school associated with this account. Please contact support."),console.error(" No schoolId or schoolCode found in user object:",e),be.missingSchoolAssociation=!0),g({...be})}catch(be){console.error(" Error in fetchSchoolAndUsers:",be),p(`Failed to load school information: ${be.message}`),g({...f,generalError:{message:be.message,stack:be.stack,response:be.response?.data}})}finally{u(!1)}})(),console.log("[DASHBOARD] User data:",e),console.log("[DASHBOARD] School code:",e?.schoolCode),console.log("[DASHBOARD] Socket ref exists:",!!X.current),e?.schoolCode&&!X.current){const be="https://erp-backend-kfut.onrender.com/api".replace("/api","")||"http://localhost:5050";console.log(" [DASHBOARD] Connecting to socket server:",be),console.log(" [DASHBOARD] Will join school room:",e.schoolCode),X.current=uh(be,{transports:["polling","websocket"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,timeout:1e4}),X.current.on("connect",()=>{console.log(" [DASHBOARD] Socket connected! ID:",X.current?.id),e.schoolCode&&(X.current?.emit("join-school",e.schoolCode),console.log(" [DASHBOARD] Emitted join-school event for:",e.schoolCode))}),X.current.on("connect_error",re=>{console.error(" [DASHBOARD] Socket connection error:",re.message)}),X.current.on("sos-alert",re=>{console.log(" [DASHBOARD] SOS ALERT RECEIVED!",re),console.log("[DASHBOARD] Current alerts before adding:",L),G(ie=>{console.log("[DASHBOARD] Adding alert to list. Previous:",ie);const ne=[re,...ie];return console.log("[DASHBOARD] New alerts list:",ne),ne}),console.log("[DASHBOARD] Showing toast notification..."),ge.error(` EMERGENCY: ${re.studentName} (${re.studentClass}) has sent an SOS alert!`,{duration:1e4,position:"top-center",style:{background:"#DC2626",color:"#fff",fontWeight:"bold",fontSize:"16px",padding:"16px",borderRadius:"8px"}}),console.log("[DASHBOARD] Toast notification triggered");try{new Audio("/alert-sound.mp3").play().catch(ne=>console.log("Could not play alert sound:",ne))}catch{console.log("Audio not available")}}),X.current.on("sos-acknowledged",re=>{console.log(" [DASHBOARD] SOS acknowledged:",re),G(ie=>ie.filter(ne=>ne.id!==re.alertId)),ge.success(`SOS alert acknowledged by ${re.adminName}`)}),X.current.on("disconnect",re=>{console.log(" [DASHBOARD] Socket disconnected. Reason:",re)}),console.log(" [DASHBOARD] Socket event listeners registered")}else console.log(" [DASHBOARD] Socket not initialized. Reasons:"),console.log("  - Has schoolCode?",!!e?.schoolCode),console.log("  - Socket already exists?",!!X.current);return()=>{X.current&&(X.current.disconnect(),X.current=null)}},[e]),console.log(e),j.useEffect(()=>{(async()=>{try{const be=ee();if(!be||!e?.schoolCode)return;const re=new Date().toISOString().split("T")[0];console.log(" Fetching today's attendance rate for:",re);const ie=await fetch(`https://erp-backend-kfut.onrender.com/api/attendance/stats?date=${re}`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});if(ie.ok){const ne=await ie.json();if(console.log(" Today's attendance data:",ne),ne.success){const Te=(ne.presentCount||0)+(ne.absentCount||0);if(Te>0){const ve=((ne.presentCount||0)/Te*100).toFixed(1);y(`${ve}%`)}else y("0.0%")}}}catch(be){console.error("Error fetching today's attendance rate:",be)}})()},[e]),j.useEffect(()=>{(async()=>{try{const be=ee();if(!be||!e?.schoolCode)return;const re=new Date().toISOString().split("T")[0];console.log(" Fetching today's attendance for:",re);const ie=await fetch(`https://erp-backend-kfut.onrender.com/api/attendance/stats?date=${re}`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});if(ie.ok){const ve=await ie.json();console.log(" Today's attendance data:",ve),ve.success&&A({present:ve.presentCount||0,absent:ve.absentCount||0})}const ne=await fetch(`https://erp-backend-kfut.onrender.com/api/attendance/session-data?date=${re}&session=morning`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});if(ne.ok){const ve=await ne.json();console.log(" Morning attendance data:",ve),ve.success&&C({present:ve.presentCount||0,absent:ve.absentCount||0})}const Te=await fetch(`https://erp-backend-kfut.onrender.com/api/attendance/session-data?date=${re}&session=afternoon`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});if(Te.ok){const ve=await Te.json();console.log(" Afternoon attendance data:",ve),ve.success&&F({present:ve.presentCount||0,absent:ve.absentCount||0})}}catch(be){console.error("Error fetching today's attendance:",be)}})()},[e]),j.useEffect(()=>{(async()=>{try{const be=ee();if(!be||!e?.schoolCode)return;const re=new Date,ie=[];for(let Te=6;Te>=0;Te--){const ve=new Date(re);ve.setDate(ve.getDate()-Te),ie.push(ve)}console.log(" Fetching attendance for last 7 days");const ne=await fetch(`https://erp-backend-kfut.onrender.com/api/attendance/daily-stats?schoolCode=${e.schoolCode}`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});if(ne.ok){const Te=await ne.json();if(console.log(" Daily attendance data:",Te),Te.success&&Te.dailyStats){const ve=Te.dailyStats.map(We=>({name:new Date(We.date).toLocaleDateString("en-US",{weekday:"short"}),attendance:We.attendanceRate||0,date:We.date}));O(ve)}else{const ve=ie.map(We=>({name:We.toLocaleDateString("en-US",{weekday:"short"}),attendance:0,date:We.toISOString().split("T")[0]}));O(ve)}}else{const Te=ie.map(ve=>({name:ve.toLocaleDateString("en-US",{weekday:"short"}),attendance:0,date:ve.toISOString().split("T")[0]}));O(Te)}}catch(be){console.error("Error fetching daily attendance:",be);const re=new Date,ie=[];for(let ne=6;ne>=0;ne--){const Te=new Date(re);Te.setDate(Te.getDate()-ne),ie.push({name:Te.toLocaleDateString("en-US",{weekday:"short"}),attendance:0,date:Te.toISOString().split("T")[0]})}O(ie)}})()},[e]),j.useEffect(()=>{(async()=>{try{const be=ee();if(!be||!e?.schoolCode)return;console.log(" Fetching class performance data");const re=await fetch("https://erp-backend-kfut.onrender.com/api/results/class-performance-stats",{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});if(re.ok){const ie=await re.json();console.log(" Class performance data:",ie),ie.success&&ie.data&&$(ie.data)}}catch(be){console.error("Error fetching class performance:",be)}})()},[e]);const W=K=>K?K.startsWith("http")?K:K.startsWith("/uploads")?`${"https://erp-backend-kfut.onrender.com/api".replace(/\/api\/?$/,"")}${K}`:K:"",U=K=>{!X.current||!e||(X.current.emit("acknowledge-sos",{alertId:K,schoolCode:e.schoolCode,adminId:e._id,adminName:e.name||"Admin"}),G(be=>be.filter(re=>re.id!==K)))},Q=K=>{G(be=>be.filter(re=>re.id!==K))},Y=i.filter(K=>K.role==="student").length,H=i.filter(K=>K.role==="teacher").length,te=[{name:"Total Students",value:Y.toString(),icon:$n,color:"bg-blue-500"},{name:"Attendance Rate",value:w,icon:_s,color:"bg-green-500"},{name:"Total Teachers",value:H.toString(),icon:xs,color:"bg-purple-500"}],fe=E.length>0?E:[{name:"Mon",attendance:0},{name:"Tue",attendance:0},{name:"Wed",attendance:0},{name:"Thu",attendance:0},{name:"Fri",attendance:0},{name:"Sat",attendance:0},{name:"Sun",attendance:0}],Le=[{name:"Present",value:I.present,color:"#10B981"},{name:"Absent",value:I.absent,color:"#EF4444"}],he=[{name:"Present",value:P.present,color:"#10B981"},{name:"Absent",value:P.absent,color:"#EF4444"}];return r.jsx("div",{className:"space-y-6",children:d?r.jsxs("div",{className:"flex justify-center items-center h-64",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),r.jsx("span",{className:"ml-4 text-gray-600",children:"Loading school data..."})]}):m?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-md",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(sa,{className:"h-5 w-5 text-red-400 mr-2"}),r.jsx("p",{className:"text-red-700 font-medium",children:"Error Loading Data"})]}),r.jsx("p",{className:"text-red-600 mt-2",children:m}),r.jsxs("div",{className:"mt-3 flex gap-2",children:[r.jsxs("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-3 py-2 border border-red-300 rounded-md text-sm font-medium text-red-700 bg-red-50 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500",children:[r.jsx(xf,{className:"h-4 w-4 mr-2"}),"Retry"]}),!ee()&&r.jsx("button",{onClick:()=>{n(),window.location.href="/login"},className:"inline-flex items-center px-3 py-2 border border-red-300 rounded-md text-sm font-medium text-red-700 bg-red-50 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Login Again"})]})]}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 p-4 rounded-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(R6,{className:"h-5 w-5 text-gray-500 mr-2"}),r.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Debug Information"})]}),r.jsxs("button",{onClick:()=>v(!N),className:"text-sm text-gray-500 hover:text-gray-700",children:[N?"Hide":"Show"," Details"]})]}),N&&f&&r.jsx("div",{className:"bg-white p-3 rounded border text-xs",children:r.jsx("pre",{className:"whitespace-pre-wrap overflow-x-auto text-gray-600",children:JSON.stringify(f,null,2)})}),r.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[r.jsxs("p",{children:["User Role: ",e?.role]}),r.jsxs("p",{children:["School ID: ",e?.schoolId||"Not found"]}),r.jsxs("p",{children:["School Code: ",e?.schoolCode||"Not found"]}),r.jsxs("p",{children:["Token Available: ",ee()?"Yes":"No"]})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Dashboard"}),r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs("div",{className:"text-xs sm:text-sm text-gray-500",children:["Last updated: ",new Date().toLocaleDateString()]})})]}),L.length>0&&me&&r.jsx("div",{className:"space-y-3",children:L.map(K=>r.jsx("div",{className:"bg-red-50 border-2 border-red-500 rounded-lg p-4 shadow-lg animate-pulse",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Zo,{className:"h-8 w-8 text-red-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("h3",{className:"text-lg font-bold text-red-900",children:" EMERGENCY SOS ALERT"}),r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-600 text-white animate-pulse",children:"URGENT"})]}),r.jsxs("div",{className:"space-y-1 text-sm text-red-800",children:[r.jsxs("p",{className:"font-semibold text-base",children:["Student: ",r.jsx("span",{className:"text-red-900",children:K.studentName})]}),r.jsxs("p",{children:["Class: ",r.jsx("span",{className:"font-medium",children:K.studentClass}),K.studentRollNo&&r.jsxs("span",{className:"ml-3",children:["Roll No: ",r.jsx("span",{className:"font-medium",children:K.studentRollNo})]})]}),K.studentMobile&&K.studentMobile!=="N/A"&&r.jsxs("p",{children:["Mobile: ",r.jsx("a",{href:`tel:${K.studentMobile}`,className:"font-medium text-red-900 hover:underline",children:K.studentMobile})]}),r.jsxs("p",{children:["Time: ",r.jsx("span",{className:"font-medium",children:new Date(K.timestamp).toLocaleString()})]}),K.location&&r.jsxs("p",{children:["Location: ",r.jsx("span",{className:"font-medium",children:K.location})]})]})]})]}),r.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[r.jsx("button",{onClick:()=>U(K.id),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors",children:"Acknowledge"}),r.jsx("button",{onClick:()=>Q(K.id),className:"inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors",children:"Dismiss"})]})]})},K.id))}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:r.jsx("div",{className:"p-4 sm:p-6",children:r.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-4 sm:gap-6",children:[a?.logoUrl&&r.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 border border-gray-200 rounded-lg p-2 flex-shrink-0",children:r.jsx("img",{src:W(a.logoUrl),alt:`${a.name} logo`,className:"w-full h-full object-contain"})}),r.jsxs("div",{className:"flex-grow text-center md:text-left",children:[r.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2",children:a?.name||e?.schoolName||"Your School"}),r.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-2 sm:gap-3 mb-3",children:[r.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700 border border-gray-300",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1.5",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a?.code||"N/A"]}),a?.affiliationBoard&&r.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700 border border-gray-300",children:a.affiliationBoard})]}),a?.address&&r.jsxs("div",{className:"flex items-start justify-center md:justify-start text-gray-600 mb-2",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2 mt-0.5 flex-shrink-0",children:[r.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),r.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),r.jsxs("span",{className:"text-sm",children:[a.address.street&&a.address.city?`${a.address.street}, ${a.address.city}`:a.address.street||a.address.city||"Address not available",a.address.state&&`, ${a.address.state}`,a.address.pinCode&&` - ${a.address.pinCode}`]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-3 sm:gap-4 text-gray-600 text-xs sm:text-sm",children:[(a?.contact?.phone||a?.mobile)&&r.jsxs("div",{className:"flex items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1.5",children:r.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),a.contact?.phone||a.mobile]}),(a?.contact?.email||a?.principalEmail)&&r.jsxs("div",{className:"flex items-center",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1.5",children:[r.jsx("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}),r.jsx("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"})]}),a.contact?.email||a.principalEmail]}),(a?.contact?.website||a?.website)&&r.jsxs("div",{className:"flex items-center",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1.5",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"2",x2:"22",y1:"12",y2:"12"}),r.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),r.jsx("a",{href:(a.contact?.website||a.website)?.startsWith("http")?a.contact?.website||a.website:`https://${a.contact?.website||a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:a.contact?.website||a.website})]})]})]})]})})}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:te.map(K=>r.jsx("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:`${K.color} p-3 rounded-lg`,children:r.jsx(K.icon,{className:"h-6 w-6 text-white"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:K.name}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K.value})]})]})},K.name))}),r.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200",children:[r.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4",children:["Associated Users",r.jsxs("span",{className:"text-xs sm:text-sm font-normal text-gray-500 ml-2",children:["(",i.length," total)"]})]}),r.jsxs("div",{className:"overflow-x-auto",children:[r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{scope:"col",className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),r.jsx("th",{scope:"col",className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell",children:"Email"}),r.jsx("th",{scope:"col",className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),r.jsx("th",{scope:"col",className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.length>0?i.slice(0,5).map(K=>r.jsxs("tr",{children:[r.jsxs("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900",children:typeof K.name=="string"?K.name:K.name?.displayName||((K.name?.firstName||"")+" "+(K.name?.lastName||"")).trim()||K.email||"Unknown User"}),r.jsx("div",{className:"text-xs text-gray-500 sm:hidden",children:K.email})]}),r.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap hidden sm:table-cell",children:r.jsx("div",{className:"text-sm text-gray-500",children:K.email})}),r.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${K.role==="admin"?"bg-purple-100 text-purple-800":K.role==="teacher"?"bg-blue-100 text-blue-800":K.role==="student"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:K.role.charAt(0).toUpperCase()+K.role.slice(1)})}),r.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${K.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:K.isActive?"Active":"Inactive"})})]},K._id)):r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"px-3 sm:px-6 py-4 text-center text-xs sm:text-sm text-gray-500",children:"No users found for this school"})})})]}),i.length>5&&r.jsx("div",{className:"px-3 sm:px-6 py-4 text-center",children:r.jsxs(ph,{to:"/admin/users",className:"text-xs sm:text-sm text-blue-600 hover:text-blue-800",children:["View all ",i.length," users"]})})]})]}),r.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200",children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4",children:"Class Performance"}),R.length>0?r.jsx(qm,{width:"100%",height:300,children:r.jsxs(QE,{data:R,children:[r.jsx(k1,{strokeDasharray:"3 3"}),r.jsx(vu,{dataKey:"name"}),r.jsx(wu,{domain:[0,100],label:{value:"Percentage (%)",angle:-90,position:"insideLeft"}}),r.jsx(Qa,{formatter:(K,be,re)=>[`${K}%`,`Average: ${K}% (${re.payload.studentCount} students)`],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"}}),r.jsx(ho,{dataKey:"percentage",fill:"#10B981",radius:[4,4,0,0]})]})}):r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("p",{children:"No performance data available"}),r.jsx("p",{className:"text-sm mt-2",children:"Results will appear here once students' grades are entered"})]})]}),r.jsx("div",{className:"mt-2",children:r.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center",children:"Today's Attendance"})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[r.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-center mb-4",children:[r.jsx("div",{className:"bg-yellow-100 p-2 rounded-full mr-2",children:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-yellow-600",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),r.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),r.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),r.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),r.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),r.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),r.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),r.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]})}),r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Morning Session"})]}),r.jsx(qm,{width:"100%",height:200,children:r.jsxs(e4,{children:[r.jsx(ti,{data:Le,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,dataKey:"value",label:({name:K,value:be,percent:re})=>`${K}: ${be} (${(re*100).toFixed(1)}%)`,labelLine:!0,children:Le.map((K,be)=>r.jsx(Vd,{fill:K.color},`cell-${be}`))}),r.jsx(Qa,{formatter:K=>[`${K} students`,"Count"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"}})]})}),r.jsx("div",{className:"flex justify-center space-x-6 mt-4",children:Le.map(K=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:K.color}}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:K.name}),r.jsx("span",{className:"text-xl font-bold text-gray-900 ml-2",children:K.value})]})]},K.name))}),I.present+I.absent>0&&r.jsxs("div",{className:"text-center mt-3 text-xs text-gray-500",children:["Total: ",I.present+I.absent," students"]})]}),r.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-center mb-4",children:[r.jsx("div",{className:"bg-orange-100 p-2 rounded-full mr-2",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-orange-600",children:r.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})})}),r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Afternoon Session"})]}),r.jsx(qm,{width:"100%",height:200,children:r.jsxs(e4,{children:[r.jsx(ti,{data:he,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,dataKey:"value",label:({name:K,value:be,percent:re})=>`${K}: ${be} (${(re*100).toFixed(1)}%)`,labelLine:!0,children:he.map((K,be)=>r.jsx(Vd,{fill:K.color},`cell-${be}`))}),r.jsx(Qa,{formatter:K=>[`${K} students`,"Count"],contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"}})]})}),r.jsx("div",{className:"flex justify-center space-x-6 mt-4",children:he.map(K=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:K.color}}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:K.name}),r.jsx("span",{className:"text-xl font-bold text-gray-900 ml-2",children:K.value})]})]},K.name))}),P.present+P.absent>0&&r.jsxs("div",{className:"text-center mt-3 text-xs text-gray-500",children:["Total: ",P.present+P.absent," students"]})]})]}),r.jsx("div",{className:"flex justify-center",children:r.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200 w-full lg:w-3/4 xl:w-1/2",children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4 text-center",children:"Weekly Attendance"}),r.jsx(qm,{width:"100%",height:250,children:r.jsxs(QE,{data:fe,children:[r.jsx(k1,{strokeDasharray:"3 3"}),r.jsx(vu,{dataKey:"name"}),r.jsx(wu,{}),r.jsx(Qa,{}),r.jsx(ho,{dataKey:"attendance",fill:"#3B82F6",radius:[4,4,0,0]})]})})]})})]})})},e5=j.createContext(void 0),pn=()=>{const e=j.useContext(e5);if(!e)throw new Error("useAcademicYear must be used within AcademicYearProvider");return e},t5=({children:e,schoolCode:t})=>{const[n,a]=j.useState("2024-2025"),[s,i]=j.useState("2024-2025"),[l,d]=j.useState("2024-04-01"),[u,m]=j.useState("2025-03-31"),[p,f]=j.useState(!0),[g,N]=j.useState(null),[v,w]=j.useState([]),y=async()=>{try{f(!0),N(null);const I=localStorage.getItem("erp.auth"),C=I?JSON.parse(I).token:null;let P=t;if(!P&&I){const R=JSON.parse(I);P=R.user?.schoolCode||R.schoolCode}if(!P){console.warn("No school code available for fetching academic year"),f(!1);return}console.log(` Fetching academic year for school: ${P}`);const F=await ot.get(`/admin/academic-year/${P}`,{headers:C?{Authorization:`Bearer ${C}`}:{}});if(F.data.success){const{currentYear:R,startDate:$,endDate:L}=F.data.data;a(R||"2024-2025"),i(R||"2024-2025"),d($?$.split("T")[0]:"2024-04-01"),m(L?L.split("T")[0]:"2025-03-31");const G=A(R||"2024-2025");w(G),console.log(` Academic year loaded: ${R}`)}}catch(I){console.error("Error fetching academic year:",I),N(I.message||"Failed to fetch academic year")}finally{f(!1)}};j.useEffect(()=>{y()},[t]);const E=async()=>{await y()},O=I=>{i(I),console.log(` Switched to viewing academic year: ${I}`)},T=s!==n,A=I=>{const C=[],P=I.split("-"),F=parseInt(P[0]),R=P[1].length===2,$=F+1,L=$+1;C.push(R?`${$}-${String(L).slice(-2)}`:`${$}-${L}`),C.push(I);for(let G=1;G<=3;G++){const X=F-G,me=X+1;C.push(R?`${X}-${String(me).slice(-2)}`:`${X}-${me}`)}return C};return r.jsx(e5.Provider,{value:{currentAcademicYear:n,viewingAcademicYear:s,academicYearStart:l,academicYearEnd:u,loading:p,error:g,isViewingHistoricalYear:T,refreshAcademicYear:E,setViewingYear:O,availableYears:v},children:e})},Ea=()=>{const{user:e,token:t}=yr(),[n,a]=j.useState(null),[s,i]=j.useState(!1),[l,d]=j.useState(null),u=async()=>{if(!e?.schoolCode||!t){d("School code or authentication token not available");return}i(!0),d(null);try{const[E,O]=await Promise.all([zt.get(`/admin/classes/${e.schoolCode}/classes-sections`),zt.get(`/admin/classes/${e.schoolCode}/tests`)]),T=E.data;if(!T.success)throw new Error(T.message||"Failed to fetch classes");let A={tests:[],testsByClass:{},totalTests:0};try{const C=O.data;C.success&&(A=C.data)}catch(C){console.log("Tests endpoint failed, continuing without tests:",C)}const I={...T.data,...A};a(I),console.log(" Classes, sections, and tests loaded:",I)}catch(E){console.error("Error fetching school data:",E),d(E.message||"Failed to fetch school data")}finally{i(!1)}},m=async E=>{if(!e?.schoolCode||!t)throw new Error("School code or authentication token not available");try{const T=(await zt.get(`/admin/classes/${e.schoolCode}/classes/${E}/sections`)).data;if(T.success)return T.data.sections;throw new Error(T.message||"Failed to fetch sections")}catch(O){throw console.error("Error fetching sections for class:",O),O}};j.useEffect(()=>{u()},[e?.schoolCode,t]);const p=j.useCallback(()=>n?.classOptions||[],[n?.classOptions]),f=j.useCallback(()=>n?.allSections||[],[n?.allSections]),g=j.useCallback(E=>n?.sectionsByClass[E]||[],[n?.sectionsByClass]),N=j.useCallback(()=>(n?.totalClasses||0)>0,[n?.totalClasses]),v=j.useCallback(()=>n?.tests||[],[n?.tests]),w=j.useCallback(E=>n?.testsByClass[E]||[],[n?.testsByClass]),y=j.useCallback(()=>(n?.totalTests||0)>0,[n?.totalTests]);return{classesData:n,loading:s,error:l,refetch:u,getSectionsForClass:m,getClassOptions:p,getAllSections:f,getSectionsByClass:g,hasClasses:N,getAllTests:v,getTestsByClass:w,hasTests:y}},Kb=[{id:1,name:"Andhra Pradesh",code:"AP"},{id:2,name:"Arunachal Pradesh",code:"AR"},{id:3,name:"Assam",code:"AS"},{id:4,name:"Bihar",code:"BR"},{id:5,name:"Chhattisgarh",code:"CG"},{id:6,name:"Goa",code:"GA"},{id:7,name:"Gujarat",code:"GJ"},{id:8,name:"Haryana",code:"HR"},{id:9,name:"Himachal Pradesh",code:"HP"},{id:10,name:"Jharkhand",code:"JH"},{id:11,name:"Karnataka",code:"KA"},{id:12,name:"Kerala",code:"KL"},{id:13,name:"Madhya Pradesh",code:"MP"},{id:14,name:"Maharashtra",code:"MH"},{id:15,name:"Manipur",code:"MN"},{id:16,name:"Meghalaya",code:"ML"},{id:17,name:"Mizoram",code:"MZ"},{id:18,name:"Nagaland",code:"NL"},{id:19,name:"Odisha",code:"OR"},{id:20,name:"Punjab",code:"PB"},{id:21,name:"Rajasthan",code:"RJ"},{id:22,name:"Sikkim",code:"SK"},{id:23,name:"Tamil Nadu",code:"TN"},{id:24,name:"Telangana",code:"TG"},{id:25,name:"Tripura",code:"TR"},{id:26,name:"Uttar Pradesh",code:"UP"},{id:27,name:"Uttarakhand",code:"UK"},{id:28,name:"West Bengal",code:"WB"},{id:29,name:"Andaman and Nicobar Islands",code:"AN"},{id:30,name:"Chandigarh",code:"CH"},{id:31,name:"Dadra and Nagar Haveli and Daman and Diu",code:"DN"},{id:32,name:"Delhi",code:"DL"},{id:33,name:"Jammu and Kashmir",code:"JK"},{id:34,name:"Ladakh",code:"LA"},{id:35,name:"Lakshadweep",code:"LD"},{id:36,name:"Puducherry",code:"PY"}],Gb=[{id:1001,name:"Anantapur",stateId:1},{id:1002,name:"Chittoor",stateId:1},{id:1003,name:"East Godavari",stateId:1},{id:1004,name:"Guntur",stateId:1},{id:1005,name:"Krishna",stateId:1},{id:1006,name:"Kurnool",stateId:1},{id:1007,name:"Nellore",stateId:1},{id:1008,name:"Prakasam",stateId:1},{id:1009,name:"Srikakulam",stateId:1},{id:1010,name:"Visakhapatnam",stateId:1},{id:1011,name:"Vizianagaram",stateId:1},{id:1012,name:"West Godavari",stateId:1},{id:1013,name:"YSR Kadapa",stateId:1},{id:1014,name:"Alluri Sitharama Raju",stateId:1},{id:1015,name:"Anakapalli",stateId:1},{id:1016,name:"Annamayya",stateId:1},{id:1017,name:"Bapatla",stateId:1},{id:1018,name:"Dr. B.R. Ambedkar Konaseema",stateId:1},{id:1019,name:"Eluru",stateId:1},{id:1020,name:"Kakinada",stateId:1},{id:1021,name:"NTR",stateId:1},{id:1022,name:"Nandyal",stateId:1},{id:1023,name:"Palnadu",stateId:1},{id:1024,name:"Parvathipuram Manyam",stateId:1},{id:1025,name:"Sri Potti Sriramulu Nellore",stateId:1},{id:1026,name:"Sri Sathya Sai",stateId:1},{id:2001,name:"Anjaw",stateId:2},{id:2002,name:"Changlang",stateId:2},{id:2003,name:"Dibang Valley",stateId:2},{id:2004,name:"East Kameng",stateId:2},{id:2005,name:"East Siang",stateId:2},{id:2006,name:"Kamle",stateId:2},{id:2007,name:"Kra Daadi",stateId:2},{id:2008,name:"Kurung Kumey",stateId:2},{id:2009,name:"Lepa Rada",stateId:2},{id:2010,name:"Lohit",stateId:2},{id:2011,name:"Longding",stateId:2},{id:2012,name:"Lower Dibang Valley",stateId:2},{id:2013,name:"Lower Siang",stateId:2},{id:2014,name:"Lower Subansiri",stateId:2},{id:2015,name:"Namsai",stateId:2},{id:2016,name:"Pakke Kessang",stateId:2},{id:2017,name:"Papum Pare",stateId:2},{id:2018,name:"Shi Yomi",stateId:2},{id:2019,name:"Siang",stateId:2},{id:2020,name:"Tawang",stateId:2},{id:2021,name:"Tirap",stateId:2},{id:2022,name:"Upper Siang",stateId:2},{id:2023,name:"Upper Subansiri",stateId:2},{id:2024,name:"West Kameng",stateId:2},{id:2025,name:"West Siang",stateId:2},{id:2026,name:"Itanagar Capital Complex",stateId:2},{id:3001,name:"Baksa",stateId:3},{id:3002,name:"Barpeta",stateId:3},{id:3003,name:"Biswanath",stateId:3},{id:3004,name:"Bongaigaon",stateId:3},{id:3005,name:"Cachar",stateId:3},{id:3006,name:"Charaideo",stateId:3},{id:3007,name:"Chirang",stateId:3},{id:3008,name:"Darrang",stateId:3},{id:3009,name:"Dhemaji",stateId:3},{id:3010,name:"Dhubri",stateId:3},{id:3011,name:"Dibrugarh",stateId:3},{id:3012,name:"Dima Hasao",stateId:3},{id:3013,name:"Goalpara",stateId:3},{id:3014,name:"Golaghat",stateId:3},{id:3015,name:"Hailakandi",stateId:3},{id:3016,name:"Hojai",stateId:3},{id:3017,name:"Jorhat",stateId:3},{id:3018,name:"Kamrup",stateId:3},{id:3019,name:"Kamrup Metropolitan",stateId:3},{id:3020,name:"Karbi Anglong",stateId:3},{id:3021,name:"Karimganj",stateId:3},{id:3022,name:"Kokrajhar",stateId:3},{id:3023,name:"Lakhimpur",stateId:3},{id:3024,name:"Majuli",stateId:3},{id:3025,name:"Morigaon",stateId:3},{id:3026,name:"Nagaon",stateId:3},{id:3027,name:"Nalbari",stateId:3},{id:3028,name:"Sivasagar",stateId:3},{id:3029,name:"Sonitpur",stateId:3},{id:3030,name:"South Salmara-Mankachar",stateId:3},{id:3031,name:"Tinsukia",stateId:3},{id:3032,name:"Udalguri",stateId:3},{id:3033,name:"West Karbi Anglong",stateId:3},{id:3034,name:"Bajali",stateId:3},{id:3035,name:"Tamulpur",stateId:3},{id:4001,name:"Araria",stateId:4},{id:4002,name:"Arwal",stateId:4},{id:4003,name:"Aurangabad",stateId:4},{id:4004,name:"Banka",stateId:4},{id:4005,name:"Begusarai",stateId:4},{id:4006,name:"Bhagalpur",stateId:4},{id:4007,name:"Bhojpur",stateId:4},{id:4008,name:"Buxar",stateId:4},{id:4009,name:"Darbhanga",stateId:4},{id:4010,name:"East Champaran",stateId:4},{id:4011,name:"Gaya",stateId:4},{id:4012,name:"Gopalganj",stateId:4},{id:4013,name:"Jamui",stateId:4},{id:4014,name:"Jehanabad",stateId:4},{id:4015,name:"Kaimur",stateId:4},{id:4016,name:"Katihar",stateId:4},{id:4017,name:"Khagaria",stateId:4},{id:4018,name:"Kishanganj",stateId:4},{id:4019,name:"Lakhisarai",stateId:4},{id:4020,name:"Madhepura",stateId:4},{id:4021,name:"Madhubani",stateId:4},{id:4022,name:"Munger",stateId:4},{id:4023,name:"Muzaffarpur",stateId:4},{id:4024,name:"Nalanda",stateId:4},{id:4025,name:"Nawada",stateId:4},{id:4026,name:"Patna",stateId:4},{id:4027,name:"Purnia",stateId:4},{id:4028,name:"Rohtas",stateId:4},{id:4029,name:"Saharsa",stateId:4},{id:4030,name:"Samastipur",stateId:4},{id:4031,name:"Saran",stateId:4},{id:4032,name:"Sheikhpura",stateId:4},{id:4033,name:"Sheohar",stateId:4},{id:4034,name:"Sitamarhi",stateId:4},{id:4035,name:"Siwan",stateId:4},{id:4036,name:"Supaul",stateId:4},{id:4037,name:"Vaishali",stateId:4},{id:4038,name:"West Champaran",stateId:4},{id:5001,name:"Balod",stateId:5},{id:5002,name:"Baloda Bazar",stateId:5},{id:5003,name:"Balrampur",stateId:5},{id:5004,name:"Bastar",stateId:5},{id:5005,name:"Bemetara",stateId:5},{id:5006,name:"Bijapur",stateId:5},{id:5007,name:"Bilaspur",stateId:5},{id:5008,name:"Dantewada",stateId:5},{id:5009,name:"Dhamtari",stateId:5},{id:5010,name:"Durg",stateId:5},{id:5011,name:"Gariaband",stateId:5},{id:5012,name:"Gaurela Pendra Marwahi",stateId:5},{id:5013,name:"Janjgir Champa",stateId:5},{id:5014,name:"Jashpur",stateId:5},{id:5015,name:"Kabirdham",stateId:5},{id:5016,name:"Kanker",stateId:5},{id:5017,name:"Kondagaon",stateId:5},{id:5018,name:"Korba",stateId:5},{id:5019,name:"Koriya",stateId:5},{id:5020,name:"Mahasamund",stateId:5},{id:5021,name:"Manendragarh Chirmiri Bharatpur",stateId:5},{id:5022,name:"Mohla Manpur",stateId:5},{id:5023,name:"Mungeli",stateId:5},{id:5024,name:"Narayanpur",stateId:5},{id:5025,name:"Raigarh",stateId:5},{id:5026,name:"Raipur",stateId:5},{id:5027,name:"Rajnandgaon",stateId:5},{id:5028,name:"Sakti",stateId:5},{id:5029,name:"Sarangarh Bilaigarh",stateId:5},{id:5030,name:"Sukma",stateId:5},{id:5031,name:"Surajpur",stateId:5},{id:5032,name:"Surguja",stateId:5},{id:5033,name:"Khairagarh",stateId:5},{id:6001,name:"North Goa",stateId:6},{id:6002,name:"South Goa",stateId:6},{id:7001,name:"Ahmedabad",stateId:7},{id:7002,name:"Amreli",stateId:7},{id:7003,name:"Anand",stateId:7},{id:7004,name:"Aravalli",stateId:7},{id:7005,name:"Banaskantha",stateId:7},{id:7006,name:"Bharuch",stateId:7},{id:7007,name:"Bhavnagar",stateId:7},{id:7008,name:"Botad",stateId:7},{id:7009,name:"Chhota Udaipur",stateId:7},{id:7010,name:"Dahod",stateId:7},{id:7011,name:"Dang",stateId:7},{id:7012,name:"Devbhoomi Dwarka",stateId:7},{id:7013,name:"Gandhinagar",stateId:7},{id:7014,name:"Gir Somnath",stateId:7},{id:7015,name:"Jamnagar",stateId:7},{id:7016,name:"Junagadh",stateId:7},{id:7017,name:"Kheda",stateId:7},{id:7018,name:"Kutch",stateId:7},{id:7019,name:"Mahisagar",stateId:7},{id:7020,name:"Mehsana",stateId:7},{id:7021,name:"Morbi",stateId:7},{id:7022,name:"Narmada",stateId:7},{id:7023,name:"Navsari",stateId:7},{id:7024,name:"Panchmahal",stateId:7},{id:7025,name:"Patan",stateId:7},{id:7026,name:"Porbandar",stateId:7},{id:7027,name:"Rajkot",stateId:7},{id:7028,name:"Sabarkantha",stateId:7},{id:7029,name:"Surat",stateId:7},{id:7030,name:"Surendranagar",stateId:7},{id:7031,name:"Tapi",stateId:7},{id:7032,name:"Vadodara",stateId:7},{id:7033,name:"Valsad",stateId:7},{id:8001,name:"Ambala",stateId:8},{id:8002,name:"Bhiwani",stateId:8},{id:8003,name:"Charkhi Dadri",stateId:8},{id:8004,name:"Faridabad",stateId:8},{id:8005,name:"Fatehabad",stateId:8},{id:8006,name:"Gurugram",stateId:8},{id:8007,name:"Hisar",stateId:8},{id:8008,name:"Jhajjar",stateId:8},{id:8009,name:"Jind",stateId:8},{id:8010,name:"Kaithal",stateId:8},{id:8011,name:"Karnal",stateId:8},{id:8012,name:"Kurukshetra",stateId:8},{id:8013,name:"Mahendragarh",stateId:8},{id:8014,name:"Nuh",stateId:8},{id:8015,name:"Palwal",stateId:8},{id:8016,name:"Panchkula",stateId:8},{id:8017,name:"Panipat",stateId:8},{id:8018,name:"Rewari",stateId:8},{id:8019,name:"Rohtak",stateId:8},{id:8020,name:"Sirsa",stateId:8},{id:8021,name:"Sonipat",stateId:8},{id:8022,name:"Yamunanagar",stateId:8},{id:9001,name:"Bilaspur",stateId:9},{id:9002,name:"Chamba",stateId:9},{id:9003,name:"Hamirpur",stateId:9},{id:9004,name:"Kangra",stateId:9},{id:9005,name:"Kinnaur",stateId:9},{id:9006,name:"Kullu",stateId:9},{id:9007,name:"Lahaul and Spiti",stateId:9},{id:9008,name:"Mandi",stateId:9},{id:9009,name:"Shimla",stateId:9},{id:9010,name:"Sirmaur",stateId:9},{id:9011,name:"Solan",stateId:9},{id:9012,name:"Una",stateId:9},{id:10001,name:"Bokaro",stateId:10},{id:10002,name:"Chatra",stateId:10},{id:10003,name:"Deoghar",stateId:10},{id:10004,name:"Dhanbad",stateId:10},{id:10005,name:"Dumka",stateId:10},{id:10006,name:"East Singhbhum",stateId:10},{id:10007,name:"Garhwa",stateId:10},{id:10008,name:"Giridih",stateId:10},{id:10009,name:"Godda",stateId:10},{id:10010,name:"Gumla",stateId:10},{id:10011,name:"Hazaribagh",stateId:10},{id:10012,name:"Jamtara",stateId:10},{id:10013,name:"Khunti",stateId:10},{id:10014,name:"Koderma",stateId:10},{id:10015,name:"Latehar",stateId:10},{id:10016,name:"Lohardaga",stateId:10},{id:10017,name:"Pakur",stateId:10},{id:10018,name:"Palamu",stateId:10},{id:10019,name:"Ramgarh",stateId:10},{id:10020,name:"Ranchi",stateId:10},{id:10021,name:"Sahebganj",stateId:10},{id:10022,name:"Seraikela Kharsawan",stateId:10},{id:10023,name:"Simdega",stateId:10},{id:10024,name:"West Singhbhum",stateId:10},{id:11001,name:"Bagalkot",stateId:11},{id:11002,name:"Ballari",stateId:11},{id:11003,name:"Belagavi",stateId:11},{id:11004,name:"Bengaluru Rural",stateId:11},{id:11005,name:"Bengaluru Urban",stateId:11},{id:11006,name:"Bidar",stateId:11},{id:11007,name:"Chamarajanagar",stateId:11},{id:11008,name:"Chikkaballapur",stateId:11},{id:11009,name:"Chikkamagaluru",stateId:11},{id:11010,name:"Chitradurga",stateId:11},{id:11011,name:"Dakshina Kannada",stateId:11},{id:11012,name:"Davanagere",stateId:11},{id:11013,name:"Dharwad",stateId:11},{id:11014,name:"Gadag",stateId:11},{id:11015,name:"Hassan",stateId:11},{id:11016,name:"Haveri",stateId:11},{id:11017,name:"Kalaburagi",stateId:11},{id:11018,name:"Kodagu",stateId:11},{id:11019,name:"Kolar",stateId:11},{id:11020,name:"Koppal",stateId:11},{id:11021,name:"Mandya",stateId:11},{id:11022,name:"Mysuru",stateId:11},{id:11023,name:"Raichur",stateId:11},{id:11024,name:"Ramanagara",stateId:11},{id:11025,name:"Shivamogga",stateId:11},{id:11026,name:"Tumakuru",stateId:11},{id:11027,name:"Udupi",stateId:11},{id:11028,name:"Uttara Kannada",stateId:11},{id:11029,name:"Vijayapura",stateId:11},{id:11030,name:"Yadgir",stateId:11},{id:11031,name:"Vijayanagara",stateId:11},{id:12001,name:"Alappuzha",stateId:12},{id:12002,name:"Ernakulam",stateId:12},{id:12003,name:"Idukki",stateId:12},{id:12004,name:"Kannur",stateId:12},{id:12005,name:"Kasaragod",stateId:12},{id:12006,name:"Kollam",stateId:12},{id:12007,name:"Kottayam",stateId:12},{id:12008,name:"Kozhikode",stateId:12},{id:12009,name:"Malappuram",stateId:12},{id:12010,name:"Palakkad",stateId:12},{id:12011,name:"Pathanamthitta",stateId:12},{id:12012,name:"Thiruvananthapuram",stateId:12},{id:12013,name:"Thrissur",stateId:12},{id:12014,name:"Wayanad",stateId:12},{id:13001,name:"Agar Malwa",stateId:13},{id:13002,name:"Alirajpur",stateId:13},{id:13003,name:"Anuppur",stateId:13},{id:13004,name:"Ashoknagar",stateId:13},{id:13005,name:"Balaghat",stateId:13},{id:13006,name:"Barwani",stateId:13},{id:13007,name:"Betul",stateId:13},{id:13008,name:"Bhind",stateId:13},{id:13009,name:"Bhopal",stateId:13},{id:13010,name:"Burhanpur",stateId:13},{id:13011,name:"Chachaura",stateId:13},{id:13012,name:"Chhatarpur",stateId:13},{id:13013,name:"Chhindwara",stateId:13},{id:13014,name:"Damoh",stateId:13},{id:13015,name:"Datia",stateId:13},{id:13016,name:"Dewas",stateId:13},{id:13017,name:"Dhar",stateId:13},{id:13018,name:"Dindori",stateId:13},{id:13019,name:"Guna",stateId:13},{id:13020,name:"Gwalior",stateId:13},{id:13021,name:"Harda",stateId:13},{id:13022,name:"Hoshangabad",stateId:13},{id:13023,name:"Indore",stateId:13},{id:13024,name:"Jabalpur",stateId:13},{id:13025,name:"Jhabua",stateId:13},{id:13026,name:"Katni",stateId:13},{id:13027,name:"Khandwa",stateId:13},{id:13028,name:"Khargone",stateId:13},{id:13029,name:"Maihar",stateId:13},{id:13030,name:"Mandla",stateId:13},{id:13031,name:"Mandsaur",stateId:13},{id:13032,name:"Morena",stateId:13},{id:13033,name:"Nagda",stateId:13},{id:13034,name:"Narsinghpur",stateId:13},{id:13035,name:"Neemuch",stateId:13},{id:13036,name:"Niwari",stateId:13},{id:13037,name:"Panna",stateId:13},{id:13038,name:"Raisen",stateId:13},{id:13039,name:"Rajgarh",stateId:13},{id:13040,name:"Ratlam",stateId:13},{id:13041,name:"Rewa",stateId:13},{id:13042,name:"Sagar",stateId:13},{id:13043,name:"Satna",stateId:13},{id:13044,name:"Sehore",stateId:13},{id:13045,name:"Seoni",stateId:13},{id:13046,name:"Shahdol",stateId:13},{id:13047,name:"Shajapur",stateId:13},{id:13048,name:"Sheopur",stateId:13},{id:13049,name:"Shivpuri",stateId:13},{id:13050,name:"Sidhi",stateId:13},{id:13051,name:"Singrauli",stateId:13},{id:13052,name:"Tikamgarh",stateId:13},{id:13053,name:"Ujjain",stateId:13},{id:13054,name:"Umaria",stateId:13},{id:13055,name:"Vidisha",stateId:13},{id:14001,name:"Ahmednagar",stateId:14},{id:14002,name:"Akola",stateId:14},{id:14003,name:"Amravati",stateId:14},{id:14004,name:"Aurangabad",stateId:14},{id:14005,name:"Beed",stateId:14},{id:14006,name:"Bhandara",stateId:14},{id:14007,name:"Buldhana",stateId:14},{id:14008,name:"Chandrapur",stateId:14},{id:14009,name:"Dhule",stateId:14},{id:14010,name:"Gadchiroli",stateId:14},{id:14011,name:"Gondia",stateId:14},{id:14012,name:"Hingoli",stateId:14},{id:14013,name:"Jalgaon",stateId:14},{id:14014,name:"Jalna",stateId:14},{id:14015,name:"Kolhapur",stateId:14},{id:14016,name:"Latur",stateId:14},{id:14017,name:"Mumbai City",stateId:14},{id:14018,name:"Mumbai Suburban",stateId:14},{id:14019,name:"Nagpur",stateId:14},{id:14020,name:"Nanded",stateId:14},{id:14021,name:"Nandurbar",stateId:14},{id:14022,name:"Nashik",stateId:14},{id:14023,name:"Osmanabad",stateId:14},{id:14024,name:"Palghar",stateId:14},{id:14025,name:"Parbhani",stateId:14},{id:14026,name:"Pune",stateId:14},{id:14027,name:"Raigad",stateId:14},{id:14028,name:"Ratnagiri",stateId:14},{id:14029,name:"Sangli",stateId:14},{id:14030,name:"Satara",stateId:14},{id:14031,name:"Sindhudurg",stateId:14},{id:14032,name:"Solapur",stateId:14},{id:14033,name:"Thane",stateId:14},{id:14034,name:"Wardha",stateId:14},{id:14035,name:"Washim",stateId:14},{id:14036,name:"Yavatmal",stateId:14},{id:15001,name:"Bishnupur",stateId:15},{id:15002,name:"Chandel",stateId:15},{id:15003,name:"Churachandpur",stateId:15},{id:15004,name:"Imphal East",stateId:15},{id:15005,name:"Imphal West",stateId:15},{id:15006,name:"Jiribam",stateId:15},{id:15007,name:"Kakching",stateId:15},{id:15008,name:"Kamjong",stateId:15},{id:15009,name:"Kangpokpi",stateId:15},{id:15010,name:"Noney",stateId:15},{id:15011,name:"Pherzawl",stateId:15},{id:15012,name:"Senapati",stateId:15},{id:15013,name:"Tamenglong",stateId:15},{id:15014,name:"Tengnoupal",stateId:15},{id:15015,name:"Thoubal",stateId:15},{id:15016,name:"Ukhrul",stateId:15},{id:16001,name:"East Garo Hills",stateId:16},{id:16002,name:"East Jaintia Hills",stateId:16},{id:16003,name:"East Khasi Hills",stateId:16},{id:16004,name:"Eastern West Khasi Hills",stateId:16},{id:16005,name:"North Garo Hills",stateId:16},{id:16006,name:"Ri Bhoi",stateId:16},{id:16007,name:"South Garo Hills",stateId:16},{id:16008,name:"South West Garo Hills",stateId:16},{id:16009,name:"South West Khasi Hills",stateId:16},{id:16010,name:"West Garo Hills",stateId:16},{id:16011,name:"West Jaintia Hills",stateId:16},{id:16012,name:"West Khasi Hills",stateId:16},{id:17001,name:"Aizawl",stateId:17},{id:17002,name:"Champhai",stateId:17},{id:17003,name:"Hnahthial",stateId:17},{id:17004,name:"Khawzawl",stateId:17},{id:17005,name:"Kolasib",stateId:17},{id:17006,name:"Lawngtlai",stateId:17},{id:17007,name:"Lunglei",stateId:17},{id:17008,name:"Mamit",stateId:17},{id:17009,name:"Saiha",stateId:17},{id:17010,name:"Saitual",stateId:17},{id:17011,name:"Serchhip",stateId:17},{id:18001,name:"Chumoukedima",stateId:18},{id:18002,name:"Dimapur",stateId:18},{id:18003,name:"Kiphire",stateId:18},{id:18004,name:"Kohima",stateId:18},{id:18005,name:"Longleng",stateId:18},{id:18006,name:"Mokokchung",stateId:18},{id:18007,name:"Mon",stateId:18},{id:18008,name:"Niuland",stateId:18},{id:18009,name:"Noklak",stateId:18},{id:18010,name:"Peren",stateId:18},{id:18011,name:"Phek",stateId:18},{id:18012,name:"Shamator",stateId:18},{id:18013,name:"Tseminyu",stateId:18},{id:18014,name:"Tuensang",stateId:18},{id:18015,name:"Wokha",stateId:18},{id:18016,name:"Zunheboto",stateId:18},{id:19001,name:"Angul",stateId:19},{id:19002,name:"Balangir",stateId:19},{id:19003,name:"Balasore",stateId:19},{id:19004,name:"Bargarh",stateId:19},{id:19005,name:"Bhadrak",stateId:19},{id:19006,name:"Boudh",stateId:19},{id:19007,name:"Cuttack",stateId:19},{id:19008,name:"Debagarh",stateId:19},{id:19009,name:"Dhenkanal",stateId:19},{id:19010,name:"Gajapati",stateId:19},{id:19011,name:"Ganjam",stateId:19},{id:19012,name:"Jagatsinghpur",stateId:19},{id:19013,name:"Jajpur",stateId:19},{id:19014,name:"Jharsuguda",stateId:19},{id:19015,name:"Kalahandi",stateId:19},{id:19016,name:"Kandhamal",stateId:19},{id:19017,name:"Kendrapara",stateId:19},{id:19018,name:"Kendujhar",stateId:19},{id:19019,name:"Khordha",stateId:19},{id:19020,name:"Koraput",stateId:19},{id:19021,name:"Malkangiri",stateId:19},{id:19022,name:"Mayurbhanj",stateId:19},{id:19023,name:"Nabarangpur",stateId:19},{id:19024,name:"Nayagarh",stateId:19},{id:19025,name:"Nuapada",stateId:19},{id:19026,name:"Puri",stateId:19},{id:19027,name:"Rayagada",stateId:19},{id:19028,name:"Sambalpur",stateId:19},{id:19029,name:"Subarnapur",stateId:19},{id:19030,name:"Sundargarh",stateId:19},{id:20001,name:"Amritsar",stateId:20},{id:20002,name:"Barnala",stateId:20},{id:20003,name:"Bathinda",stateId:20},{id:20004,name:"Faridkot",stateId:20},{id:20005,name:"Fatehgarh Sahib",stateId:20},{id:20006,name:"Fazilka",stateId:20},{id:20007,name:"Ferozepur",stateId:20},{id:20008,name:"Gurdaspur",stateId:20},{id:20009,name:"Hoshiarpur",stateId:20},{id:20010,name:"Jalandhar",stateId:20},{id:20011,name:"Kapurthala",stateId:20},{id:20012,name:"Ludhiana",stateId:20},{id:20013,name:"Malerkotla",stateId:20},{id:20014,name:"Mansa",stateId:20},{id:20015,name:"Moga",stateId:20},{id:20016,name:"Mohali",stateId:20},{id:20017,name:"Muktsar",stateId:20},{id:20018,name:"Pathankot",stateId:20},{id:20019,name:"Patiala",stateId:20},{id:20020,name:"Rupnagar",stateId:20},{id:20021,name:"Sangrur",stateId:20},{id:20022,name:"Shaheed Bhagat Singh Nagar",stateId:20},{id:20023,name:"Tarn Taran",stateId:20},{id:21001,name:"Ajmer",stateId:21},{id:21002,name:"Alwar",stateId:21},{id:21003,name:"Anupgarh",stateId:21},{id:21004,name:"Balotra",stateId:21},{id:21005,name:"Banswara",stateId:21},{id:21006,name:"Baran",stateId:21},{id:21007,name:"Barmer",stateId:21},{id:21008,name:"Beawar",stateId:21},{id:21009,name:"Bharatpur",stateId:21},{id:21010,name:"Bhilwara",stateId:21},{id:21011,name:"Bikaner",stateId:21},{id:21012,name:"Bundi",stateId:21},{id:21013,name:"Chittorgarh",stateId:21},{id:21014,name:"Churu",stateId:21},{id:21015,name:"Dausa",stateId:21},{id:21016,name:"Deeg",stateId:21},{id:21017,name:"Dholpur",stateId:21},{id:21018,name:"Didwana Kuchaman",stateId:21},{id:21019,name:"Dudu",stateId:21},{id:21020,name:"Dungarpur",stateId:21},{id:21021,name:"Ganganagar",stateId:21},{id:21022,name:"Gangapur City",stateId:21},{id:21023,name:"Hanumangarh",stateId:21},{id:21024,name:"Jaipur",stateId:21},{id:21025,name:"Jaisalmer",stateId:21},{id:21026,name:"Jalore",stateId:21},{id:21027,name:"Jhalawar",stateId:21},{id:21028,name:"Jhunjhunu",stateId:21},{id:21029,name:"Jodhpur",stateId:21},{id:21030,name:"Karauli",stateId:21},{id:21031,name:"Kekri",stateId:21},{id:21032,name:"Khairthal Tijara",stateId:21},{id:21033,name:"Kota",stateId:21},{id:21034,name:"Kotputli Behror",stateId:21},{id:21035,name:"Nagaur",stateId:21},{id:21036,name:"Neem Ka Thana",stateId:21},{id:21037,name:"Pali",stateId:21},{id:21038,name:"Phalodi",stateId:21},{id:21039,name:"Pratapgarh",stateId:21},{id:21040,name:"Rajsamand",stateId:21},{id:21041,name:"Salumbar",stateId:21},{id:21042,name:"Sanchore",stateId:21},{id:21043,name:"Sawai Madhopur",stateId:21},{id:21044,name:"Shahpura",stateId:21},{id:21045,name:"Sikar",stateId:21},{id:21046,name:"Sirohi",stateId:21},{id:21047,name:"Tonk",stateId:21},{id:21048,name:"Udaipur",stateId:21},{id:21049,name:"Jaipur Rural",stateId:21},{id:21050,name:"Jodhpur Rural",stateId:21},{id:22001,name:"East Sikkim",stateId:22},{id:22002,name:"North Sikkim",stateId:22},{id:22003,name:"Pakyong",stateId:22},{id:22004,name:"Soreng",stateId:22},{id:22005,name:"South Sikkim",stateId:22},{id:22006,name:"West Sikkim",stateId:22},{id:23001,name:"Ariyalur",stateId:23},{id:23002,name:"Chengalpattu",stateId:23},{id:23003,name:"Chennai",stateId:23},{id:23004,name:"Coimbatore",stateId:23},{id:23005,name:"Cuddalore",stateId:23},{id:23006,name:"Dharmapuri",stateId:23},{id:23007,name:"Dindigul",stateId:23},{id:23008,name:"Erode",stateId:23},{id:23009,name:"Kallakurichi",stateId:23},{id:23010,name:"Kanchipuram",stateId:23},{id:23011,name:"Kanyakumari",stateId:23},{id:23012,name:"Karur",stateId:23},{id:23013,name:"Krishnagiri",stateId:23},{id:23014,name:"Madurai",stateId:23},{id:23015,name:"Mayiladuthurai",stateId:23},{id:23016,name:"Nagapattinam",stateId:23},{id:23017,name:"Namakkal",stateId:23},{id:23018,name:"Nilgiris",stateId:23},{id:23019,name:"Perambalur",stateId:23},{id:23020,name:"Pudukkottai",stateId:23},{id:23021,name:"Ramanathapuram",stateId:23},{id:23022,name:"Ranipet",stateId:23},{id:23023,name:"Salem",stateId:23},{id:23024,name:"Sivaganga",stateId:23},{id:23025,name:"Tenkasi",stateId:23},{id:23026,name:"Thanjavur",stateId:23},{id:23027,name:"Theni",stateId:23},{id:23028,name:"Thoothukudi",stateId:23},{id:23029,name:"Tiruchirappalli",stateId:23},{id:23030,name:"Tirunelveli",stateId:23},{id:23031,name:"Tirupathur",stateId:23},{id:23032,name:"Tiruppur",stateId:23},{id:23033,name:"Tiruvallur",stateId:23},{id:23034,name:"Tiruvannamalai",stateId:23},{id:23035,name:"Tiruvarur",stateId:23},{id:23036,name:"Vellore",stateId:23},{id:23037,name:"Viluppuram",stateId:23},{id:23038,name:"Virudhunagar",stateId:23},{id:24001,name:"Adilabad",stateId:24},{id:24002,name:"Bhadradri Kothagudem",stateId:24},{id:24003,name:"Hanamkonda",stateId:24},{id:24004,name:"Hyderabad",stateId:24},{id:24005,name:"Jagtial",stateId:24},{id:24006,name:"Jangaon",stateId:24},{id:24007,name:"Jayashankar Bhupalpally",stateId:24},{id:24008,name:"Jogulamba Gadwal",stateId:24},{id:24009,name:"Kamareddy",stateId:24},{id:24010,name:"Karimnagar",stateId:24},{id:24011,name:"Khammam",stateId:24},{id:24012,name:"Komaram Bheem",stateId:24},{id:24013,name:"Mahabubabad",stateId:24},{id:24014,name:"Mahabubnagar",stateId:24},{id:24015,name:"Mancherial",stateId:24},{id:24016,name:"Medak",stateId:24},{id:24017,name:"Medchal Malkajgiri",stateId:24},{id:24018,name:"Mulugu",stateId:24},{id:24019,name:"Nagarkurnool",stateId:24},{id:24020,name:"Nalgonda",stateId:24},{id:24021,name:"Narayanpet",stateId:24},{id:24022,name:"Nirmal",stateId:24},{id:24023,name:"Nizamabad",stateId:24},{id:24024,name:"Peddapalli",stateId:24},{id:24025,name:"Rajanna Sircilla",stateId:24},{id:24026,name:"Rangareddy",stateId:24},{id:24027,name:"Sangareddy",stateId:24},{id:24028,name:"Siddipet",stateId:24},{id:24029,name:"Suryapet",stateId:24},{id:24030,name:"Vikarabad",stateId:24},{id:24031,name:"Wanaparthy",stateId:24},{id:24032,name:"Warangal",stateId:24},{id:24033,name:"Yadadri Bhuvanagiri",stateId:24},{id:25001,name:"Dhalai",stateId:25},{id:25002,name:"Gomati",stateId:25},{id:25003,name:"Khowai",stateId:25},{id:25004,name:"North Tripura",stateId:25},{id:25005,name:"Sepahijala",stateId:25},{id:25006,name:"South Tripura",stateId:25},{id:25007,name:"Unakoti",stateId:25},{id:25008,name:"West Tripura",stateId:25},{id:26001,name:"Agra",stateId:26},{id:26002,name:"Aligarh",stateId:26},{id:26003,name:"Ambedkar Nagar",stateId:26},{id:26004,name:"Amethi",stateId:26},{id:26005,name:"Amroha",stateId:26},{id:26006,name:"Auraiya",stateId:26},{id:26007,name:"Ayodhya",stateId:26},{id:26008,name:"Azamgarh",stateId:26},{id:26009,name:"Baghpat",stateId:26},{id:26010,name:"Bahraich",stateId:26},{id:26011,name:"Ballia",stateId:26},{id:26012,name:"Balrampur",stateId:26},{id:26013,name:"Banda",stateId:26},{id:26014,name:"Barabanki",stateId:26},{id:26015,name:"Bareilly",stateId:26},{id:26016,name:"Basti",stateId:26},{id:26017,name:"Bhadohi",stateId:26},{id:26018,name:"Bijnor",stateId:26},{id:26019,name:"Budaun",stateId:26},{id:26020,name:"Bulandshahr",stateId:26},{id:26021,name:"Chandauli",stateId:26},{id:26022,name:"Chitrakoot",stateId:26},{id:26023,name:"Deoria",stateId:26},{id:26024,name:"Etah",stateId:26},{id:26025,name:"Etawah",stateId:26},{id:26026,name:"Farrukhabad",stateId:26},{id:26027,name:"Fatehpur",stateId:26},{id:26028,name:"Firozabad",stateId:26},{id:26029,name:"Gautam Buddha Nagar",stateId:26},{id:26030,name:"Ghaziabad",stateId:26},{id:26031,name:"Ghazipur",stateId:26},{id:26032,name:"Gonda",stateId:26},{id:26033,name:"Gorakhpur",stateId:26},{id:26034,name:"Hamirpur",stateId:26},{id:26035,name:"Hapur",stateId:26},{id:26036,name:"Hardoi",stateId:26},{id:26037,name:"Hathras",stateId:26},{id:26038,name:"Jalaun",stateId:26},{id:26039,name:"Jaunpur",stateId:26},{id:26040,name:"Jhansi",stateId:26},{id:26041,name:"Kannauj",stateId:26},{id:26042,name:"Kanpur Dehat",stateId:26},{id:26043,name:"Kanpur Nagar",stateId:26},{id:26044,name:"Kasganj",stateId:26},{id:26045,name:"Kaushambi",stateId:26},{id:26046,name:"Kushinagar",stateId:26},{id:26047,name:"Lakhimpur Kheri",stateId:26},{id:26048,name:"Lalitpur",stateId:26},{id:26049,name:"Lucknow",stateId:26},{id:26050,name:"Maharajganj",stateId:26},{id:26051,name:"Mahoba",stateId:26},{id:26052,name:"Mainpuri",stateId:26},{id:26053,name:"Mathura",stateId:26},{id:26054,name:"Mau",stateId:26},{id:26055,name:"Meerut",stateId:26},{id:26056,name:"Mirzapur",stateId:26},{id:26057,name:"Moradabad",stateId:26},{id:26058,name:"Muzaffarnagar",stateId:26},{id:26059,name:"Pilibhit",stateId:26},{id:26060,name:"Pratapgarh",stateId:26},{id:26061,name:"Prayagraj",stateId:26},{id:26062,name:"Raebareli",stateId:26},{id:26063,name:"Rampur",stateId:26},{id:26064,name:"Saharanpur",stateId:26},{id:26065,name:"Sambhal",stateId:26},{id:26066,name:"Sant Kabir Nagar",stateId:26},{id:26067,name:"Shahjahanpur",stateId:26},{id:26068,name:"Shamli",stateId:26},{id:26069,name:"Shravasti",stateId:26},{id:26070,name:"Siddharthnagar",stateId:26},{id:26071,name:"Sitapur",stateId:26},{id:26072,name:"Sonbhadra",stateId:26},{id:26073,name:"Sultanpur",stateId:26},{id:26074,name:"Unnao",stateId:26},{id:26075,name:"Varanasi",stateId:26},{id:27001,name:"Almora",stateId:27},{id:27002,name:"Bageshwar",stateId:27},{id:27003,name:"Chamoli",stateId:27},{id:27004,name:"Champawat",stateId:27},{id:27005,name:"Dehradun",stateId:27},{id:27006,name:"Haridwar",stateId:27},{id:27007,name:"Nainital",stateId:27},{id:27008,name:"Pauri Garhwal",stateId:27},{id:27009,name:"Pithoragarh",stateId:27},{id:27010,name:"Rudraprayag",stateId:27},{id:27011,name:"Tehri Garhwal",stateId:27},{id:27012,name:"Udham Singh Nagar",stateId:27},{id:27013,name:"Uttarkashi",stateId:27},{id:28001,name:"Alipurduar",stateId:28},{id:28002,name:"Bankura",stateId:28},{id:28003,name:"Birbhum",stateId:28},{id:28004,name:"Cooch Behar",stateId:28},{id:28005,name:"Dakshin Dinajpur",stateId:28},{id:28006,name:"Darjeeling",stateId:28},{id:28007,name:"Hooghly",stateId:28},{id:28008,name:"Howrah",stateId:28},{id:28009,name:"Jalpaiguri",stateId:28},{id:28010,name:"Jhargram",stateId:28},{id:28011,name:"Kalimpong",stateId:28},{id:28012,name:"Kolkata",stateId:28},{id:28013,name:"Malda",stateId:28},{id:28014,name:"Murshidabad",stateId:28},{id:28015,name:"Nadia",stateId:28},{id:28016,name:"North 24 Parganas",stateId:28},{id:28017,name:"Paschim Bardhaman",stateId:28},{id:28018,name:"Paschim Medinipur",stateId:28},{id:28019,name:"Purba Bardhaman",stateId:28},{id:28020,name:"Purba Medinipur",stateId:28},{id:28021,name:"Purulia",stateId:28},{id:28022,name:"South 24 Parganas",stateId:28},{id:28023,name:"Uttar Dinajpur",stateId:28},{id:29001,name:"Nicobar",stateId:29},{id:29002,name:"North and Middle Andaman",stateId:29},{id:29003,name:"South Andaman",stateId:29},{id:30001,name:"Chandigarh",stateId:30},{id:31001,name:"Dadra and Nagar Haveli",stateId:31},{id:31002,name:"Daman",stateId:31},{id:31003,name:"Diu",stateId:31},{id:32001,name:"Central Delhi",stateId:32},{id:32002,name:"East Delhi",stateId:32},{id:32003,name:"New Delhi",stateId:32},{id:32004,name:"North Delhi",stateId:32},{id:32005,name:"North East Delhi",stateId:32},{id:32006,name:"North West Delhi",stateId:32},{id:32007,name:"Shahdara",stateId:32},{id:32008,name:"South Delhi",stateId:32},{id:32009,name:"South East Delhi",stateId:32},{id:32010,name:"South West Delhi",stateId:32},{id:32011,name:"West Delhi",stateId:32},{id:33001,name:"Anantnag",stateId:33},{id:33002,name:"Bandipora",stateId:33},{id:33003,name:"Baramulla",stateId:33},{id:33004,name:"Budgam",stateId:33},{id:33005,name:"Doda",stateId:33},{id:33006,name:"Ganderbal",stateId:33},{id:33007,name:"Jammu",stateId:33},{id:33008,name:"Kathua",stateId:33},{id:33009,name:"Kishtwar",stateId:33},{id:33010,name:"Kulgam",stateId:33},{id:33011,name:"Kupwara",stateId:33},{id:33012,name:"Poonch",stateId:33},{id:33013,name:"Pulwama",stateId:33},{id:33014,name:"Rajouri",stateId:33},{id:33015,name:"Ramban",stateId:33},{id:33016,name:"Reasi",stateId:33},{id:33017,name:"Samba",stateId:33},{id:33018,name:"Shopian",stateId:33},{id:33019,name:"Srinagar",stateId:33},{id:33020,name:"Udhampur",stateId:33},{id:34001,name:"Kargil",stateId:34},{id:34002,name:"Leh",stateId:34},{id:35001,name:"Lakshadweep",stateId:35},{id:36001,name:"Karaikal",stateId:36},{id:36002,name:"Mahe",stateId:36},{id:36003,name:"Puducherry",stateId:36},{id:36004,name:"Yanam",stateId:36}],Xb=[{id:1100101,name:"Badami",districtId:11001},{id:1100102,name:"Bagalkot",districtId:11001},{id:1100103,name:"Bilagi",districtId:11001},{id:1100104,name:"Hunagund",districtId:11001},{id:1100105,name:"Jamkhandi",districtId:11001},{id:1100106,name:"Mudhol",districtId:11001},{id:1100201,name:"Ballari",districtId:11002},{id:1100202,name:"Hadagalli",districtId:11002},{id:1100203,name:"Hagaribommanahalli",districtId:11002},{id:1100204,name:"Hospet",districtId:11002},{id:1100205,name:"Kudligi",districtId:11002},{id:1100206,name:"Sandur",districtId:11002},{id:1100207,name:"Siruguppa",districtId:11002},{id:1100301,name:"Athani",districtId:11003},{id:1100302,name:"Bailhongal",districtId:11003},{id:1100303,name:"Belagavi",districtId:11003},{id:1100304,name:"Chikodi",districtId:11003},{id:1100305,name:"Gokak",districtId:11003},{id:1100306,name:"Hukkeri",districtId:11003},{id:1100307,name:"Khanapur",districtId:11003},{id:1100308,name:"Raibag",districtId:11003},{id:1100309,name:"Ramadurg",districtId:11003},{id:1100310,name:"Soundatti",districtId:11003},{id:1100401,name:"Devanahalli",districtId:11004},{id:1100402,name:"Doddaballapur",districtId:11004},{id:1100403,name:"Hosakote",districtId:11004},{id:1100404,name:"Nelamangala",districtId:11004},{id:1100501,name:"Anekal",districtId:11005},{id:1100502,name:"Bengaluru East",districtId:11005},{id:1100503,name:"Bengaluru North",districtId:11005},{id:1100504,name:"Bengaluru South",districtId:11005},{id:1100601,name:"Aurad",districtId:11006},{id:1100602,name:"Basavakalyan",districtId:11006},{id:1100603,name:"Bidar",districtId:11006},{id:1100604,name:"Bhalki",districtId:11006},{id:1100605,name:"Homnabad",districtId:11006},{id:1100701,name:"Chamarajanagar",districtId:11007},{id:1100702,name:"Gundlupet",districtId:11007},{id:1100703,name:"Kollegal",districtId:11007},{id:1100704,name:"Yelandur",districtId:11007},{id:1100801,name:"Bagepalli",districtId:11008},{id:1100802,name:"Chikkaballapur",districtId:11008},{id:1100803,name:"Chintamani",districtId:11008},{id:1100804,name:"Gauribidanur",districtId:11008},{id:1100805,name:"Gudibande",districtId:11008},{id:1100806,name:"Sidlaghatta",districtId:11008},{id:1100901,name:"Ajjampura",districtId:11009},{id:1100902,name:"Chikkamagaluru",districtId:11009},{id:1100903,name:"Kadur",districtId:11009},{id:1100904,name:"Kalasa",districtId:11009},{id:1100905,name:"Koppa",districtId:11009},{id:1100906,name:"Mudigere",districtId:11009},{id:1100907,name:"Narasimharajapura",districtId:11009},{id:1100908,name:"Sringeri",districtId:11009},{id:1100909,name:"Tarikere",districtId:11009},{id:1101001,name:"Challakere",districtId:11010},{id:1101002,name:"Chitradurga",districtId:11010},{id:1101003,name:"Hiriyur",districtId:11010},{id:1101004,name:"Holalkere",districtId:11010},{id:1101005,name:"Hosadurga",districtId:11010},{id:1101006,name:"Molakalmuru",districtId:11010},{id:1101101,name:"Bantwal",districtId:11011},{id:1101102,name:"Belthangady",districtId:11011},{id:1101103,name:"Mangaluru",districtId:11011},{id:1101104,name:"Puttur",districtId:11011},{id:1101105,name:"Sullia",districtId:11011},{id:1101201,name:"Channagiri",districtId:11012},{id:1101202,name:"Davanagere",districtId:11012},{id:1101203,name:"Harapanahalli",districtId:11012},{id:1101204,name:"Harihar",districtId:11012},{id:1101205,name:"Jagalur",districtId:11012},{id:1101206,name:"Nyamati",districtId:11012},{id:1101301,name:"Dharwad",districtId:11013},{id:1101302,name:"Hubli",districtId:11013},{id:1101303,name:"Kalghatgi",districtId:11013},{id:1101304,name:"Kundgol",districtId:11013},{id:1101305,name:"Navalgund",districtId:11013},{id:1101401,name:"Gadag",districtId:11014},{id:1101402,name:"Lakshmeshwar",districtId:11014},{id:1101403,name:"Mundargi",districtId:11014},{id:1101404,name:"Nargund",districtId:11014},{id:1101405,name:"Ron",districtId:11014},{id:1101406,name:"Shirhatti",districtId:11014},{id:1101501,name:"Alur",districtId:11015},{id:1101502,name:"Arkalgud",districtId:11015},{id:1101503,name:"Arsikere",districtId:11015},{id:1101504,name:"Belur",districtId:11015},{id:1101505,name:"Channarayapatna",districtId:11015},{id:1101506,name:"Hassan",districtId:11015},{id:1101507,name:"Holenarasipur",districtId:11015},{id:1101508,name:"Sakleshpur",districtId:11015},{id:1101601,name:"Byadgi",districtId:11016},{id:1101602,name:"Hangal",districtId:11016},{id:1101603,name:"Haveri",districtId:11016},{id:1101604,name:"Hirekerur",districtId:11016},{id:1101605,name:"Ranebennuru",districtId:11016},{id:1101606,name:"Rattihalli",districtId:11016},{id:1101607,name:"Savanur",districtId:11016},{id:1101608,name:"Shiggaon",districtId:11016},{id:1101701,name:"Afzalpur",districtId:11017},{id:1101702,name:"Aland",districtId:11017},{id:1101703,name:"Chincholi",districtId:11017},{id:1101704,name:"Chitapur",districtId:11017},{id:1101705,name:"Gulbarga",districtId:11017},{id:1101706,name:"Jewargi",districtId:11017},{id:1101707,name:"Kalaburagi",districtId:11017},{id:1101708,name:"Sedam",districtId:11017},{id:1101801,name:"Madikeri",districtId:11018},{id:1101802,name:"Somwarpet",districtId:11018},{id:1101803,name:"Virajpet",districtId:11018},{id:1101901,name:"Bangarpet",districtId:11019},{id:1101902,name:"Kolar",districtId:11019},{id:1101903,name:"Kolar Gold Fields",districtId:11019},{id:1101904,name:"Malur",districtId:11019},{id:1101905,name:"Mulbagal",districtId:11019},{id:1101906,name:"Srinivaspur",districtId:11019},{id:1102001,name:"Gangavathi",districtId:11020},{id:1102002,name:"Koppal",districtId:11020},{id:1102003,name:"Kushtagi",districtId:11020},{id:1102004,name:"Yelburga",districtId:11020},{id:1102101,name:"Krishnarajpet",districtId:11021},{id:1102102,name:"Maddur",districtId:11021},{id:1102103,name:"Malavalli",districtId:11021},{id:1102104,name:"Mandya",districtId:11021},{id:1102105,name:"Nagamangala",districtId:11021},{id:1102106,name:"Pandavapura",districtId:11021},{id:1102107,name:"Shrirangapattana",districtId:11021},{id:1102201,name:"Hunsur",districtId:11022},{id:1102202,name:"Krishnarajanagara",districtId:11022},{id:1102203,name:"Mysuru",districtId:11022},{id:1102204,name:"Nanjangud",districtId:11022},{id:1102205,name:"Periyapatna",districtId:11022},{id:1102206,name:"Saragur",districtId:11022},{id:1102207,name:"Tirumakudalu Narsipur",districtId:11022},{id:1102301,name:"Devadurga",districtId:11023},{id:1102302,name:"Lingsugur",districtId:11023},{id:1102303,name:"Manvi",districtId:11023},{id:1102304,name:"Raichur",districtId:11023},{id:1102305,name:"Sindhnur",districtId:11023},{id:1102401,name:"Channapatna",districtId:11024},{id:1102402,name:"Kanakapura",districtId:11024},{id:1102403,name:"Magadi",districtId:11024},{id:1102404,name:"Ramanagara",districtId:11024},{id:1102501,name:"Bhadravati",districtId:11025},{id:1102502,name:"Hosanagar",districtId:11025},{id:1102503,name:"Sagar",districtId:11025},{id:1102504,name:"Shikaripur",districtId:11025},{id:1102505,name:"Shimoga",districtId:11025},{id:1102506,name:"Sorab",districtId:11025},{id:1102507,name:"Thirthahalli",districtId:11025},{id:1102601,name:"Chikkanayakanahalli",districtId:11026},{id:1102602,name:"Gubbi",districtId:11026},{id:1102603,name:"Koratagere",districtId:11026},{id:1102604,name:"Kunigal",districtId:11026},{id:1102605,name:"Madhugiri",districtId:11026},{id:1102606,name:"Pavagada",districtId:11026},{id:1102607,name:"Sira",districtId:11026},{id:1102608,name:"Tiptur",districtId:11026},{id:1102609,name:"Tumakuru",districtId:11026},{id:1102610,name:"Turuvekere",districtId:11026},{id:1102701,name:"Byndoor",districtId:11027},{id:1102702,name:"Karkala",districtId:11027},{id:1102703,name:"Kundapura",districtId:11027},{id:1102704,name:"Udupi",districtId:11027},{id:1102801,name:"Ankola",districtId:11028},{id:1102802,name:"Bhatkal",districtId:11028},{id:1102803,name:"Haliyal",districtId:11028},{id:1102804,name:"Honnavar",districtId:11028},{id:1102805,name:"Joida",districtId:11028},{id:1102806,name:"Karwar",districtId:11028},{id:1102807,name:"Kumta",districtId:11028},{id:1102808,name:"Mundgod",districtId:11028},{id:1102809,name:"Siddapur",districtId:11028},{id:1102810,name:"Sirsi",districtId:11028},{id:1102811,name:"Yellapur",districtId:11028},{id:1102901,name:"Basavana Bagewadi",districtId:11029},{id:1102902,name:"Bijapur",districtId:11029},{id:1102903,name:"Chadachan",districtId:11029},{id:1102904,name:"Indi",districtId:11029},{id:1102905,name:"Muddebihal",districtId:11029},{id:1102906,name:"Sindagi",districtId:11029},{id:1102907,name:"Vijayapura",districtId:11029},{id:1103001,name:"Gurmitkal",districtId:11030},{id:1103002,name:"Shahapur",districtId:11030},{id:1103003,name:"Shorapur",districtId:11030},{id:1103004,name:"Surpur",districtId:11030},{id:1103005,name:"Yadgir",districtId:11030},{id:1001,name:"Badami",districtId:11},{id:1002,name:"Bagalkot",districtId:11},{id:1003,name:"Bilagi",districtId:11},{id:1004,name:"Hunagund",districtId:11},{id:1005,name:"Jamkhandi",districtId:11},{id:1006,name:"Mudhol",districtId:11},{id:1101,name:"Ballari",districtId:12},{id:1102,name:"Hadagalli",districtId:12},{id:1103,name:"Hagaribommanahalli",districtId:12},{id:1104,name:"Hospet",districtId:12},{id:1105,name:"Kudligi",districtId:12},{id:1106,name:"Sandur",districtId:12},{id:1107,name:"Siruguppa",districtId:12},{id:1201,name:"Athani",districtId:13},{id:1202,name:"Bailhongal",districtId:13},{id:1203,name:"Belagavi",districtId:13},{id:1204,name:"Chikodi",districtId:13},{id:1205,name:"Gokak",districtId:13},{id:1206,name:"Hukkeri",districtId:13},{id:1207,name:"Khanapur",districtId:13},{id:1208,name:"Raibag",districtId:13},{id:1209,name:"Ramadurg",districtId:13},{id:1210,name:"Soundatti",districtId:13},{id:1301,name:"Devanahalli",districtId:14},{id:1302,name:"Doddaballapur",districtId:14},{id:1303,name:"Hosakote",districtId:14},{id:1304,name:"Nelamangala",districtId:14},{id:1401,name:"Anekal",districtId:15},{id:1402,name:"Bengaluru East",districtId:15},{id:1403,name:"Bengaluru North",districtId:15},{id:1404,name:"Bengaluru South",districtId:15},{id:1501,name:"Aurad",districtId:16},{id:1502,name:"Basavakalyan",districtId:16},{id:1503,name:"Bidar",districtId:16},{id:1504,name:"Bhalki",districtId:16},{id:1505,name:"Homnabad",districtId:16},{id:1601,name:"Chamarajanagar",districtId:17},{id:1602,name:"Gundlupet",districtId:17},{id:1603,name:"Kollegal",districtId:17},{id:1604,name:"Yelandur",districtId:17},{id:1701,name:"Bagepalli",districtId:18},{id:1702,name:"Chikkaballapur",districtId:18},{id:1703,name:"Chintamani",districtId:18},{id:1704,name:"Gauribidanur",districtId:18},{id:1705,name:"Gudibande",districtId:18},{id:1706,name:"Sidlaghatta",districtId:18},{id:1801,name:"Ajjampura",districtId:19},{id:1802,name:"Chikkamagaluru",districtId:19},{id:1803,name:"Kadur",districtId:19},{id:1804,name:"Kalasa",districtId:19},{id:1805,name:"Koppa",districtId:19},{id:1806,name:"Mudigere",districtId:19},{id:1807,name:"Narasimharajapura",districtId:19},{id:1808,name:"Sringeri",districtId:19},{id:1809,name:"Tarikere",districtId:19},{id:1901,name:"Challakere",districtId:20},{id:1902,name:"Chitradurga",districtId:20},{id:1903,name:"Hiriyur",districtId:20},{id:1904,name:"Holalkere",districtId:20},{id:1905,name:"Hosadurga",districtId:20},{id:1906,name:"Molakalmuru",districtId:20},{id:2001,name:"Bantwal",districtId:21},{id:2002,name:"Belthangady",districtId:21},{id:2003,name:"Mangaluru",districtId:21},{id:2004,name:"Puttur",districtId:21},{id:2005,name:"Sullia",districtId:21},{id:2101,name:"Channagiri",districtId:22},{id:2102,name:"Davanagere",districtId:22},{id:2103,name:"Harapanahalli",districtId:22},{id:2104,name:"Harihar",districtId:22},{id:2105,name:"Jagalur",districtId:22},{id:2106,name:"Nyamati",districtId:22},{id:2201,name:"Dharwad",districtId:23},{id:2202,name:"Hubli",districtId:23},{id:2203,name:"Kalghatgi",districtId:23},{id:2204,name:"Kundgol",districtId:23},{id:2205,name:"Navalgund",districtId:23},{id:2301,name:"Gadag",districtId:24},{id:2302,name:"Lakshmeshwar",districtId:24},{id:2303,name:"Mundargi",districtId:24},{id:2304,name:"Nargund",districtId:24},{id:2305,name:"Ron",districtId:24},{id:2306,name:"Shirhatti",districtId:24},{id:2401,name:"Alur",districtId:25},{id:2402,name:"Arkalgud",districtId:25},{id:2403,name:"Arsikere",districtId:25},{id:2404,name:"Belur",districtId:25},{id:2405,name:"Channarayapatna",districtId:25},{id:2406,name:"Hassan",districtId:25},{id:2407,name:"Holenarasipur",districtId:25},{id:2408,name:"Sakleshpur",districtId:25},{id:2501,name:"Byadgi",districtId:26},{id:2502,name:"Hangal",districtId:26},{id:2503,name:"Haveri",districtId:26},{id:2504,name:"Hirekerur",districtId:26},{id:2505,name:"Ranebennuru",districtId:26},{id:2506,name:"Rattihalli",districtId:26},{id:2507,name:"Savanur",districtId:26},{id:2508,name:"Shiggaon",districtId:26},{id:2601,name:"Afzalpur",districtId:27},{id:2602,name:"Aland",districtId:27},{id:2603,name:"Chincholi",districtId:27},{id:2604,name:"Chitapur",districtId:27},{id:2605,name:"Gulbarga",districtId:27},{id:2606,name:"Jewargi",districtId:27},{id:2607,name:"Kalaburagi",districtId:27},{id:2608,name:"Sedam",districtId:27},{id:2701,name:"Madikeri",districtId:28},{id:2702,name:"Somwarpet",districtId:28},{id:2703,name:"Virajpet",districtId:28},{id:2801,name:"Bangarpet",districtId:29},{id:2802,name:"Kolar",districtId:29},{id:2803,name:"Kolar Gold Fields",districtId:29},{id:2804,name:"Malur",districtId:29},{id:2805,name:"Mulbagal",districtId:29},{id:2806,name:"Srinivaspur",districtId:29},{id:2901,name:"Gangavathi",districtId:30},{id:2902,name:"Koppal",districtId:30},{id:2903,name:"Kushtagi",districtId:30},{id:2904,name:"Yelburga",districtId:30},{id:3001,name:"Krishnarajpet",districtId:31},{id:3002,name:"Maddur",districtId:31},{id:3003,name:"Malavalli",districtId:31},{id:3004,name:"Mandya",districtId:31},{id:3005,name:"Nagamangala",districtId:31},{id:3006,name:"Pandavapura",districtId:31},{id:3007,name:"Shrirangapattana",districtId:31},{id:3101,name:"Hunsur",districtId:32},{id:3102,name:"Krishnarajanagara",districtId:32},{id:3103,name:"Mysuru",districtId:32},{id:3104,name:"Nanjangud",districtId:32},{id:3105,name:"Periyapatna",districtId:32},{id:3106,name:"Saragur",districtId:32},{id:3107,name:"Tirumakudalu Narsipur",districtId:32},{id:3201,name:"Devadurga",districtId:33},{id:3202,name:"Lingsugur",districtId:33},{id:3203,name:"Manvi",districtId:33},{id:3204,name:"Raichur",districtId:33},{id:3205,name:"Sindhnur",districtId:33},{id:3301,name:"Channapatna",districtId:34},{id:3302,name:"Kanakapura",districtId:34},{id:3303,name:"Magadi",districtId:34},{id:3304,name:"Ramanagara",districtId:34},{id:3401,name:"Bhadravati",districtId:35},{id:3402,name:"Hosanagar",districtId:35},{id:3403,name:"Sagar",districtId:35},{id:3404,name:"Shikaripur",districtId:35},{id:3405,name:"Shimoga",districtId:35},{id:3406,name:"Sorab",districtId:35},{id:3407,name:"Thirthahalli",districtId:35},{id:3501,name:"Chikkanayakanahalli",districtId:36},{id:3502,name:"Gubbi",districtId:36},{id:3503,name:"Koratagere",districtId:36},{id:3504,name:"Kunigal",districtId:36},{id:3505,name:"Madhugiri",districtId:36},{id:3506,name:"Pavagada",districtId:36},{id:3507,name:"Sira",districtId:36},{id:3508,name:"Tiptur",districtId:36},{id:3509,name:"Tumakuru",districtId:36},{id:3510,name:"Turuvekere",districtId:36},{id:3601,name:"Byndoor",districtId:37},{id:3602,name:"Karkala",districtId:37},{id:3603,name:"Kundapura",districtId:37},{id:3604,name:"Udupi",districtId:37},{id:3701,name:"Ankola",districtId:38},{id:3702,name:"Bhatkal",districtId:38},{id:3703,name:"Haliyal",districtId:38},{id:3704,name:"Honnavar",districtId:38},{id:3705,name:"Joida",districtId:38},{id:3706,name:"Karwar",districtId:38},{id:3707,name:"Kumta",districtId:38},{id:3708,name:"Mundgod",districtId:38},{id:3709,name:"Siddapur",districtId:38},{id:3710,name:"Sirsi",districtId:38},{id:3711,name:"Yellapur",districtId:38},{id:3801,name:"Basavana Bagewadi",districtId:39},{id:3802,name:"Bijapur",districtId:39},{id:3803,name:"Chadachan",districtId:39},{id:3804,name:"Indi",districtId:39},{id:3805,name:"Muddebihal",districtId:39},{id:3806,name:"Sindagi",districtId:39},{id:3807,name:"Vijayapura",districtId:39},{id:3901,name:"Gurmitkal",districtId:40},{id:3902,name:"Shahapur",districtId:40},{id:3903,name:"Shorapur",districtId:40},{id:3904,name:"Surpur",districtId:40},{id:3905,name:"Yadgir",districtId:40},{id:4001,name:"Hagaribommanahalli",districtId:41},{id:4002,name:"Hospet",districtId:41},{id:4003,name:"Kottur",districtId:41},{id:4004,name:"Kudligi",districtId:41},{id:10001,name:"Mumbai City",districtId:101},{id:10002,name:"Colaba",districtId:101},{id:20001,name:"Chennai North",districtId:201},{id:20002,name:"Chennai South",districtId:201}];class PZ{async getStates(){return await new Promise(t=>setTimeout(t,200)),Kb}async getDistrictsByState(t){return await new Promise(n=>setTimeout(n,200)),Gb.filter(n=>n.stateId===t)}async getTalukasByDistrict(t){return await new Promise(n=>setTimeout(n,200)),Xb.filter(n=>n.districtId===t)}async getStateById(t){return Kb.find(n=>n.id===t)||null}async getDistrictById(t){return Gb.find(n=>n.id===t)||null}async getTalukaById(t){return Xb.find(n=>n.id===t)||null}async searchStates(t){await new Promise(a=>setTimeout(a,100));const n=t.toLowerCase();return Kb.filter(a=>a.name.toLowerCase().includes(n)||a.code.toLowerCase().includes(n))}async searchDistricts(t,n){await new Promise(s=>setTimeout(s,100));const a=n.toLowerCase();return Gb.filter(s=>s.stateId===t&&s.name.toLowerCase().includes(a))}async searchTalukas(t,n){await new Promise(s=>setTimeout(s,100));const a=n.toLowerCase();return Xb.filter(s=>s.districtId===t&&s.name.toLowerCase().includes(a))}}const Jb=new PZ,yj=({selectedState:e,selectedDistrict:t,selectedTaluka:n,onStateChange:a,onDistrictChange:s,onTalukaChange:i,onDistrictTextChange:l,onTalukaTextChange:d,disabled:u=!1,required:m=!1,showTaluka:p=!0,className:f=""})=>{const[g,N]=j.useState([]),[v,w]=j.useState([]),[y,E]=j.useState([]),[O,T]=j.useState({states:!1,districts:!1,talukas:!1});j.useEffect(()=>{(async()=>{T(R=>({...R,states:!0}));try{const R=await Jb.getStates();N(R)}catch(R){console.error("Error loading states:",R)}finally{T(R=>({...R,states:!1}))}})()},[]),j.useEffect(()=>{(async()=>{if(!e){w([]),E([]);return}T(R=>({...R,districts:!0}));try{const R=typeof e=="string"?parseInt(e):e,$=await Jb.getDistrictsByState(R);w($),E([])}catch(R){console.error("Error loading districts:",R)}finally{T(R=>({...R,districts:!1}))}})()},[e]),j.useEffect(()=>{(async()=>{if(!t||!p){E([]);return}T(R=>({...R,talukas:!0}));try{const R=typeof t=="string"?parseInt(t):t,$=await Jb.getTalukasByDistrict(R);E($)}catch(R){console.error("Error loading talukas:",R)}finally{T(R=>({...R,talukas:!1}))}})()},[t,p]);const A=F=>{const R=parseInt(F.target.value),$=g.find(L=>L.id===R);$&&a&&a(R,$)},I=F=>{const R=parseInt(F.target.value),$=v.find(L=>L.id===R);$&&s&&s(R,$)},C=F=>{const R=parseInt(F.target.value),$=y.find(L=>L.id===R);$&&i&&i(R,$)},P=`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none ${u?"bg-gray-100 cursor-not-allowed":"bg-white"}`;return r.jsxs("div",{className:f||"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["State ",m&&r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("select",{value:e||"",onChange:A,disabled:u||O.states,required:m,className:P,children:[r.jsx("option",{value:"",children:O.states?"Loading states...":"Select State"}),g.map(F=>r.jsx("option",{value:F.id,children:F.name},F.id))]}),r.jsx(Gs,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["District ",m&&r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("select",{value:t||"",onChange:I,disabled:u||O.districts||!e,required:m,className:P,children:[r.jsx("option",{value:"",children:O.districts?"Loading districts...":e?v.length===0?"No districts found":"Select District":"Select state first"}),v.map(F=>r.jsx("option",{value:F.id,children:F.name},F.id))]}),r.jsx(Gs,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]}),p&&r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Taluka/Taluk ",m&&r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("select",{value:n||"",onChange:C,disabled:u||O.talukas||!t,required:m,className:P,children:[r.jsx("option",{value:"",children:O.talukas?"Loading talukas...":t?y.length===0?"No talukas found":"Select Taluka":"Select district first"}),y.map(F=>r.jsx("option",{value:F.id,children:F.name},F.id))]}),r.jsx(Gs,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]})]})},TZ={maxSizeKB:30,maxWidth:800,maxHeight:800,quality:.7},DZ=async(e,t={})=>{const n={...TZ,...t};return new Promise((a,s)=>{const i=new FileReader;i.onerror=()=>s(new Error("Failed to read file")),i.onload=l=>{const d=new Image;d.onerror=()=>s(new Error("Failed to load image")),d.onload=()=>{try{let{width:u,height:m}=d;if(u>n.maxWidth||m>n.maxHeight){const y=Math.min(n.maxWidth/u,n.maxHeight/m);u=Math.floor(u*y),m=Math.floor(m*y)}const p=document.createElement("canvas");p.width=u,p.height=m;const f=p.getContext("2d");if(!f){s(new Error("Failed to get canvas context"));return}f.drawImage(d,0,0,u,m);let g=n.quality,N=0;const v=10,w=()=>{p.toBlob(y=>{if(!y){s(new Error("Failed to create blob"));return}const E=y.size/1024;if(E<=n.maxSizeKB||N>=v){console.log(` Compressed image: ${E.toFixed(2)}KB (quality: ${g.toFixed(2)})`),a(y);return}N++,g=Math.max(.1,g-.1),w()},"image/jpeg",g)};w()}catch(u){s(u)}},d.src=l.target?.result},i.readAsDataURL(e)})},OZ=e=>{if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(e.type))return{valid:!1,error:"Invalid file type. Please upload JPG, PNG, GIF, or WebP images."};const n=10*1024*1024;return e.size>n?{valid:!1,error:"File size too large. Maximum size is 10MB."}:{valid:!0}},o4=()=>{const{user:e}=yr(),t=S=>{if(!S)return"";if(typeof S=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(S))return S;const ue=new Date(S);if(isNaN(ue.getTime()))return"";const qe=ue.getFullYear(),we=String(ue.getMonth()+1).padStart(2,"0"),de=String(ue.getDate()).padStart(2,"0");return`${qe}-${we}-${de}`},{currentAcademicYear:n,viewingAcademicYear:a,isViewingHistoricalYear:s,setViewingYear:i,availableYears:l,loading:d}=pn(),{classesData:u,loading:m,error:p,getClassOptions:f,getSectionsByClass:g,hasClasses:N}=Ea(),[v,w]=j.useState([]),y=S=>{if(S&&u){const ue=g(S);w(ue)}else w([])},E=async(S,ue)=>{const qe=S.charAt(0).toUpperCase(),we=`${ue.toUpperCase()}-${qe}-`,ze=F.filter(Qe=>Qe.role===S&&Qe._id&&Qe._id.toString().startsWith(we)).map(Qe=>{const Jt=Qe._id.toString().match(new RegExp(`${we}(\\d+)$`));return Jt?parseInt(Jt[1]):0}).filter(Qe=>!isNaN(Qe));let Ee=ze.length>0?Math.max(...ze)+1:1,ye,Ge=!1;for(;!Ge;){const Qe=Ee.toString().padStart(4,"0");ye=`${we}${Qe}`,F.some(Ct=>Ct._id===ye)?Ee++:Ge=!0}return ye},O=()=>{const ue="abcdefghijklmnopqrstuvwxyz",qe="ABCDEFGHIJKLMNOPQRSTUVWXYZ",we="0123456789",de="!@#$%^&*";let ze="";ze+=ue.charAt(Math.floor(Math.random()*ue.length)),ze+=qe.charAt(Math.floor(Math.random()*qe.length)),ze+=we.charAt(Math.floor(Math.random()*we.length)),ze+=de.charAt(Math.floor(Math.random()*de.length));const Ee=ue+qe+we+de;for(let ye=ze.length;ye<8;ye++)ze+=Ee.charAt(Math.floor(Math.random()*Ee.length));return ze.split("").sort(()=>Math.random()-.5).join("")},T=j.useRef(!1),A=S=>{const ue=[];if(!S)return ue.push("Form data is required"),ue;(!S.firstName||S.firstName.trim()==="")&&ue.push("First name is required"),(!S.lastName||S.lastName.trim()==="")&&ue.push("Last name is required"),(!S.email||!S.email.includes("@"))&&ue.push("A valid email is required");const qe=S.primaryPhone||S.phone;if(qe){const de=qe.replace(/\D/g,"");(de.length<7||de.length>15)&&ue.push("Phone number must be 7-15 digits")}else S.role!=="teacher"&&ue.push("Phone number is required");if(S.role!=="teacher"){const de=S.permanentStreet||S.address,ze=S.permanentCity||S.city,Ee=S.permanentState||S.state,ye=S.permanentPincode||S.pinCode;(!de||de.trim()==="")&&ue.push("Address/Street is required"),(!ze||ze.trim()==="")&&ue.push("City is required"),(!Ee||Ee.trim()==="")&&ue.push("State is required"),(!ye||!/^\d{6}$/.test(ye))&&ue.push("A valid 6-digit PIN code is required")}if(S.role==="student"){const de=S.studentDetails,ze=de?.currentClass||S.class,Ee=de?.currentSection||S.section,ye=de?.dateOfBirth||S.dateOfBirth,Ge=de?.gender||S.gender,Qe=de?.personal?.bloodGroup||S.bloodGroup;(!ze||ze==="")&&ue.push("Class selection is required for students"),(!Ee||Ee==="")&&ue.push("Section selection is required for students"),ye||ue.push("Date of birth is required for students"),(!Ge||Ge.trim()==="")&&ue.push("Gender is required for students"),(!Qe||Qe.trim()==="")&&ue.push("Blood group is required for students"),de?.fatherName||S.fatherName,de?.motherName||S.motherName;const Jt=de?.enrollmentNo||S.enrollmentNo,Ct=de?.tcNo||S.tcNo||S.tcNumber;(!Jt||Jt.toString().trim()==="")&&ue.push("Enrollment number is required for students"),(!Ct||Ct.toString().trim()==="")&&ue.push("TC number is required for students");const ur=de?.ageYears||S.ageYears;de?.socialCategory||S.socialCategory,de?.belongingToBPL||S.belongingToBPL,de?.disability||S.disability,ur&&(ur<3||ur>25)&&ue.push("Student age must be between 3 and 25 years");const Wt=de?.studentAadhaar||S.studentAadhaar,zr=de?.fatherAadhaar||S.fatherAadhaar,mr=de?.motherAadhaar||S.motherAadhaar;!Wt||Wt.toString().trim()===""?ue.push("Student Aadhaar/KPR number is required"):/^\d{12}$/.test(Wt)||ue.push("Student Aadhaar number must be 12 digits"),zr&&!/^\d{12}$/.test(zr)&&ue.push("Father Aadhaar number must be 12 digits"),mr&&!/^\d{12}$/.test(mr)&&ue.push("Mother Aadhaar number must be 12 digits");const br=de?.studentCasteCertNo||S.studentCasteCertNo;(!br||br.toString().trim()==="")&&ue.push("Student caste certificate number is required for students");const Mr=de?.fatherPhone||S.fatherPhone||S.fatherMobile,un=de?.motherPhone||S.motherPhone||S.motherMobile;Mr&&!/^[6-9]\d{9}$/.test(Mr)&&ue.push("Father phone number must be a valid 10-digit mobile number"),un&&!/^[6-9]\d{9}$/.test(un)&&ue.push("Mother phone number must be a valid 10-digit mobile number"),de?.schoolAdmissionDate||S.schoolAdmissionDate||S.admissionDate||ue.push("School admission date is required for students");const Er=de?.bankName||S.bankName;(!Er||Er.toString().trim()==="")&&ue.push("Bank Name is required for students");const mn=de?.bankAccountNo||S.bankAccountNo||S.bankAccountNumber;(!mn||mn.toString().trim()==="")&&ue.push("Bank account number is required for students");const Nn=de?.bankIFSC||S.bankIFSC||S.bankIfsc;!Nn||Nn.toString().trim()===""?ue.push("Bank IFSC code is required for students"):/^[A-Z]{4}0[A-Z0-9]{6}$/.test(Nn)||ue.push("Bank IFSC code must be in valid format (e.g., SBIN0012345)")}else if(b.role==="teacher"){const de=b.teacherDetails,ze=de?.qualification||b.qualification,Ee=de?.experience||Number(b.experience);de?.subjects||(typeof b.subjects=="string"?b.subjects.split(","):b.subjects),(!ze||ze.trim()==="")&&ue.push("Highest qualification is required for teachers"),(Ee===void 0||Ee<0)&&ue.push("Total experience is required for teachers (minimum 0 years)");const ye=de?.employeeId||b.employeeId;ye&&ye.trim()===""&&ue.push("Employee ID cannot be empty if provided");const Ge=de?.bankIFSC||b.bankIFSC;Ge&&!/^[A-Z]{4}0[A-Z0-9]{6}$/.test(Ge)&&ue.push("Bank IFSC code must be in valid format (e.g., SBIN0012345)")}else if(b.role==="admin"){const de=b.adminDetails,ze=de?.adminType||b.adminLevel;de?.designation,(!ze||ze.trim()==="")&&ue.push("Admin type/level is required for administrators");const Ee=de?.employeeId||b.employeeId;Ee&&Ee.trim()===""&&ue.push("Employee ID cannot be empty if provided"),de&&(Object.values({userManagement:de.userManagement,academicManagement:de.academicManagement,feeManagement:de.feeManagement,reportGeneration:de.reportGeneration,systemSettings:de.systemSettings,schoolSettings:de.schoolSettings,dataExport:de.dataExport,auditLogs:de.auditLogs}).some(Qe=>Qe===!0)||ue.push("At least one permission must be granted to admin users"));const ye=de?.bankIFSC||b.bankIFSC;ye&&!/^[A-Z]{4}0[A-Z0-9]{6}$/.test(ye)&&ue.push("Bank IFSC code must be in valid format (e.g., SBIN0012345)")}const we=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return b.email&&!we.test(b.email)&&ue.push("Please enter a valid email address"),b.panNumber&&!/^[A-Z]{5}\d{4}[A-Z]$/.test(b.panNumber)&&ue.push("PAN number must be in valid format (e.g., ABCDE1234F)"),b.aadharNumber&&!/^\d{12}$/.test(b.aadharNumber)&&ue.push("Aadhaar number must be 12 digits"),S.role==="student"&&((!S.nationality||S.nationality.trim()==="")&&ue.push("Nationality is required for students"),S.alternatePhone&&!/^[6-9]\d{9}$/.test(S.alternatePhone)&&ue.push("Emergency contact phone must be a valid 10-digit mobile number"),S.previousSchool&&S.previousSchool.trim()!==""&&(!S.tcNumber||S.tcNumber.trim()==="")&&ue.push("TC Number is required when previous school is mentioned"),S.birthCertificateNumber&&S.birthCertificateNumber.trim().length<5&&ue.push("Birth certificate number must be at least 5 characters"),S.rationCardNumber&&S.rationCardNumber.trim().length<5&&ue.push("Ration card number must be at least 5 characters"),S.familyIncome&&!["Below 1 Lakh","1-2 Lakhs","2-5 Lakhs","5-10 Lakhs","Above 10 Lakhs"].includes(S.familyIncome)&&ue.push("Please select a valid family income range"),S.economicStatus==="BPL"&&(!S.bplCardNumber||S.bplCardNumber.trim()==="")&&ue.push("BPL card number is required when economic status is BPL"),S.guardianName&&S.guardianName.trim()!==""&&(!S.guardianRelation||S.guardianRelation.trim()==="")&&ue.push("Guardian relationship is required when guardian name is provided"),S.transportMode==="School Bus"&&(!S.busRoute||S.busRoute.trim()==="")&&ue.push("Bus route is required when school bus transport is selected")),ue},I=async S=>{console.log(` Role changed to: ${S}`);const ue=S==="student"?"":O();B(qe=>({...qe,role:S,userId:"",generatedPassword:ue})),rr("");try{console.log(` Auto-fetching next ID for role: ${S}`);const qe=await Ha(S);qe?(console.log(` Auto-generated ID for ${S}: ${qe}`),ge.success(`Role set to ${S.charAt(0).toUpperCase()+S.slice(1)}. Next available ID: ${qe}`)):(console.log(` Failed to auto-fetch ID for role: ${S}`),ge.error(`Role set to ${S.charAt(0).toUpperCase()+S.slice(1)}, but failed to fetch ID. Please try again.`))}catch(qe){console.error(` Error auto-fetching ID for role ${S}:`,qe),ge.error(`Role set to ${S.charAt(0).toUpperCase()+S.slice(1)}, but failed to fetch ID. Please try again.`)}},C=S=>{B(ue=>{const qe={...ue,dateOfBirth:S};if(ue.role==="student"&&S){const we=new Date(S);if(!isNaN(we.getTime())){const de=we.getDate().toString().padStart(2,"0"),ze=(we.getMonth()+1).toString().padStart(2,"0"),Ee=we.getFullYear();qe.generatedPassword=`${de}${ze}${Ee}`}}return qe})},P=S=>{B(ue=>{const qe={...ue,dateOfBirth:S,studentDetails:{...ue.studentDetails,dateOfBirth:S}};if(ue.role==="student"&&S){const we=new Date(S);if(!isNaN(we.getTime())){const de=we.getDate().toString().padStart(2,"0"),ze=(we.getMonth()+1).toString().padStart(2,"0"),Ee=we.getFullYear();qe.generatedPassword=`${de}${ze}${Ee}`}}return qe})},[F,R]=j.useState([]),[$,L]=j.useState(null),[G,X]=j.useState(!1),[me,se]=j.useState(""),[ee,W]=j.useState("all"),[U,Q]=j.useState(null),[Y,H]=j.useState(!1),[te,fe]=j.useState([]),[Le,he]=j.useState(!1),[K,be]=j.useState(null),[re,ie]=j.useState(null),[ne,Te]=j.useState("student"),[ve,We]=j.useState(null),[Ie,je]=j.useState(null),[oe,$e]=j.useState(!1),et=j.useRef(null),[lt,rt]=j.useState("all"),[Lt,kt]=j.useState("all"),[Oe,Nt]=j.useState(null),[Mt,rr]=j.useState(""),[Ft,cr]=j.useState(!1),[or,ke]=j.useState(new Set),[ht,_e]=j.useState("table"),[tt,gt]=j.useState(!1),[Pt,Ot]=j.useState(null),[vt,nr]=j.useState([]),[Yt,Or]=j.useState(0),[Sr,$t]=j.useState(!1),[gr,kr]=j.useState(null),[b,B]=j.useState({role:"student",firstName:"",middleName:"",lastName:"",email:"",phone:"",primaryPhone:"",secondaryPhone:"",whatsappNumber:"",emergencyContactName:"",emergencyContactRelation:"",emergencyContactPhone:"",permanentStreet:"",permanentArea:"",permanentCity:"",permanentState:"Karnataka",permanentCountry:"India",permanentPincode:"",permanentLandmark:"",stateId:"",districtId:"",talukaId:"",districtText:"",talukaText:"",currentStreet:"",currentArea:"",currentCity:"",currentState:"Karnataka",currentCountry:"India",currentPincode:"",currentLandmark:"",sameAsPermanent:!0,aadharNumber:"",panNumber:"",voterIdNumber:"",drivingLicenseNumber:"",passportNumber:"",studentDetails:{currentClass:"",currentSection:"",academicYear:n||"2024-25",admissionDate:"",admissionClass:"",rollNumber:"",admissionNumber:"",enrollmentNo:"",tcNo:"",previousSchoolName:"",previousBoard:"",lastClass:"",tcNumber:"",tcDate:"",reasonForTransfer:"",dateOfBirth:"",placeOfBirth:"",gender:"male",bloodGroup:"",nationality:"Indian",religion:"",religionOther:"",caste:"",casteOther:"",category:"",categoryOther:"",motherTongue:"",motherTongueOther:"",ageYears:0,ageMonths:0,socialCategory:"",socialCategoryOther:"",studentCaste:"",studentCasteOther:"",studentAadhaar:"",studentCasteCertNo:"",belongingToBPL:"No",bplCardNo:"",bhagyalakshmiBondNo:"",disability:"Not Applicable",disabilityOther:"",isRTECandidate:"No",fatherName:"",fatherOccupation:"",fatherQualification:"",fatherPhone:"",fatherEmail:"",fatherAadhaar:"",fatherCaste:"",fatherCasteOther:"",fatherCasteCertNo:"",fatherAnnualIncome:0,motherName:"",motherOccupation:"",motherQualification:"",motherPhone:"",motherEmail:"",motherAadhaar:"",motherCaste:"",motherCasteOther:"",motherCasteCertNo:"",motherAnnualIncome:0,guardianName:"",guardianRelationship:"",guardianPhone:"",guardianEmail:"",isEmergencyContact:!1,transportMode:"",busRoute:"",pickupPoint:"",dropPoint:"",pickupTime:"",dropTime:"",feeCategory:"",concessionType:"",concessionPercentage:0,scholarshipName:"",scholarshipAmount:0,scholarshipProvider:"",bankName:"",bankAccountNo:"",bankIFSC:"",bankAccountHolderName:"",allergies:[],chronicConditions:[],medications:[],doctorName:"",hospitalName:"",doctorPhone:"",lastMedicalCheckup:""},teacherDetails:{employeeId:"",joiningDate:"",highestQualification:"",specialization:"",university:"",graduationYear:0,totalExperience:0,experienceAtCurrentSchool:0,previousSchools:[],subjects:[],primarySubjects:[],classTeacherOf:"",responsibilities:[],department:"",workingDays:[],workingHoursStart:"",workingHoursEnd:"",maxPeriodsPerDay:0,maxPeriodsPerWeek:0,basicSalary:0,allowances:[],bankAccountNumber:"",bankIFSC:"",bankName:"",bankBranchName:""},adminDetails:{adminType:"",employeeId:"",joiningDate:"",designation:"",department:"",userManagement:!1,academicManagement:!1,feeManagement:!1,reportGeneration:!1,systemSettings:!1,schoolSettings:!1,dataExport:!1,auditLogs:!1,workingDays:[],workingHoursStart:"",workingHoursEnd:"",basicSalary:0,allowances:[],bankAccountNumber:"",bankIFSC:"",bankName:"",bankBranchName:"",bankAccountHolderName:""},name:"",address:"",city:"",state:"Karnataka",dateOfBirth:"",gender:"male",fatherName:"",motherName:"",class:"",section:"",rollNumber:"",qualification:"",experience:"",subjects:[],adminLevel:"",accessLevel:"",userId:"",generatedPassword:"",studentNameKannada:"",ageYears:0,ageMonths:0,socialCategory:"",socialCategoryOther:"",studentCaste:"",studentCasteOther:"",studentAadhaar:"",studentCasteCertNo:"",fatherNameKannada:"",fatherAadhaar:"",fatherCaste:"",fatherCasteOther:"",fatherCasteCertNo:"",motherNameKannada:"",motherAadhaar:"",motherCaste:"",motherCasteOther:"",motherCasteCertNo:"",religion:"",religionOther:"",belongingToBPL:"No",bplCardNo:"",bhagyalakshmiBondNo:"",disability:"Not Applicable",disabilityOther:"",cityVillageTown:"",locality:"",taluka:"",district:"",pinCode:"",studentMobile:"",studentEmail:"",fatherMobile:"",fatherEmail:"",motherMobile:"",motherEmail:"",schoolAdmissionDate:"",bankName:"",bankAccountNo:"",bankIFSC:"",nationality:"Indian",bloodGroup:"",fatherPhone:"",fatherOccupation:"",motherPhone:"",motherOccupation:"",guardianName:"",guardianRelation:"",fatherEducation:"",motherEducation:"",familyIncome:"",alternatePhone:"",parentEmail:"",admissionNumber:"",admissionDate:"",previousSchool:"",previousClass:"",tcNumber:"",migrationCertificate:"",aadhaarNumber:"",birthCertificateNumber:"",rationCardNumber:"",caste:"",casteOther:"",category:"",categoryOther:"",subCaste:"",economicStatus:"",bplCardNumber:"",scholarshipDetails:"",specialNeeds:"",disabilityType:"",disabilityCertificate:"",medicalConditions:"",permanentAddress:"",currentAddress:"",village:"",motherTongue:"",motherTongueOther:"",mediumOfInstruction:"",spouseName:""}),[Pe,Se]=j.useState({}),[Ae,Xe]=j.useState(!1),[Ke,Ve]=j.useState("single"),[ut,Je]=j.useState(null),[ae,ct]=j.useState(""),[st,dt]=j.useState(""),[it,xt]=j.useState(!1),[Bt,qt]=j.useState([]),[Ar,Ir]=j.useState(!1),[gn,sn]=j.useState(!1),[Ht,Dr]=j.useState(null),[dr,Vt]=j.useState(""),[er,Nr]=j.useState(""),[xn,dn]=j.useState(!1),Qn=(S,ue)=>{try{console.log(`Toggling visibility for user: ${S}, Current state: ${!!Pe[S]}`),Pe[S]?(console.log(`Hiding password for ${S}`),Se(we=>{const de={...we,[S]:!1};return console.log("New visibility state (hiding):",de),de})):(console.log(`Requesting admin password to show password for ${S} (${ue})`),Je(S),ct(ue),Ve("single"),Xe(!0))}catch(qe){console.error("Error in togglePasswordVisibility:",qe),ge.error("Failed to toggle password visibility")}},js=()=>{try{Ar?(console.log("Hiding all passwords"),Se({}),Ir(!1),qt([]),ge.success("All passwords hidden")):(console.log("Opening bulk password modal"),Ve("bulk"),Xe(!0))}catch(S){console.error("Error in handleShowAllPasswords:",S),ge.error("Failed to toggle passwords")}},jn=async()=>{if(!st.trim()){ge.error("Please enter your admin password");return}xt(!0);try{const S=localStorage.getItem("erp.auth"),ue=S?JSON.parse(S).token:null;if(!ue){ge.error("Authentication token not found"),xt(!1);return}const qe=e?.schoolCode||$?.code||"SB";console.log("Verifying admin password with school code:",qe),console.log("Token available:",!!ue);const we=await pa.verifyAdminAndGetPasswords(qe,st,Ke==="single"?ut:null,ue);if(Ke==="single"){const de=we.data;if(!de||!de.temporaryPassword){ge.error("Password not available. This user may have been created without storing the temporary password."),Xe(!1),dt(""),Je(null),ct("");return}Se(ze=>({...ze,[ut]:!0})),ge.success("Password revealed")}else{const de=Array.isArray(we.data)?we.data.filter(Ge=>Ge.temporaryPassword):[];if(de.length===0){ge.error("No passwords available. Teachers may have been created without storing temporary passwords."),Xe(!1),dt("");return}qt(we.data||[]);const ze={};(we.data||[]).forEach(Ge=>{Ge.temporaryPassword&&(ze[Ge.userId]=!0)}),Se(ze),Ir(!0);const Ee=de.length,ye=we.count||(Array.isArray(we.data)?we.data.length:0);Ee<ye?ge.success(`Revealed ${Ee} of ${ye} teacher passwords. Some passwords are not available.`,{duration:5e3}):ge.success(`Revealed ${Ee} teacher passwords`)}Xe(!1),dt(""),Je(null),ct("")}catch(S){console.error("Error verifying admin password:",S),ge.error(S.message||"Invalid admin password")}finally{xt(!1)}},Fn=(S,ue)=>{console.log("State changed:",S,ue.name),B(qe=>({...qe,stateId:S.toString(),state:ue.name,permanentState:ue.name,districtId:"",district:"",talukaId:"",taluka:"",districtText:"",talukaText:""}))},yn=(S,ue)=>{console.log("District changed:",S,ue.name),B(qe=>({...qe,districtId:S.toString(),district:ue.name,talukaId:"",taluka:"",talukaText:""}))},Tn=(S,ue)=>{console.log("Taluka changed:",S,ue.name),B(qe=>({...qe,talukaId:S.toString(),taluka:ue.name}))},on=S=>{B(ue=>({...ue,districtText:S,district:S,talukaText:""}))},ii=S=>{B(ue=>({...ue,talukaText:S,taluka:S}))},ns=()=>{B({role:"student",firstName:"",middleName:"",lastName:"",email:"",phone:"",primaryPhone:"",secondaryPhone:"",whatsappNumber:"",emergencyContactName:"",emergencyContactRelation:"",emergencyContactPhone:"",permanentStreet:"",permanentArea:"",permanentCity:"",permanentState:"",permanentCountry:"India",permanentPincode:"",permanentLandmark:"",stateId:"",districtId:"",talukaId:"",districtText:"",talukaText:"",currentStreet:"",currentArea:"",currentCity:"",currentState:"",currentCountry:"India",currentPincode:"",currentLandmark:"",sameAsPermanent:!0,aadharNumber:"",panNumber:"",voterIdNumber:"",drivingLicenseNumber:"",passportNumber:"",studentDetails:{currentClass:"",currentSection:"",academicYear:n||"2024-25",admissionDate:"",admissionClass:"",rollNumber:"",admissionNumber:"",enrollmentNo:"",tcNo:"",previousSchoolName:"",previousBoard:"",lastClass:"",tcNumber:"",tcDate:"",reasonForTransfer:"",dateOfBirth:"",placeOfBirth:"",gender:"male",bloodGroup:"",nationality:"Indian",religion:"",religionOther:"",caste:"",casteOther:"",category:"",categoryOther:"",motherTongue:"",motherTongueOther:"",studentNameKannada:"",ageYears:0,ageMonths:0,socialCategory:"",socialCategoryOther:"",studentCaste:"",studentCasteOther:"",studentAadhaar:"",studentCasteCertNo:"",belongingToBPL:"No",bplCardNo:"",bhagyalakshmiBondNo:"",disability:"Not Applicable",disabilityOther:"",isRTECandidate:"No",fatherName:"",fatherNameKannada:"",fatherOccupation:"",fatherQualification:"",fatherPhone:"",fatherEmail:"",fatherAadhaar:"",fatherCaste:"",fatherCasteOther:"",fatherCasteCertNo:"",fatherWorkAddress:"",fatherAnnualIncome:0,motherName:"",motherNameKannada:"",motherOccupation:"",motherQualification:"",motherPhone:"",motherEmail:"",motherAadhaar:"",motherCaste:"",motherCasteOther:"",motherCasteCertNo:"",motherWorkAddress:"",motherAnnualIncome:0,guardianName:"",guardianRelationship:"",guardianPhone:"",guardianEmail:"",guardianAddress:"",isEmergencyContact:!1,transportMode:"",busRoute:"",pickupPoint:"",dropPoint:"",pickupTime:"",dropTime:"",feeCategory:"",concessionType:"",concessionPercentage:0,scholarshipName:"",scholarshipAmount:0,scholarshipProvider:"",bankName:"",bankAccountNo:"",bankIFSC:"",accountHolderName:"",allergies:[],chronicConditions:[],medications:[],doctorName:"",hospitalName:"",doctorPhone:"",lastMedicalCheckup:""},teacherDetails:{employeeId:"",joiningDate:"",highestQualification:"",specialization:"",university:"",graduationYear:0,totalExperience:0,experienceAtCurrentSchool:0,previousSchools:[],subjects:[],primarySubjects:[],classTeacherOf:"",responsibilities:[],department:"",workingDays:[],workingHoursStart:"",workingHoursEnd:"",maxPeriodsPerDay:0,maxPeriodsPerWeek:0,basicSalary:0,allowances:[],bankAccountNumber:"",bankIFSC:"",bankName:"",bankBranchName:""},adminDetails:{adminType:"",employeeId:"",joiningDate:"",designation:"",department:"",userManagement:!1,academicManagement:!1,feeManagement:!1,reportGeneration:!1,systemSettings:!1,schoolSettings:!1,dataExport:!1,auditLogs:!1,workingDays:[],workingHoursStart:"",workingHoursEnd:"",basicSalary:0,allowances:[],bankAccountNumber:"",bankIFSC:"",bankName:"",bankBranchName:"",bankAccountHolderName:""},name:"",address:"",city:"",state:"",dateOfBirth:"",gender:"male",fatherName:"",motherName:"",class:"",section:"",rollNumber:"",qualification:"",experience:"",subjects:[],adminLevel:"",accessLevel:"",userId:"",generatedPassword:"",studentNameKannada:"",ageYears:0,ageMonths:0,socialCategory:"",socialCategoryOther:"",studentCaste:"",studentCasteOther:"",studentAadhaar:"",studentCasteCertNo:"",fatherNameKannada:"",fatherAadhaar:"",fatherCaste:"",fatherCasteOther:"",fatherCasteCertNo:"",motherNameKannada:"",motherAadhaar:"",motherCaste:"",motherCasteOther:"",motherCasteCertNo:"",religion:"",religionOther:"",belongingToBPL:"No",bplCardNo:"",bhagyalakshmiBondNo:"",disability:"Not Applicable",disabilityOther:"",cityVillageTown:"",locality:"",taluka:"",district:"",pinCode:"",studentMobile:"",studentEmail:"",fatherMobile:"",fatherEmail:"",motherMobile:"",motherEmail:"",schoolAdmissionDate:"",bankName:"",bankAccountNo:"",bankIFSC:"",nationality:"Indian",bloodGroup:"",fatherPhone:"",fatherOccupation:"",motherPhone:"",motherOccupation:"",guardianName:"",guardianRelation:"",fatherEducation:"",motherEducation:"",familyIncome:"",alternatePhone:"",parentEmail:"",admissionNumber:"",admissionDate:"",previousSchool:"",previousClass:"",tcNumber:"",migrationCertificate:"",aadhaarNumber:"",birthCertificateNumber:"",rationCardNumber:"",caste:"",casteOther:"",category:"",categoryOther:"",subCaste:"",economicStatus:"",bplCardNumber:"",scholarshipDetails:"",specialNeeds:"",disabilityType:"",disabilityCertificate:"",medicalConditions:"",permanentAddress:"",currentAddress:"",village:"",motherTongue:"",motherTongueOther:"",mediumOfInstruction:"",spouseName:""})};j.useEffect(()=>{Bn(),as()},[]),j.useEffect(()=>{Y&&!b.userId&&I(b.role)},[Y]),j.useEffect(()=>{Y&&fe([])},[Y]),j.useEffect(()=>{Mt&&B(S=>({...S,userId:Mt}))},[Mt]),j.useEffect(()=>{Y&&B(S=>({...S,role:ne}))},[ne,Y]);const oi=async()=>{console.log("===  DEBUG: Testing Next ID API ===");const S=["student","teacher","admin"],ue=localStorage.getItem("erp.auth"),qe=ue?JSON.parse(ue).token:null;if(!qe){console.log(" No authentication token found");return}console.log(" Using token:",qe.substring(0,20)+"..."),console.log(" User context:",{schoolCode:e?.schoolCode,role:e?.role});for(const we of S)try{console.log(`
 Testing ${we.toUpperCase()} endpoint...`);try{const de=await ot.get(`/users/next-id/${we}`);console.log(` ${we.toUpperCase()} Next ID:`,de.data)}catch(de){console.log(` ${we.toUpperCase()} Error:`,de.response?.data||de.message)}}catch(de){console.error(` ${we.toUpperCase()} Network Error:`,de)}console.log(`===  DEBUG COMPLETE ===
`)};j.useEffect(()=>{},[e?.schoolCode]),j.useEffect(()=>{typeof window<"u"&&(window.testManageUsersAPI=async()=>{console.log(" Manual API Test Started"),await oi();const S=["student","teacher","admin"];for(const ue of S)try{console.log(`
 Testing ${ue} ID generation...`);const qe=window.fetchNextUserId||Ha;if(typeof qe=="function"){const we=await qe(ue);console.log(`Result for ${ue}:`,we)}else console.warn("fetchNextUserId not available to call")}catch(qe){console.error("Error testing role",ue,qe)}console.log(" Manual API Test Complete")},console.log(" Test function registered: window.testManageUsersAPI()"))},[e]);const Bn=async()=>{console.log(" fetchUsers() called!");try{X(!0);const S=localStorage.getItem("erp.auth"),ue=S?JSON.parse(S).token:null,qe=e?.schoolCode||"TST";if(!ue){console.error(" No token found!"),ge.error("Authentication required");return}console.log(" User object:",e),console.log(" Fetching users for school:",qe),console.log(" API URL will be:",`/api/school-users/${qe}/users`),console.log(" Token being used:",ue?"Present":"Missing");try{const we=await pa.getAllUsers(qe,ue);console.log(" ========== API RESPONSE DEBUG =========="),console.log(" response type:",typeof we),console.log(" response is object:",we!==null&&typeof we=="object"),console.log(" response keys:",Object.keys(we||{})),console.log(" response.success:",we?.success),console.log(" response.data type:",typeof we?.data),console.log(" Is response.data an array?",Array.isArray(we?.data)),console.log(" response.data length:",we?.data?.length),console.log(" response.totalCount:",we?.totalCount),console.log(" response.breakdown:",we?.breakdown),console.log(" ========== END DEBUG =========="),console.log("Full response object:",JSON.stringify(we,null,2));const de=[];let ze=[];we?.data&&Array.isArray(we.data)?(console.log(" Found users array in response.data"),ze=we.data):console.warn(" Could not find users array in response. Response structure:",{hasSuccess:"success"in(we||{}),hasData:"data"in(we||{}),dataType:typeof we?.data,isArray:Array.isArray(we?.data),responseKeys:Object.keys(we||{})}),console.log(` Users array length: ${ze.length}`),ze&&Array.isArray(ze)&&ze.length>0?ze.forEach(Ee=>{const ye={_id:Ee._id||Ee.userId,userId:Ee.userId,name:Ee.name?.displayName||(Ee.name?.firstName&&Ee.name?.lastName?`${Ee.name.firstName} ${Ee.name.lastName}`:Ee.name?.firstName||Ee.name?.lastName||Ee.name||"Unknown"),email:Ee.email||"No email",role:Ee.role,phone:Ee.contact?.primaryPhone||Ee.contact?.phone||Ee.phone,temporaryPassword:Ee.temporaryPassword||Ee.tempPassword||null,address:Ee.address,isActive:Ee.isActive!==!1,createdAt:Ee.createdAt||new Date().toISOString(),profileImage:Ee.profileImage||Ee.profilePicture||null,studentDetails:void 0};Ee.role==="student"?Ee.studentDetails?ye.studentDetails={...Ee.studentDetails,class:Ee.studentDetails.academic?.currentClass||Ee.studentDetails.class||Ee.class||"Not assigned",section:Ee.studentDetails.academic?.currentSection||Ee.studentDetails.section||Ee.section||"Not assigned",studentId:Ee.userId||Ee._id}:ye.studentDetails={class:Ee.class||"Not assigned",section:Ee.section||"Not assigned",studentId:Ee.userId||Ee._id}:Ee.role==="teacher"&&Ee.teacherDetails&&(ye.teacherDetails={employeeId:Ee.teacherDetails?.employeeId||Ee.employeeId||"Not assigned",temporaryPassword:Ee.temporaryPassword||Ee.tempPassword||null,subjects:Array.isArray(Ee.teacherDetails?.subjects)?Ee.teacherDetails.subjects:typeof Ee.teacherDetails?.subjects=="string"?Ee.teacherDetails.subjects.split(",").map(Ge=>Ge.trim()):[],qualification:Ee.teacherDetails?.qualification||"Not provided",experience:Ee.teacherDetails?.experience||0}),de.push(ye)}):!ze||ze.length===0?(console.warn(" Users array is empty or undefined"),console.log("Response structure:",{isArray:Array.isArray(we.data),hasData:!!we.data,hasDataProperty:!!we.data?.data,responseKeys:Object.keys(we.data||{}),responseDataKeys:Object.keys(we.data?.data||{})}),we.success&&we.data&&Array.isArray(we.data)&&(console.log("Found users in response.data (alternate structure)"),ze=we.data)):["students","teachers","admins"].forEach(Ee=>{we[Ee]&&Array.isArray(we[Ee])&&we[Ee].forEach(ye=>{const Ge=Ee.slice(0,-1),Qe={_id:ye._id||ye.userId,userId:ye.userId,name:ye.name?.displayName||(ye.name?.firstName&&ye.name?.lastName?`${ye.name.firstName} ${ye.name.lastName}`:ye.name?.firstName||ye.name?.lastName||ye.name||"Unknown"),email:ye.email||"No email",role:Ge,phone:ye.contact?.primaryPhone||ye.contact?.phone||ye.phone,temporaryPassword:ye.temporaryPassword||ye.tempPassword||null,address:ye.address?.permanent?.street||ye.address?.street||ye.address,profileImage:ye.profileImage||ye.profilePicture||null,isActive:ye.isActive!==!1,createdAt:ye.createdAt||new Date().toISOString()};Ge==="student"?ye.studentDetails?Qe.studentDetails={...ye.studentDetails,studentId:ye.userId||ye._id,class:ye.studentDetails.academic?.currentClass||ye.studentDetails.class||ye.class||"Not assigned",section:ye.studentDetails.academic?.currentSection||ye.studentDetails.section||ye.section||"Not assigned"}:Qe.studentDetails={studentId:ye.userId||ye._id,class:ye.academicInfo?.class||ye.class||"Not assigned",section:ye.academicInfo?.section||ye.section||"Not assigned",rollNumber:ye.studentDetails?.rollNumber||ye.rollNumber||""}:Ge==="teacher"?Qe.teacherDetails={employeeId:ye.teacherDetails?.employeeId||ye.employeeId||ye.teacherId||"Not assigned",subjects:ye.subjects||[],qualification:ye.qualification||"Not provided",experience:ye.experience||0}:Ge==="admin"&&(Qe.adminDetails={employeeId:ye.adminDetails?.employeeId||ye.employeeId||"Not assigned",designation:ye.adminDetails?.designation||"Administrator"}),de.push(Qe)})}),console.log("Processed users:",de),console.log(` Total processed users: ${de.length}`),de.length===0&&(console.warn(" No users were processed from the API response!"),console.log("Full API response:",we)),console.log("Processed Users with Passwords:",de.filter(Ee=>Ee.role==="teacher").map(Ee=>({id:Ee.userId,name:Ee.name,pass:Ee.temporaryPassword,hasPassword:!!Ee.temporaryPassword}))),console.log("Raw teacher data from API:",we.data?.filter(Ee=>Ee.role==="teacher").map(Ee=>({userId:Ee.userId,temporaryPassword:Ee.temporaryPassword,tempPassword:Ee.tempPassword}))),R(de)}catch(we){console.error("API Error:",we),ge.error("Failed to fetch users from API"),R([])}}catch(S){console.error("Error fetching users:",S),ge.error("Failed to fetch users")}finally{X(!1)}},Ha=async S=>{if(!S)return console.log(" No role provided to fetchNextUserId"),rr(""),"";try{cr(!0),console.log(` Fetching next user ID for role: ${S}`);const ue=localStorage.getItem("erp.auth");if(!(ue?JSON.parse(ue).token:null))return console.error(" No authentication token available"),ge.error("Authentication required"),rr(""),"";console.log(" Making API request to:",`/users/next-id/${S}`);const de=(await ot.get(`/users/next-id/${S}`)).data;if(console.log(" API Response data:",de),de.success&&de.nextUserId){const ze=de.nextUserId;return rr(ze),B(Ee=>({...Ee,userId:ze})),console.log(` Successfully fetched next ${S} ID: ${ze}`),ge.success(`Next available ID: ${ze}`),ze}else return console.error(" Invalid response format:",de),ge.error(de.message||"Invalid response from server"),rr(""),""}catch(ue){return console.error(" Error fetching next user ID:",ue),ge.error(`Network error: ${ue.response?.data?.message||ue.message}`),rr(""),""}finally{cr(!1)}},as=async()=>{try{e?.schoolCode&&L({_id:"1",name:e.schoolName||"School",code:e.schoolCode}),console.log("School details set from user context")}catch(S){console.error("Error fetching school details:",S)}},Va=async S=>{try{const ue=F.find(ze=>ze.email.toLowerCase()===S.toLowerCase());if(ue)return{exists:!0,role:ue.role,name:ue.name};const qe=localStorage.getItem("erp.auth"),we=qe?JSON.parse(qe).token:null,de=e?.schoolCode||"P";if(we)try{const ze=await pa.getAllUsers(de,we);if(ze.data&&Array.isArray(ze.data)){const Ee=ze.data.find(ye=>ye.email&&ye.email.toLowerCase()===S.toLowerCase());if(Ee)return{exists:!0,role:Ee.role,name:Ee.name?.displayName||(Ee.name?.firstName&&Ee.name?.lastName?`${Ee.name.firstName} ${Ee.name.lastName}`:Ee.name?.firstName||Ee.name?.lastName||Ee.name||"Unknown")}}}catch{console.warn("Could not verify email uniqueness via API, proceeding with form validation only")}return{exists:!1}}catch(ue){return console.error("Error checking email existence:",ue),{exists:!1}}},D=async S=>{S.preventDefault();try{if(fe([]),T.current)return;const ue=A(b);if(ue.length>0){ue.slice(0,3).forEach(Wt=>ge.error(Wt));return}T.current=!0,X(!0);const qe=await Va(b.email);if(qe.exists){ge.error(`Email already exists for ${qe.role}: ${qe.name}`),X(!1),T.current=!1;return}const we=localStorage.getItem("erp.auth"),de=we?JSON.parse(we).token:null,ze=e?.schoolCode||"NPS";if(!de){ge.error("Authentication required");return}const Ee=b.role==="student"&&b.dateOfBirth?(()=>{const Wt=new Date(b.dateOfBirth);return`${Wt.getDate().toString().padStart(2,"0")}${(Wt.getMonth()+1).toString().padStart(2,"0")}${Wt.getFullYear()}`})():b.generatedPassword||"defaultPassword123",ye={role:b.role,email:b.email,firstName:b.firstName,lastName:b.lastName,phone:b.primaryPhone||b.phone,password:Ee,dateOfBirth:b.dateOfBirth,gender:b.gender,address:b.address,city:b.cityVillageTown||b.city||b.permanentCity,state:b.state||b.permanentState,pinCode:b.pinCode||b.permanentPincode,cityVillageTown:b.cityVillageTown,locality:b.locality||b.permanentArea||"",district:b.district||b.districtText||"",name:{firstName:b.firstName,middleName:b.middleName||"",lastName:b.lastName,displayName:`${b.firstName} ${b.lastName}`.trim()},temporaryPassword:Ee,passwordChangeRequired:!0,contact:{primaryPhone:b.primaryPhone||b.phone,secondaryPhone:b.secondaryPhone||"",whatsappNumber:b.whatsappNumber||"",emergencyContact:{name:b.emergencyContactName||"",relationship:b.emergencyContactRelation||"",phone:b.emergencyContactPhone||""}},addressDetails:{permanent:{street:b.permanentStreet||b.address||"",area:b.permanentArea||"",city:b.permanentCity||b.city||"",state:b.permanentState||b.state||"",country:b.permanentCountry||"India",pincode:b.permanentPincode||b.pinCode||"",landmark:b.permanentLandmark||""},current:{street:b.sameAsPermanent?b.permanentStreet||b.address||"":b.currentStreet||"",area:b.sameAsPermanent?b.permanentArea||"":b.currentArea||"",city:b.sameAsPermanent?b.permanentCity||b.city||"":b.currentCity||"",state:b.sameAsPermanent?b.permanentState||b.state||"":b.currentState||"",country:b.sameAsPermanent?b.permanentCountry||"India":b.currentCountry||"India",pincode:b.sameAsPermanent?b.permanentPincode||b.pinCode||"":b.currentPincode||"",landmark:b.sameAsPermanent?b.permanentLandmark||"":b.currentLandmark||"",sameAsPermanent:b.sameAsPermanent}},identity:{aadharNumber:b.aadharNumber||b.studentAadhaar||b.aadhaarNumber||"",panNumber:b.panNumber||"",voterIdNumber:b.voterIdNumber||"",drivingLicenseNumber:b.drivingLicenseNumber||"",passportNumber:b.passportNumber||""},isActive:!0,isVerified:!1,schoolCode:ze,schoolAccess:{joinedDate:new Date,status:"active",accessLevel:"standard"}};if(b.role==="student"?(ye.studentDetails={academic:{currentClass:b.studentDetails?.currentClass||b.class||"",currentSection:b.studentDetails?.currentSection||b.section||"",academicYear:b.studentDetails?.academicYear||n||"2024-25",admissionDate:b.studentDetails?.admissionDate?new Date(b.studentDetails.admissionDate):void 0,admissionClass:b.studentDetails?.admissionClass||"",rollNumber:b.studentDetails?.rollNumber||b.rollNumber||"",admissionNumber:b.studentDetails?.admissionNumber||b.admissionNumber||"",enrollmentNo:b.studentDetails?.enrollmentNo||b.enrollmentNo||"",tcNo:b.studentDetails?.tcNo||b.tcNo||"",previousSchool:{name:b.studentDetails?.previousSchoolName||b.previousSchool||"",board:b.studentDetails?.previousBoard||"",lastClass:b.studentDetails?.lastClass||b.previousClass||"",tcNumber:b.studentDetails?.tcNumber||b.tcNumber||"",tcDate:b.studentDetails?.tcDate?new Date(b.studentDetails.tcDate):void 0,reasonForTransfer:b.studentDetails?.reasonForTransfer||""}},personal:{dateOfBirth:b.studentDetails?.dateOfBirth?new Date(b.studentDetails.dateOfBirth):b.dateOfBirth?new Date(b.dateOfBirth):void 0,placeOfBirth:b.studentDetails?.placeOfBirth||"",gender:b.studentDetails?.gender||b.gender||"male",bloodGroup:b.studentDetails?.bloodGroup||b.bloodGroup||"",nationality:b.studentDetails?.nationality||b.nationality||"Indian",religion:b.studentDetails?.religion||b.religion||"",religionOther:b.studentDetails?.religionOther||b.religionOther||"",caste:b.studentDetails?.caste||b.caste||"",casteOther:b.studentDetails?.casteOther||b.casteOther||"",category:b.studentDetails?.category||b.category||"",categoryOther:b.studentDetails?.categoryOther||b.categoryOther||"",motherTongue:b.studentDetails?.motherTongue||b.motherTongue||"",motherTongueOther:b.studentDetails?.motherTongueOther||b.motherTongueOther||"",studentNameKannada:b.studentDetails?.studentNameKannada||b.studentNameKannada||"",ageYears:b.studentDetails?.ageYears||b.ageYears||0,ageMonths:b.studentDetails?.ageMonths||b.ageMonths||0,socialCategory:b.studentDetails?.socialCategory||b.socialCategory||"",socialCategoryOther:b.studentDetails?.socialCategoryOther||b.socialCategoryOther||"",studentCaste:b.studentDetails?.studentCaste||b.studentCaste||"",studentCasteOther:b.studentDetails?.studentCasteOther||b.studentCasteOther||"",studentAadhaar:b.studentDetails?.studentAadhaar||b.studentAadhaar||"",studentCasteCertNo:b.studentDetails?.studentCasteCertNo||b.studentCasteCertNo||"",belongingToBPL:b.studentDetails?.belongingToBPL||b.belongingToBPL||"No",bplCardNo:b.studentDetails?.bplCardNo||b.bplCardNo||"",bhagyalakshmiBondNo:b.studentDetails?.bhagyalakshmiBondNo||b.bhagyalakshmiBondNo||"",disability:b.studentDetails?.disability||b.disability||"Not Applicable",disabilityOther:b.studentDetails?.disabilityOther||b.disabilityOther||"",isRTECandidate:b.studentDetails?.isRTECandidate||b.isRTECandidate||"No"},family:{father:{name:b.studentDetails?.fatherName||b.fatherName||"",nameKannada:b.studentDetails?.fatherNameKannada||b.fatherNameKannada||"",occupation:b.studentDetails?.fatherOccupation||b.fatherOccupation||"",qualification:b.studentDetails?.fatherQualification||b.fatherEducation||"",phone:b.studentDetails?.fatherPhone||b.fatherPhone||b.fatherMobile||"",email:b.studentDetails?.fatherEmail||b.fatherEmail||"",aadhaar:b.studentDetails?.fatherAadhaar||b.fatherAadhaar||"",caste:b.studentDetails?.fatherCaste||b.fatherCaste||"",casteOther:b.studentDetails?.fatherCasteOther||b.fatherCasteOther||"",casteCertNo:b.studentDetails?.fatherCasteCertNo||b.fatherCasteCertNo||"",workAddress:b.studentDetails?.fatherWorkAddress||"",annualIncome:b.studentDetails?.fatherAnnualIncome||0},mother:{name:b.studentDetails?.motherName||b.motherName||"",nameKannada:b.studentDetails?.motherNameKannada||b.motherNameKannada||"",occupation:b.studentDetails?.motherOccupation||b.motherOccupation||"",qualification:b.studentDetails?.motherQualification||b.motherEducation||"",phone:b.studentDetails?.motherPhone||b.motherPhone||b.motherMobile||"",email:b.studentDetails?.motherEmail||b.motherEmail||"",aadhaar:b.studentDetails?.motherAadhaar||b.motherAadhaar||"",caste:b.studentDetails?.motherCaste||b.motherCaste||"",casteOther:b.studentDetails?.motherCasteOther||b.motherCasteOther||"",casteCertNo:b.studentDetails?.motherCasteCertNo||b.motherCasteCertNo||"",workAddress:b.studentDetails?.motherWorkAddress||"",annualIncome:b.studentDetails?.motherAnnualIncome||0},guardian:b.studentDetails?.guardianName?{name:b.studentDetails.guardianName,relationship:b.studentDetails.guardianRelationship||b.guardianRelation||"",phone:b.studentDetails.guardianPhone||"",email:b.studentDetails.guardianEmail||"",address:b.studentDetails.guardianAddress||"",isEmergencyContact:b.studentDetails.isEmergencyContact||!1}:void 0},transport:{mode:b.studentDetails?.transportMode||"",busRoute:b.studentDetails?.busRoute||"",pickupPoint:b.studentDetails?.pickupPoint||"",dropPoint:b.studentDetails?.dropPoint||"",pickupTime:b.studentDetails?.pickupTime||"",dropTime:b.studentDetails?.dropTime||""},financial:{feeCategory:b.studentDetails?.feeCategory||"",concessionType:b.studentDetails?.concessionType||"",concessionPercentage:b.studentDetails?.concessionPercentage||0,scholarshipDetails:b.studentDetails?.scholarshipName?{name:b.studentDetails.scholarshipName,amount:b.studentDetails.scholarshipAmount||0,provider:b.studentDetails.scholarshipProvider||""}:void 0,bankDetails:{bankName:b.studentDetails?.financial?.bankDetails?.bankName||b.bankName||"",accountNumber:b.studentDetails?.financial?.bankDetails?.accountNumber||b.bankAccountNo||"",ifscCode:b.studentDetails?.financial?.bankDetails?.ifscCode||b.bankIFSC||"",accountHolderName:b.studentDetails?.financial?.bankDetails?.accountHolderName||b.accountHolderName||""}},medical:b.studentDetails?.allergies?.length?{allergies:b.studentDetails.allergies,chronicConditions:b.studentDetails.chronicConditions||[],medications:b.studentDetails.medications||[],emergencyMedicalContact:{doctorName:b.studentDetails.doctorName||"",hospitalName:b.studentDetails.hospitalName||"",phone:b.studentDetails.doctorPhone||""},lastMedicalCheckup:b.studentDetails.lastMedicalCheckup?new Date(b.studentDetails.lastMedicalCheckup):void 0}:void 0},ye.class=b.class||ye.studentDetails.academic.currentClass,ye.section=b.section||ye.studentDetails.academic.currentSection,ye.enrollmentNo=b.enrollmentNo||ye.studentDetails.academic.enrollmentNo,ye.tcNo=b.tcNo||ye.studentDetails.academic.tcNo,ye.studentAadhaar=b.studentAadhaar||ye.studentDetails.personal.studentAadhaar,ye.studentCasteCertNo=b.studentCasteCertNo||ye.studentDetails.personal.studentCasteCertNo,ye.isRTECandidate=b.isRTECandidate||ye.studentDetails.personal.isRTECandidate,ye.fatherName=b.fatherName||ye.studentDetails.family?.father?.name,ye.schoolAdmissionDate=b.schoolAdmissionDate?new Date(b.schoolAdmissionDate):b.studentDetails?.schoolAdmissionDate?new Date(b.studentDetails.schoolAdmissionDate):void 0,ye.bankName=b.bankName||ye.studentDetails.financial?.bankDetails?.bankName,ye.bankAccountNo=b.bankAccountNo||ye.studentDetails.financial?.bankDetails?.accountNumber,ye.bankIFSC=b.bankIFSC||ye.studentDetails.financial?.bankDetails?.ifscCode,ye.accountHolderName=b.accountHolderName||ye.studentDetails.financial?.bankDetails?.accountHolderName,ye.nationality=b.nationality||ye.studentDetails.personal.nationality,ye.cityVillageTown=b.cityVillageTown||ye.addressDetails?.permanent?.city,ye.permanentStreet=ye.studentDetails.addressDetails?.permanent?.street||b.address,ye.permanentCity=ye.studentDetails.addressDetails?.permanent?.city||b.city,ye.permanentState=ye.studentDetails.addressDetails?.permanent?.state||b.state,ye.permanentPincode=ye.studentDetails.addressDetails?.permanent?.pincode||b.pinCode,ye.academicYear=b.studentDetails?.academicYear||n||"2024-25",ye.aadharKPRNo=b.studentAadhaar||ye.studentDetails.personal.studentAadhaar||b.aadharNumber||ye.identity?.aadharNumber,ye.studentCasteCertificateNo=b.studentCasteCertNo||ye.studentDetails.personal.studentCasteCertNo||"",ye.studentCaste=b.studentCaste||ye.studentDetails.personal.studentCaste||"",ye.socialCategory=b.socialCategory||ye.studentDetails.personal.socialCategory||"",ye.motherTongue=b.motherTongue||ye.studentDetails.personal.motherTongue||"",ye.belongingToBPL=b.belongingToBPL||ye.studentDetails.personal.belongingToBPL||"No",ye.bplCardNo=b.bplCardNo||ye.studentDetails.personal.bplCardNo||"",ye.bhagyalakshmiBondNo=b.bhagyalakshmiBondNo||ye.studentDetails.personal.bhagyalakshmiBondNo||"",ye.bankIFSCCode=b.bankIFSC||ye.studentDetails.financial?.bankDetails?.ifscCode||ye.bankIFSC||""):b.role==="teacher"?ye.teacherDetails={employeeId:b.teacherDetails?.employeeId||b.employeeId||"",joiningDate:b.teacherDetails?.joiningDate?new Date(b.teacherDetails.joiningDate):b.joiningDate?new Date(b.joiningDate):void 0,qualification:b.teacherDetails?.qualification||b.qualification||"",experience:b.teacherDetails?.experience||Number(b.experience)||0,subjects:b.teacherDetails?.subjects?.length?b.teacherDetails.subjects:b.subjects?String(b.subjects).split(",").map(Wt=>Wt.trim()).filter(Wt=>Wt):[],specialization:b.teacherDetails?.specialization||"",designation:b.teacherDetails?.designation||"",department:b.teacherDetails?.department||b.department||"",bankDetails:{accountNumber:b.teacherDetails?.bankAccountNumber||"",ifscCode:b.teacherDetails?.bankIFSC||"",bankName:b.teacherDetails?.bankName||"",branchName:b.teacherDetails?.bankBranchName||"",accountHolderName:b.teacherDetails?.bankAccountHolderName||`${b.firstName} ${b.lastName}`.trim()}}:b.role==="admin"&&(ye.adminDetails={adminType:b.adminDetails?.adminType||b.adminLevel||"",employeeId:b.adminDetails?.employeeId||b.employeeId||"",joiningDate:b.adminDetails?.joiningDate?new Date(b.adminDetails.joiningDate):void 0,designation:b.adminDetails?.designation||"",department:b.adminDetails?.department||b.department||"",permissions:{userManagement:b.adminDetails?.userManagement||!1,academicManagement:b.adminDetails?.academicManagement||!1,feeManagement:b.adminDetails?.feeManagement||!1,reportGeneration:b.adminDetails?.reportGeneration||!1,systemSettings:b.adminDetails?.systemSettings||!1,schoolSettings:b.adminDetails?.schoolSettings||!1,dataExport:b.adminDetails?.dataExport||!1,auditLogs:b.adminDetails?.auditLogs||!1},workSchedule:{workingDays:b.adminDetails?.workingDays||[],workingHours:{start:b.adminDetails?.workingHoursStart||"",end:b.adminDetails?.workingHoursEnd||""}},salary:b.adminDetails?.basicSalary?{basic:b.adminDetails.basicSalary,allowances:b.adminDetails.allowances||[],currency:"INR"}:void 0,bankDetails:b.adminDetails?.bankAccountNumber?{accountNumber:b.adminDetails.bankAccountNumber,ifscCode:b.adminDetails.bankIFSC||"",bankName:b.adminDetails.bankName||"",branchName:b.adminDetails.bankBranchName||"",accountHolderName:b.adminDetails.bankAccountHolderName||""}:void 0}),console.log("Creating user with comprehensive data:",ye),b.userId)ye.userId=b.userId;else try{await Ha(b.role),ye.userId=Mt||b.userId}catch{console.warn("Could not fetch next user ID before create, proceeding with backend generation")}console.log(" Sending to server:",JSON.stringify(ye,null,2));const Ge=await pa.addUser(ze,ye,de),Qe=Ge?.data?.user?.userId||Ge?.data?.credentials?.userId||Ge?.user?.userId||Ge?.userId,Jt=Ee||Ge?.data?.credentials?.password||Ge?.data?.user?.tempPassword||Ge?.user?.tempPassword,Ct=Ge?.data?.user?.email||Ge?.user?.email||b.email,ur=Ge?.data?.user?.role||Ge?.user?.role||b.role;if(!Qe||!Jt)throw console.error("Server response:",Ge),new Error("Server did not return required user credentials");Q({userId:Qe,password:Jt,email:Ct,role:ur}),ge.success("User created successfully with comprehensive details"),H(!1),ns(),Bn()}catch(ue){console.error("Error creating user:",ue);const qe=ue?.response?.data?.message,we=ue?.response?.data?.errors||[];if(console.log(" Server response data:",ue?.response?.data),we&&we.length>0){qe&&ge.error(qe),we.slice(0,6).forEach(de=>ge.error(String(de)));try{fe(we.map(String))}catch(de){console.warn("Could not set addFormServerErrors",de)}console.warn("Server validation errors:",we)}else ge.error(qe||ue.message||"Failed to create user")}finally{X(!1),T.current=!1}},q=S=>{console.log("=== EDITING USER ==="),console.log("User:",S),be(S),he(!0)};j.useEffect(()=>{if(!K)return;console.log("=== POPULATING FORM DATA FROM EDITING USER ==="),console.log("Full editingUser:",JSON.stringify(K,null,2));const S=K,ue=S.studentDetails||{},qe=ue.academic||{},we=ue.personal||{},de=ue.family||{},ze=de.father||{},Ee=de.mother||{},ye=de.guardian||{},Qe=(ue.financial||{}).bankDetails||{},Jt=ue.transport||{},Ct=ue.medical||{};let ur="",Wt="";if(typeof S.name=="string"&&S.name){const mr=S.name.trim().split(" ");ur=mr[0]||"",Wt=mr.slice(1).join(" ")||""}const zr={userId:S.userId||S._id||"",generatedPassword:"",enrollmentNo:qe.enrollmentNo||S.enrollmentNo||"",tcNo:qe.tcNo||S.tcNo||"",role:S.role||"student",class:qe.currentClass||ue.currentClass||S.class||"",academicYear:qe.academicYear||S.academicYear||"2024-2025",section:qe.currentSection||ue.currentSection||S.section||"",mediumOfInstruction:S.mediumOfInstruction||"English",motherTongue:we.motherTongue||S.motherTongue||"",motherTongueOther:we.motherTongueOther||S.motherTongueOther||"",name:S.name?.displayName||(S.name?.firstName&&S.name?.lastName?S.name.firstName+" "+S.name.lastName:"")||(typeof S.name=="string"?S.name:"")||"",studentNameKannada:we.studentNameKannada||S.studentNameKannada||"",firstName:S.name?.firstName||ur||S.firstName||ue.firstName||"",middleName:S.name?.middleName||S.middleName||ue.middleName||"",lastName:S.name?.lastName||Wt||S.lastName||ue.lastName||"",dateOfBirth:t(we.dateOfBirth||S.dateOfBirth||""),ageYears:we.ageYears||S.ageYears||0,ageMonths:we.ageMonths||S.ageMonths||0,gender:we.gender||S.gender||"male",fatherName:ze.name||S.fatherName||"",fatherNameKannada:ze.nameKannada||S.fatherNameKannada||"",fatherAadhaar:ze.aadhaar||S.fatherAadhaar||"",motherName:Ee.name||S.motherName||"",motherNameKannada:Ee.nameKannada||S.motherNameKannada||"",motherAadhaar:Ee.aadhaar||S.motherAadhaar||"",guardianName:ye.name||S.guardianName||"",studentAadhaar:we.studentAadhaar||S.identity?.aadharNumber||"",studentCasteCertNo:we.studentCasteCertNo||"",fatherCasteCertNo:ze.casteCertNo||"",motherCasteCertNo:Ee.casteCertNo||"",studentCaste:we.studentCaste||we.caste||"",studentCasteOther:we.studentCasteOther||"",fatherCaste:ze.caste||"",fatherCasteOther:ze.casteOther||"",motherCaste:Ee.caste||"",motherCasteOther:Ee.casteOther||"",socialCategory:we.category||"",socialCategoryOther:we.categoryOther||"",religion:we.religion||"",religionOther:we.religionOther||"",belongingToBPL:we.belongingToBPL||"No",bplCardNo:we.bplCardNo||"",bhagyalakshmiBondNo:we.bhagyalakshmiBondNo||"",disability:we.disability||"Not Applicable",disabilityOther:we.disabilityOther||"",isRTECandidate:we.isRTECandidate||"No",address:S.address?.permanent?.street||S.address||"",cityVillageTown:S.address?.permanent?.city||"",locality:S.address?.permanent?.area||"",taluka:S.address?.permanent?.taluka||"",district:S.address?.permanent?.district||"",pinCode:S.address?.permanent?.pincode||"",state:S.address?.permanent?.state||"",permanentStreet:S.address?.permanent?.street||"",permanentArea:S.address?.permanent?.area||"",permanentCity:S.address?.permanent?.city||"",permanentState:S.address?.permanent?.state||"Karnataka",permanentCountry:S.address?.permanent?.country||"India",permanentPincode:S.address?.permanent?.pincode||"",permanentLandmark:S.address?.permanent?.landmark||"",currentStreet:S.address?.current?.street||"",currentArea:S.address?.current?.area||"",currentCity:S.address?.current?.city||"",currentState:S.address?.current?.state||"Karnataka",currentCountry:S.address?.current?.country||"India",currentPincode:S.address?.current?.pincode||"",currentLandmark:S.address?.current?.landmark||"",sameAsPermanent:S.address?.sameAsPermanent!==void 0?S.address.sameAsPermanent:!0,studentMobile:S.contact?.primaryPhone||S.phone||"",studentEmail:S.email||"",fatherMobile:ze.phone||"",fatherEmail:ze.email||"",motherMobile:Ee.phone||"",motherEmail:Ee.email||"",schoolAdmissionDate:t(qe.admissionDate||S.schoolAdmissionDate||""),bankName:Qe.bankName||"",bankAccountNo:Qe.accountNumber||"",bankIFSC:Qe.ifscCode||"",email:S.email||"",phone:S.contact?.primaryPhone||S.phone||"",primaryPhone:S.contact?.primaryPhone||S.phone||"",secondaryPhone:S.contact?.secondaryPhone||"",whatsappNumber:S.contact?.whatsappNumber||"",city:S.address?.permanent?.city||"",nationality:we.nationality||"Indian",bloodGroup:we.bloodGroup||"",fatherPhone:ze.phone||"",fatherOccupation:ze.occupation||"",motherPhone:Ee.phone||"",motherOccupation:Ee.occupation||"",guardianRelation:ye.relationship||"",fatherEducation:ze.qualification||"",motherEducation:Ee.qualification||"",familyIncome:ze.annualIncome||Ee.annualIncome||"",emergencyContactName:S.contact?.emergencyContact?.name||"",emergencyContactPhone:S.contact?.emergencyContact?.phone||"",emergencyContactRelation:S.contact?.emergencyContact?.relationship||"",previousSchool:qe.previousSchool?.name||"",previousClass:qe.previousSchool?.lastClass||"",migrationCertificate:"",aadhaarNumber:S.identity?.aadharNumber||"",panNumber:S.identity?.panNumber||"",transportMode:Jt.mode||"",busRoute:Jt.busRoute||"",pickupPoint:Jt.pickupPoint||"",medicalConditions:Array.isArray(Ct.chronicConditions)?Ct.chronicConditions.join(", "):"",allergies:Array.isArray(Ct.allergies)?Ct.allergies.join(", "):"",specialNeeds:"",subjects:Array.isArray(S.teacherDetails?.subjects)?S.teacherDetails.subjects.map(mr=>mr.subjectName||mr).join(", "):S.teacherDetails?.subjects||"",qualification:S.teacherDetails?.qualification?.highest||S.teacherDetails?.qualification||"",experience:S.teacherDetails?.experience?.total||S.teacherDetails?.experience||0,employeeId:S.teacherDetails?.employeeId||"",department:S.teacherDetails?.department||"",joiningDate:t(S.teacherDetails?.joiningDate||""),adminLevel:S.adminDetails?.adminType||"",accessLevel:"",studentDetails:ue,teacherDetails:S.teacherDetails||{},adminDetails:S.adminDetails||{}};console.log("=== FORM DATA POPULATED WITH FIXES ==="),B(zr)},[K]);const Z=async S=>{if(S.preventDefault(),!!K)try{if(X(!0),b.email!==K.email){const ze=await Va(b.email);if(ze.exists){ge.error(`Email already exists for ${ze.role}: ${ze.name}`),X(!1);return}}const ue=localStorage.getItem("erp.auth"),qe=ue?JSON.parse(ue).token:null,we=e?.schoolCode||"P";if(!qe){ge.error("Authentication required");return}const de={firstName:b.firstName,middleName:b.middleName,lastName:b.lastName,email:b.email,phone:b.phone,role:K.role,primaryPhone:b.primaryPhone||b.phone,secondaryPhone:b.secondaryPhone,whatsappNumber:b.whatsappNumber,emergencyContactPhone:b.emergencyContactPhone,permanentStreet:b.permanentStreet,permanentArea:b.permanentArea,permanentCity:b.permanentCity,permanentState:b.permanentState,permanentCountry:b.permanentCountry,permanentPincode:b.permanentPincode,permanentLandmark:b.permanentLandmark,currentStreet:b.currentStreet,currentArea:b.currentArea,currentCity:b.currentCity,currentState:b.currentState,currentCountry:b.currentCountry,currentPincode:b.currentPincode,currentLandmark:b.currentLandmark,sameAsPermanent:b.sameAsPermanent,stateId:b.stateId,districtId:b.districtId,talukaId:b.talukaId,districtText:b.districtText,talukaText:b.talukaText,state:b.state||b.permanentState,district:b.district,taluka:b.taluka,city:b.city||b.permanentCity,pinCode:b.pinCode||b.permanentPincode};if(K.role==="student"?(de.class=b.class,de.section=b.section,de.rollNumber=b.rollNumber,de.dateOfBirth=b.dateOfBirth,de.gender=b.gender,de.bloodGroup=b.bloodGroup,de.admissionDate=b.admissionDate,de.admissionNumber=b.admissionNumber,de.motherTongue=b.motherTongue,de.motherTongueOther=b.motherTongueOther,de.fatherName=b.fatherName,de.motherName=b.motherName,de.fatherPhone=b.fatherPhone,de.motherPhone=b.motherPhone,de.fatherOccupation=b.fatherOccupation,de.motherOccupation=b.motherOccupation,de.guardianName=b.guardianName,de.guardianRelation=b.guardianRelation,de.fatherEducation=b.fatherEducation,de.motherEducation=b.motherEducation,de.familyIncome=b.familyIncome,de.studentCaste=b.studentCaste,de.studentCasteOther=b.studentCasteOther,de.fatherCaste=b.fatherCaste,de.fatherCasteOther=b.fatherCasteOther,de.motherCaste=b.motherCaste,de.motherCasteOther=b.motherCasteOther,de.socialCategory=b.socialCategory,de.socialCategoryOther=b.socialCategoryOther,de.religion=b.religion,de.religionOther=b.religionOther,de.disability=b.disability,de.disabilityOther=b.disabilityOther,de.isRTECandidate=b.isRTECandidate,de.aadhaarNumber=b.aadhaarNumber,de.birthCertificateNumber=b.birthCertificateNumber,de.rationCardNumber=b.rationCardNumber,de.voterIdNumber=b.voterIdNumber,de.passportNumber=b.passportNumber,de.caste=b.caste,de.category=b.category,de.subCaste=b.subCaste,de.religion=b.religion,de.economicStatus=b.economicStatus,de.bplCardNumber=b.bplCardNumber,de.scholarshipDetails=b.scholarshipDetails,de.specialNeeds=b.specialNeeds,de.disabilityType=b.disabilityType,de.disabilityCertificate=b.disabilityCertificate,de.medicalConditions=b.medicalConditions,de.permanentAddress=b.permanentAddress,de.currentAddress=b.currentAddress,de.taluka=b.taluka,de.village=b.village,de.alternatePhone=b.alternatePhone,de.parentEmail=b.parentEmail,de.bankAccountNumber=b.bankAccountNumber,de.bankName=b.bankName,de.ifscCode=b.ifscCode,de.accountHolderName=b.accountHolderName,b.studentDetails&&(de.studentDetails=b.studentDetails)):K.role==="teacher"?(de.qualification=b.qualification,de.experience=b.experience,de.subjects=b.subjects,de.department=b.department,de.employeeId=b.employeeId,de.joiningDate=b.joiningDate,de.dateOfBirth=b.dateOfBirth,de.gender=b.gender,de.phone=b.phone,de.email=b.email,b.teacherDetails&&(de.teacherDetails=b.teacherDetails)):K.role==="admin"&&(de.adminLevel=b.adminLevel,de.department=b.department,de.employeeId=b.employeeId,de.accessLevel=b.accessLevel,b.adminDetails&&(de.adminDetails=b.adminDetails)),de.address=b.address,de.city=b.city,de.state=b.state,de.pinCode=b.pinCode,de.district=b.district,console.log("Updating user with data:",de),ve){console.log(" Uploading with profile image...");const ze=new FormData;ze.append("userData",JSON.stringify(de)),ze.append("profileImage",ve),console.log("Sending FormData with image and userData string...");const Ee=await ot.put(`/school-users/${we}/users/${K._id}`,ze,{headers:{"Content-Type":void 0}});console.log(" User updated with image successfully via /api/school-users",Ee.data)}else console.log("Updating without image..."),await pa.updateUser(we,K._id,de,qe);ge.success("User updated successfully"),he(!1),be(null),We(null),je(null),ns(),Bn()}catch(ue){console.error("Error updating user:",ue),ge.error(ue.response?.data?.message||"Failed to update user")}finally{X(!1)}},ce=async(S,ue)=>{if(console.log("Delete button clicked for user:",S,ue),!window.confirm(`Are you sure you want to delete user "${ue}"? This action cannot be undone.`)){console.log("User cancelled deletion");return}try{console.log("Starting delete process...");const qe=localStorage.getItem("erp.auth"),we=qe?JSON.parse(qe).token:null,de=e?.schoolCode||"P";if(console.log("Delete request details:",{schoolCode:de,userId:S,hasToken:!!we}),!we){ge.error("Authentication required");return}console.log("Calling delete API..."),await pa.deleteUser(de,S,we),console.log("Delete API successful"),ge.success("User deleted successfully"),Bn()}catch(qe){console.error("Error deleting user:",qe),ge.error(qe.response?.data?.message||"Failed to delete user")}},Fe=(S,ue,qe)=>{console.log("Opening change password modal for:",{userId:S,name:ue,email:qe}),Dr({userId:S,name:ue,email:qe}),Vt(""),Nr(""),sn(!0)},De=async()=>{if(!Ht){console.error("No user selected for password change");return}if(console.log("Starting password change for:",Ht.userId),!dr||!er){ge.error("Please enter both password fields");return}if(dr.trim()===""){ge.error("Password cannot be empty");return}if(dr!==er){ge.error("Passwords do not match");return}dn(!0);try{const S=localStorage.getItem("erp.auth"),ue=S?JSON.parse(S).token:null;if(!ue){ge.error("Authentication token not found");return}const qe=e?.schoolCode||$?.code||"SB";console.log("Calling changePassword API with:",{schoolCode:qe,userId:Ht.userId});const we=await pa.changePassword(qe,Ht.userId,dr,ue);console.log("Change password response:",we),(we.data||we.success)&&(ge.success("Password changed successfully"),sn(!1),Dr(null),Vt(""),Nr(""),Bn())}catch(S){console.error("Error changing password:",S),ge.error(S.response?.data?.message||S.message||"Failed to change password")}finally{dn(!1)}},Ze=F.filter(S=>{const ue=(S.userId||S._id||"").toLowerCase(),qe=(S.name||"").toLowerCase(),we=(S.email||"").toLowerCase(),de=me.toLowerCase(),ze=qe.includes(de)||we.includes(de)||ue.includes(de),Ee=S.role===ne,ye=S.academicInfo?.class||S.studentDetails?.academic?.currentClass||S.studentDetails?.currentClass||S.studentDetails?.class||S.class,Ge=S.academicInfo?.section||S.studentDetails?.academic?.currentSection||S.studentDetails?.currentSection||S.studentDetails?.section||S.section,Qe=ne!=="student"||lt==="all"||String(ye).trim()===String(lt).trim(),Jt=ne!=="student"||Lt==="all"||String(Ge).trim().toUpperCase()===String(Lt).trim().toUpperCase(),Ct=S.studentDetails?.academic?.academicYear||S.studentDetails?.academicYear||S.academicYear||S.academicInfo?.academicYear,ur=ne!=="student"||!Ct||String(Ct).trim()===String(a).trim();return ne==="student"&&S.userId==="AVM-S-0063"&&console.log(" Filtering AVM-S-0063:",{studentAcademicYear:Ct,viewingAcademicYear:a,matchesAcademicYear:ur,matchesGrade:Qe,matchesSection:Jt,currentClass:S.studentDetails?.academic?.currentClass||S.studentDetails?.currentClass,selectedGrade:lt}),ze&&Ee&&Qe&&Jt&&ur}).sort((S,ue)=>{if(S.role==="student"&&ue.role==="student"){const qe=S.userId||S._id||"",we=ue.userId||ue._id||"",de=ye=>{const Ge=ye.match(/\d+$/);return Ge?parseInt(Ge[0]):0},ze=de(qe),Ee=de(we);return ze!==0||Ee!==0?ze-Ee:qe.localeCompare(we)}if(S.role==="teacher"&&ue.role==="teacher"){const qe=S.userId||S._id||"",we=ue.userId||ue._id||"",de=ye=>{const Ge=ye.match(/\d+$/);return Ge?parseInt(Ge[0]):0},ze=de(qe),Ee=de(we);return ze!==0||Ee!==0?ze-Ee:qe.localeCompare(we)}if(S.role==="admin"&&ue.role==="admin"){const qe=S.userId||S._id||"",we=ue.userId||ue._id||"",de=ye=>{const Ge=ye.match(/\d+$/);return Ge?parseInt(Ge[0]):0},ze=de(qe),Ee=de(we);return ze!==0||Ee!==0?ze-Ee:qe.localeCompare(we)}return 0}),bt=()=>{try{if(!b)return!1;const S=String(b.firstName||"").trim()!=="",ue=String(b.lastName||"").trim()!=="",qe=String(b.email||"").trim()!==""&&/\S+@\S+\.\S+/.test(b.email),de=String(b.phone||b.primaryPhone||"").trim()!=="",Ee=String(b.dateOfBirth||b.studentDetails?.dateOfBirth||"").trim()!=="",Ge=String(b.gender||b.studentDetails?.gender||"").trim()!=="";if(b.role==="student"){const Qe=String(b.class||b.studentDetails?.currentClass||"").trim(),Jt=String(b.section||b.studentDetails?.currentSection||"").trim(),Ct=String(b.enrollmentNo||b.studentDetails?.enrollmentNo||b.studentDetails?.admissionNumber||b.admissionNumber||"").trim(),ur=String(b.tcNo||b.studentDetails?.tcNo||b.tcNumber||"").trim(),Wt=String(b.studentCasteCertNo||b.studentDetails?.studentCasteCertNo||"").trim(),zr=String(b.schoolAdmissionDate||b.studentDetails?.admissionDate||b.admissionDate||"").trim(),mr=String(b.bankName||b.studentDetails?.bankName||"").trim(),br=String(b.bankAccountNo||b.studentDetails?.bankAccountNo||b.bankAccountNumber||"").trim(),Mr=String(b.bankIFSC||b.studentDetails?.bankIFSC||b.bankIfsc||"").trim(),un=String(b.address||b.permanentStreet||"").trim(),hr=String(b.cityVillageTown||b.city||b.permanentCity||"").trim(),Er=String(b.pinCode||b.permanentPincode||"").trim(),mn=String(b.nationality||b.studentDetails?.nationality||"").trim();return[S,ue,qe,de,Ee,Ge,Qe!=="",Ct!=="",ur!=="",Wt!=="",zr!=="",mr!=="",br!=="",Mr!=="",un!=="",hr!=="",Er!=="",mn!==""].every(Boolean)}return b.role==="teacher"||b.role==="admin"?S&&ue&&qe&&de:S&&ue&&qe}catch(S){return console.error("Error in isFormValid quick-check:",S),!1}},St=()=>{const S=A(b);if(S.length===0)return"";const ue=we=>we.includes("First name")?"First name":we.includes("Last name")?"Last name":we.includes("email")?"Email":we.includes("phone")?"Phone":we.includes("Date of birth")?"Date of birth":we.includes("Gender")?"Gender":we.includes("Address")?"Address":we.includes("Class selection")?"Class":we.includes("Father's name")?"Father's name":we.includes("Mother's name")?"Mother's name":we.includes("Enrollment")?"Enrollment No":we.includes("TC Number")||we.includes("TC No")||we.includes("TC number")?"TC No":we.toLowerCase().includes("school admission")||we.toLowerCase().includes("admission date")?"School Admission Date":we.toLowerCase().includes("bank name")?"Bank Name":we.toLowerCase().includes("account")&&we.toLowerCase().includes("number")?"Bank Account No":we.toLowerCase().includes("ifsc")?"Bank IFSC Code":we.toLowerCase().includes("student caste")&&we.toLowerCase().includes("certificate")?"Student Caste Cert No":we.toLowerCase().includes("aadhaar")||we.toLowerCase().includes("aadhar")||we.toLowerCase().includes("kpr")?"Aadhaar/KPR No":we,qe=S.map(ue);return`Missing: ${Array.from(new Set(qe)).join(", ")}`},Kt=S=>Array.from(S.querySelectorAll('input:not([type=hidden]):not(:disabled), select:not(:disabled), textarea:not(:disabled), button:not(:disabled), [tabindex]:not([tabindex="-1"])')).filter(we=>!!(we.offsetWidth||we.offsetHeight||we.getClientRects().length)),ar=S=>{const ue=S.key;if(!["Enter","ArrowDown","ArrowUp"].includes(ue))return;const qe=S.target;if(!qe||qe.tagName==="TEXTAREA")return;if(qe.tagName==="INPUT"){const ye=qe;if(typeof ye.selectionStart=="number"){const Ge=ye.selectionStart||0,Qe=ye.selectionEnd||0;if(Ge!==Qe||(ue==="ArrowDown"||ue==="Enter")&&Ge<(ye.value?.length||0)||ue==="ArrowUp"&&Ge>0)return}}let we=qe.closest("form");if(!we)return;const de=Kt(we),ze=de.indexOf(qe);if(ze===-1)return;let Ee=ze;if((ue==="Enter"||ue==="ArrowDown")&&(Ee=Math.min(de.length-1,ze+1)),ue==="ArrowUp"&&(Ee=Math.max(0,ze-1)),Ee!==ze){S.preventDefault();const ye=de[Ee];ye.focus();try{ye.select&&ye.select()}catch{}}},_r=async()=>{try{const S=e?.schoolCode||"P",ue=await qg.exportUsers(S,{role:ne,format:"csv"}),qe=new Blob([ue.data],{type:"text/csv"}),we=window.URL.createObjectURL(qe),de=document.createElement("a");de.href=we;const ze=new Date().toISOString().split("T")[0];de.download=`${ne}_users_${ze}.csv`,document.body.appendChild(de),de.click(),document.body.removeChild(de),window.URL.revokeObjectURL(we),ge.success(`${Ze.length} ${ne} records exported successfully!`)}catch(S){console.error("Export error:",S),ge.error("Failed to export users. Please try again.")}},ea=async S=>{try{const ue=e?.schoolCode||"P",qe=await qg.generateTemplate(ue,S),we=new Blob([qe.data],{type:"text/csv"}),de=window.URL.createObjectURL(we),ze=document.createElement("a");ze.href=de;const Ee=new Date().toISOString().split("T")[0];ze.download=`${S}_import_template_${Ee}.csv`,document.body.appendChild(ze),ze.click(),document.body.removeChild(ze),window.URL.revokeObjectURL(de),ge.success(`${S} template downloaded successfully!`)}catch(ue){console.error("Template generation error:",ue),ge.error("API template failed. Using fallback template.");try{ia(S)}catch(qe){console.error("Fallback template error:",qe),ge.error("Failed to generate template. Please try again.")}}},ia=S=>{const ue=new Date().toISOString().split("T")[0],qe=`${S}_import_template_${ue}.csv`;let we=[],de=[];S==="student"?(we=["First Name","Last Name","Email","Phone","Date of Birth","Gender","Current Class","Current Section","Admission Number","Address"],de=Ze.map(ye=>{const Ge=ye,Qe=Ge.name||{},Jt=Ge.contact||{},Ct=Ge.studentDetails||{},ur=Ge.address||"";return[Qe.firstName||"",Qe.lastName||"",ye.email||"",Jt.primaryPhone||"",Ct.dateOfBirth?new Date(Ct.dateOfBirth).toISOString().split("T")[0]:"",Ct.gender||"",Ct.currentClass||"",Ct.currentSection||"",Ct.admissionNumber||"",typeof ur=="string"?ur:ur.permanent?.street||""].map(Wt=>`"${String(Wt).replace(/"/g,'""')}"`).join(",")}),de=Ze.map(ye=>{const Ge=ye,Qe=Ge.studentDetails||{},Jt=Ge.name||{},Ct=Ge.address||{},ur=Ge.contact||{},Wt=Qe.personal||{},zr=Qe.academic||{},mr=Qe.family||{},br=mr.father||{},Mr=mr.mother||{},un=mr.guardian||{},hr=mr.siblings||[],Er=Qe.medical||{},mn=Qe.transport||{},Nn=Qe.financial||{},Sn=Nn.bankDetails||{},Cn=zr.previousSchool||{},qr=(Qe.academicHistory||[])[0]||{},ja=Ge.identity||{},qn=Ge.metadata||{},Hr=Ge.parentDetails||{};return[Ge.userId||ye._id||"",Jt.firstName||"",Jt.middleName||"",Jt.lastName||"",ye.email||"",ur.primaryPhone||ur.phone||ye.phone||"",Qe.studentId||Ge.userId||"",Qe.admissionNumber||"",Qe.rollNumber||"",Qe.currentClass||"",Qe.currentSection||"",Qe.academicYear||"",Qe.admissionDate?new Date(Qe.admissionDate).toISOString().split("T")[0]:"",Qe.admissionClass||"",Qe.stream||"",Array.isArray(Qe.electives)?Qe.electives.join(", "):"",Qe.enrollmentNo||"",Qe.tcNo||"",Qe.dateOfBirth?new Date(Qe.dateOfBirth).toISOString().split("T")[0]:"",Qe.placeOfBirth||"",Qe.gender||"",Qe.bloodGroup||"",Qe.nationality||"",Qe.religion||"",Qe.religionOther||"",Qe.caste||"",Qe.casteOther||"",Qe.category||"",Qe.categoryOther||"",Qe.motherTongue||"",Qe.motherTongueOther||"",Array.isArray(Qe.languagesKnown)?Qe.languagesKnown.join(", "):"",Wt.studentNameKannada||"",Wt.ageYears||"",Wt.ageMonths||"",Wt.socialCategory||"",Wt.socialCategoryOther||"",Wt.studentCaste||"",Wt.studentCasteOther||"",Wt.studentAadhaar||ja.aadharNumber||"",Wt.studentCasteCertNo||"",Wt.belongingToBPL||"",Wt.bplCardNo||"",Wt.bhagyalakshmiBondNo||"",Wt.disability||"",Wt.disabilityOther||"",Wt.isRTECandidate||"",Ct.current?.street||"",Ct.current?.area||"",Ct.current?.city||"",Ct.current?.district||"",Ct.current?.state||"",Ct.current?.pincode||"",Ct.current?.taluka||"",Ct.current?.urbanRural||"",Ct.permanent?.street||"",Ct.permanent?.area||"",Ct.permanent?.city||"",Ct.permanent?.district||"",Ct.permanent?.state||"",Ct.permanent?.pincode||"",Ct.permanent?.taluka||"",Ct.permanent?.urbanRural||"",br.name||"",br.nameKannada||"",br.occupation||"",br.qualification||"",br.phone||"",br.email||"",br.workAddress||"",br.annualIncome||"",br.aadhaar||"",br.caste||"",br.casteOther||"",br.casteCertNo||"",Mr.name||"",Mr.nameKannada||"",Mr.occupation||"",Mr.qualification||"",Mr.phone||"",Mr.email||"",Mr.workAddress||"",Mr.annualIncome||"",Mr.aadhaar||"",Mr.caste||"",Mr.casteOther||"",Mr.casteCertNo||"",un.name||"",un.relationship||"",un.phone||"",un.email||"",un.address||"",un.isEmergencyContact===!0?"TRUE":"FALSE",hr[0]?.name||"",hr[0]?.age||"",hr[0]?.relationship||"",hr[0]?.school||"",hr[0]?.class||"",hr[1]?.name||"",hr[1]?.age||"",hr[1]?.relationship||"",hr[1]?.school||"",hr[1]?.class||"",hr[2]?.name||"",hr[2]?.age||"",hr[2]?.relationship||"",hr[2]?.school||"",hr[2]?.class||"",Array.isArray(Er.allergies)?Er.allergies.join(", "):"",Array.isArray(Er.chronicConditions)?Er.chronicConditions.join(", "):"",Array.isArray(Er.medications)?Er.medications.join(", "):"",Er.emergencyMedicalContact?.doctorName||"",Er.emergencyMedicalContact?.hospitalName||"",Er.emergencyMedicalContact?.phone||"",Er.lastMedicalCheckup?new Date(Er.lastMedicalCheckup).toISOString().split("T")[0]:"",Array.isArray(Er.vaccinationStatus)?Er.vaccinationStatus.map(li=>li.vaccine).join(", "):"",mn.mode||"",mn.busRoute||"",mn.pickupPoint||"",mn.dropPoint||"",mn.pickupTime||"",mn.dropTime||"",Nn.feeCategory||"",Nn.concessionType||"",Nn.concessionPercentage||"",Nn.scholarshipDetails?.name||"",Nn.scholarshipDetails?.amount||"",Nn.scholarshipDetails?.provider||"",Sn.bankName||"",Sn.accountNumber||"",Sn.ifscCode||"",Sn.accountHolderName||"",Ge.profileImage||Ge.profilePicture||"",Cn.name||"",Cn.board||"",Cn.lastClass||"",Cn.tcNumber||"",Cn.tcDate?new Date(Cn.tcDate).toISOString().split("T")[0]:"",Cn.reasonForTransfer||"",Hr.emergencyContacts?.[0]?.name||"",Hr.emergencyContacts?.[0]?.relationship||"",Hr.emergencyContacts?.[0]?.phone||"",Hr.emergencyContacts?.[0]?.address||"",Hr.emergencyContacts?.[0]?.isPrimary||"",Hr.emergencyContacts?.[1]?.name||"",Hr.emergencyContacts?.[1]?.relationship||"",Hr.emergencyContacts?.[1]?.phone||"",Hr.emergencyContacts?.[1]?.address||"",Hr.emergencyContacts?.[1]?.isPrimary||"",qr.academicYear||"",qr.result||"",qr.percentage||"",qr.rank||"",qr.attendance||"",ye.isActive?"Active":"Inactive",new Date(ye.createdAt).toLocaleDateString(),Ge.updatedAt?new Date(Ge.updatedAt).toLocaleDateString():"",qn.source||"",qn.importBatch||"",Array.isArray(qn.tags)?qn.tags.join(", "):"",qn.notes||""].map(li=>`"${String(li).replace(/"/g,'""')}"`).join(",")})):ne==="teacher"?(we=["First Name","Last Name","Email","Phone Number","Date of Birth","Gender","Qualification","Experience (Years)","Subjects Taught","Employee ID","Address"],de=Ze.map(ye=>{const Ge=ye,Qe=Ge.teacherDetails||{},Jt=Ge.name||{},Ct=Ge.address||{},ur=Ge.contact||{},Wt=Qe.subjects||[],zr=Array.isArray(Wt)?Wt.map(br=>br.subjectName||br).join(", "):"",mr=[Ct.current?.street,Ct.current?.area,Ct.current?.city,Ct.current?.state,Ct.current?.pincode].filter(Boolean).join(", ");return[Jt.firstName||"",Jt.lastName||"",ye.email||"",ur.primaryPhone||ur.phone||ye.phone||"",Qe.dateOfBirth?new Date(Qe.dateOfBirth).toISOString().split("T")[0]:"",Qe.gender||"",Qe.qualification?.highest||"",Qe.experience?.total||"",zr,Qe.employeeId||"",mr].map(br=>`"${String(br).replace(/"/g,'""')}"`).join(",")})):ne==="admin"&&(we=["User ID","First Name","Middle Name","Last Name","Email","Phone","Date of Birth","Place of Birth","Gender","Blood Group","Nationality","Religion","Caste","Category","Mother Tongue","Languages Known","Marital Status","Spouse Name","Current Address Line 1","Current Address Line 2","Current City","Current District","Current State","Current Pin Code","Permanent Address Line 1","Permanent Address Line 2","Permanent City","Permanent District","Permanent State","Permanent Pin Code","Aadhaar Number","PAN Number","Passport Number","Driving License","Admin ID","Admin Level","Designation","Department","Joining Date","Reporting Manager","Permissions","Access Level","Can Manage Users","Can Manage Academics","Can Manage Finance","Can Manage Reports","Can Manage School Settings","Can View All Data","Can Export Data","Can Import Data","Primary Responsibilities","Secondary Responsibilities","Committees","Special Duties","Highest Qualification","Specialization","University","Qualification Year","Total Experience (Years)","Administrative Experience (Years)","Education Sector Experience (Years)","Previous Organization 1","Previous Position 1","Previous Duration 1","Previous Responsibilities 1","Previous Organization 2","Previous Position 2","Previous Duration 2","Previous Responsibilities 2","Previous Organization 3","Previous Position 3","Previous Duration 3","Previous Responsibilities 3","Working Days","Working Hours Start","Working Hours End","Overtime Eligible","On-Call Duties","Basic Salary","HRA Allowance","Transport Allowance","Medical Allowance","Management Allowance","Other Allowances","Currency","Bank Name","Account Number","IFSC Code","Branch Name","Account Holder Name","Profile Image Path","Emergency Contact 1 Name","Emergency Contact 1 Relationship","Emergency Contact 1 Phone","Emergency Contact 1 Address","Emergency Contact 2 Name","Emergency Contact 2 Relationship","Emergency Contact 2 Phone","Emergency Contact 2 Address","Assigned By","Admin Role Level","Permissions","Last Login","Status","Created Date","Last Modified","Source","Import Batch","Tags","Notes"],de=Ze.map(ye=>{const Ge=ye,Qe=Ge.adminDetails||{},Jt=Ge.name||{},Ct=Ge.address||{},ur=Ge.contact||{},Wt=Ge.personalInfo||{},zr=Ge.identity||{},mr=Qe.permissions||{},br=Qe.responsibilities||{},Mr=Qe.qualification||{},un=Qe.experience||{},hr=un.previousExperience||[],Er=Qe.workSchedule||{},mn=Qe.salary||{},Nn=mn.allowances||[],Sn=Qe.bankDetails||{},Cn=Ge.emergencyContacts||[];Qe.systemAccess,Qe.performanceReview;const Pa=Ge.metadata||{},qr=ur.emergencyContact||{},ja=new Map(Nn.map(Hr=>[Hr.type,Hr.amount])),qn=[mr.userManagement?"UserManagement":"",mr.academicManagement?"AcademicManagement":"",mr.feeManagement?"FeeManagement":"",mr.reportGeneration?"ReportGeneration":"",mr.systemSettings?"SystemSettings":"",mr.schoolSettings?"SchoolSettings":"",mr.dataExport?"DataExport":"",mr.auditLogs?"AuditLogs":""].filter(Boolean).join(", ");return[Ge.userId||ye._id||"",Jt.firstName||"",Jt.middleName||"",Jt.lastName||"",ye.email||"",ur.primaryPhone||ur.phone||ye.phone||"",Qe.dateOfBirth?new Date(Qe.dateOfBirth).toISOString().split("T")[0]:"",Wt.placeOfBirth||"",ye.gender||Qe.gender||"",ye.bloodGroup||Qe.bloodGroup||"",ye.nationality||"Indian",ye.religion||Qe.religion||"",ye.caste||Qe.caste||"",ye.category||Qe.category||"",Wt.motherTongue||"",Array.isArray(Wt.languagesKnown)?Wt.languagesKnown.join(", "):"",Wt.maritalStatus||"",Wt.spouseName||"",Ct.current?.street||"",Ct.current?.area||"",Ct.current?.city||"",Ct.current?.district||"",Ct.current?.state||"",Ct.current?.pincode||"",Ct.permanent?.street||"",Ct.permanent?.area||"",Ct.permanent?.city||"",Ct.permanent?.district||"",Ct.permanent?.state||"",Ct.permanent?.pincode||"",zr.aadharNumber||"",zr.panNumber||"",zr.passportNumber||"",zr.drivingLicenseNumber||"",Qe.employeeId||"",Qe.adminType||"Admin",Qe.designation||"",Qe.department||"",Qe.joiningDate?new Date(Qe.joiningDate).toISOString().split("T")[0]:"",Qe.reportingTo||"",qn,Ge.accessLevel||"",mr.userManagement?"TRUE":"FALSE",mr.academicManagement?"TRUE":"FALSE",mr.feeManagement?"TRUE":"FALSE",mr.reportGeneration?"TRUE":"FALSE",mr.systemSettings?"TRUE":"FALSE",mr.schoolSettings?"TRUE":"FALSE",mr.dataExport?"TRUE":"FALSE",mr.auditLogs?"TRUE":"FALSE",Array.isArray(Qe.responsibilities)?Qe.responsibilities.join(", "):"",br.secondary||"",br.committees||"",br.specialDuties||"",Mr.highest||"",Mr.specialization||"",Mr.university||"",Mr.year||"",un.total||"",un.administrativeYears||"",un.educationSectorYears||"",hr[0]?.organization||"",hr[0]?.position||"",hr[0]?.duration||"",hr[0]?.responsibilities||"",hr[1]?.organization||"",hr[1]?.position||"",hr[1]?.duration||"",hr[1]?.responsibilities||"",hr[2]?.organization||"",hr[2]?.position||"",hr[2]?.duration||"",hr[2]?.responsibilities||"",Array.isArray(Er.workingDays)?Er.workingDays.join(", "):"",Er.workingHours?.start||"",Er.workingHours?.end||"",Er.overtimeEligible||"",Er.onCallDuties||"",mn.basic||"",ja.get("HRA")||"",ja.get("Transport")||"",ja.get("Medical")||"",ja.get("Management")||"",Nn.filter(Hr=>!["HRA","Transport","Medical","Management"].includes(Hr.type)).map(Hr=>`${Hr.type}: ${Hr.amount}`).join(", ")||"",mn.currency||"",Sn.bankName||"",Sn.accountNumber||"",Sn.ifscCode||"",Sn.branchName||"",Sn.accountHolderName||Jt.firstName&&Jt.lastName?`${Jt.firstName} ${Jt.lastName}`:"",Ge.profileImage||Ge.profilePicture||"",qr.name||"",qr.relationship||"",qr.phone||"",qr.address||"",Cn[0]?.name||"",Cn[0]?.relationship||"",Cn[0]?.phone||"",Cn[0]?.address||"",Ge.schoolAccess?.assignedBy||"",ye.role||"admin",qn,Ge.lastLogin?new Date(Ge.lastLogin).toLocaleDateString():"",ye.isActive?"Active":"Inactive",new Date(ye.createdAt).toLocaleDateString(),Ge.updatedAt?new Date(Ge.updatedAt).toLocaleDateString():"",Pa.source||"",Pa.importBatch||"",Array.isArray(Pa.tags)?Pa.tags.join(", "):"",Pa.notes||""].map(Hr=>`"${String(Hr).replace(/"/g,'""')}"`).join(",")}));const ze="data:text/csv;charset=utf-8,"+we.join(",")+`
`+de.map(ye=>ye.map(Ge=>{const Qe=String(Ge??"");return Qe.includes('"')||Qe.includes(",")||Qe.includes(`
`)||Qe.includes("\r")?`"${Qe.replace(/"/g,'""')}"`:Qe}).join(",")).join(`
`),Ee=document.createElement("a");Ee.setAttribute("href",encodeURI(ze)),Ee.setAttribute("download",qe),document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee),ge.success(`${Ze.length} ${ne} records exported successfully!`)},Un=S=>{const ue=S.target.files?.[0];if(ue){if(!ue.name.toLowerCase().endsWith(".csv")){ge.error("Please select a CSV file");return}Ot(ue),nr([]),kr(null)}},Wa=async()=>{if(!Pt){ge.error("No file selected for import");return}$t(!0),Or(0);try{const S=e?.schoolCode||"SB";console.log("Starting import for school:",S);const ue=await qg.importUsers(S,Pt);console.log("Import response:",ue),Or(100);const qe=ue.data?.results||ue.data||{successData:[],errors:[]},we=Array.isArray(qe.successData)?qe.successData:Array.isArray(qe.success)?qe.success:[],de=Array.isArray(qe.errors)?qe.errors:[],ze=qe.insertedCount||we.length;kr({success:we,errors:de}),ze>0&&ge.success(`Successfully imported ${ze} users`),de.length>0&&ge.error(`${de.length} rows had errors`),ze===0&&de.length===0&&ge.error("No users were imported. Please check your CSV file.")}catch(S){console.error("Import error:",S);const ue=S.response?.data?.message||S.message||"Failed to import users. Please try again.";ge.error(ue);const qe=S.response?.data?.results;kr(qe?{success:qe.successData||qe.success||[],errors:qe.errors||[]}:{success:[],errors:[{row:"N/A",error:ue,data:{}}]})}finally{$t(!1)}},oa=()=>{if(!gr?.success.length){ge.error("No successful imports to download credentials for");return}const ue=`imported_user_credentials_${new Date().toISOString().split("T")[0]}.csv`,qe=["User ID","Email","Default Password","Role","Login Instructions"],we=gr.success.map(Ee=>[Ee.userId,Ee.email,"Use DOB (DDMMYYYY)",Ee.role,"Use Date of Birth (DDMMYYYY) as password, change on first login"]),de="data:text/csv;charset=utf-8,"+qe.join(",")+`
`+we.map(Ee=>Ee.map(ye=>`"${ye}"`).join(",")).join(`
`),ze=document.createElement("a");ze.setAttribute("href",encodeURI(de)),ze.setAttribute("download",ue),document.body.appendChild(ze),ze.click(),document.body.removeChild(ze),ge.success("User credentials downloaded successfully!")},ta=()=>{const S=Ze.filter(ze=>ze.role==="student"),ue={},qe=["LKG","UKG","1","2","3","4","5","6","7","8","9","10","11","12"];S.forEach(ze=>{const Ee=ze.academicInfo?.class||ze.studentDetails?.academic?.currentClass||ze.studentDetails?.currentClass||ze.studentDetails?.class||ze.class||"Unassigned",ye=ze.academicInfo?.section||ze.studentDetails?.academic?.currentSection||ze.studentDetails?.currentSection||ze.studentDetails?.section||ze.section||"A";ue[Ee]||(ue[Ee]={}),ue[Ee][ye]||(ue[Ee][ye]=[]),ue[Ee][ye].push(ze)});const we=Object.keys(ue).sort((ze,Ee)=>{const ye=qe.indexOf(ze),Ge=qe.indexOf(Ee);return ye===-1&&Ge===-1?ze.localeCompare(Ee):ye===-1?1:Ge===-1?-1:ye-Ge}),de={};return we.forEach(ze=>{de[ze]=ue[ze];const Ee={};Object.keys(ue[ze]).sort().forEach(ye=>{Ee[ye]=ue[ze][ye].sort((Ge,Qe)=>{const Jt=Ge.userId||Ge._id||"",Ct=Qe.userId||Qe._id||"",ur=mr=>{const br=mr.match(/\d+$/);return br?parseInt(br[0]):0},Wt=ur(Jt),zr=ur(Ct);return Wt!==0||zr!==0?Wt-zr:Jt.localeCompare(Ct)})}),de[ze]=Ee}),de},zn=S=>{const ue=new Set(or);ue.has(S)?ue.delete(S):ue.add(S),ke(ue)},wa=S=>{rt(S),kt("all"),y(S)},[la,Ya]=xe.useState(!1);if(la)return r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"There was an error rendering the page."}),r.jsx("button",{onClick:()=>{Ya(!1),window.location.reload()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Reload Page"})]})});try{return r.jsxs("div",{className:"space-y-6",children:[s&&ne==="student"&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-4",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:" Viewing Historical Data:"})," You are viewing students from ",a,". This data is read-only."]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(ov,{className:"h-8 w-8 text-blue-600"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Manage Users"}),r.jsx("p",{className:"text-gray-600",children:"Add, edit, and manage system users"})]})]}),$&&r.jsxs("div",{className:"flex items-center space-x-3",children:[$.logoUrl&&r.jsx("img",{src:$.logoUrl,alt:$.name,className:"h-12 w-12 rounded-lg object-cover"}),r.jsxs("div",{className:"text-right",children:[r.jsx("h3",{className:"font-semibold text-gray-900",children:$.name}),r.jsxs("p",{className:"text-sm text-gray-500",children:["School Code: ",$.code]})]})]})]}),r.jsx("div",{className:"border-b border-gray-200 mb-6",children:r.jsxs("nav",{className:"-mb-px flex space-x-8",children:[r.jsxs("button",{onClick:()=>{console.log(" Switching to Student tab"),Te("student"),Y&&I("student")},className:`py-2 px-1 border-b-2 font-medium text-sm ${ne==="student"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Students (",F.filter(S=>S.role==="student").length,")"]}),r.jsxs("button",{onClick:()=>{console.log(" Switching to Teacher tab"),Te("teacher"),Y&&I("teacher")},className:`py-2 px-1 border-b-2 font-medium text-sm ${ne==="teacher"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Teachers (",F.filter(S=>S.role==="teacher").length,")"]}),r.jsxs("button",{onClick:()=>{console.log(" Switching to Admin tab"),Te("admin"),Y&&I("admin")},className:`py-2 px-1 border-b-2 font-medium text-sm ${ne==="admin"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Admins (",F.filter(S=>S.role==="admin").length,")"]})]})}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between mb-4",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-1",children:[r.jsxs("div",{className:"relative flex-1 max-w-md",children:[r.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),r.jsx("input",{type:"text",placeholder:"Search by name, email, or ID...",value:me,onChange:S=>se(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),ne==="student"&&r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(ew,{className:"h-5 w-5 text-gray-400"}),r.jsx("select",{value:a,onChange:S=>i(S.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:l.map(S=>r.jsxs("option",{value:S,children:[S," ",S===n&&"(Current)"]},S))}),r.jsxs("select",{value:lt,onChange:S=>wa(S.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:m,children:[r.jsx("option",{value:"all",children:"All Classes"}),u?.classes?.map(S=>r.jsxs("option",{value:S.className,children:["Class ",S.className]},S._id))]}),lt!=="all"&&r.jsxs("select",{value:Lt,onChange:S=>kt(S.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:m,children:[r.jsx("option",{value:"all",children:"All Sections"}),v.map(S=>r.jsxs("option",{value:S.section,children:["Section ",S.section]},S.value))]})]}),r.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-lg p-1",children:[r.jsx("button",{onClick:()=>_e("table"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${ht==="table"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:"Table View"}),r.jsx("button",{onClick:()=>_e("hierarchy"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${ht==="hierarchy"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:"Class View"})]})]})]}),ne==="admin"?r.jsx("div",{className:"flex items-center justify-center px-4 py-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center space-x-2 text-yellow-800",children:[r.jsx(z4,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:"Admins are only created by super admin"})]})}):r.jsxs("div",{className:"flex space-x-2",children:[r.jsxs("button",{onClick:_r,className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[r.jsx(Ci,{className:"h-4 w-4"}),r.jsx("span",{children:"Export"})]}),r.jsxs("button",{onClick:()=>{try{console.log("Opening import modal for:",ne),gt(!0)}catch(S){console.error("Error opening import modal:",S),ge.error("Failed to open import dialog")}},className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[r.jsx(Xl,{className:"h-4 w-4"}),r.jsx("span",{children:"Import"})]}),r.jsxs("button",{onClick:()=>ea(ne),className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",title:`Download ${ne} import template`,children:[r.jsx(Pn,{className:"h-4 w-4"}),r.jsx("span",{children:"Template"})]}),ne==="teacher"&&r.jsx("button",{onClick:js,className:`flex items-center space-x-2 px-4 py-2 border rounded-lg ${Ar?"border-gray-300 bg-gray-50 text-gray-700 hover:bg-gray-100":"border-purple-300 bg-purple-50 text-purple-700 hover:bg-purple-100"}`,title:Ar?"Hide all teacher passwords":"Show all teacher passwords (requires admin password)",children:Ar?r.jsxs(r.Fragment,{children:[r.jsx(Wo,{className:"h-4 w-4"}),r.jsx("span",{children:"Hide All Passwords"})]}):r.jsxs(r.Fragment,{children:[r.jsx(wn,{className:"h-4 w-4"}),r.jsx("span",{children:"Show All Passwords"})]})}),r.jsxs("button",{onClick:async()=>{H(!0),B(we=>({...we,role:ne}));const S=e?.schoolCode||"P",ue=await E(ne,S),qe=ne==="student"?"":O();B(we=>({...we,userId:ue,generatedPassword:qe}))},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[r.jsx(Os,{className:"h-4 w-4"}),r.jsxs("span",{children:["Add ",ne.charAt(0).toUpperCase()+ne.slice(1)]})]})]})]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:ne==="student"&&ht==="hierarchy"?r.jsx("div",{className:"p-6",children:Object.keys(ta()).length===0?r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-gray-500",children:"No students found"})}):r.jsx("div",{className:"space-y-4",children:Object.entries(ta()).map(([S,ue])=>r.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[r.jsx("div",{className:"bg-gray-50 px-4 py-3 cursor-pointer hover:bg-gray-100 transition-colors flex items-center justify-between",onClick:()=>zn(S),children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:`transform transition-transform ${or.has(S)?"rotate-90":""}`,children:""}),r.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Class ",S]}),r.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-2.5 py-0.5 rounded",children:[Object.values(ue).reduce((qe,we)=>qe+we.length,0)," students"]})]})}),or.has(S)&&r.jsx("div",{className:"border-t border-gray-200",children:Object.entries(ue).map(([qe,we])=>r.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[r.jsx("div",{className:"bg-gray-25 px-6 py-2 border-b border-gray-100",children:r.jsxs("h4",{className:"text-md font-medium text-gray-700 flex items-center space-x-2",children:[r.jsxs("span",{children:["Section ",qe]}),r.jsxs("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-0.5 rounded",children:[we.length," students"]})]})}),r.jsx("div",{className:"divide-y divide-gray-100",children:we.map(de=>r.jsxs("div",{className:"px-6 py-3 hover:bg-gray-50 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:r.jsx("span",{className:"text-sm font-medium text-blue-600",children:de.name.charAt(0)})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 break-words",children:de.name}),r.jsx("div",{className:"text-sm text-gray-500 break-words",children:de.email}),de.studentDetails?.studentId&&r.jsxs("div",{className:"text-xs text-gray-400 truncate",children:["ID: ",de.studentDetails.studentId]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs("div",{className:"flex items-center",children:[de.isActive?r.jsx(_s,{className:"h-4 w-4 text-green-500 mr-1"}):r.jsx(dv,{className:"h-4 w-4 text-red-500 mr-1"}),r.jsx("span",{className:`text-sm ${de.isActive?"text-green-700":"text-red-700"}`,children:de.isActive?"Active":"Inactive"})]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>q(de),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"Edit User",children:r.jsx(Qs,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>ce(de._id,de.name||`User ${de._id}`),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",title:"Delete User",children:r.jsx(Ba,{className:"h-4 w-4"})})]})]})]},de._id))})]},qe))})]},S))})}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Photo"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),ne==="student"&&r.jsxs(r.Fragment,{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Section"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student ID"})]}),ne==="teacher"&&r.jsxs(r.Fragment,{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee ID"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Password"})]}),ne==="admin"&&r.jsxs(r.Fragment,{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee ID"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Access Level"})]}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:G?r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-gray-500",children:"Loading users..."})}):Ze.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-gray-500",children:"No users found"})}):Ze.map(S=>{const ue="https://erp-backend-kfut.onrender.com/api",qe=ue?ue.replace(/\/api\/?$/,""):typeof window<"u"?window.location.origin:"",we=S.profileImage||S.profilePicture,de=we?we.startsWith("http")?we:`${qe}${we.startsWith("/")?"":"/"}${we}`:null,ze=S.name?.firstName||"",Ee=S.name?.lastName||"",ye=`${ze.charAt(0)}${Ee.charAt(0)}`.toUpperCase()||"U";return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:de?r.jsx("img",{src:de,alt:`${de}`,className:"h-10 w-10 rounded-full object-cover border border-gray-200",onError:Ge=>{const Qe=Ge.target;Qe.style.display="none";const Jt=Qe.parentElement;Jt&&(Jt.innerHTML=`<div class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center"><span class="text-sm font-medium text-blue-700">${ye}</span></div>`)}}):r.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:r.jsx("span",{className:"text-sm font-medium text-blue-700",children:ye})})})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"max-w-xs",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 break-words",children:S.name?.displayName||(S.name?.firstName&&S.name?.lastName?`${S.name.firstName} ${S.name.lastName}`:S.name?.firstName||S.name||"No name")}),r.jsx("div",{className:"text-sm text-gray-500 truncate",children:S.userId||S._id})]})}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:r.jsxs("div",{className:"max-w-xs",children:[r.jsx("div",{className:"break-words",children:S.email}),r.jsx("div",{className:"text-xs text-gray-400",children:S.contact?.primaryPhone||S.phone||"No phone"})]})}),ne==="student"&&r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.studentDetails?.currentClass||S.studentDetails?.class||S.academicInfo?.class||"Not assigned"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.studentDetails?.currentSection||S.studentDetails?.section||S.academicInfo?.section||"Not assigned"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.userId||S._id||"Not assigned"})]}),ne==="teacher"&&r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S.userId||S._id||"N/A"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.jsx("div",{className:"flex items-center space-x-1",children:S.temporaryPassword?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"flex-grow font-mono text-xs text-gray-700",children:Pe[S.userId]?S.temporaryPassword:"********"}),r.jsx("button",{onClick:Ge=>{Ge.stopPropagation(),Qn(S.userId,S.name?.displayName||"this user")},className:"text-gray-400 hover:text-gray-600 p-0.5 rounded hover:bg-gray-100 flex-shrink-0",title:Pe[S.userId]?"Hide password":"Show password (requires admin password)",type:"button",children:Pe[S.userId]?r.jsx(Wo,{size:14}):r.jsx(wn,{size:14})})]}):r.jsx("span",{className:"text-xs text-gray-400 italic",children:"Not Available"})})})]}),ne==="admin"&&r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Employee ID"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Administration"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Full Access"})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[S.isActive?r.jsx(_s,{className:"h-4 w-4 text-green-500 mr-1"}):r.jsx(dv,{className:"h-4 w-4 text-red-500 mr-1"}),r.jsx("span",{className:`text-sm ${S.isActive?"text-green-700":"text-red-700"}`,children:S.isActive?"Active":"Inactive"})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(S.createdAt).toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>q(S),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"Edit User",children:r.jsx(Qs,{className:"h-4 w-4"})}),ne==="teacher"&&r.jsx("button",{onClick:()=>{console.log("Change password clicked for:",S.userId,S.email),Fe(S.userId||S._id,S.name?.displayName||S.name||"User",S.email)},className:"text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-50",title:"Change Password (Set New Password)",children:r.jsx(U2,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>ce(S._id,S.name||`User ${S._id}`),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete User",disabled:!1,children:r.jsx(Ba,{className:"h-4 w-4"})})]})})]},S._id)})})]})})}),Y&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[60]",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[95vh] overflow-y-auto relative z-[61]",children:[r.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:["Add New ",b.role.charAt(0).toUpperCase()+b.role.slice(1)," - Enrollment Form"]}),te&&te.length>0&&r.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded",children:[r.jsx("p",{className:"text-sm font-semibold text-red-700",children:"Validation errors:"}),r.jsx("ul",{className:"list-disc list-inside text-sm text-red-600 mt-2",children:te.map((S,ue)=>r.jsx("li",{children:S},ue))})]}),r.jsxs("form",{onSubmit:D,onKeyDown:ar,className:"space-y-6",children:[r.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Role"}),r.jsx("div",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100 text-gray-700 font-medium",children:ne.charAt(0).toUpperCase()+ne.slice(1)}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Role is automatically set based on the current tab"})]}),r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Generated Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Next User ID",Ft&&r.jsx("span",{className:"text-blue-500 ml-1",children:"(Loading...)"}),!Ft&&b.userId&&r.jsx("span",{className:"text-green-600 ml-1",children:""})]}),r.jsx("input",{type:"text",value:Ft?"Generating next ID...":b.userId||Mt||"Select a role to auto-generate ID",readOnly:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100",placeholder:"Next sequential ID will appear here"}),!b.userId&&!Ft&&b.role&&r.jsx("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded",children:r.jsx("p",{className:"text-xs text-blue-700",children:" Select a role above to automatically fetch the next available ID from the database"})}),b.userId&&!Ft&&r.jsxs("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:[r.jsxs("p",{className:"text-xs text-green-700 font-medium",children:[" Next available ID for ",b.role," role: ",r.jsx("strong",{children:b.userId})]}),r.jsx("p",{className:"text-xs text-green-600 mt-1",children:"This ID has been reserved from the backend database"})]}),Ft&&r.jsx("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded",children:r.jsx("p",{className:"text-xs text-blue-700",children:" Fetching next available ID from database..."})})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[b.role==="student"?"Student Password":"Generated Password",b.generatedPassword&&r.jsx("span",{className:"text-green-600 ml-1",children:""})]}),b.role==="student"?r.jsxs("div",{children:[b.generatedPassword?r.jsxs("div",{className:"w-full border rounded-lg px-3 py-2 bg-green-50 border-green-300 text-green-800 font-mono",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"font-medium text-lg",children:b.generatedPassword}),r.jsx("span",{className:"text-green-600 text-sm font-semibold",children:" Generated from DOB"})]}),r.jsx("div",{className:"text-xs text-green-600 mt-1",children:"Password format: DDMMYYYY (e.g., 15032010)"})]}):r.jsxs("div",{className:"w-full border rounded-lg px-3 py-2 bg-blue-50 border-blue-300 text-blue-800",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-blue-500 mr-2",children:""}),r.jsx("span",{className:"font-medium",children:"Enter Date of Birth to generate password"})]}),r.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Password will be in DDMMYYYY format (e.g., 15032010)"})]}),b.generatedPassword&&r.jsx("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("span",{className:"text-green-500 text-lg",children:""})}),r.jsxs("div",{className:"ml-3",children:[r.jsxs("p",{className:"text-sm text-green-700 font-medium",children:[" Password created from Date of Birth: ",r.jsx("code",{className:"bg-green-100 px-2 py-1 rounded font-mono text-sm",children:b.generatedPassword})]}),r.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Give this password to the student for their first login. They will be required to change it on first login."}),r.jsxs("div",{className:"mt-2 text-xs text-green-600",children:[r.jsx("strong",{children:"Format:"})," DDMMYYYY (Day-Month-Year)"]})]})]})})]}):r.jsx("input",{type:"text",value:b.generatedPassword||"Password will be generated when role is selected",readOnly:!0,className:`w-full border rounded-lg px-3 py-2 font-mono ${b.generatedPassword?"bg-green-50 border-green-300 text-green-800":"bg-gray-100 border-gray-300 text-gray-500"}`,placeholder:"8-character secure password will appear here"}),b.generatedPassword&&b.role!=="student"&&r.jsxs("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:[r.jsxs("p",{className:"text-xs text-green-700 font-medium",children:[" 8-character secure password generated:",r.jsx("code",{className:"bg-green-100 px-1 rounded",children:b.generatedPassword})]}),r.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Copy this password - user will need it for first login"})]})]})]}),(b.userId||b.generatedPassword)&&r.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[r.jsxs("p",{className:"text-sm text-yellow-800 font-medium",children:[" ",r.jsx("strong",{children:"Important:"})," Save this password! It will be needed for the user's first login."]}),r.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"The user will be required to change this password on their first login."})]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Basic Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),r.jsx("input",{type:"text",required:!0,value:b.firstName,onChange:S=>B({...b,firstName:S.target.value,name:`${S.target.value} ${b.lastName}`.trim()}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter first name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),r.jsx("input",{type:"text",required:!0,value:b.lastName,onChange:S=>B({...b,lastName:S.target.value,name:`${b.firstName} ${S.target.value}`.trim()}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter last name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),r.jsx("input",{type:"email",required:!0,value:b.email,onChange:S=>B({...b,email:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter email address"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),r.jsx("input",{type:"tel",required:!0,value:b.phone,onChange:S=>B({...b,phone:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter phone number (10 digits)",pattern:"[0-9]{10}",maxLength:10})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth *"}),r.jsx("input",{type:"date",required:!0,value:b.dateOfBirth||b.studentDetails?.dateOfBirth||"",onChange:S=>P(S.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender *"}),r.jsxs("select",{required:!0,value:b.gender||b.studentDetails?.gender||"male",onChange:S=>{const ue=S.target.value;B({...b,gender:ue,studentDetails:{...b.studentDetails,gender:ue}})},className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]})]})]})]}),b.role==="student"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Basic Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enrollment No *"}),r.jsx("input",{type:"text",required:!0,value:b.enrollmentNo,onChange:S=>B({...b,enrollmentNo:S.target.value,studentDetails:{...b.studentDetails,academic:{...b.studentDetails.academic,enrollmentNo:S.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter enrollment number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TC No *"}),r.jsx("input",{type:"text",required:!0,value:b.tcNo,onChange:S=>B({...b,tcNo:S.target.value,studentDetails:{...b.studentDetails,academic:{...b.studentDetails.academic,tcNo:S.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter TC number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Admission Date *"}),r.jsx("input",{type:"date",required:!0,value:b.schoolAdmissionDate,onChange:S=>B({...b,schoolAdmissionDate:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Select admission date"})]})]})]}),r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Admission Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admission to Class *"}),m?r.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500",children:"Loading classes..."}):r.jsxs("select",{required:!0,value:b.class||b.studentDetails?.currentClass||"",onChange:S=>{const ue=S.target.value;y(ue),B({...b,class:ue,section:"",studentDetails:{...b.studentDetails,currentClass:ue,currentSection:""}})},className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Class"}),N()?f().map(S=>r.jsx("option",{value:S.value,children:S.label},S.value)):r.jsxs(r.Fragment,{children:[r.jsx("option",{value:"LKG",children:"LKG"}),r.jsx("option",{value:"UKG",children:"UKG"}),[1,2,3,4,5,6,7,8,9,10,11,12].map(S=>r.jsx("option",{value:S.toString(),children:S},S))]})]}),p&&r.jsx("p",{className:"text-yellow-600 text-sm mt-1",children:" Using default classes (Super Admin hasn't configured classes yet)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year *"}),r.jsx("select",{required:!0,value:b.studentDetails?.academicYear||n,onChange:S=>{const ue=S.target.value;B({...b,studentDetails:{...b.studentDetails,academicYear:ue}})},className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:d?r.jsx("option",{children:"Loading years..."}):l.map(S=>r.jsxs("option",{value:S,children:[S," ",S===n&&"(Current)"]},S))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),r.jsxs("select",{value:b.section||b.studentDetails?.currentSection||"",onChange:S=>{const ue=S.target.value;B({...b,section:ue,studentDetails:{...b.studentDetails,currentSection:ue}})},className:"w-full border border-gray-300 rounded-lg px-3 py-2",disabled:!b.class&&!b.studentDetails?.currentClass,children:[r.jsx("option",{value:"",children:!b.class&&!b.studentDetails?.currentClass?"Select Class First":"Select Section"}),v.length>0?v.map(S=>r.jsx("option",{value:S.value,children:S.label},S.value)):["A","B","C","D","E","F","G","H","I","J","K","L","M"].map(S=>r.jsxs("option",{value:S,children:["Section ",S]},S))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Medium of Instruction *"}),r.jsxs("select",{required:!0,value:b.mediumOfInstruction,onChange:S=>B({...b,mediumOfInstruction:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"English",children:"English"}),r.jsx("option",{value:"Kannada",children:"Kannada"}),r.jsx("option",{value:"Hindi",children:"Hindi"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Tongue"}),r.jsxs("select",{value:b.motherTongue,onChange:S=>B({...b,motherTongue:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Mother Tongue"}),r.jsx("option",{value:"Kannada",children:"Kannada"}),r.jsx("option",{value:"Hindi",children:"Hindi"}),r.jsx("option",{value:"Tamil",children:"Tamil"}),r.jsx("option",{value:"Telugu",children:"Telugu"}),r.jsx("option",{value:"Malayalam",children:"Malayalam"}),r.jsx("option",{value:"English",children:"English"}),r.jsx("option",{value:"Urdu",children:"Urdu"}),r.jsx("option",{value:"Marathi",children:"Marathi"}),r.jsx("option",{value:"Bengali",children:"Bengali"}),r.jsx("option",{value:"Gujarati",children:"Gujarati"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.motherTongue==="Other"&&r.jsx("input",{type:"text",value:b.motherTongueOther||"",onChange:S=>B({...b,motherTongueOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify mother tongue"})]})]})]}),r.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Student Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Name (English) *"}),r.jsx("input",{type:"text",required:!0,value:b.name,onChange:S=>B({...b,name:S.target.value,firstName:S.target.value.split(" ")[0],lastName:S.target.value.split(" ").slice(1).join(" ")}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter full name in English"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth *"}),r.jsx("input",{type:"date",required:!0,value:b.dateOfBirth,onChange:S=>C(S.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Age (Years)"}),r.jsx("input",{type:"number",value:b.ageYears,onChange:S=>B({...b,ageYears:parseInt(S.target.value)||0}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Years",min:"0",max:"25"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Age (Months)"}),r.jsx("input",{type:"number",value:b.ageMonths,onChange:S=>B({...b,ageMonths:parseInt(S.target.value)||0}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Months",min:"0",max:"11"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender *"}),r.jsxs("select",{required:!0,value:b.gender,onChange:S=>B({...b,gender:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]})]})]})]}),r.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Family Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Name (English)"}),r.jsx("input",{type:"text",value:b.fatherName,onChange:S=>B({...b,fatherName:S.target.value,studentDetails:{...b.studentDetails,family:{...b.studentDetails.family,father:{...b.studentDetails.family?.father,name:S.target.value}}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter father's name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Aadhaar No"}),r.jsx("input",{type:"text",value:b.fatherAadhaar,onChange:S=>B({...b,fatherAadhaar:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"12-digit Aadhaar number",pattern:"[0-9]{12}",maxLength:12})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Name (English)"}),r.jsx("input",{type:"text",value:b.motherName,onChange:S=>B({...b,motherName:S.target.value,studentDetails:{...b.studentDetails,motherName:S.target.value}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter mother's name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Aadhaar No"}),r.jsx("input",{type:"text",value:b.motherAadhaar,onChange:S=>B({...b,motherAadhaar:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"12-digit Aadhaar number",pattern:"[0-9]{12}",maxLength:12})]})]})]}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Identity Documents"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aadhaar/KPR No *"}),r.jsx("input",{type:"text",required:!0,value:b.studentAadhaar,onChange:S=>B({...b,studentAadhaar:S.target.value,studentDetails:{...b.studentDetails,personal:{...b.studentDetails.personal,studentAadhaar:S.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"12-digit Aadhaar number",pattern:"[0-9]{12}",maxLength:12})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Caste Certificate No *"}),r.jsx("input",{type:"text",required:!0,value:b.studentCasteCertNo,onChange:S=>B({...b,studentCasteCertNo:S.target.value,studentDetails:{...b.studentDetails,personal:{...b.studentDetails.personal,studentCasteCertNo:S.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter certificate number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Caste Certificate No"}),r.jsx("input",{type:"text",value:b.fatherCasteCertNo,onChange:S=>B({...b,fatherCasteCertNo:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter certificate number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Caste Certificate No"}),r.jsx("input",{type:"text",value:b.motherCasteCertNo,onChange:S=>B({...b,motherCasteCertNo:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter certificate number"})]})]})]}),r.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Caste and Category"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Caste"}),r.jsxs("select",{value:b.studentCaste,onChange:S=>B({...b,studentCaste:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Caste"}),r.jsx("option",{value:"Brahmin",children:"Brahmin"}),r.jsx("option",{value:"Kshatriya",children:"Kshatriya"}),r.jsx("option",{value:"Vaishya",children:"Vaishya"}),r.jsx("option",{value:"Shudra",children:"Shudra"}),r.jsx("option",{value:"Lingayat",children:"Lingayat"}),r.jsx("option",{value:"Vokkaliga",children:"Vokkaliga"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.studentCaste==="Other"&&r.jsx("input",{type:"text",value:b.studentCasteOther,onChange:S=>B({...b,studentCasteOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify student caste"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Caste"}),r.jsxs("select",{value:b.fatherCaste,onChange:S=>B({...b,fatherCaste:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Caste"}),r.jsx("option",{value:"Brahmin",children:"Brahmin"}),r.jsx("option",{value:"Kshatriya",children:"Kshatriya"}),r.jsx("option",{value:"Vaishya",children:"Vaishya"}),r.jsx("option",{value:"Shudra",children:"Shudra"}),r.jsx("option",{value:"Lingayat",children:"Lingayat"}),r.jsx("option",{value:"Vokkaliga",children:"Vokkaliga"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.fatherCaste==="Other"&&r.jsx("input",{type:"text",value:b.fatherCasteOther,onChange:S=>B({...b,fatherCasteOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify father caste"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Caste"}),r.jsxs("select",{value:b.motherCaste,onChange:S=>B({...b,motherCaste:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Caste"}),r.jsx("option",{value:"Brahmin",children:"Brahmin"}),r.jsx("option",{value:"Kshatriya",children:"Kshatriya"}),r.jsx("option",{value:"Vaishya",children:"Vaishya"}),r.jsx("option",{value:"Shudra",children:"Shudra"}),r.jsx("option",{value:"Lingayat",children:"Lingayat"}),r.jsx("option",{value:"Vokkaliga",children:"Vokkaliga"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.motherCaste==="Other"&&r.jsx("input",{type:"text",value:b.motherCasteOther,onChange:S=>B({...b,motherCasteOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify mother caste"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Social Category"}),r.jsxs("select",{value:b.socialCategory,onChange:S=>B({...b,socialCategory:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Category"}),r.jsx("option",{value:"General",children:"General"}),r.jsx("option",{value:"SC",children:"SC (Scheduled Caste)"}),r.jsx("option",{value:"ST",children:"ST (Scheduled Tribe)"}),r.jsx("option",{value:"OBC",children:"OBC (Other Backward Class)"}),r.jsx("option",{value:"Category-1",children:"Category-1"}),r.jsx("option",{value:"Category-2A",children:"Category-2A"}),r.jsx("option",{value:"Category-2B",children:"Category-2B"}),r.jsx("option",{value:"Category-3A",children:"Category-3A"}),r.jsx("option",{value:"Category-3B",children:"Category-3B"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.socialCategory==="Other"&&r.jsx("input",{type:"text",value:b.socialCategoryOther,onChange:S=>B({...b,socialCategoryOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify social category"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Religion"}),r.jsxs("select",{value:b.religion,onChange:S=>B({...b,religion:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Religion"}),r.jsx("option",{value:"Hindu",children:"Hindu"}),r.jsx("option",{value:"Muslim",children:"Muslim"}),r.jsx("option",{value:"Christian",children:"Christian"}),r.jsx("option",{value:"Sikh",children:"Sikh"}),r.jsx("option",{value:"Buddhist",children:"Buddhist"}),r.jsx("option",{value:"Jain",children:"Jain"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.religion==="Other"&&r.jsx("input",{type:"text",value:b.religionOther,onChange:S=>B({...b,religionOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify religion"})]})]})]}),r.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Economic Status"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Belonging to BPL"}),r.jsxs("select",{value:b.belongingToBPL,onChange:S=>B({...b,belongingToBPL:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"No",children:"No"}),r.jsx("option",{value:"Yes",children:"Yes"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"BPL Card No"}),r.jsx("input",{type:"text",value:b.bplCardNo,onChange:S=>B({...b,bplCardNo:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter BPL card number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bhagyalakshmi Bond No"}),r.jsx("input",{type:"text",value:b.bhagyalakshmiBondNo,onChange:S=>B({...b,bhagyalakshmiBondNo:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter bond number"})]})]})]}),r.jsxs("div",{className:"bg-pink-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Special Needs"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Disability / Child with Special Need"}),r.jsxs("select",{value:b.disability,onChange:S=>B({...b,disability:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"Not Applicable",children:"Not Applicable"}),r.jsx("option",{value:"Visual Impairment",children:"Visual Impairment"}),r.jsx("option",{value:"Hearing Impairment",children:"Hearing Impairment"}),r.jsx("option",{value:"Speech and Language Disability",children:"Speech and Language Disability"}),r.jsx("option",{value:"Locomotor Disability",children:"Locomotor Disability"}),r.jsx("option",{value:"Intellectual Disability",children:"Intellectual Disability"}),r.jsx("option",{value:"Learning Disability",children:"Learning Disability"}),r.jsx("option",{value:"Autism Spectrum Disorder",children:"Autism Spectrum Disorder"}),r.jsx("option",{value:"Multiple Disabilities",children:"Multiple Disabilities"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.disability==="Other"&&r.jsx("input",{type:"text",value:b.disabilityOther,onChange:S=>B({...b,disabilityOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify disability type"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Is the student an RTE (Right to Education) candidate? ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:b.isRTECandidate||"",onChange:S=>B({...b,isRTECandidate:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Option"}),r.jsx("option",{value:"Yes",children:"Yes"}),r.jsx("option",{value:"No",children:"No"})]})]})]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Address Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address *"}),r.jsx("textarea",{required:!0,value:b.address,onChange:S=>B({...b,address:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter complete address",rows:2})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City/Village/Town *"}),r.jsx("input",{type:"text",required:!0,value:b.cityVillageTown,onChange:S=>B({...b,cityVillageTown:S.target.value,city:S.target.value,addressDetails:{...b.addressDetails,permanent:{...b.addressDetails?.permanent,city:S.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter city/village/town"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Locality"}),r.jsx("input",{type:"text",value:b.locality,onChange:S=>B({...b,locality:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter locality"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pin Code *"}),r.jsx("input",{type:"text",required:!0,value:b.pinCode,onChange:S=>B({...b,pinCode:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"6-digit pin code",pattern:"[0-9]{6}",maxLength:6})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("h5",{className:"text-md font-medium text-gray-800 mb-2",children:"Location Details (State, District, Taluka)"}),r.jsx(yj,{selectedState:b.stateId,selectedDistrict:b.districtId,selectedTaluka:b.talukaId,districtText:b.districtText,talukaText:b.talukaText,onStateChange:Fn,onDistrictChange:yn,onTalukaChange:Tn,onDistrictTextChange:on,onTalukaTextChange:ii,required:!0,className:"grid grid-cols-1 md:grid-cols-3 gap-4"})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"})]}),r.jsxs("div",{className:"bg-cyan-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Communication Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Mobile No"}),r.jsx("input",{type:"tel",value:b.studentMobile,onChange:S=>B({...b,studentMobile:S.target.value,phone:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"10-digit mobile number",pattern:"[0-9]{10}",maxLength:10})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Email ID"}),r.jsx("input",{type:"email",value:b.studentEmail,onChange:S=>B({...b,studentEmail:S.target.value,email:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter email address"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Mobile No"}),r.jsx("input",{type:"tel",value:b.fatherMobile,onChange:S=>B({...b,fatherMobile:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"10-digit mobile number",pattern:"[0-9]{10}",maxLength:10})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Email ID"}),r.jsx("input",{type:"email",value:b.fatherEmail,onChange:S=>B({...b,fatherEmail:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter email address"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Mobile No"}),r.jsx("input",{type:"tel",value:b.motherMobile,onChange:S=>B({...b,motherMobile:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"10-digit mobile number",pattern:"[0-9]{10}",maxLength:10})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Email ID"}),r.jsx("input",{type:"email",value:b.motherEmail,onChange:S=>B({...b,motherEmail:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter email address"})]})]})]}),r.jsxs("div",{className:"bg-teal-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"School and Banking"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["School Admission Date ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"date",required:!0,value:b.schoolAdmissionDate,onChange:S=>B({...b,schoolAdmissionDate:S.target.value,admissionDate:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bank Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",required:!0,value:b.bankName,onChange:S=>B({...b,bankName:S.target.value,studentDetails:{...b.studentDetails,financial:{...b.studentDetails.financial,bankDetails:{...b.studentDetails.financial?.bankDetails,bankName:S.target.value}}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter bank name"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bank Account No ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",required:!0,value:b.bankAccountNo,onChange:S=>B({...b,bankAccountNo:S.target.value,studentDetails:{...b.studentDetails,financial:{...b.studentDetails.financial,bankDetails:{...b.studentDetails.financial?.bankDetails,accountNumber:S.target.value}}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter account number"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bank IFSC Code ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",required:!0,value:b.bankIFSC,onChange:S=>B({...b,bankIFSC:S.target.value,studentDetails:{...b.studentDetails,financial:{...b.studentDetails.financial,bankDetails:{...b.studentDetails.financial?.bankDetails,ifscCode:S.target.value}}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"11-character IFSC code",pattern:"[A-Z]{4}0[A-Z0-9]{6}",maxLength:11})]})]})]}),r.jsxs("div",{className:"bg-emerald-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Additional Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),r.jsxs("select",{value:b.section,onChange:S=>B({...b,section:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Section"}),["A","B","C","D","E"].map(S=>r.jsx("option",{value:S,children:S},S))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Roll Number"}),r.jsx("input",{type:"text",value:b.rollNumber,onChange:S=>B({...b,rollNumber:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter roll number"})]})]})]}),r.jsxs("div",{className:"bg-rose-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Additional Essential Information"}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h5",{className:"text-md font-medium text-gray-800 mb-3",children:"Personal Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Blood Group ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:b.bloodGroup||"",onChange:S=>B({...b,bloodGroup:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0,children:[r.jsx("option",{value:"",children:"Select Blood Group"}),r.jsx("option",{value:"A+",children:"A+"}),r.jsx("option",{value:"A-",children:"A-"}),r.jsx("option",{value:"B+",children:"B+"}),r.jsx("option",{value:"B-",children:"B-"}),r.jsx("option",{value:"AB+",children:"AB+"}),r.jsx("option",{value:"AB-",children:"AB-"}),r.jsx("option",{value:"O+",children:"O+"}),r.jsx("option",{value:"O-",children:"O-"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nationality *"}),r.jsx("input",{type:"text",required:!0,value:b.nationality||"Indian",onChange:S=>B({...b,nationality:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter nationality"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Place of Birth"}),r.jsx("input",{type:"text",value:b.placeOfBirth||"",onChange:S=>B({...b,placeOfBirth:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter place of birth"})]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h5",{className:"text-md font-medium text-gray-800 mb-3",children:"Previous School Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Previous School Name"}),r.jsx("input",{type:"text",value:b.previousSchool||"",onChange:S=>B({...b,previousSchool:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter previous school name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TC Number"}),r.jsx("input",{type:"text",value:b.tcNumber||"",onChange:S=>B({...b,tcNumber:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter TC number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Migration Certificate"}),r.jsx("input",{type:"text",value:b.migrationCertificate||"",onChange:S=>B({...b,migrationCertificate:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter migration certificate number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Class Passed"}),r.jsx("input",{type:"text",value:b.previousClass||"",onChange:S=>B({...b,previousClass:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter last class passed"})]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h5",{className:"text-md font-medium text-gray-800 mb-3",children:"Guardian & Emergency Contact"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guardian Name"}),r.jsx("input",{type:"text",value:b.guardianName||"",onChange:S=>B({...b,guardianName:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter guardian name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guardian Relationship"}),r.jsxs("select",{value:b.guardianRelation||"",onChange:S=>B({...b,guardianRelation:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Relationship"}),r.jsx("option",{value:"Father",children:"Father"}),r.jsx("option",{value:"Mother",children:"Mother"}),r.jsx("option",{value:"Uncle",children:"Uncle"}),r.jsx("option",{value:"Aunt",children:"Aunt"}),r.jsx("option",{value:"Grandfather",children:"Grandfather"}),r.jsx("option",{value:"Grandmother",children:"Grandmother"}),r.jsx("option",{value:"Elder Brother",children:"Elder Brother"}),r.jsx("option",{value:"Elder Sister",children:"Elder Sister"}),r.jsx("option",{value:"Other",children:"Other"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Contact Phone"}),r.jsx("input",{type:"tel",value:b.alternatePhone||"",onChange:S=>B({...b,alternatePhone:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"10-digit emergency contact",pattern:"[0-9]{10}",maxLength:10})]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h5",{className:"text-md font-medium text-gray-800 mb-3",children:"Medical Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Medical Conditions"}),r.jsx("textarea",{value:b.medicalConditions||"",onChange:S=>B({...b,medicalConditions:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter any chronic medical conditions",rows:2})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Special Needs"}),r.jsx("textarea",{value:b.specialNeeds||"",onChange:S=>B({...b,specialNeeds:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter any special educational needs",rows:2})]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h5",{className:"text-md font-medium text-gray-800 mb-3",children:"Transport Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transport Required"}),r.jsxs("select",{value:b.transportMode||"Own",onChange:S=>B({...b,transportMode:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"Own",children:"Own Transport"}),r.jsx("option",{value:"School Bus",children:"School Bus"}),r.jsx("option",{value:"Public Transport",children:"Public Transport"}),r.jsx("option",{value:"Walking",children:"Walking"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bus Route"}),r.jsx("input",{type:"text",value:b.busRoute||"",onChange:S=>B({...b,busRoute:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter bus route (if applicable)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pickup Point"}),r.jsx("input",{type:"text",value:b.pickupPoint||"",onChange:S=>B({...b,pickupPoint:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter pickup point"})]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h5",{className:"text-md font-medium text-gray-800 mb-3",children:"Additional Documents"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Birth Certificate Number"}),r.jsx("input",{type:"text",value:b.birthCertificateNumber||"",onChange:S=>B({...b,birthCertificateNumber:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter birth certificate number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ration Card Number"}),r.jsx("input",{type:"text",value:b.rationCardNumber||"",onChange:S=>B({...b,rationCardNumber:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter ration card number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scholarship Details"}),r.jsx("input",{type:"text",value:b.scholarshipDetails||"",onChange:S=>B({...b,scholarshipDetails:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter scholarship information"})]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h5",{className:"text-md font-medium text-gray-800 mb-3",children:"Family Economic Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Education"}),r.jsx("input",{type:"text",value:b.fatherEducation||"",onChange:S=>B({...b,fatherEducation:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter father's education"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Education"}),r.jsx("input",{type:"text",value:b.motherEducation||"",onChange:S=>B({...b,motherEducation:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter mother's education"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Family Income (Annual)"}),r.jsxs("select",{value:b.familyIncome||"",onChange:S=>B({...b,familyIncome:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Income Range"}),r.jsx("option",{value:"Below 1 Lakh",children:"Below 1 Lakh"}),r.jsx("option",{value:"1-2 Lakhs",children:"1-2 Lakhs"}),r.jsx("option",{value:"2-5 Lakhs",children:"2-5 Lakhs"}),r.jsx("option",{value:"5-10 Lakhs",children:"5-10 Lakhs"}),r.jsx("option",{value:"Above 10 Lakhs",children:"Above 10 Lakhs"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Economic Status"}),r.jsxs("select",{value:b.economicStatus||"",onChange:S=>B({...b,economicStatus:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Status"}),r.jsx("option",{value:"BPL",children:"Below Poverty Line (BPL)"}),r.jsx("option",{value:"APL",children:"Above Poverty Line (APL)"}),r.jsx("option",{value:"EWS",children:"Economically Weaker Section (EWS)"}),r.jsx("option",{value:"General",children:"General"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"BPL Card Number"}),r.jsx("input",{type:"text",value:b.bplCardNumber||"",onChange:S=>B({...b,bplCardNumber:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter BPL card number"})]})]})]})]})]}),b.role==="teacher"&&r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Professional Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Qualification *"}),r.jsx("input",{type:"text",required:!0,value:b.qualification,onChange:S=>B({...b,qualification:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter qualification"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Experience (Years)"}),r.jsx("input",{type:"number",value:b.experience,onChange:S=>B({...b,experience:parseInt(S.target.value)||0}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter experience in years",min:"0"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subjects Taught"}),r.jsx("input",{type:"text",value:b.subjects,onChange:S=>B({...b,subjects:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter subjects separated by commas (e.g., Mathematics, Physics, Chemistry)"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Enter subjects separated by commas"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),r.jsx("input",{type:"text",value:b.employeeId,onChange:S=>B({...b,employeeId:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter employee ID (optional)"})]})]})]}),b.role==="admin"&&r.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Administrative Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Level *"}),r.jsxs("select",{required:!0,value:b.adminLevel,onChange:S=>B({...b,adminLevel:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Admin Level"}),r.jsx("option",{value:"Super Admin",children:"Super Admin"}),r.jsx("option",{value:"Principal",children:"Principal"}),r.jsx("option",{value:"Vice Principal",children:"Vice Principal"}),r.jsx("option",{value:"Academic Coordinator",children:"Academic Coordinator"}),r.jsx("option",{value:"Administrative Officer",children:"Administrative Officer"}),r.jsx("option",{value:"Office Staff",children:"Office Staff"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),r.jsxs("select",{value:b.department,onChange:S=>B({...b,department:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Department"}),r.jsx("option",{value:"Administration",children:"Administration"}),r.jsx("option",{value:"Academic Affairs",children:"Academic Affairs"}),r.jsx("option",{value:"Student Affairs",children:"Student Affairs"}),r.jsx("option",{value:"Finance",children:"Finance"}),r.jsx("option",{value:"Human Resources",children:"Human Resources"}),r.jsx("option",{value:"IT Department",children:"IT Department"}),r.jsx("option",{value:"Facilities",children:"Facilities"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),r.jsx("input",{type:"text",value:b.employeeId,onChange:S=>B({...b,employeeId:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter employee ID"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Access Level"}),r.jsxs("select",{value:b.accessLevel,onChange:S=>B({...b,accessLevel:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Access Level"}),r.jsx("option",{value:"Full Access",children:"Full Access"}),r.jsx("option",{value:"Limited Access",children:"Limited Access"}),r.jsx("option",{value:"Read Only",children:"Read Only"}),r.jsx("option",{value:"Department Specific",children:"Department Specific"})]})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{value:b.address,onChange:S=>B({...b,address:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter address",rows:2})]}),r.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:()=>{H(!1),ns()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:G||!bt(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",title:G?"Please wait...":bt()?void 0:St(),children:G?"Adding...":"Add User"})]})]})]})}),Le&&K&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[60]",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto relative z-[61]",children:[r.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:["Edit User - ",K.role.charAt(0).toUpperCase()+K.role.slice(1)]}),r.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"User Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User ID"}),r.jsx("div",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100 text-gray-700 font-mono",children:K.userId||K._id})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),r.jsx("div",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100 text-gray-700",children:K.role.charAt(0).toUpperCase()+K.role.slice(1)})]})]})]}),r.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Profile Picture"}),r.jsxs("div",{className:"flex items-start gap-6",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-32 h-32 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden bg-gray-50",children:Ie||K.profileImage?r.jsx("img",{src:Ie||(K.profileImage?.startsWith("http")?K.profileImage:`${"https://erp-backend-kfut.onrender.com/api".replace("/api","")||""}${K.profileImage}`),alt:"Profile preview",className:"w-full h-full object-cover"}):r.jsx($6,{className:"w-12 h-12 text-gray-400"})})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("input",{ref:et,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:S=>{const ue=S.target.files?.[0];if(!ue)return;console.log(` Selected image: ${ue.name}, Size: ${(ue.size/1024).toFixed(2)}KB`);const qe=OZ(ue);if(!qe.valid){ge.error(qe.error||"Invalid file");return}const we=new FileReader;we.onload=de=>{je(de.target?.result)},we.readAsDataURL(ue),We(ue),ge.success("Image selected. Will be compressed on upload.")},className:"hidden",id:"profile-image-input"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("label",{htmlFor:"profile-image-input",className:`px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors ${oe?"opacity-50 cursor-not-allowed":""}`,children:Ie||K.profileImage?"Change Photo":"Upload Photo"}),(Ie||K.profileImage)&&r.jsxs("button",{type:"button",onClick:()=>{je(null),We(null),et.current&&(et.current.value="")},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[r.jsx(Ur,{className:"w-4 h-4"}),"Remove"]})]}),r.jsx("p",{className:"text-sm text-gray-600",children:"Upload JPG, PNG, GIF or WebP (max 10MB). Image will be automatically compressed to ~30KB on the server."}),K.profileImage&&!Ie&&r.jsx("p",{className:"text-sm text-blue-600",children:"Current image will be kept if no new image is uploaded."})]})]})]})]}),r.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Basic Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),r.jsx("input",{type:"text",required:!0,value:b.firstName,onChange:S=>B({...b,firstName:S.target.value,name:`${S.target.value} ${b.lastName}`.trim()}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter first name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),r.jsx("input",{type:"text",required:!0,value:b.lastName,onChange:S=>B({...b,lastName:S.target.value,name:`${b.firstName} ${S.target.value}`.trim()}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter last name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),r.jsx("input",{type:"email",required:!0,value:b.email,onChange:S=>B({...b,email:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter email address"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone *"}),r.jsx("input",{type:"tel",required:!0,value:b.phone,onChange:S=>B({...b,phone:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter phone number",pattern:"[0-9]{10}",maxLength:10})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),r.jsx("input",{type:"date",value:b.dateOfBirth,onChange:S=>C(S.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender *"}),r.jsxs("select",{required:!0,value:b.gender,onChange:S=>B({...b,gender:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address *"}),r.jsx("textarea",{required:!0,value:b.address,onChange:S=>B({...b,address:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter complete address",rows:2})]})]})]}),K.role==="student"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Student Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Name (English) *"}),r.jsx("input",{type:"text",required:!0,value:b.name,onChange:S=>B({...b,name:S.target.value,firstName:S.target.value.split(" ")[0],lastName:S.target.value.split(" ").slice(1).join(" ")}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter full name in English"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth *"}),r.jsx("input",{type:"date",required:!0,value:b.dateOfBirth,onChange:S=>C(S.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Age (Years)"}),r.jsx("input",{type:"number",value:b.ageYears,onChange:S=>B({...b,ageYears:parseInt(S.target.value)||0}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Years",min:"0",max:"25"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Age (Months)"}),r.jsx("input",{type:"number",value:b.ageMonths,onChange:S=>B({...b,ageMonths:parseInt(S.target.value)||0}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Months",min:"0",max:"11"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender *"}),r.jsxs("select",{required:!0,value:b.gender,onChange:S=>B({...b,gender:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]})]})]})]}),r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Admission Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year *"}),r.jsxs("select",{required:!0,value:b.academicYear,onChange:S=>B({...b,academicYear:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"2024-2025",children:"2024-2025"}),r.jsx("option",{value:"2025-2026",children:"2025-2026"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Medium of Instruction *"}),r.jsxs("select",{required:!0,value:b.mediumOfInstruction,onChange:S=>B({...b,mediumOfInstruction:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"English",children:"English"}),r.jsx("option",{value:"Kannada",children:"Kannada"}),r.jsx("option",{value:"Hindi",children:"Hindi"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Tongue"}),r.jsxs("select",{value:b.motherTongue,onChange:S=>B({...b,motherTongue:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Mother Tongue"}),r.jsx("option",{value:"Kannada",children:"Kannada"}),r.jsx("option",{value:"Hindi",children:"Hindi"}),r.jsx("option",{value:"Tamil",children:"Tamil"}),r.jsx("option",{value:"Telugu",children:"Telugu"}),r.jsx("option",{value:"Malayalam",children:"Malayalam"}),r.jsx("option",{value:"English",children:"English"}),r.jsx("option",{value:"Urdu",children:"Urdu"}),r.jsx("option",{value:"Marathi",children:"Marathi"}),r.jsx("option",{value:"Bengali",children:"Bengali"}),r.jsx("option",{value:"Gujarati",children:"Gujarati"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.motherTongue==="Other"&&r.jsx("input",{type:"text",value:b.motherTongueOther||"",onChange:S=>B({...b,motherTongueOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify mother tongue"})]})]})]}),r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Academic Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class *"}),r.jsxs("select",{required:!0,value:b.class,onChange:S=>B({...b,class:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Class"}),r.jsx("option",{value:"LKG",children:"LKG"}),r.jsx("option",{value:"UKG",children:"UKG"}),[1,2,3,4,5,6,7,8,9,10,11,12].map(S=>r.jsx("option",{value:S.toString(),children:S},S))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),r.jsxs("select",{value:b.section,onChange:S=>B({...b,section:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Section"}),["A","B","C","D","E","F","G","H","I","J","K","L","M"].map(S=>r.jsxs("option",{value:S,children:["Section ",S]},S))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Roll Number"}),r.jsx("input",{type:"text",value:b.rollNumber,onChange:S=>B({...b,rollNumber:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter roll number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admission Date"}),r.jsx("input",{type:"date",value:b.admissionDate,onChange:S=>B({...b,admissionDate:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]})]})]}),r.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Family Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Name (English)"}),r.jsx("input",{type:"text",value:b.fatherName,onChange:S=>B({...b,fatherName:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter father's name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Aadhaar No"}),r.jsx("input",{type:"text",value:b.fatherAadhaar,onChange:S=>B({...b,fatherAadhaar:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"12-digit Aadhaar number",pattern:"[0-9]{12}",maxLength:12})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Name (English)"}),r.jsx("input",{type:"text",value:b.motherName,onChange:S=>B({...b,motherName:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter mother's name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Aadhaar No"}),r.jsx("input",{type:"text",value:b.motherAadhaar,onChange:S=>B({...b,motherAadhaar:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"12-digit Aadhaar number",pattern:"[0-9]{12}",maxLength:12})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father's Phone"}),r.jsx("input",{type:"tel",value:b.fatherPhone,onChange:S=>B({...b,fatherPhone:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter father's phone (10 digits)",pattern:"[0-9]{10}",maxLength:10})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother's Phone"}),r.jsx("input",{type:"tel",value:b.motherPhone,onChange:S=>B({...b,motherPhone:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter mother's phone (10 digits)",pattern:"[0-9]{10}",maxLength:10})]})]})]}),r.jsxs("div",{className:"bg-cyan-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Contact Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Email"}),r.jsx("input",{type:"email",value:b.email,onChange:S=>B({...b,email:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter email address"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Mobile"}),r.jsx("input",{type:"tel",value:b.phone,onChange:S=>B({...b,phone:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter mobile number (10 digits)",pattern:"[0-9]{10}",maxLength:10})]})]})]}),r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Identity Documents"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Aadhaar/KPR No"}),r.jsx("input",{type:"text",value:b.studentAadhaar,onChange:S=>B({...b,studentAadhaar:S.target.value,studentDetails:{...b.studentDetails,personal:{...b.studentDetails.personal,studentAadhaar:S.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"12-digit Aadhaar number",pattern:"[0-9]{12}",maxLength:12})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Caste Certificate No *"}),r.jsx("input",{type:"text",required:!0,value:b.studentCasteCertNo,onChange:S=>B({...b,studentCasteCertNo:S.target.value,studentDetails:{...b.studentDetails,personal:{...b.studentDetails.personal,studentCasteCertNo:S.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter certificate number"})]})]})]}),r.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Caste and Category"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Social Category"}),r.jsxs("select",{value:b.socialCategory,onChange:S=>B({...b,socialCategory:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Category"}),r.jsx("option",{value:"General",children:"General"}),r.jsx("option",{value:"SC",children:"SC (Scheduled Caste)"}),r.jsx("option",{value:"ST",children:"ST (Scheduled Tribe)"}),r.jsx("option",{value:"OBC",children:"OBC (Other Backward Class)"}),r.jsx("option",{value:"Category-1",children:"Category-1"}),r.jsx("option",{value:"Category-2A",children:"Category-2A"}),r.jsx("option",{value:"Category-2B",children:"Category-2B"}),r.jsx("option",{value:"Category-3A",children:"Category-3A"}),r.jsx("option",{value:"Category-3B",children:"Category-3B"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.socialCategory==="Other"&&r.jsx("input",{type:"text",value:b.socialCategoryOther,onChange:S=>B({...b,socialCategoryOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify social category"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Religion"}),r.jsxs("select",{value:b.religion,onChange:S=>B({...b,religion:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Religion"}),r.jsx("option",{value:"Hindu",children:"Hindu"}),r.jsx("option",{value:"Muslim",children:"Muslim"}),r.jsx("option",{value:"Christian",children:"Christian"}),r.jsx("option",{value:"Sikh",children:"Sikh"}),r.jsx("option",{value:"Buddhist",children:"Buddhist"}),r.jsx("option",{value:"Jain",children:"Jain"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.religion==="Other"&&r.jsx("input",{type:"text",value:b.religionOther,onChange:S=>B({...b,religionOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify religion"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Caste"}),r.jsxs("select",{value:b.studentCaste,onChange:S=>B({...b,studentCaste:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Caste"}),r.jsx("option",{value:"Brahmin",children:"Brahmin"}),r.jsx("option",{value:"Kshatriya",children:"Kshatriya"}),r.jsx("option",{value:"Vaishya",children:"Vaishya"}),r.jsx("option",{value:"Shudra",children:"Shudra"}),r.jsx("option",{value:"Lingayat",children:"Lingayat"}),r.jsx("option",{value:"Vokkaliga",children:"Vokkaliga"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.studentCaste==="Other"&&r.jsx("input",{type:"text",value:b.studentCasteOther,onChange:S=>B({...b,studentCasteOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify student caste"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Father Caste"}),r.jsxs("select",{value:b.fatherCaste,onChange:S=>B({...b,fatherCaste:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Caste"}),r.jsx("option",{value:"Brahmin",children:"Brahmin"}),r.jsx("option",{value:"Kshatriya",children:"Kshatriya"}),r.jsx("option",{value:"Vaishya",children:"Vaishya"}),r.jsx("option",{value:"Shudra",children:"Shudra"}),r.jsx("option",{value:"Lingayat",children:"Lingayat"}),r.jsx("option",{value:"Vokkaliga",children:"Vokkaliga"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.fatherCaste==="Other"&&r.jsx("input",{type:"text",value:b.fatherCasteOther,onChange:S=>B({...b,fatherCasteOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify father caste"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mother Caste"}),r.jsxs("select",{value:b.motherCaste,onChange:S=>B({...b,motherCaste:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Caste"}),r.jsx("option",{value:"Brahmin",children:"Brahmin"}),r.jsx("option",{value:"Kshatriya",children:"Kshatriya"}),r.jsx("option",{value:"Vaishya",children:"Vaishya"}),r.jsx("option",{value:"Shudra",children:"Shudra"}),r.jsx("option",{value:"Lingayat",children:"Lingayat"}),r.jsx("option",{value:"Vokkaliga",children:"Vokkaliga"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.motherCaste==="Other"&&r.jsx("input",{type:"text",value:b.motherCasteOther,onChange:S=>B({...b,motherCasteOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify mother caste"})]})]})]}),r.jsxs("div",{className:"bg-pink-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Special Needs"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Disability / Child with Special Need"}),r.jsxs("select",{value:b.disability,onChange:S=>B({...b,disability:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"Not Applicable",children:"Not Applicable"}),r.jsx("option",{value:"Visual Impairment",children:"Visual Impairment"}),r.jsx("option",{value:"Hearing Impairment",children:"Hearing Impairment"}),r.jsx("option",{value:"Speech and Language Disability",children:"Speech and Language Disability"}),r.jsx("option",{value:"Locomotor Disability",children:"Locomotor Disability"}),r.jsx("option",{value:"Intellectual Disability",children:"Intellectual Disability"}),r.jsx("option",{value:"Learning Disability",children:"Learning Disability"}),r.jsx("option",{value:"Autism Spectrum Disorder",children:"Autism Spectrum Disorder"}),r.jsx("option",{value:"Multiple Disabilities",children:"Multiple Disabilities"}),r.jsx("option",{value:"Other",children:"Other"})]}),b.disability==="Other"&&r.jsx("input",{type:"text",value:b.disabilityOther,onChange:S=>B({...b,disabilityOther:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 mt-2",placeholder:"Please specify disability type"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Is the student an RTE (Right to Education) candidate? ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:b.isRTECandidate||"",onChange:S=>B({...b,isRTECandidate:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[r.jsx("option",{value:"",children:"Select Option"}),r.jsx("option",{value:"Yes",children:"Yes"}),r.jsx("option",{value:"No",children:"No"})]})]})]})]}),r.jsxs("div",{className:"bg-teal-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Banking Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bank Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",required:!0,value:b.bankName,onChange:S=>B({...b,bankName:S.target.value,studentDetails:{...b.studentDetails,financial:{...b.studentDetails.financial,bankDetails:{...b.studentDetails.financial?.bankDetails,bankName:S.target.value}}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter bank name"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bank Account No ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",required:!0,value:b.bankAccountNo,onChange:S=>B({...b,bankAccountNo:S.target.value,studentDetails:{...b.studentDetails,financial:{...b.studentDetails.financial,bankDetails:{...b.studentDetails.financial?.bankDetails,accountNumber:S.target.value}}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter account number"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bank IFSC Code ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",required:!0,value:b.bankIFSC,onChange:S=>B({...b,bankIFSC:S.target.value,studentDetails:{...b.studentDetails,financial:{...b.studentDetails.financial,bankDetails:{...b.studentDetails.financial?.bankDetails,ifscCode:S.target.value}}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"11-character IFSC code",pattern:"[A-Z]{4}0[A-Z0-9]{6}",maxLength:11})]})]})]})]}),K.role==="teacher"&&r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Professional Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Qualification *"}),r.jsx("input",{type:"text",required:!0,value:b.qualification,onChange:S=>B({...b,qualification:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter qualification"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Experience (Years)"}),r.jsx("input",{type:"number",value:b.experience,onChange:S=>B({...b,experience:parseInt(S.target.value)||0}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter experience in years",min:"0"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subjects Taught"}),r.jsx("input",{type:"text",value:b.subjects,onChange:S=>B({...b,subjects:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter subjects separated by commas (e.g., Mathematics, Physics, Chemistry)"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Enter subjects separated by commas"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),r.jsx("input",{type:"text",value:b.employeeId,onChange:S=>B({...b,employeeId:S.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Enter employee ID (optional)"})]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:()=>{he(!1),be(null),ns()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:G,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:G?"Updating...":"Update User"})]})]})]})}),U&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[70]",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 relative z-[71]",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:r.jsx(_s,{className:"h-6 w-6 text-green-600"})}),r.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"User Created Successfully!"}),r.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Please save these credentials and share them with the user."})]}),r.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Login Credentials"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide",children:"User ID"}),r.jsxs("div",{className:"mt-1 flex items-center justify-between bg-white border rounded px-3 py-2",children:[r.jsx("span",{className:"text-sm font-mono text-gray-900",children:U.userId}),r.jsx("button",{onClick:()=>navigator.clipboard.writeText(U.userId),className:"text-blue-600 hover:text-blue-800 text-xs",children:"Copy"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Email"}),r.jsxs("div",{className:"mt-1 flex items-center justify-between bg-white border rounded px-3 py-2",children:[r.jsx("span",{className:"text-sm text-gray-900",children:U.email}),r.jsx("button",{onClick:()=>navigator.clipboard.writeText(U.email),className:"text-blue-600 hover:text-blue-800 text-xs",children:"Copy"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Password"}),r.jsxs("div",{className:"mt-1 flex items-center justify-between bg-white border rounded px-3 py-2",children:[r.jsx("span",{className:"text-sm font-mono text-gray-900",children:U.password}),r.jsx("button",{onClick:()=>navigator.clipboard.writeText(U.password),className:"text-blue-600 hover:text-blue-800 text-xs",children:"Copy"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Role"}),r.jsx("div",{className:"mt-1 bg-white border rounded px-3 py-2",children:r.jsx("span",{className:"text-sm capitalize text-gray-900",children:U.role})})]})]})]}),r.jsx("div",{className:"mt-6 flex justify-end",children:r.jsx("button",{onClick:()=>Q(null),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Done"})})]})})}),Oe&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[70]",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 relative z-[71]",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-purple-100",children:r.jsx(K6,{className:"h-6 w-6 text-purple-600"})}),r.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Password Reset Successfully!"}),r.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Please save these new credentials and share them with the user."})]}),r.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"New Login Credentials"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide",children:"User ID"}),r.jsxs("div",{className:"mt-1 flex items-center justify-between bg-white border rounded px-3 py-2",children:[r.jsx("span",{className:"text-sm font-mono text-gray-900",children:Oe.userId}),r.jsx("button",{onClick:()=>navigator.clipboard.writeText(Oe.userId),className:"text-blue-600 hover:text-blue-800 text-xs",children:"Copy"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Email"}),r.jsxs("div",{className:"mt-1 flex items-center justify-between bg-white border rounded px-3 py-2",children:[r.jsx("span",{className:"text-sm text-gray-900",children:Oe.email}),r.jsx("button",{onClick:()=>navigator.clipboard.writeText(Oe.email),className:"text-blue-600 hover:text-blue-800 text-xs",children:"Copy"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide",children:"New Password"}),r.jsxs("div",{className:"mt-1 flex items-center justify-between bg-white border rounded px-3 py-2",children:[r.jsx("span",{className:"text-sm font-mono text-gray-900",children:Oe.password}),r.jsx("button",{onClick:()=>navigator.clipboard.writeText(Oe.password),className:"text-blue-600 hover:text-blue-800 text-xs",children:"Copy"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Role"}),r.jsx("div",{className:"mt-1 bg-white border rounded px-3 py-2",children:r.jsx("span",{className:"text-sm capitalize text-gray-900",children:Oe.role})})]})]})]}),r.jsx("div",{className:"mt-6 flex justify-end",children:r.jsx("button",{onClick:()=>Nt(null),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Done"})})]})})}),tt&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[60]",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto relative z-[61]",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Import ",ne?ne.charAt(0).toUpperCase()+ne.slice(1):"User","s"]}),r.jsxs("button",{onClick:()=>{gt(!1),Ot(null),nr([]),kr(null),$t(!1),Or(0)},className:"text-gray-400 hover:text-gray-600",children:[r.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),gr?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:r.jsx(Ld,{className:"h-6 w-6 text-green-600"})}),r.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Import Completed"}),r.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:[gr.success.length," users imported successfully",gr.errors.length>0&&`, ${gr.errors.length} failed`]})]}),gr.success.length>0&&r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[r.jsxs("h4",{className:"font-medium text-green-900 mb-2",children:["Successfully Imported (",gr.success.length,")"]}),r.jsxs("div",{className:"max-h-40 overflow-auto",children:[r.jsxs("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-left text-green-700",children:[r.jsx("th",{className:"font-medium",children:"User ID"}),r.jsx("th",{className:"font-medium",children:"Email"}),r.jsx("th",{className:"font-medium",children:"Password"})]})}),r.jsx("tbody",{className:"text-green-800",children:gr.success.slice(0,10).map((S,ue)=>r.jsxs("tr",{children:[r.jsx("td",{className:"font-mono",children:S.userId}),r.jsx("td",{children:S.email}),r.jsx("td",{className:"font-mono",children:S.password})]},ue))})]}),gr.success.length>10&&r.jsxs("p",{className:"text-green-600 text-center mt-2",children:["+",gr.success.length-10," more users"]})]})]}),gr.errors.length>0&&r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[r.jsxs("h4",{className:"font-medium text-red-900 mb-2",children:["Failed to Import (",gr.errors.length,")"]}),r.jsxs("div",{className:"max-h-40 overflow-auto space-y-2",children:[gr.errors.slice(0,10).map((S,ue)=>r.jsxs("div",{className:"text-sm",children:[r.jsxs("span",{className:"font-medium text-red-800",children:["Row ",S.row,":"]}),r.jsx("span",{className:"text-red-700 ml-2",children:S.error})]},ue)),gr.errors.length>10&&r.jsxs("p",{className:"text-red-600 text-center",children:["+",gr.errors.length-10," more errors"]})]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("button",{onClick:()=>{kr(null),Ot(null),nr([])},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Import More"}),r.jsxs("div",{className:"space-x-2",children:[gr.success.length>0&&r.jsx("button",{onClick:oa,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Download Credentials"}),r.jsx("button",{onClick:()=>{Bn(),gt(!1),Ot(null),nr([]),kr(null),$t(!1),Or(0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Done"})]})]})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Import Instructions"}),r.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[r.jsxs("li",{children:[" Download the template for ",ne,'s using the "Template" button']}),r.jsx("li",{children:" Fill in your data (required fields marked with *)"}),r.jsx("li",{children:" Date of Birth will be used as the default password (format: DDMMYYYY)"}),r.jsx("li",{children:" User IDs will be auto-generated sequentially"}),r.jsx("li",{children:" Upload the completed CSV file below"})]})]}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[r.jsx("input",{type:"file",accept:".csv",onChange:Un,className:"hidden",id:"csv-upload"}),r.jsxs("label",{htmlFor:"csv-upload",className:"cursor-pointer",children:[r.jsx(Xl,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),r.jsx("p",{className:"text-lg text-gray-600 mb-2",children:Pt?Pt.name:"Choose CSV file or drag and drop"}),r.jsx("p",{className:"text-sm text-gray-500",children:"CSV files only. Make sure to use the template format."})]})]}),Pt&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("h4",{className:"font-medium text-gray-900",children:["File Selected: ",Pt.name]}),r.jsx("div",{className:"space-x-2",children:r.jsx("button",{onClick:()=>ea(ne),className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:"Download Template"})})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Pn,{className:"h-5 w-5 text-blue-500 mr-2"}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-sm font-medium text-blue-800",children:["Ready to import ",ne," users"]}),r.jsx("p",{className:"text-xs text-blue-600",children:"Make sure your CSV file follows the template format"})]})]})}),Sr?r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Processing users..."}),r.jsxs("span",{children:[Math.round(Yt),"%"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Yt}%`}})})]}):r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>{Ot(null),nr([]),kr(null)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear"}),r.jsx("button",{onClick:Wa,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Import Users"})]})]})]})]})})}),Ae&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70] p-4",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md relative z-[71]",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:Ke==="single"?`Verify Admin Password${ae?` - ${ae}`:""}`:"Show All Teacher Passwords"}),r.jsx("button",{onClick:()=>{Xe(!1),dt(""),Je(null),ct("")},className:"text-gray-400 hover:text-gray-600 rounded-full p-1 hover:bg-gray-100",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx(Zo,{className:"h-5 w-5 text-yellow-600 mr-2 flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Admin Authentication Required"}),r.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:Ke==="single"?`Enter your admin password to view the password${ae?` for ${ae}`:""}`:"Enter your admin password to reveal all teacher passwords"})]})]})}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:r.jsxs("p",{className:"text-xs text-blue-700",children:[r.jsx("strong",{children:"Note:"})," Only passwords stored during user creation are available. Users created before this feature may not have viewable passwords."]})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Password"}),r.jsx("input",{type:"password",value:st,onChange:S=>dt(S.target.value),onKeyPress:S=>{S.key==="Enter"&&jn()},placeholder:"Enter your admin password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 p-6 bg-gray-50 border-t rounded-b-xl",children:[r.jsx("button",{onClick:()=>{Xe(!1),dt(""),Je(null),ct("")},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100",children:"Cancel"}),r.jsx("button",{onClick:jn,disabled:it||!st.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:it?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r.jsx("span",{children:"Verifying..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(wn,{className:"h-4 w-4"}),r.jsx("span",{children:"Show Password"})]})})]})]})}),gn&&Ht&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[70]",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 relative z-[71]",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Change Password"}),r.jsx("button",{onClick:()=>{sn(!1),Dr(null),Vt(""),Nr("")},className:"text-gray-400 hover:text-gray-600",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("p",{className:"text-sm text-gray-600",children:["Set a new password for ",r.jsx("strong",{children:Ht.name})]}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Email: ",Ht.email]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password *"}),r.jsx("input",{type:"password",value:dr,onChange:S=>Vt(S.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter new password",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password *"}),r.jsx("input",{type:"password",value:er,onChange:S=>Nr(S.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Re-enter new password"})]}),dr&&er&&dr!==er&&r.jsx("div",{className:"p-2 bg-red-50 border border-red-200 rounded",children:r.jsx("p",{className:"text-xs text-red-600",children:"Passwords do not match"})}),dr&&dr.trim()!==""&&r.jsx("div",{className:"p-2 bg-green-50 border border-green-200 rounded",children:r.jsxs("p",{className:"text-xs text-green-600",children:["Password length: ",dr.length," characters"]})})]}),r.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[r.jsx("button",{onClick:()=>{sn(!1),Dr(null),Vt(""),Nr("")},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100",disabled:xn,children:"Cancel"}),r.jsx("button",{onClick:De,disabled:xn||!dr||!er||dr!==er||dr.trim()==="",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:xn?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r.jsx("span",{children:"Changing..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(U2,{className:"h-4 w-4"}),r.jsx("span",{children:"Change Password"})]})})]})]})})})]})}catch(S){return console.error("Render error in ManageUsers:",S),Ya(!0),null}},_Z=({fromYear:e,setFromYear:t,toYear:n,classes:a,loading:s})=>{const[i,l]=j.useState(""),[d,u]=j.useState(""),[m,p]=j.useState(""),[f,g]=j.useState([]),[N,v]=j.useState([]),[w,y]=j.useState(new Set),[E,O]=j.useState(!1),[T,A]=j.useState(!1),[I,C]=j.useState(!1),[P,F]=j.useState(null),[R,$]=j.useState(!0),[L,G]=j.useState(!1),[X,me]=j.useState(!1),se=["LKG","UKG","1","2","3","4","5","6","7","8","9","10","11","12"],ee=a.find(he=>he.className===i),W=()=>{const he=localStorage.getItem("erp.auth");if(he){const K=JSON.parse(he);return{schoolCode:K.user?.schoolCode||K.schoolCode,token:K.token}}return{schoolCode:null,token:null}},U=he=>{const K=se.indexOf(he);return K!==-1&&K<se.length-1?se[K+1]:"Graduated"},Q=xe.useCallback(async he=>{const K=U(he);return K==="Graduated"||!a.some(re=>re.className===K)?(F(null),$(!1),G(!0),!1):(F(null),$(!0),G(!1),!0)},[a]);j.useEffect(()=>{i&&f.length>0?Q(i):(F(null),$(!0),G(!1),me(!1))},[i,f,Q]),j.useEffect(()=>{L&&me(!0)},[L]);const Y=xe.useCallback(async()=>{if(!i||!d){console.log(" Cannot fetch students: selectedClass or selectedSection is empty");return}const{schoolCode:he}=W();if(!he){console.log(" Cannot fetch students: schoolCode is empty");return}console.log(" Fetching students for:",{selectedClass:i,selectedSection:d,fromYear:e,schoolCode:he});try{O(!0);const K=`/school-users/${he}/users/role/student`;console.log(" API Endpoint:",K);const be=await ot.get(K);if(console.log(" API Response:",be.data),be.data.success){const re=be.data.data||be.data.users||[];console.log(` Total students fetched: ${re.length}`),re.length>0&&console.log(" Sample student structure:",re[0]);const ie=re.filter(ne=>{const Te=ne.academicInfo?.class||ne.studentDetails?.academic?.currentClass||ne.studentDetails?.currentClass||ne.studentDetails?.class||ne.class,ve=ne.academicInfo?.section||ne.studentDetails?.academic?.currentSection||ne.studentDetails?.currentSection||ne.studentDetails?.section||ne.section,We=ne.studentDetails?.academicYear||ne.studentDetails?.academic?.academicYear||ne.academicYear||ne.academicInfo?.academicYear,Ie=String(Te).trim()===String(i).trim(),je=String(ve).trim().toUpperCase()===String(d).trim().toUpperCase(),oe=!We||String(We).trim()===String(e).trim(),$e=Ie&&je&&oe;return $e&&console.log(" Matched student:",ne.userId||ne.sequenceId,ne.name,{class:Te,section:ve,year:We}),$e});console.log(` Filtered students for Class ${i}-${d} (Year: ${e}): ${ie.length}`),g(ie),v(ie)}else console.log(" API response not successful:",be.data)}catch(K){console.error(" Error fetching students:",K)}finally{O(!1)}},[i,d,e]),H=he=>{if(he){const K=new Set(N.map(be=>be.userId||be.sequenceId));y(K)}else y(new Set)},te=(he,K)=>{const be=new Set(w);K?be.add(he):be.delete(he),y(be)},fe=N.length>0&&N.every(he=>w.has(he.userId||he.sequenceId));j.useEffect(()=>{if(!m.trim()){v(f);return}const he=m.toLowerCase(),K=f.filter(be=>{const re=`${be.name?.firstName||""} ${be.name?.lastName||""}`.toLowerCase(),ie=be.sequenceId?.toLowerCase()||"",ne=be.email?.toLowerCase()||"";return re.includes(he)||ie.includes(he)||ne.includes(he)});v(K)},[m,f]),j.useEffect(()=>{i&&d?(Y(),A(!1),y(new Set)):(g([]),v([]),A(!1),y(new Set))},[i,d,e,Y]);const Le=async()=>{const{schoolCode:he}=W();if(!he)return;if(w.size===0){alert("Please select at least one student to promote.");return}const K=w.size,be=N.length-K;let re="";if(X)re=`Are you sure you want to mark ${K} student(s) from Class ${i}-${d} as PASSED OUT?

They will be moved to Alumni and marked as inactive.`,be>0&&(re+=`

${be} student(s) will remain in the same class.`);else{const ie=U(i);re=`Are you sure you want to promote ${K} student(s) from Class ${i}-${d} to Class ${ie}?`,be>0&&(re+=`

${be} student(s) will remain in the same class.`)}if(confirm(re))try{C(!0);const ie=N.filter(Te=>!w.has(Te.userId||Te.sequenceId)).map(Te=>Te.userId||Te.sequenceId),ne=await ot.post(`/admin/promotion/${he}/section`,{fromYear:e,toYear:n,className:i,section:d,holdBackSequenceIds:ie,graduateStudents:X});if(ne.data.success){let Te=`Successfully promoted ${K} student(s)!${be>0?` ${be} student(s) held back.`:""}`;ne.data.data?.warning&&(Te+=`

 ${ne.data.data.warning}`),alert(Te),l(""),u(""),g([]),v([]),y(new Set),A(!1),p(""),F(null)}else alert(ne.data.message||"Failed to promote students")}catch(ie){console.error("Error promoting students:",ie);const ne=ie.response?.data?.message||"Failed to promote students",Te=ie.response?.data?.details;Te?.suggestion?alert(`${ne}

${Te.suggestion}`):alert(ne)}finally{C(!1)}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Student Promotion System"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Promote students to the next academic year"})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-2",children:"Promote From:"}),r.jsxs("select",{value:e,onChange:he=>t(he.target.value),className:"w-full border border-blue-300 rounded-lg px-3 py-2 bg-white focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"2023-24",children:"2023-24"}),r.jsx("option",{value:"2024-25",children:"2024-25"}),r.jsx("option",{value:"2025-26",children:"2025-26"})]})]}),r.jsx("div",{className:"flex justify-center",children:r.jsx(M6,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-2",children:"Promote To:"}),r.jsx("input",{type:"text",value:n,disabled:!0,className:"w-full border border-blue-300 rounded-lg px-3 py-2 bg-gray-100 text-gray-700"})]})]})}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[r.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Select Class & Section"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),r.jsxs("select",{value:i,onChange:he=>{l(he.target.value),u("")},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select a class..."}),a.sort((he,K)=>{const be=se.indexOf(he.className),re=se.indexOf(K.className);return be!==-1&&re!==-1?be-re:be!==-1?-1:re!==-1?1:he.className.localeCompare(K.className)}).map(he=>r.jsxs("option",{value:he.className,children:["Class ",he.className]},he._id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),r.jsxs("select",{value:d,onChange:he=>u(he.target.value),disabled:!i,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",children:[r.jsx("option",{value:"",children:"Select a section..."}),ee?.sections.sort().map(he=>r.jsxs("option",{value:he,children:["Section ",he]},he))]})]})]}),L&&r.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-300 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx(Zo,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"text-sm font-semibold text-blue-800 mb-2",children:"Final Year Class Detected"}),r.jsxs("p",{className:"text-sm text-blue-700 mb-3",children:["Class ",i," is the final year in your school. The next class (Class ",U(i),") is not configured."]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{type:"radio",name:"promotionMode",checked:!X,onChange:()=>me(!1),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300",disabled:!0}),r.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Promote to Next Class (Not Available)"})]}),r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{type:"radio",name:"promotionMode",checked:X,onChange:()=>me(!0),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),r.jsx("span",{className:"ml-2 text-sm font-medium text-blue-900",children:"Mark as Passed Out / Alumni"})]})]}),r.jsx("p",{className:"text-xs text-blue-600 mt-2",children:' Students marked as "Passed Out" will be moved to Alumni and marked as inactive.'})]})]})}),i&&d&&r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Students"}),r.jsxs("div",{className:"relative",children:[r.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),r.jsx("input",{type:"text",value:m,onChange:he=>p(he.target.value),placeholder:"Search by name, sequence ID, or email...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),E?r.jsxs("div",{className:"flex items-center justify-center py-8",children:[r.jsx(z6,{className:"h-6 w-6 animate-spin text-blue-600"}),r.jsx("span",{className:"ml-2 text-gray-600",children:"Loading students..."})]}):N.length>0?r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:r.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[N.length," student(s) found",w.size>0&&r.jsxs("span",{className:"ml-2 text-blue-600 font-semibold",children:["(",w.size," selected for promotion)"]})]})}),r.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:r.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50 sticky top-0",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-center",children:r.jsx("input",{type:"checkbox",checked:fe,onChange:he=>H(he.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer",title:"Select/Deselect All"})}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Seq ID"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Current Class"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Academic Year"}),T&&r.jsxs(r.Fragment,{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Promoted To"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"New Year"})]})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(he=>{const K=he.userId||he.sequenceId,be=w.has(K);return r.jsxs("tr",{className:`hover:bg-gray-50 ${be?"bg-blue-50":""}`,children:[r.jsx("td",{className:"px-4 py-3 text-center",children:r.jsx("input",{type:"checkbox",checked:be,onChange:re=>te(K,re.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:K}),r.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[he.name?.firstName," ",he.name?.lastName]}),r.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[he.studentDetails?.currentClass,"-",he.studentDetails?.currentSection]}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:he.studentDetails?.academicYear||e}),T&&r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:be?X?r.jsx("span",{className:"text-purple-600 font-semibold",children:" Passed Out"}):r.jsx("span",{className:"text-green-600",children:U(he.studentDetails?.currentClass)}):r.jsxs("span",{className:"text-orange-600",children:[he.studentDetails?.currentClass," (Held Back)"]})}),r.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:be?X?r.jsx("span",{className:"text-purple-600",children:"Alumni"}):r.jsx("span",{className:"text-green-600",children:n}):r.jsx("span",{className:"text-orange-600",children:n})})]})]},K)})})]})})}),r.jsx("div",{className:"flex gap-3",children:T?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>A(!1),className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Cancel Preview"}),r.jsxs("button",{onClick:Le,disabled:I||w.size===0,className:`flex-1 ${X?"bg-purple-600 hover:bg-purple-700":"bg-green-600 hover:bg-green-700"} text-white px-6 py-3 rounded-lg font-medium disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2`,children:[r.jsx(ba,{className:"h-5 w-5"}),I?X?"Processing...":"Promoting...":X?`Mark as Passed Out (${w.size})`:`Confirm Promotion (${w.size})`]})]}):r.jsxs("button",{onClick:()=>A(!0),disabled:w.size===0||!R&&!X,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 disabled:bg-gray-400 disabled:cursor-not-allowed",title:!R&&!X?"Please select graduation mode":"",children:[r.jsx(wn,{className:"h-5 w-5"}),X?"Preview Pass Out":"Preview Promotion"," ",w.size>0&&`(${w.size})`]})})]}):i&&d?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx($n,{className:"h-12 w-12 mx-auto mb-2 text-gray-400"}),r.jsxs("p",{children:["No students found for Class ",i,"-",d]}),r.jsxs("p",{className:"text-sm",children:["in academic year ",e]})]}):null]})]})};var eo={},$o={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l4;function MZ(){if(l4)return $o;l4=1;var e=Su();function t(D){for(var q="https://reactjs.org/docs/error-decoder.html?invariant="+D,Z=1;Z<arguments.length;Z++)q+="&args[]="+encodeURIComponent(arguments[Z]);return"Minified React error #"+D+"; visit "+q+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=Object.prototype.hasOwnProperty,a=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,s={},i={};function l(D){return n.call(i,D)?!0:n.call(s,D)?!1:a.test(D)?i[D]=!0:(s[D]=!0,!1)}function d(D,q,Z,ce,Fe,De,Ze){this.acceptsBooleans=q===2||q===3||q===4,this.attributeName=ce,this.attributeNamespace=Fe,this.mustUseProperty=Z,this.propertyName=D,this.type=q,this.sanitizeURL=De,this.removeEmptyString=Ze}var u={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(D){u[D]=new d(D,0,!1,D,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(D){var q=D[0];u[q]=new d(q,1,!1,D[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(D){u[D]=new d(D,2,!1,D.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(D){u[D]=new d(D,2,!1,D,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(D){u[D]=new d(D,3,!1,D.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(D){u[D]=new d(D,3,!0,D,null,!1,!1)}),["capture","download"].forEach(function(D){u[D]=new d(D,4,!1,D,null,!1,!1)}),["cols","rows","size","span"].forEach(function(D){u[D]=new d(D,6,!1,D,null,!1,!1)}),["rowSpan","start"].forEach(function(D){u[D]=new d(D,5,!1,D.toLowerCase(),null,!1,!1)});var m=/[\-:]([a-z])/g;function p(D){return D[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(D){var q=D.replace(m,p);u[q]=new d(q,1,!1,D,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(D){var q=D.replace(m,p);u[q]=new d(q,1,!1,D,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(D){var q=D.replace(m,p);u[q]=new d(q,1,!1,D,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(D){u[D]=new d(D,1,!1,D.toLowerCase(),null,!1,!1)}),u.xlinkHref=new d("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(D){u[D]=new d(D,1,!1,D.toLowerCase(),null,!0,!0)});var f={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},g=["Webkit","ms","Moz","O"];Object.keys(f).forEach(function(D){g.forEach(function(q){q=q+D.charAt(0).toUpperCase()+D.substring(1),f[q]=f[D]})});var N=/["'&<>]/;function v(D){if(typeof D=="boolean"||typeof D=="number")return""+D;D=""+D;var q=N.exec(D);if(q){var Z="",ce,Fe=0;for(ce=q.index;ce<D.length;ce++){switch(D.charCodeAt(ce)){case 34:q="&quot;";break;case 38:q="&amp;";break;case 39:q="&#x27;";break;case 60:q="&lt;";break;case 62:q="&gt;";break;default:continue}Fe!==ce&&(Z+=D.substring(Fe,ce)),Fe=ce+1,Z+=q}D=Fe!==ce?Z+D.substring(Fe,ce):Z}return D}var w=/([A-Z])/g,y=/^ms-/,E=Array.isArray;function O(D,q){return{insertionMode:D,selectedValue:q}}function T(D,q,Z){switch(q){case"select":return O(1,Z.value!=null?Z.value:Z.defaultValue);case"svg":return O(2,null);case"math":return O(3,null);case"foreignObject":return O(1,null);case"table":return O(4,null);case"thead":case"tbody":case"tfoot":return O(5,null);case"colgroup":return O(7,null);case"tr":return O(6,null)}return 4<=D.insertionMode||D.insertionMode===0?O(1,null):D}var A=new Map;function I(D,q,Z){if(typeof Z!="object")throw Error(t(62));q=!0;for(var ce in Z)if(n.call(Z,ce)){var Fe=Z[ce];if(Fe!=null&&typeof Fe!="boolean"&&Fe!==""){if(ce.indexOf("--")===0){var De=v(ce);Fe=v((""+Fe).trim())}else{De=ce;var Ze=A.get(De);Ze!==void 0||(Ze=v(De.replace(w,"-$1").toLowerCase().replace(y,"-ms-")),A.set(De,Ze)),De=Ze,Fe=typeof Fe=="number"?Fe===0||n.call(f,ce)?""+Fe:Fe+"px":v((""+Fe).trim())}q?(q=!1,D.push(' style="',De,":",Fe)):D.push(";",De,":",Fe)}}q||D.push('"')}function C(D,q,Z,ce){switch(Z){case"style":I(D,q,ce);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<Z.length)||Z[0]!=="o"&&Z[0]!=="O"||Z[1]!=="n"&&Z[1]!=="N"){if(q=u.hasOwnProperty(Z)?u[Z]:null,q!==null){switch(typeof ce){case"function":case"symbol":return;case"boolean":if(!q.acceptsBooleans)return}switch(Z=q.attributeName,q.type){case 3:ce&&D.push(" ",Z,'=""');break;case 4:ce===!0?D.push(" ",Z,'=""'):ce!==!1&&D.push(" ",Z,'="',v(ce),'"');break;case 5:isNaN(ce)||D.push(" ",Z,'="',v(ce),'"');break;case 6:!isNaN(ce)&&1<=ce&&D.push(" ",Z,'="',v(ce),'"');break;default:q.sanitizeURL&&(ce=""+ce),D.push(" ",Z,'="',v(ce),'"')}}else if(l(Z)){switch(typeof ce){case"function":case"symbol":return;case"boolean":if(q=Z.toLowerCase().slice(0,5),q!=="data-"&&q!=="aria-")return}D.push(" ",Z,'="',v(ce),'"')}}}function P(D,q,Z){if(q!=null){if(Z!=null)throw Error(t(60));if(typeof q!="object"||!("__html"in q))throw Error(t(61));q=q.__html,q!=null&&D.push(""+q)}}function F(D){var q="";return e.Children.forEach(D,function(Z){Z!=null&&(q+=Z)}),q}function R(D,q,Z,ce){D.push(G(Z));var Fe=Z=null,De;for(De in q)if(n.call(q,De)){var Ze=q[De];if(Ze!=null)switch(De){case"children":Z=Ze;break;case"dangerouslySetInnerHTML":Fe=Ze;break;default:C(D,ce,De,Ze)}}return D.push(">"),P(D,Fe,Z),typeof Z=="string"?(D.push(v(Z)),null):Z}var $=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,L=new Map;function G(D){var q=L.get(D);if(q===void 0){if(!$.test(D))throw Error(t(65,D));q="<"+D,L.set(D,q)}return q}function X(D,q,Z,ce,Fe){switch(q){case"select":D.push(G("select"));var De=null,Ze=null;for(ar in Z)if(n.call(Z,ar)){var bt=Z[ar];if(bt!=null)switch(ar){case"children":De=bt;break;case"dangerouslySetInnerHTML":Ze=bt;break;case"defaultValue":case"value":break;default:C(D,ce,ar,bt)}}return D.push(">"),P(D,Ze,De),De;case"option":Ze=Fe.selectedValue,D.push(G("option"));var St=bt=null,Kt=null,ar=null;for(De in Z)if(n.call(Z,De)){var _r=Z[De];if(_r!=null)switch(De){case"children":bt=_r;break;case"selected":Kt=_r;break;case"dangerouslySetInnerHTML":ar=_r;break;case"value":St=_r;default:C(D,ce,De,_r)}}if(Ze!=null)if(Z=St!==null?""+St:F(bt),E(Ze)){for(ce=0;ce<Ze.length;ce++)if(""+Ze[ce]===Z){D.push(' selected=""');break}}else""+Ze===Z&&D.push(' selected=""');else Kt&&D.push(' selected=""');return D.push(">"),P(D,ar,bt),bt;case"textarea":D.push(G("textarea")),ar=Ze=De=null;for(bt in Z)if(n.call(Z,bt)&&(St=Z[bt],St!=null))switch(bt){case"children":ar=St;break;case"value":De=St;break;case"defaultValue":Ze=St;break;case"dangerouslySetInnerHTML":throw Error(t(91));default:C(D,ce,bt,St)}if(De===null&&Ze!==null&&(De=Ze),D.push(">"),ar!=null){if(De!=null)throw Error(t(92));if(E(ar)&&1<ar.length)throw Error(t(93));De=""+ar}return typeof De=="string"&&De[0]===`
`&&D.push(`
`),De!==null&&D.push(v(""+De)),null;case"input":D.push(G("input")),St=ar=bt=De=null;for(Ze in Z)if(n.call(Z,Ze)&&(Kt=Z[Ze],Kt!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,"input"));case"defaultChecked":St=Kt;break;case"defaultValue":bt=Kt;break;case"checked":ar=Kt;break;case"value":De=Kt;break;default:C(D,ce,Ze,Kt)}return ar!==null?C(D,ce,"checked",ar):St!==null&&C(D,ce,"checked",St),De!==null?C(D,ce,"value",De):bt!==null&&C(D,ce,"value",bt),D.push("/>"),null;case"menuitem":D.push(G("menuitem"));for(var ea in Z)if(n.call(Z,ea)&&(De=Z[ea],De!=null))switch(ea){case"children":case"dangerouslySetInnerHTML":throw Error(t(400));default:C(D,ce,ea,De)}return D.push(">"),null;case"title":D.push(G("title")),De=null;for(_r in Z)if(n.call(Z,_r)&&(Ze=Z[_r],Ze!=null))switch(_r){case"children":De=Ze;break;case"dangerouslySetInnerHTML":throw Error(t(434));default:C(D,ce,_r,Ze)}return D.push(">"),De;case"listing":case"pre":D.push(G(q)),Ze=De=null;for(St in Z)if(n.call(Z,St)&&(bt=Z[St],bt!=null))switch(St){case"children":De=bt;break;case"dangerouslySetInnerHTML":Ze=bt;break;default:C(D,ce,St,bt)}if(D.push(">"),Ze!=null){if(De!=null)throw Error(t(60));if(typeof Ze!="object"||!("__html"in Ze))throw Error(t(61));Z=Ze.__html,Z!=null&&(typeof Z=="string"&&0<Z.length&&Z[0]===`
`?D.push(`
`,Z):D.push(""+Z))}return typeof De=="string"&&De[0]===`
`&&D.push(`
`),De;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":D.push(G(q));for(var ia in Z)if(n.call(Z,ia)&&(De=Z[ia],De!=null))switch(ia){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,q));default:C(D,ce,ia,De)}return D.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return R(D,Z,q,ce);case"html":return Fe.insertionMode===0&&D.push("<!DOCTYPE html>"),R(D,Z,q,ce);default:if(q.indexOf("-")===-1&&typeof Z.is!="string")return R(D,Z,q,ce);D.push(G(q)),Ze=De=null;for(Kt in Z)if(n.call(Z,Kt)&&(bt=Z[Kt],bt!=null))switch(Kt){case"children":De=bt;break;case"dangerouslySetInnerHTML":Ze=bt;break;case"style":I(D,ce,bt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:l(Kt)&&typeof bt!="function"&&typeof bt!="symbol"&&D.push(" ",Kt,'="',v(bt),'"')}return D.push(">"),P(D,Ze,De),De}}function me(D,q,Z){if(D.push('<!--$?--><template id="'),Z===null)throw Error(t(395));return D.push(Z),D.push('"></template>')}function se(D,q,Z,ce){switch(Z.insertionMode){case 0:case 1:return D.push('<div hidden id="'),D.push(q.segmentPrefix),q=ce.toString(16),D.push(q),D.push('">');case 2:return D.push('<svg aria-hidden="true" style="display:none" id="'),D.push(q.segmentPrefix),q=ce.toString(16),D.push(q),D.push('">');case 3:return D.push('<math aria-hidden="true" style="display:none" id="'),D.push(q.segmentPrefix),q=ce.toString(16),D.push(q),D.push('">');case 4:return D.push('<table hidden id="'),D.push(q.segmentPrefix),q=ce.toString(16),D.push(q),D.push('">');case 5:return D.push('<table hidden><tbody id="'),D.push(q.segmentPrefix),q=ce.toString(16),D.push(q),D.push('">');case 6:return D.push('<table hidden><tr id="'),D.push(q.segmentPrefix),q=ce.toString(16),D.push(q),D.push('">');case 7:return D.push('<table hidden><colgroup id="'),D.push(q.segmentPrefix),q=ce.toString(16),D.push(q),D.push('">');default:throw Error(t(397))}}function ee(D,q){switch(q.insertionMode){case 0:case 1:return D.push("</div>");case 2:return D.push("</svg>");case 3:return D.push("</math>");case 4:return D.push("</table>");case 5:return D.push("</tbody></table>");case 6:return D.push("</tr></table>");case 7:return D.push("</colgroup></table>");default:throw Error(t(397))}}var W=/[<\u2028\u2029]/g;function U(D){return JSON.stringify(D).replace(W,function(q){switch(q){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function Q(D,q){return q=q===void 0?"":q,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:q+"P:",segmentPrefix:q+"S:",boundaryPrefix:q+"B:",idPrefix:q,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:D}}function Y(D,q,Z,ce){return Z.generateStaticMarkup?(D.push(v(q)),!1):(q===""?D=ce:(ce&&D.push("<!-- -->"),D.push(v(q)),D=!0),D)}var H=Object.assign,te=Symbol.for("react.element"),fe=Symbol.for("react.portal"),Le=Symbol.for("react.fragment"),he=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),be=Symbol.for("react.provider"),re=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),ne=Symbol.for("react.suspense"),Te=Symbol.for("react.suspense_list"),ve=Symbol.for("react.memo"),We=Symbol.for("react.lazy"),Ie=Symbol.for("react.scope"),je=Symbol.for("react.debug_trace_mode"),oe=Symbol.for("react.legacy_hidden"),$e=Symbol.for("react.default_value"),et=Symbol.iterator;function lt(D){if(D==null)return null;if(typeof D=="function")return D.displayName||D.name||null;if(typeof D=="string")return D;switch(D){case Le:return"Fragment";case fe:return"Portal";case K:return"Profiler";case he:return"StrictMode";case ne:return"Suspense";case Te:return"SuspenseList"}if(typeof D=="object")switch(D.$$typeof){case re:return(D.displayName||"Context")+".Consumer";case be:return(D._context.displayName||"Context")+".Provider";case ie:var q=D.render;return D=D.displayName,D||(D=q.displayName||q.name||"",D=D!==""?"ForwardRef("+D+")":"ForwardRef"),D;case ve:return q=D.displayName||null,q!==null?q:lt(D.type)||"Memo";case We:q=D._payload,D=D._init;try{return lt(D(q))}catch{}}return null}var rt={};function Lt(D,q){if(D=D.contextTypes,!D)return rt;var Z={},ce;for(ce in D)Z[ce]=q[ce];return Z}var kt=null;function Oe(D,q){if(D!==q){D.context._currentValue2=D.parentValue,D=D.parent;var Z=q.parent;if(D===null){if(Z!==null)throw Error(t(401))}else{if(Z===null)throw Error(t(401));Oe(D,Z)}q.context._currentValue2=q.value}}function Nt(D){D.context._currentValue2=D.parentValue,D=D.parent,D!==null&&Nt(D)}function Mt(D){var q=D.parent;q!==null&&Mt(q),D.context._currentValue2=D.value}function rr(D,q){if(D.context._currentValue2=D.parentValue,D=D.parent,D===null)throw Error(t(402));D.depth===q.depth?Oe(D,q):rr(D,q)}function Ft(D,q){var Z=q.parent;if(Z===null)throw Error(t(402));D.depth===Z.depth?Oe(D,Z):Ft(D,Z),q.context._currentValue2=q.value}function cr(D){var q=kt;q!==D&&(q===null?Mt(D):D===null?Nt(q):q.depth===D.depth?Oe(q,D):q.depth>D.depth?rr(q,D):Ft(q,D),kt=D)}var or={isMounted:function(){return!1},enqueueSetState:function(D,q){D=D._reactInternals,D.queue!==null&&D.queue.push(q)},enqueueReplaceState:function(D,q){D=D._reactInternals,D.replace=!0,D.queue=[q]},enqueueForceUpdate:function(){}};function ke(D,q,Z,ce){var Fe=D.state!==void 0?D.state:null;D.updater=or,D.props=Z,D.state=Fe;var De={queue:[],replace:!1};D._reactInternals=De;var Ze=q.contextType;if(D.context=typeof Ze=="object"&&Ze!==null?Ze._currentValue2:ce,Ze=q.getDerivedStateFromProps,typeof Ze=="function"&&(Ze=Ze(Z,Fe),Fe=Ze==null?Fe:H({},Fe,Ze),D.state=Fe),typeof q.getDerivedStateFromProps!="function"&&typeof D.getSnapshotBeforeUpdate!="function"&&(typeof D.UNSAFE_componentWillMount=="function"||typeof D.componentWillMount=="function"))if(q=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),q!==D.state&&or.enqueueReplaceState(D,D.state,null),De.queue!==null&&0<De.queue.length)if(q=De.queue,Ze=De.replace,De.queue=null,De.replace=!1,Ze&&q.length===1)D.state=q[0];else{for(De=Ze?q[0]:D.state,Fe=!0,Ze=Ze?1:0;Ze<q.length;Ze++){var bt=q[Ze];bt=typeof bt=="function"?bt.call(D,De,Z,ce):bt,bt!=null&&(Fe?(Fe=!1,De=H({},De,bt)):H(De,bt))}D.state=De}else De.queue=null}var ht={id:1,overflow:""};function _e(D,q,Z){var ce=D.id;D=D.overflow;var Fe=32-tt(ce)-1;ce&=~(1<<Fe),Z+=1;var De=32-tt(q)+Fe;if(30<De){var Ze=Fe-Fe%5;return De=(ce&(1<<Ze)-1).toString(32),ce>>=Ze,Fe-=Ze,{id:1<<32-tt(q)+Fe|Z<<Fe|ce,overflow:De+D}}return{id:1<<De|Z<<Fe|ce,overflow:D}}var tt=Math.clz32?Math.clz32:Ot,gt=Math.log,Pt=Math.LN2;function Ot(D){return D>>>=0,D===0?32:31-(gt(D)/Pt|0)|0}function vt(D,q){return D===q&&(D!==0||1/D===1/q)||D!==D&&q!==q}var nr=typeof Object.is=="function"?Object.is:vt,Yt=null,Or=null,Sr=null,$t=null,gr=!1,kr=!1,b=0,B=null,Pe=0;function Se(){if(Yt===null)throw Error(t(321));return Yt}function Ae(){if(0<Pe)throw Error(t(312));return{memoizedState:null,queue:null,next:null}}function Xe(){return $t===null?Sr===null?(gr=!1,Sr=$t=Ae()):(gr=!0,$t=Sr):$t.next===null?(gr=!1,$t=$t.next=Ae()):(gr=!0,$t=$t.next),$t}function Ke(){Or=Yt=null,kr=!1,Sr=null,Pe=0,$t=B=null}function Ve(D,q){return typeof q=="function"?q(D):q}function ut(D,q,Z){if(Yt=Se(),$t=Xe(),gr){var ce=$t.queue;if(q=ce.dispatch,B!==null&&(Z=B.get(ce),Z!==void 0)){B.delete(ce),ce=$t.memoizedState;do ce=D(ce,Z.action),Z=Z.next;while(Z!==null);return $t.memoizedState=ce,[ce,q]}return[$t.memoizedState,q]}return D=D===Ve?typeof q=="function"?q():q:Z!==void 0?Z(q):q,$t.memoizedState=D,D=$t.queue={last:null,dispatch:null},D=D.dispatch=ae.bind(null,Yt,D),[$t.memoizedState,D]}function Je(D,q){if(Yt=Se(),$t=Xe(),q=q===void 0?null:q,$t!==null){var Z=$t.memoizedState;if(Z!==null&&q!==null){var ce=Z[1];e:if(ce===null)ce=!1;else{for(var Fe=0;Fe<ce.length&&Fe<q.length;Fe++)if(!nr(q[Fe],ce[Fe])){ce=!1;break e}ce=!0}if(ce)return Z[0]}}return D=D(),$t.memoizedState=[D,q],D}function ae(D,q,Z){if(25<=Pe)throw Error(t(301));if(D===Yt)if(kr=!0,D={action:Z,next:null},B===null&&(B=new Map),Z=B.get(q),Z===void 0)B.set(q,D);else{for(q=Z;q.next!==null;)q=q.next;q.next=D}}function ct(){throw Error(t(394))}function st(){}var dt={readContext:function(D){return D._currentValue2},useContext:function(D){return Se(),D._currentValue2},useMemo:Je,useReducer:ut,useRef:function(D){Yt=Se(),$t=Xe();var q=$t.memoizedState;return q===null?(D={current:D},$t.memoizedState=D):q},useState:function(D){return ut(Ve,D)},useInsertionEffect:st,useLayoutEffect:function(){},useCallback:function(D,q){return Je(function(){return D},q)},useImperativeHandle:st,useEffect:st,useDebugValue:st,useDeferredValue:function(D){return Se(),D},useTransition:function(){return Se(),[!1,ct]},useId:function(){var D=Or.treeContext,q=D.overflow;D=D.id,D=(D&~(1<<32-tt(D)-1)).toString(32)+q;var Z=it;if(Z===null)throw Error(t(404));return q=b++,D=":"+Z.idPrefix+"R"+D,0<q&&(D+="H"+q.toString(32)),D+":"},useMutableSource:function(D,q){return Se(),q(D._source)},useSyncExternalStore:function(D,q,Z){if(Z===void 0)throw Error(t(407));return Z()}},it=null,xt=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Bt(D){return console.error(D),null}function qt(){}function Ar(D,q,Z,ce,Fe,De,Ze,bt,St){var Kt=[],ar=new Set;return q={destination:null,responseState:q,progressiveChunkSize:ce===void 0?12800:ce,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:ar,pingedTasks:Kt,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Fe===void 0?Bt:Fe,onAllReady:qt,onShellReady:Ze===void 0?qt:Ze,onShellError:qt,onFatalError:qt},Z=gn(q,0,null,Z,!1,!1),Z.parentFlushed=!0,D=Ir(q,D,null,Z,ar,rt,null,ht),Kt.push(D),q}function Ir(D,q,Z,ce,Fe,De,Ze,bt){D.allPendingTasks++,Z===null?D.pendingRootTasks++:Z.pendingTasks++;var St={node:q,ping:function(){var Kt=D.pingedTasks;Kt.push(St),Kt.length===1&&yn(D)},blockedBoundary:Z,blockedSegment:ce,abortSet:Fe,legacyContext:De,context:Ze,treeContext:bt};return Fe.add(St),St}function gn(D,q,Z,ce,Fe,De){return{status:0,id:-1,index:q,parentFlushed:!1,chunks:[],children:[],formatContext:ce,boundary:Z,lastPushedText:Fe,textEmbedded:De}}function sn(D,q){if(D=D.onError(q),D!=null&&typeof D!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof D+'" instead');return D}function Ht(D,q){var Z=D.onShellError;Z(q),Z=D.onFatalError,Z(q),D.destination!==null?(D.status=2,D.destination.destroy(q)):(D.status=1,D.fatalError=q)}function Dr(D,q,Z,ce,Fe){for(Yt={},Or=q,b=0,D=Z(ce,Fe);kr;)kr=!1,b=0,Pe+=1,$t=null,D=Z(ce,Fe);return Ke(),D}function dr(D,q,Z,ce){var Fe=Z.render(),De=ce.childContextTypes;if(De!=null){var Ze=q.legacyContext;if(typeof Z.getChildContext!="function")ce=Ze;else{Z=Z.getChildContext();for(var bt in Z)if(!(bt in De))throw Error(t(108,lt(ce)||"Unknown",bt));ce=H({},Ze,Z)}q.legacyContext=ce,Nr(D,q,Fe),q.legacyContext=Ze}else Nr(D,q,Fe)}function Vt(D,q){if(D&&D.defaultProps){q=H({},q),D=D.defaultProps;for(var Z in D)q[Z]===void 0&&(q[Z]=D[Z]);return q}return q}function er(D,q,Z,ce,Fe){if(typeof Z=="function")if(Z.prototype&&Z.prototype.isReactComponent){Fe=Lt(Z,q.legacyContext);var De=Z.contextType;De=new Z(ce,typeof De=="object"&&De!==null?De._currentValue2:Fe),ke(De,Z,ce,Fe),dr(D,q,De,Z)}else{De=Lt(Z,q.legacyContext),Fe=Dr(D,q,Z,ce,De);var Ze=b!==0;if(typeof Fe=="object"&&Fe!==null&&typeof Fe.render=="function"&&Fe.$$typeof===void 0)ke(Fe,Z,ce,De),dr(D,q,Fe,Z);else if(Ze){ce=q.treeContext,q.treeContext=_e(ce,1,0);try{Nr(D,q,Fe)}finally{q.treeContext=ce}}else Nr(D,q,Fe)}else if(typeof Z=="string"){switch(Fe=q.blockedSegment,De=X(Fe.chunks,Z,ce,D.responseState,Fe.formatContext),Fe.lastPushedText=!1,Ze=Fe.formatContext,Fe.formatContext=T(Ze,Z,ce),dn(D,q,De),Fe.formatContext=Ze,Z){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Fe.chunks.push("</",Z,">")}Fe.lastPushedText=!1}else{switch(Z){case oe:case je:case he:case K:case Le:Nr(D,q,ce.children);return;case Te:Nr(D,q,ce.children);return;case Ie:throw Error(t(343));case ne:e:{Z=q.blockedBoundary,Fe=q.blockedSegment,De=ce.fallback,ce=ce.children,Ze=new Set;var bt={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Ze,errorDigest:null},St=gn(D,Fe.chunks.length,bt,Fe.formatContext,!1,!1);Fe.children.push(St),Fe.lastPushedText=!1;var Kt=gn(D,0,null,Fe.formatContext,!1,!1);Kt.parentFlushed=!0,q.blockedBoundary=bt,q.blockedSegment=Kt;try{if(dn(D,q,ce),D.responseState.generateStaticMarkup||Kt.lastPushedText&&Kt.textEmbedded&&Kt.chunks.push("<!-- -->"),Kt.status=1,jn(bt,Kt),bt.pendingTasks===0)break e}catch(ar){Kt.status=4,bt.forceClientRender=!0,bt.errorDigest=sn(D,ar)}finally{q.blockedBoundary=Z,q.blockedSegment=Fe}q=Ir(D,De,Z,St,Ze,q.legacyContext,q.context,q.treeContext),D.pingedTasks.push(q)}return}if(typeof Z=="object"&&Z!==null)switch(Z.$$typeof){case ie:if(ce=Dr(D,q,Z.render,ce,Fe),b!==0){Z=q.treeContext,q.treeContext=_e(Z,1,0);try{Nr(D,q,ce)}finally{q.treeContext=Z}}else Nr(D,q,ce);return;case ve:Z=Z.type,ce=Vt(Z,ce),er(D,q,Z,ce,Fe);return;case be:if(Fe=ce.children,Z=Z._context,ce=ce.value,De=Z._currentValue2,Z._currentValue2=ce,Ze=kt,kt=ce={parent:Ze,depth:Ze===null?0:Ze.depth+1,context:Z,parentValue:De,value:ce},q.context=ce,Nr(D,q,Fe),D=kt,D===null)throw Error(t(403));ce=D.parentValue,D.context._currentValue2=ce===$e?D.context._defaultValue:ce,D=kt=D.parent,q.context=D;return;case re:ce=ce.children,ce=ce(Z._currentValue2),Nr(D,q,ce);return;case We:Fe=Z._init,Z=Fe(Z._payload),ce=Vt(Z,ce),er(D,q,Z,ce,void 0);return}throw Error(t(130,Z==null?Z:typeof Z,""))}}function Nr(D,q,Z){if(q.node=Z,typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case te:er(D,q,Z.type,Z.props,Z.ref);return;case fe:throw Error(t(257));case We:var ce=Z._init;Z=ce(Z._payload),Nr(D,q,Z);return}if(E(Z)){xn(D,q,Z);return}if(Z===null||typeof Z!="object"?ce=null:(ce=et&&Z[et]||Z["@@iterator"],ce=typeof ce=="function"?ce:null),ce&&(ce=ce.call(Z))){if(Z=ce.next(),!Z.done){var Fe=[];do Fe.push(Z.value),Z=ce.next();while(!Z.done);xn(D,q,Fe)}return}throw D=Object.prototype.toString.call(Z),Error(t(31,D==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":D))}typeof Z=="string"?(ce=q.blockedSegment,ce.lastPushedText=Y(q.blockedSegment.chunks,Z,D.responseState,ce.lastPushedText)):typeof Z=="number"&&(ce=q.blockedSegment,ce.lastPushedText=Y(q.blockedSegment.chunks,""+Z,D.responseState,ce.lastPushedText))}function xn(D,q,Z){for(var ce=Z.length,Fe=0;Fe<ce;Fe++){var De=q.treeContext;q.treeContext=_e(De,ce,Fe);try{dn(D,q,Z[Fe])}finally{q.treeContext=De}}}function dn(D,q,Z){var ce=q.blockedSegment.formatContext,Fe=q.legacyContext,De=q.context;try{return Nr(D,q,Z)}catch(St){if(Ke(),typeof St=="object"&&St!==null&&typeof St.then=="function"){Z=St;var Ze=q.blockedSegment,bt=gn(D,Ze.chunks.length,null,Ze.formatContext,Ze.lastPushedText,!0);Ze.children.push(bt),Ze.lastPushedText=!1,D=Ir(D,q.node,q.blockedBoundary,bt,q.abortSet,q.legacyContext,q.context,q.treeContext).ping,Z.then(D,D),q.blockedSegment.formatContext=ce,q.legacyContext=Fe,q.context=De,cr(De)}else throw q.blockedSegment.formatContext=ce,q.legacyContext=Fe,q.context=De,cr(De),St}}function Qn(D){var q=D.blockedBoundary;D=D.blockedSegment,D.status=3,Fn(this,q,D)}function js(D,q,Z){var ce=D.blockedBoundary;D.blockedSegment.status=3,ce===null?(q.allPendingTasks--,q.status!==2&&(q.status=2,q.destination!==null&&q.destination.push(null))):(ce.pendingTasks--,ce.forceClientRender||(ce.forceClientRender=!0,D=Z===void 0?Error(t(432)):Z,ce.errorDigest=q.onError(D),ce.parentFlushed&&q.clientRenderedBoundaries.push(ce)),ce.fallbackAbortableTasks.forEach(function(Fe){return js(Fe,q,Z)}),ce.fallbackAbortableTasks.clear(),q.allPendingTasks--,q.allPendingTasks===0&&(ce=q.onAllReady,ce()))}function jn(D,q){if(q.chunks.length===0&&q.children.length===1&&q.children[0].boundary===null){var Z=q.children[0];Z.id=q.id,Z.parentFlushed=!0,Z.status===1&&jn(D,Z)}else D.completedSegments.push(q)}function Fn(D,q,Z){if(q===null){if(Z.parentFlushed){if(D.completedRootSegment!==null)throw Error(t(389));D.completedRootSegment=Z}D.pendingRootTasks--,D.pendingRootTasks===0&&(D.onShellError=qt,q=D.onShellReady,q())}else q.pendingTasks--,q.forceClientRender||(q.pendingTasks===0?(Z.parentFlushed&&Z.status===1&&jn(q,Z),q.parentFlushed&&D.completedBoundaries.push(q),q.fallbackAbortableTasks.forEach(Qn,D),q.fallbackAbortableTasks.clear()):Z.parentFlushed&&Z.status===1&&(jn(q,Z),q.completedSegments.length===1&&q.parentFlushed&&D.partialBoundaries.push(q)));D.allPendingTasks--,D.allPendingTasks===0&&(D=D.onAllReady,D())}function yn(D){if(D.status!==2){var q=kt,Z=xt.current;xt.current=dt;var ce=it;it=D.responseState;try{var Fe=D.pingedTasks,De;for(De=0;De<Fe.length;De++){var Ze=Fe[De],bt=D,St=Ze.blockedSegment;if(St.status===0){cr(Ze.context);try{Nr(bt,Ze,Ze.node),bt.responseState.generateStaticMarkup||St.lastPushedText&&St.textEmbedded&&St.chunks.push("<!-- -->"),Ze.abortSet.delete(Ze),St.status=1,Fn(bt,Ze.blockedBoundary,St)}catch(Un){if(Ke(),typeof Un=="object"&&Un!==null&&typeof Un.then=="function"){var Kt=Ze.ping;Un.then(Kt,Kt)}else{Ze.abortSet.delete(Ze),St.status=4;var ar=Ze.blockedBoundary,_r=Un,ea=sn(bt,_r);if(ar===null?Ht(bt,_r):(ar.pendingTasks--,ar.forceClientRender||(ar.forceClientRender=!0,ar.errorDigest=ea,ar.parentFlushed&&bt.clientRenderedBoundaries.push(ar))),bt.allPendingTasks--,bt.allPendingTasks===0){var ia=bt.onAllReady;ia()}}}finally{}}}Fe.splice(0,De),D.destination!==null&&Bn(D,D.destination)}catch(Un){sn(D,Un),Ht(D,Un)}finally{it=ce,xt.current=Z,Z===dt&&cr(q)}}}function Tn(D,q,Z){switch(Z.parentFlushed=!0,Z.status){case 0:var ce=Z.id=D.nextSegmentId++;return Z.lastPushedText=!1,Z.textEmbedded=!1,D=D.responseState,q.push('<template id="'),q.push(D.placeholderPrefix),D=ce.toString(16),q.push(D),q.push('"></template>');case 1:Z.status=2;var Fe=!0;ce=Z.chunks;var De=0;Z=Z.children;for(var Ze=0;Ze<Z.length;Ze++){for(Fe=Z[Ze];De<Fe.index;De++)q.push(ce[De]);Fe=on(D,q,Fe)}for(;De<ce.length-1;De++)q.push(ce[De]);return De<ce.length&&(Fe=q.push(ce[De])),Fe;default:throw Error(t(390))}}function on(D,q,Z){var ce=Z.boundary;if(ce===null)return Tn(D,q,Z);if(ce.parentFlushed=!0,ce.forceClientRender)return D.responseState.generateStaticMarkup||(ce=ce.errorDigest,q.push("<!--$!-->"),q.push("<template"),ce&&(q.push(' data-dgst="'),ce=v(ce),q.push(ce),q.push('"')),q.push("></template>")),Tn(D,q,Z),D=D.responseState.generateStaticMarkup?!0:q.push("<!--/$-->"),D;if(0<ce.pendingTasks){ce.rootSegmentID=D.nextSegmentId++,0<ce.completedSegments.length&&D.partialBoundaries.push(ce);var Fe=D.responseState,De=Fe.nextSuspenseID++;return Fe=Fe.boundaryPrefix+De.toString(16),ce=ce.id=Fe,me(q,D.responseState,ce),Tn(D,q,Z),q.push("<!--/$-->")}if(ce.byteSize>D.progressiveChunkSize)return ce.rootSegmentID=D.nextSegmentId++,D.completedBoundaries.push(ce),me(q,D.responseState,ce.id),Tn(D,q,Z),q.push("<!--/$-->");if(D.responseState.generateStaticMarkup||q.push("<!--$-->"),Z=ce.completedSegments,Z.length!==1)throw Error(t(391));return on(D,q,Z[0]),D=D.responseState.generateStaticMarkup?!0:q.push("<!--/$-->"),D}function ii(D,q,Z){return se(q,D.responseState,Z.formatContext,Z.id),on(D,q,Z),ee(q,Z.formatContext)}function ns(D,q,Z){for(var ce=Z.completedSegments,Fe=0;Fe<ce.length;Fe++)oi(D,q,Z,ce[Fe]);if(ce.length=0,D=D.responseState,ce=Z.id,Z=Z.rootSegmentID,q.push(D.startInlineScript),D.sentCompleteBoundaryFunction?q.push('$RC("'):(D.sentCompleteBoundaryFunction=!0,q.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),ce===null)throw Error(t(395));return Z=Z.toString(16),q.push(ce),q.push('","'),q.push(D.segmentPrefix),q.push(Z),q.push('")<\/script>')}function oi(D,q,Z,ce){if(ce.status===2)return!0;var Fe=ce.id;if(Fe===-1){if((ce.id=Z.rootSegmentID)===-1)throw Error(t(392));return ii(D,q,ce)}return ii(D,q,ce),D=D.responseState,q.push(D.startInlineScript),D.sentCompleteSegmentFunction?q.push('$RS("'):(D.sentCompleteSegmentFunction=!0,q.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),q.push(D.segmentPrefix),Fe=Fe.toString(16),q.push(Fe),q.push('","'),q.push(D.placeholderPrefix),q.push(Fe),q.push('")<\/script>')}function Bn(D,q){try{var Z=D.completedRootSegment;if(Z!==null&&D.pendingRootTasks===0){on(D,q,Z),D.completedRootSegment=null;var ce=D.responseState.bootstrapChunks;for(Z=0;Z<ce.length-1;Z++)q.push(ce[Z]);Z<ce.length&&q.push(ce[Z])}var Fe=D.clientRenderedBoundaries,De;for(De=0;De<Fe.length;De++){var Ze=Fe[De];ce=q;var bt=D.responseState,St=Ze.id,Kt=Ze.errorDigest,ar=Ze.errorMessage,_r=Ze.errorComponentStack;if(ce.push(bt.startInlineScript),bt.sentClientRenderFunction?ce.push('$RX("'):(bt.sentClientRenderFunction=!0,ce.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),St===null)throw Error(t(395));if(ce.push(St),ce.push('"'),Kt||ar||_r){ce.push(",");var ea=U(Kt||"");ce.push(ea)}if(ar||_r){ce.push(",");var ia=U(ar||"");ce.push(ia)}if(_r){ce.push(",");var Un=U(_r);ce.push(Un)}if(!ce.push(")<\/script>")){D.destination=null,De++,Fe.splice(0,De);return}}Fe.splice(0,De);var Wa=D.completedBoundaries;for(De=0;De<Wa.length;De++)if(!ns(D,q,Wa[De])){D.destination=null,De++,Wa.splice(0,De);return}Wa.splice(0,De);var oa=D.partialBoundaries;for(De=0;De<oa.length;De++){var ta=oa[De];e:{Fe=D,Ze=q;var zn=ta.completedSegments;for(bt=0;bt<zn.length;bt++)if(!oi(Fe,Ze,ta,zn[bt])){bt++,zn.splice(0,bt);var wa=!1;break e}zn.splice(0,bt),wa=!0}if(!wa){D.destination=null,De++,oa.splice(0,De);return}}oa.splice(0,De);var la=D.completedBoundaries;for(De=0;De<la.length;De++)if(!ns(D,q,la[De])){D.destination=null,De++,la.splice(0,De);return}la.splice(0,De)}finally{D.allPendingTasks===0&&D.pingedTasks.length===0&&D.clientRenderedBoundaries.length===0&&D.completedBoundaries.length===0&&q.push(null)}}function Ha(D,q){try{var Z=D.abortableTasks;Z.forEach(function(ce){return js(ce,D,q)}),Z.clear(),D.destination!==null&&Bn(D,D.destination)}catch(ce){sn(D,ce),Ht(D,ce)}}function as(){}function Va(D,q,Z,ce){var Fe=!1,De=null,Ze="",bt={push:function(Kt){return Kt!==null&&(Ze+=Kt),!0},destroy:function(Kt){Fe=!0,De=Kt}},St=!1;if(D=Ar(D,Q(Z,q?q.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,as,void 0,function(){St=!0}),yn(D),Ha(D,ce),D.status===1)D.status=2,bt.destroy(D.fatalError);else if(D.status!==2&&D.destination===null){D.destination=bt;try{Bn(D,bt)}catch(Kt){sn(D,Kt),Ht(D,Kt)}}if(Fe)throw De;if(!St)throw Error(t(426));return Ze}return $o.renderToNodeStream=function(){throw Error(t(207))},$o.renderToStaticMarkup=function(D,q){return Va(D,q,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},$o.renderToStaticNodeStream=function(){throw Error(t(208))},$o.renderToString=function(D,q){return Va(D,q,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},$o.version="18.3.1",$o}var nh={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c4;function RZ(){if(c4)return nh;c4=1;var e=Su();function t(_){for(var z="https://reactjs.org/docs/error-decoder.html?invariant="+_,J=1;J<arguments.length;J++)z+="&args[]="+encodeURIComponent(arguments[J]);return"Minified React error #"+_+"; visit "+z+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=null,a=0;function s(_,z){if(z.length!==0)if(512<z.length)0<a&&(_.enqueue(new Uint8Array(n.buffer,0,a)),n=new Uint8Array(512),a=0),_.enqueue(z);else{var J=n.length-a;J<z.length&&(J===0?_.enqueue(n):(n.set(z.subarray(0,J),a),_.enqueue(n),z=z.subarray(J)),n=new Uint8Array(512),a=0),n.set(z,a),a+=z.length}}function i(_,z){return s(_,z),!0}function l(_){n&&0<a&&(_.enqueue(new Uint8Array(n.buffer,0,a)),n=null,a=0)}var d=new TextEncoder;function u(_){return d.encode(_)}function m(_){return d.encode(_)}function p(_,z){typeof _.error=="function"?_.error(z):_.close()}var f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,N={},v={};function w(_){return f.call(v,_)?!0:f.call(N,_)?!1:g.test(_)?v[_]=!0:(N[_]=!0,!1)}function y(_,z,J,le,Ue,Re,at){this.acceptsBooleans=z===2||z===3||z===4,this.attributeName=le,this.attributeNamespace=Ue,this.mustUseProperty=J,this.propertyName=_,this.type=z,this.sanitizeURL=Re,this.removeEmptyString=at}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(_){E[_]=new y(_,0,!1,_,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(_){var z=_[0];E[z]=new y(z,1,!1,_[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(_){E[_]=new y(_,2,!1,_.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(_){E[_]=new y(_,2,!1,_,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(_){E[_]=new y(_,3,!1,_.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(_){E[_]=new y(_,3,!0,_,null,!1,!1)}),["capture","download"].forEach(function(_){E[_]=new y(_,4,!1,_,null,!1,!1)}),["cols","rows","size","span"].forEach(function(_){E[_]=new y(_,6,!1,_,null,!1,!1)}),["rowSpan","start"].forEach(function(_){E[_]=new y(_,5,!1,_.toLowerCase(),null,!1,!1)});var O=/[\-:]([a-z])/g;function T(_){return _[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(_){var z=_.replace(O,T);E[z]=new y(z,1,!1,_,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(_){var z=_.replace(O,T);E[z]=new y(z,1,!1,_,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(_){var z=_.replace(O,T);E[z]=new y(z,1,!1,_,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(_){E[_]=new y(_,1,!1,_.toLowerCase(),null,!1,!1)}),E.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(_){E[_]=new y(_,1,!1,_.toLowerCase(),null,!0,!0)});var A={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},I=["Webkit","ms","Moz","O"];Object.keys(A).forEach(function(_){I.forEach(function(z){z=z+_.charAt(0).toUpperCase()+_.substring(1),A[z]=A[_]})});var C=/["'&<>]/;function P(_){if(typeof _=="boolean"||typeof _=="number")return""+_;_=""+_;var z=C.exec(_);if(z){var J="",le,Ue=0;for(le=z.index;le<_.length;le++){switch(_.charCodeAt(le)){case 34:z="&quot;";break;case 38:z="&amp;";break;case 39:z="&#x27;";break;case 60:z="&lt;";break;case 62:z="&gt;";break;default:continue}Ue!==le&&(J+=_.substring(Ue,le)),Ue=le+1,J+=z}_=Ue!==le?J+_.substring(Ue,le):J}return _}var F=/([A-Z])/g,R=/^ms-/,$=Array.isArray,L=m("<script>"),G=m("<\/script>"),X=m('<script src="'),me=m('<script type="module" src="'),se=m('" async=""><\/script>'),ee=/(<\/|<)(s)(cript)/gi;function W(_,z,J,le){return""+z+(J==="s"?"\\u0073":"\\u0053")+le}function U(_,z,J,le,Ue){_=_===void 0?"":_,z=z===void 0?L:m('<script nonce="'+P(z)+'">');var Re=[];if(J!==void 0&&Re.push(z,u((""+J).replace(ee,W)),G),le!==void 0)for(J=0;J<le.length;J++)Re.push(X,u(P(le[J])),se);if(Ue!==void 0)for(le=0;le<Ue.length;le++)Re.push(me,u(P(Ue[le])),se);return{bootstrapChunks:Re,startInlineScript:z,placeholderPrefix:m(_+"P:"),segmentPrefix:m(_+"S:"),boundaryPrefix:_+"B:",idPrefix:_,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function Q(_,z){return{insertionMode:_,selectedValue:z}}function Y(_){return Q(_==="http://www.w3.org/2000/svg"?2:_==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function H(_,z,J){switch(z){case"select":return Q(1,J.value!=null?J.value:J.defaultValue);case"svg":return Q(2,null);case"math":return Q(3,null);case"foreignObject":return Q(1,null);case"table":return Q(4,null);case"thead":case"tbody":case"tfoot":return Q(5,null);case"colgroup":return Q(7,null);case"tr":return Q(6,null)}return 4<=_.insertionMode||_.insertionMode===0?Q(1,null):_}var te=m("<!-- -->");function fe(_,z,J,le){return z===""?le:(le&&_.push(te),_.push(u(P(z))),!0)}var Le=new Map,he=m(' style="'),K=m(":"),be=m(";");function re(_,z,J){if(typeof J!="object")throw Error(t(62));z=!0;for(var le in J)if(f.call(J,le)){var Ue=J[le];if(Ue!=null&&typeof Ue!="boolean"&&Ue!==""){if(le.indexOf("--")===0){var Re=u(P(le));Ue=u(P((""+Ue).trim()))}else{Re=le;var at=Le.get(Re);at!==void 0||(at=m(P(Re.replace(F,"-$1").toLowerCase().replace(R,"-ms-"))),Le.set(Re,at)),Re=at,Ue=typeof Ue=="number"?Ue===0||f.call(A,le)?u(""+Ue):u(Ue+"px"):u(P((""+Ue).trim()))}z?(z=!1,_.push(he,Re,K,Ue)):_.push(be,Re,K,Ue)}}z||_.push(Te)}var ie=m(" "),ne=m('="'),Te=m('"'),ve=m('=""');function We(_,z,J,le){switch(J){case"style":re(_,z,le);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<J.length)||J[0]!=="o"&&J[0]!=="O"||J[1]!=="n"&&J[1]!=="N"){if(z=E.hasOwnProperty(J)?E[J]:null,z!==null){switch(typeof le){case"function":case"symbol":return;case"boolean":if(!z.acceptsBooleans)return}switch(J=u(z.attributeName),z.type){case 3:le&&_.push(ie,J,ve);break;case 4:le===!0?_.push(ie,J,ve):le!==!1&&_.push(ie,J,ne,u(P(le)),Te);break;case 5:isNaN(le)||_.push(ie,J,ne,u(P(le)),Te);break;case 6:!isNaN(le)&&1<=le&&_.push(ie,J,ne,u(P(le)),Te);break;default:z.sanitizeURL&&(le=""+le),_.push(ie,J,ne,u(P(le)),Te)}}else if(w(J)){switch(typeof le){case"function":case"symbol":return;case"boolean":if(z=J.toLowerCase().slice(0,5),z!=="data-"&&z!=="aria-")return}_.push(ie,u(J),ne,u(P(le)),Te)}}}var Ie=m(">"),je=m("/>");function oe(_,z,J){if(z!=null){if(J!=null)throw Error(t(60));if(typeof z!="object"||!("__html"in z))throw Error(t(61));z=z.__html,z!=null&&_.push(u(""+z))}}function $e(_){var z="";return e.Children.forEach(_,function(J){J!=null&&(z+=J)}),z}var et=m(' selected=""');function lt(_,z,J,le){_.push(Oe(J));var Ue=J=null,Re;for(Re in z)if(f.call(z,Re)){var at=z[Re];if(at!=null)switch(Re){case"children":J=at;break;case"dangerouslySetInnerHTML":Ue=at;break;default:We(_,le,Re,at)}}return _.push(Ie),oe(_,Ue,J),typeof J=="string"?(_.push(u(P(J))),null):J}var rt=m(`
`),Lt=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,kt=new Map;function Oe(_){var z=kt.get(_);if(z===void 0){if(!Lt.test(_))throw Error(t(65,_));z=m("<"+_),kt.set(_,z)}return z}var Nt=m("<!DOCTYPE html>");function Mt(_,z,J,le,Ue){switch(z){case"select":_.push(Oe("select"));var Re=null,at=null;for(sr in J)if(f.call(J,sr)){var yt=J[sr];if(yt!=null)switch(sr){case"children":Re=yt;break;case"dangerouslySetInnerHTML":at=yt;break;case"defaultValue":case"value":break;default:We(_,le,sr,yt)}}return _.push(Ie),oe(_,at,Re),Re;case"option":at=Ue.selectedValue,_.push(Oe("option"));var Zt=yt=null,fr=null,sr=null;for(Re in J)if(f.call(J,Re)){var Wr=J[Re];if(Wr!=null)switch(Re){case"children":yt=Wr;break;case"selected":fr=Wr;break;case"dangerouslySetInnerHTML":sr=Wr;break;case"value":Zt=Wr;default:We(_,le,Re,Wr)}}if(at!=null)if(J=Zt!==null?""+Zt:$e(yt),$(at)){for(le=0;le<at.length;le++)if(""+at[le]===J){_.push(et);break}}else""+at===J&&_.push(et);else fr&&_.push(et);return _.push(Ie),oe(_,sr,yt),yt;case"textarea":_.push(Oe("textarea")),sr=at=Re=null;for(yt in J)if(f.call(J,yt)&&(Zt=J[yt],Zt!=null))switch(yt){case"children":sr=Zt;break;case"value":Re=Zt;break;case"defaultValue":at=Zt;break;case"dangerouslySetInnerHTML":throw Error(t(91));default:We(_,le,yt,Zt)}if(Re===null&&at!==null&&(Re=at),_.push(Ie),sr!=null){if(Re!=null)throw Error(t(92));if($(sr)&&1<sr.length)throw Error(t(93));Re=""+sr}return typeof Re=="string"&&Re[0]===`
`&&_.push(rt),Re!==null&&_.push(u(P(""+Re))),null;case"input":_.push(Oe("input")),Zt=sr=yt=Re=null;for(at in J)if(f.call(J,at)&&(fr=J[at],fr!=null))switch(at){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,"input"));case"defaultChecked":Zt=fr;break;case"defaultValue":yt=fr;break;case"checked":sr=fr;break;case"value":Re=fr;break;default:We(_,le,at,fr)}return sr!==null?We(_,le,"checked",sr):Zt!==null&&We(_,le,"checked",Zt),Re!==null?We(_,le,"value",Re):yt!==null&&We(_,le,"value",yt),_.push(je),null;case"menuitem":_.push(Oe("menuitem"));for(var ca in J)if(f.call(J,ca)&&(Re=J[ca],Re!=null))switch(ca){case"children":case"dangerouslySetInnerHTML":throw Error(t(400));default:We(_,le,ca,Re)}return _.push(Ie),null;case"title":_.push(Oe("title")),Re=null;for(Wr in J)if(f.call(J,Wr)&&(at=J[Wr],at!=null))switch(Wr){case"children":Re=at;break;case"dangerouslySetInnerHTML":throw Error(t(434));default:We(_,le,Wr,at)}return _.push(Ie),Re;case"listing":case"pre":_.push(Oe(z)),at=Re=null;for(Zt in J)if(f.call(J,Zt)&&(yt=J[Zt],yt!=null))switch(Zt){case"children":Re=yt;break;case"dangerouslySetInnerHTML":at=yt;break;default:We(_,le,Zt,yt)}if(_.push(Ie),at!=null){if(Re!=null)throw Error(t(60));if(typeof at!="object"||!("__html"in at))throw Error(t(61));J=at.__html,J!=null&&(typeof J=="string"&&0<J.length&&J[0]===`
`?_.push(rt,u(J)):_.push(u(""+J)))}return typeof Re=="string"&&Re[0]===`
`&&_.push(rt),Re;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":_.push(Oe(z));for(var Ta in J)if(f.call(J,Ta)&&(Re=J[Ta],Re!=null))switch(Ta){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,z));default:We(_,le,Ta,Re)}return _.push(je),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return lt(_,J,z,le);case"html":return Ue.insertionMode===0&&_.push(Nt),lt(_,J,z,le);default:if(z.indexOf("-")===-1&&typeof J.is!="string")return lt(_,J,z,le);_.push(Oe(z)),at=Re=null;for(fr in J)if(f.call(J,fr)&&(yt=J[fr],yt!=null))switch(fr){case"children":Re=yt;break;case"dangerouslySetInnerHTML":at=yt;break;case"style":re(_,le,yt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:w(fr)&&typeof yt!="function"&&typeof yt!="symbol"&&_.push(ie,u(fr),ne,u(P(yt)),Te)}return _.push(Ie),oe(_,at,Re),Re}}var rr=m("</"),Ft=m(">"),cr=m('<template id="'),or=m('"></template>'),ke=m("<!--$-->"),ht=m('<!--$?--><template id="'),_e=m('"></template>'),tt=m("<!--$!-->"),gt=m("<!--/$-->"),Pt=m("<template"),Ot=m('"'),vt=m(' data-dgst="');m(' data-msg="'),m(' data-stck="');var nr=m("></template>");function Yt(_,z,J){if(s(_,ht),J===null)throw Error(t(395));return s(_,J),i(_,_e)}var Or=m('<div hidden id="'),Sr=m('">'),$t=m("</div>"),gr=m('<svg aria-hidden="true" style="display:none" id="'),kr=m('">'),b=m("</svg>"),B=m('<math aria-hidden="true" style="display:none" id="'),Pe=m('">'),Se=m("</math>"),Ae=m('<table hidden id="'),Xe=m('">'),Ke=m("</table>"),Ve=m('<table hidden><tbody id="'),ut=m('">'),Je=m("</tbody></table>"),ae=m('<table hidden><tr id="'),ct=m('">'),st=m("</tr></table>"),dt=m('<table hidden><colgroup id="'),it=m('">'),xt=m("</colgroup></table>");function Bt(_,z,J,le){switch(J.insertionMode){case 0:case 1:return s(_,Or),s(_,z.segmentPrefix),s(_,u(le.toString(16))),i(_,Sr);case 2:return s(_,gr),s(_,z.segmentPrefix),s(_,u(le.toString(16))),i(_,kr);case 3:return s(_,B),s(_,z.segmentPrefix),s(_,u(le.toString(16))),i(_,Pe);case 4:return s(_,Ae),s(_,z.segmentPrefix),s(_,u(le.toString(16))),i(_,Xe);case 5:return s(_,Ve),s(_,z.segmentPrefix),s(_,u(le.toString(16))),i(_,ut);case 6:return s(_,ae),s(_,z.segmentPrefix),s(_,u(le.toString(16))),i(_,ct);case 7:return s(_,dt),s(_,z.segmentPrefix),s(_,u(le.toString(16))),i(_,it);default:throw Error(t(397))}}function qt(_,z){switch(z.insertionMode){case 0:case 1:return i(_,$t);case 2:return i(_,b);case 3:return i(_,Se);case 4:return i(_,Ke);case 5:return i(_,Je);case 6:return i(_,st);case 7:return i(_,xt);default:throw Error(t(397))}}var Ar=m('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Ir=m('$RS("'),gn=m('","'),sn=m('")<\/script>'),Ht=m('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),Dr=m('$RC("'),dr=m('","'),Vt=m('")<\/script>'),er=m('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),Nr=m('$RX("'),xn=m('"'),dn=m(")<\/script>"),Qn=m(","),js=/[<\u2028\u2029]/g;function jn(_){return JSON.stringify(_).replace(js,function(z){switch(z){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Fn=Object.assign,yn=Symbol.for("react.element"),Tn=Symbol.for("react.portal"),on=Symbol.for("react.fragment"),ii=Symbol.for("react.strict_mode"),ns=Symbol.for("react.profiler"),oi=Symbol.for("react.provider"),Bn=Symbol.for("react.context"),Ha=Symbol.for("react.forward_ref"),as=Symbol.for("react.suspense"),Va=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),Z=Symbol.for("react.scope"),ce=Symbol.for("react.debug_trace_mode"),Fe=Symbol.for("react.legacy_hidden"),De=Symbol.for("react.default_value"),Ze=Symbol.iterator;function bt(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case on:return"Fragment";case Tn:return"Portal";case ns:return"Profiler";case ii:return"StrictMode";case as:return"Suspense";case Va:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case Bn:return(_.displayName||"Context")+".Consumer";case oi:return(_._context.displayName||"Context")+".Provider";case Ha:var z=_.render;return _=_.displayName,_||(_=z.displayName||z.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case D:return z=_.displayName||null,z!==null?z:bt(_.type)||"Memo";case q:z=_._payload,_=_._init;try{return bt(_(z))}catch{}}return null}var St={};function Kt(_,z){if(_=_.contextTypes,!_)return St;var J={},le;for(le in _)J[le]=z[le];return J}var ar=null;function _r(_,z){if(_!==z){_.context._currentValue=_.parentValue,_=_.parent;var J=z.parent;if(_===null){if(J!==null)throw Error(t(401))}else{if(J===null)throw Error(t(401));_r(_,J)}z.context._currentValue=z.value}}function ea(_){_.context._currentValue=_.parentValue,_=_.parent,_!==null&&ea(_)}function ia(_){var z=_.parent;z!==null&&ia(z),_.context._currentValue=_.value}function Un(_,z){if(_.context._currentValue=_.parentValue,_=_.parent,_===null)throw Error(t(402));_.depth===z.depth?_r(_,z):Un(_,z)}function Wa(_,z){var J=z.parent;if(J===null)throw Error(t(402));_.depth===J.depth?_r(_,J):Wa(_,J),z.context._currentValue=z.value}function oa(_){var z=ar;z!==_&&(z===null?ia(_):_===null?ea(z):z.depth===_.depth?_r(z,_):z.depth>_.depth?Un(z,_):Wa(z,_),ar=_)}var ta={isMounted:function(){return!1},enqueueSetState:function(_,z){_=_._reactInternals,_.queue!==null&&_.queue.push(z)},enqueueReplaceState:function(_,z){_=_._reactInternals,_.replace=!0,_.queue=[z]},enqueueForceUpdate:function(){}};function zn(_,z,J,le){var Ue=_.state!==void 0?_.state:null;_.updater=ta,_.props=J,_.state=Ue;var Re={queue:[],replace:!1};_._reactInternals=Re;var at=z.contextType;if(_.context=typeof at=="object"&&at!==null?at._currentValue:le,at=z.getDerivedStateFromProps,typeof at=="function"&&(at=at(J,Ue),Ue=at==null?Ue:Fn({},Ue,at),_.state=Ue),typeof z.getDerivedStateFromProps!="function"&&typeof _.getSnapshotBeforeUpdate!="function"&&(typeof _.UNSAFE_componentWillMount=="function"||typeof _.componentWillMount=="function"))if(z=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),z!==_.state&&ta.enqueueReplaceState(_,_.state,null),Re.queue!==null&&0<Re.queue.length)if(z=Re.queue,at=Re.replace,Re.queue=null,Re.replace=!1,at&&z.length===1)_.state=z[0];else{for(Re=at?z[0]:_.state,Ue=!0,at=at?1:0;at<z.length;at++){var yt=z[at];yt=typeof yt=="function"?yt.call(_,Re,J,le):yt,yt!=null&&(Ue?(Ue=!1,Re=Fn({},Re,yt)):Fn(Re,yt))}_.state=Re}else Re.queue=null}var wa={id:1,overflow:""};function la(_,z,J){var le=_.id;_=_.overflow;var Ue=32-Ya(le)-1;le&=~(1<<Ue),J+=1;var Re=32-Ya(z)+Ue;if(30<Re){var at=Ue-Ue%5;return Re=(le&(1<<at)-1).toString(32),le>>=at,Ue-=at,{id:1<<32-Ya(z)+Ue|J<<Ue|le,overflow:Re+_}}return{id:1<<Re|J<<Ue|le,overflow:_}}var Ya=Math.clz32?Math.clz32:qe,S=Math.log,ue=Math.LN2;function qe(_){return _>>>=0,_===0?32:31-(S(_)/ue|0)|0}function we(_,z){return _===z&&(_!==0||1/_===1/z)||_!==_&&z!==z}var de=typeof Object.is=="function"?Object.is:we,ze=null,Ee=null,ye=null,Ge=null,Qe=!1,Jt=!1,Ct=0,ur=null,Wt=0;function zr(){if(ze===null)throw Error(t(321));return ze}function mr(){if(0<Wt)throw Error(t(312));return{memoizedState:null,queue:null,next:null}}function br(){return Ge===null?ye===null?(Qe=!1,ye=Ge=mr()):(Qe=!0,Ge=ye):Ge.next===null?(Qe=!1,Ge=Ge.next=mr()):(Qe=!0,Ge=Ge.next),Ge}function Mr(){Ee=ze=null,Jt=!1,ye=null,Wt=0,Ge=ur=null}function un(_,z){return typeof z=="function"?z(_):z}function hr(_,z,J){if(ze=zr(),Ge=br(),Qe){var le=Ge.queue;if(z=le.dispatch,ur!==null&&(J=ur.get(le),J!==void 0)){ur.delete(le),le=Ge.memoizedState;do le=_(le,J.action),J=J.next;while(J!==null);return Ge.memoizedState=le,[le,z]}return[Ge.memoizedState,z]}return _=_===un?typeof z=="function"?z():z:J!==void 0?J(z):z,Ge.memoizedState=_,_=Ge.queue={last:null,dispatch:null},_=_.dispatch=mn.bind(null,ze,_),[Ge.memoizedState,_]}function Er(_,z){if(ze=zr(),Ge=br(),z=z===void 0?null:z,Ge!==null){var J=Ge.memoizedState;if(J!==null&&z!==null){var le=J[1];e:if(le===null)le=!1;else{for(var Ue=0;Ue<le.length&&Ue<z.length;Ue++)if(!de(z[Ue],le[Ue])){le=!1;break e}le=!0}if(le)return J[0]}}return _=_(),Ge.memoizedState=[_,z],_}function mn(_,z,J){if(25<=Wt)throw Error(t(301));if(_===ze)if(Jt=!0,_={action:J,next:null},ur===null&&(ur=new Map),J=ur.get(z),J===void 0)ur.set(z,_);else{for(z=J;z.next!==null;)z=z.next;z.next=_}}function Nn(){throw Error(t(394))}function Sn(){}var Cn={readContext:function(_){return _._currentValue},useContext:function(_){return zr(),_._currentValue},useMemo:Er,useReducer:hr,useRef:function(_){ze=zr(),Ge=br();var z=Ge.memoizedState;return z===null?(_={current:_},Ge.memoizedState=_):z},useState:function(_){return hr(un,_)},useInsertionEffect:Sn,useLayoutEffect:function(){},useCallback:function(_,z){return Er(function(){return _},z)},useImperativeHandle:Sn,useEffect:Sn,useDebugValue:Sn,useDeferredValue:function(_){return zr(),_},useTransition:function(){return zr(),[!1,Nn]},useId:function(){var _=Ee.treeContext,z=_.overflow;_=_.id,_=(_&~(1<<32-Ya(_)-1)).toString(32)+z;var J=Pa;if(J===null)throw Error(t(404));return z=Ct++,_=":"+J.idPrefix+"R"+_,0<z&&(_+="H"+z.toString(32)),_+":"},useMutableSource:function(_,z){return zr(),z(_._source)},useSyncExternalStore:function(_,z,J){if(J===void 0)throw Error(t(407));return J()}},Pa=null,qr=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function ja(_){return console.error(_),null}function qn(){}function Hr(_,z,J,le,Ue,Re,at,yt,Zt){var fr=[],sr=new Set;return z={destination:null,responseState:z,progressiveChunkSize:le===void 0?12800:le,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:sr,pingedTasks:fr,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Ue===void 0?ja:Ue,onAllReady:Re===void 0?qn:Re,onShellReady:at===void 0?qn:at,onShellError:yt===void 0?qn:yt,onFatalError:Zt===void 0?qn:Zt},J=Fi(z,0,null,J,!1,!1),J.parentFlushed=!0,_=li(z,_,null,J,sr,St,null,wa),fr.push(_),z}function li(_,z,J,le,Ue,Re,at,yt){_.allPendingTasks++,J===null?_.pendingRootTasks++:J.pendingTasks++;var Zt={node:z,ping:function(){var fr=_.pingedTasks;fr.push(Zt),fr.length===1&&Lc(_)},blockedBoundary:J,blockedSegment:le,abortSet:Ue,legacyContext:Re,context:at,treeContext:yt};return Ue.add(Zt),Zt}function Fi(_,z,J,le,Ue,Re){return{status:0,id:-1,index:z,parentFlushed:!1,chunks:[],children:[],formatContext:le,boundary:J,lastPushedText:Ue,textEmbedded:Re}}function ci(_,z){if(_=_.onError(z),_!=null&&typeof _!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof _+'" instead');return _}function Ls(_,z){var J=_.onShellError;J(z),J=_.onFatalError,J(z),_.destination!==null?(_.status=2,p(_.destination,z)):(_.status=1,_.fatalError=z)}function vo(_,z,J,le,Ue){for(ze={},Ee=z,Ct=0,_=J(le,Ue);Jt;)Jt=!1,Ct=0,Wt+=1,Ge=null,_=J(le,Ue);return Mr(),_}function Mc(_,z,J,le){var Ue=J.render(),Re=le.childContextTypes;if(Re!=null){var at=z.legacyContext;if(typeof J.getChildContext!="function")le=at;else{J=J.getChildContext();for(var yt in J)if(!(yt in Re))throw Error(t(108,bt(le)||"Unknown",yt));le=Fn({},at,J)}z.legacyContext=le,Na(_,z,Ue),z.legacyContext=at}else Na(_,z,Ue)}function Lu(_,z){if(_&&_.defaultProps){z=Fn({},z),_=_.defaultProps;for(var J in _)z[J]===void 0&&(z[J]=_[J]);return z}return z}function Rc(_,z,J,le,Ue){if(typeof J=="function")if(J.prototype&&J.prototype.isReactComponent){Ue=Kt(J,z.legacyContext);var Re=J.contextType;Re=new J(le,typeof Re=="object"&&Re!==null?Re._currentValue:Ue),zn(Re,J,le,Ue),Mc(_,z,Re,J)}else{Re=Kt(J,z.legacyContext),Ue=vo(_,z,J,le,Re);var at=Ct!==0;if(typeof Ue=="object"&&Ue!==null&&typeof Ue.render=="function"&&Ue.$$typeof===void 0)zn(Ue,J,le,Re),Mc(_,z,Ue,J);else if(at){le=z.treeContext,z.treeContext=la(le,1,0);try{Na(_,z,Ue)}finally{z.treeContext=le}}else Na(_,z,Ue)}else if(typeof J=="string"){switch(Ue=z.blockedSegment,Re=Mt(Ue.chunks,J,le,_.responseState,Ue.formatContext),Ue.lastPushedText=!1,at=Ue.formatContext,Ue.formatContext=H(at,J,le),$c(_,z,Re),Ue.formatContext=at,J){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Ue.chunks.push(rr,u(J),Ft)}Ue.lastPushedText=!1}else{switch(J){case Fe:case ce:case ii:case ns:case on:Na(_,z,le.children);return;case Va:Na(_,z,le.children);return;case Z:throw Error(t(343));case as:e:{J=z.blockedBoundary,Ue=z.blockedSegment,Re=le.fallback,le=le.children,at=new Set;var yt={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:at,errorDigest:null},Zt=Fi(_,Ue.chunks.length,yt,Ue.formatContext,!1,!1);Ue.children.push(Zt),Ue.lastPushedText=!1;var fr=Fi(_,0,null,Ue.formatContext,!1,!1);fr.parentFlushed=!0,z.blockedBoundary=yt,z.blockedSegment=fr;try{if($c(_,z,le),fr.lastPushedText&&fr.textEmbedded&&fr.chunks.push(te),fr.status=1,ml(yt,fr),yt.pendingTasks===0)break e}catch(sr){fr.status=4,yt.forceClientRender=!0,yt.errorDigest=ci(_,sr)}finally{z.blockedBoundary=J,z.blockedSegment=Ue}z=li(_,Re,J,Zt,at,z.legacyContext,z.context,z.treeContext),_.pingedTasks.push(z)}return}if(typeof J=="object"&&J!==null)switch(J.$$typeof){case Ha:if(le=vo(_,z,J.render,le,Ue),Ct!==0){J=z.treeContext,z.treeContext=la(J,1,0);try{Na(_,z,le)}finally{z.treeContext=J}}else Na(_,z,le);return;case D:J=J.type,le=Lu(J,le),Rc(_,z,J,le,Ue);return;case oi:if(Ue=le.children,J=J._context,le=le.value,Re=J._currentValue,J._currentValue=le,at=ar,ar=le={parent:at,depth:at===null?0:at.depth+1,context:J,parentValue:Re,value:le},z.context=le,Na(_,z,Ue),_=ar,_===null)throw Error(t(403));le=_.parentValue,_.context._currentValue=le===De?_.context._defaultValue:le,_=ar=_.parent,z.context=_;return;case Bn:le=le.children,le=le(J._currentValue),Na(_,z,le);return;case q:Ue=J._init,J=Ue(J._payload),le=Lu(J,le),Rc(_,z,J,le,void 0);return}throw Error(t(130,J==null?J:typeof J,""))}}function Na(_,z,J){if(z.node=J,typeof J=="object"&&J!==null){switch(J.$$typeof){case yn:Rc(_,z,J.type,J.props,J.ref);return;case Tn:throw Error(t(257));case q:var le=J._init;J=le(J._payload),Na(_,z,J);return}if($(J)){ul(_,z,J);return}if(J===null||typeof J!="object"?le=null:(le=Ze&&J[Ze]||J["@@iterator"],le=typeof le=="function"?le:null),le&&(le=le.call(J))){if(J=le.next(),!J.done){var Ue=[];do Ue.push(J.value),J=le.next();while(!J.done);ul(_,z,Ue)}return}throw _=Object.prototype.toString.call(J),Error(t(31,_==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":_))}typeof J=="string"?(le=z.blockedSegment,le.lastPushedText=fe(z.blockedSegment.chunks,J,_.responseState,le.lastPushedText)):typeof J=="number"&&(le=z.blockedSegment,le.lastPushedText=fe(z.blockedSegment.chunks,""+J,_.responseState,le.lastPushedText))}function ul(_,z,J){for(var le=J.length,Ue=0;Ue<le;Ue++){var Re=z.treeContext;z.treeContext=la(Re,le,Ue);try{$c(_,z,J[Ue])}finally{z.treeContext=Re}}}function $c(_,z,J){var le=z.blockedSegment.formatContext,Ue=z.legacyContext,Re=z.context;try{return Na(_,z,J)}catch(Zt){if(Mr(),typeof Zt=="object"&&Zt!==null&&typeof Zt.then=="function"){J=Zt;var at=z.blockedSegment,yt=Fi(_,at.chunks.length,null,at.formatContext,at.lastPushedText,!0);at.children.push(yt),at.lastPushedText=!1,_=li(_,z.node,z.blockedBoundary,yt,z.abortSet,z.legacyContext,z.context,z.treeContext).ping,J.then(_,_),z.blockedSegment.formatContext=le,z.legacyContext=Ue,z.context=Re,oa(Re)}else throw z.blockedSegment.formatContext=le,z.legacyContext=Ue,z.context=Re,oa(Re),Zt}}function hp(_){var z=_.blockedBoundary;_=_.blockedSegment,_.status=3,Bu(this,z,_)}function Fu(_,z,J){var le=_.blockedBoundary;_.blockedSegment.status=3,le===null?(z.allPendingTasks--,z.status!==2&&(z.status=2,z.destination!==null&&z.destination.close())):(le.pendingTasks--,le.forceClientRender||(le.forceClientRender=!0,_=J===void 0?Error(t(432)):J,le.errorDigest=z.onError(_),le.parentFlushed&&z.clientRenderedBoundaries.push(le)),le.fallbackAbortableTasks.forEach(function(Ue){return Fu(Ue,z,J)}),le.fallbackAbortableTasks.clear(),z.allPendingTasks--,z.allPendingTasks===0&&(le=z.onAllReady,le()))}function ml(_,z){if(z.chunks.length===0&&z.children.length===1&&z.children[0].boundary===null){var J=z.children[0];J.id=z.id,J.parentFlushed=!0,J.status===1&&ml(_,J)}else _.completedSegments.push(z)}function Bu(_,z,J){if(z===null){if(J.parentFlushed){if(_.completedRootSegment!==null)throw Error(t(389));_.completedRootSegment=J}_.pendingRootTasks--,_.pendingRootTasks===0&&(_.onShellError=qn,z=_.onShellReady,z())}else z.pendingTasks--,z.forceClientRender||(z.pendingTasks===0?(J.parentFlushed&&J.status===1&&ml(z,J),z.parentFlushed&&_.completedBoundaries.push(z),z.fallbackAbortableTasks.forEach(hp,_),z.fallbackAbortableTasks.clear()):J.parentFlushed&&J.status===1&&(ml(z,J),z.completedSegments.length===1&&z.parentFlushed&&_.partialBoundaries.push(z)));_.allPendingTasks--,_.allPendingTasks===0&&(_=_.onAllReady,_())}function Lc(_){if(_.status!==2){var z=ar,J=qr.current;qr.current=Cn;var le=Pa;Pa=_.responseState;try{var Ue=_.pingedTasks,Re;for(Re=0;Re<Ue.length;Re++){var at=Ue[Re],yt=_,Zt=at.blockedSegment;if(Zt.status===0){oa(at.context);try{Na(yt,at,at.node),Zt.lastPushedText&&Zt.textEmbedded&&Zt.chunks.push(te),at.abortSet.delete(at),Zt.status=1,Bu(yt,at.blockedBoundary,Zt)}catch(Da){if(Mr(),typeof Da=="object"&&Da!==null&&typeof Da.then=="function"){var fr=at.ping;Da.then(fr,fr)}else{at.abortSet.delete(at),Zt.status=4;var sr=at.blockedBoundary,Wr=Da,ca=ci(yt,Wr);if(sr===null?Ls(yt,Wr):(sr.pendingTasks--,sr.forceClientRender||(sr.forceClientRender=!0,sr.errorDigest=ca,sr.parentFlushed&&yt.clientRenderedBoundaries.push(sr))),yt.allPendingTasks--,yt.allPendingTasks===0){var Ta=yt.onAllReady;Ta()}}}finally{}}}Ue.splice(0,Re),_.destination!==null&&Fc(_,_.destination)}catch(Da){ci(_,Da),Ls(_,Da)}finally{Pa=le,qr.current=J,J===Cn&&oa(z)}}}function hl(_,z,J){switch(J.parentFlushed=!0,J.status){case 0:var le=J.id=_.nextSegmentId++;return J.lastPushedText=!1,J.textEmbedded=!1,_=_.responseState,s(z,cr),s(z,_.placeholderPrefix),_=u(le.toString(16)),s(z,_),i(z,or);case 1:J.status=2;var Ue=!0;le=J.chunks;var Re=0;J=J.children;for(var at=0;at<J.length;at++){for(Ue=J[at];Re<Ue.index;Re++)s(z,le[Re]);Ue=fl(_,z,Ue)}for(;Re<le.length-1;Re++)s(z,le[Re]);return Re<le.length&&(Ue=i(z,le[Re])),Ue;default:throw Error(t(390))}}function fl(_,z,J){var le=J.boundary;if(le===null)return hl(_,z,J);if(le.parentFlushed=!0,le.forceClientRender)le=le.errorDigest,i(z,tt),s(z,Pt),le&&(s(z,vt),s(z,u(P(le))),s(z,Ot)),i(z,nr),hl(_,z,J);else if(0<le.pendingTasks){le.rootSegmentID=_.nextSegmentId++,0<le.completedSegments.length&&_.partialBoundaries.push(le);var Ue=_.responseState,Re=Ue.nextSuspenseID++;Ue=m(Ue.boundaryPrefix+Re.toString(16)),le=le.id=Ue,Yt(z,_.responseState,le),hl(_,z,J)}else if(le.byteSize>_.progressiveChunkSize)le.rootSegmentID=_.nextSegmentId++,_.completedBoundaries.push(le),Yt(z,_.responseState,le.id),hl(_,z,J);else{if(i(z,ke),J=le.completedSegments,J.length!==1)throw Error(t(391));fl(_,z,J[0])}return i(z,gt)}function Uu(_,z,J){return Bt(z,_.responseState,J.formatContext,J.id),fl(_,z,J),qt(z,J.formatContext)}function zu(_,z,J){for(var le=J.completedSegments,Ue=0;Ue<le.length;Ue++)pl(_,z,J,le[Ue]);if(le.length=0,_=_.responseState,le=J.id,J=J.rootSegmentID,s(z,_.startInlineScript),_.sentCompleteBoundaryFunction?s(z,Dr):(_.sentCompleteBoundaryFunction=!0,s(z,Ht)),le===null)throw Error(t(395));return J=u(J.toString(16)),s(z,le),s(z,dr),s(z,_.segmentPrefix),s(z,J),i(z,Vt)}function pl(_,z,J,le){if(le.status===2)return!0;var Ue=le.id;if(Ue===-1){if((le.id=J.rootSegmentID)===-1)throw Error(t(392));return Uu(_,z,le)}return Uu(_,z,le),_=_.responseState,s(z,_.startInlineScript),_.sentCompleteSegmentFunction?s(z,Ir):(_.sentCompleteSegmentFunction=!0,s(z,Ar)),s(z,_.segmentPrefix),Ue=u(Ue.toString(16)),s(z,Ue),s(z,gn),s(z,_.placeholderPrefix),s(z,Ue),i(z,sn)}function Fc(_,z){n=new Uint8Array(512),a=0;try{var J=_.completedRootSegment;if(J!==null&&_.pendingRootTasks===0){fl(_,z,J),_.completedRootSegment=null;var le=_.responseState.bootstrapChunks;for(J=0;J<le.length-1;J++)s(z,le[J]);J<le.length&&i(z,le[J])}var Ue=_.clientRenderedBoundaries,Re;for(Re=0;Re<Ue.length;Re++){var at=Ue[Re];le=z;var yt=_.responseState,Zt=at.id,fr=at.errorDigest,sr=at.errorMessage,Wr=at.errorComponentStack;if(s(le,yt.startInlineScript),yt.sentClientRenderFunction?s(le,Nr):(yt.sentClientRenderFunction=!0,s(le,er)),Zt===null)throw Error(t(395));s(le,Zt),s(le,xn),(fr||sr||Wr)&&(s(le,Qn),s(le,u(jn(fr||"")))),(sr||Wr)&&(s(le,Qn),s(le,u(jn(sr||"")))),Wr&&(s(le,Qn),s(le,u(jn(Wr)))),i(le,dn)}Ue.splice(0,Re);var ca=_.completedBoundaries;for(Re=0;Re<ca.length;Re++)zu(_,z,ca[Re]);ca.splice(0,Re),l(z),n=new Uint8Array(512),a=0;var Ta=_.partialBoundaries;for(Re=0;Re<Ta.length;Re++){var Da=Ta[Re];e:{Ue=_,at=z;var wo=Da.completedSegments;for(yt=0;yt<wo.length;yt++)if(!pl(Ue,at,Da,wo[yt])){yt++,wo.splice(0,yt);var Bc=!1;break e}wo.splice(0,yt),Bc=!0}if(!Bc){_.destination=null,Re++,Ta.splice(0,Re);return}}Ta.splice(0,Re);var Fs=_.completedBoundaries;for(Re=0;Re<Fs.length;Re++)zu(_,z,Fs[Re]);Fs.splice(0,Re)}finally{l(z),_.allPendingTasks===0&&_.pingedTasks.length===0&&_.clientRenderedBoundaries.length===0&&_.completedBoundaries.length===0&&z.close()}}function qu(_,z){try{var J=_.abortableTasks;J.forEach(function(le){return Fu(le,_,z)}),J.clear(),_.destination!==null&&Fc(_,_.destination)}catch(le){ci(_,le),Ls(_,le)}}return nh.renderToReadableStream=function(_,z){return new Promise(function(J,le){var Ue,Re,at=new Promise(function(sr,Wr){Re=sr,Ue=Wr}),yt=Hr(_,U(z?z.identifierPrefix:void 0,z?z.nonce:void 0,z?z.bootstrapScriptContent:void 0,z?z.bootstrapScripts:void 0,z?z.bootstrapModules:void 0),Y(z?z.namespaceURI:void 0),z?z.progressiveChunkSize:void 0,z?z.onError:void 0,Re,function(){var sr=new ReadableStream({type:"bytes",pull:function(Wr){if(yt.status===1)yt.status=2,p(Wr,yt.fatalError);else if(yt.status!==2&&yt.destination===null){yt.destination=Wr;try{Fc(yt,Wr)}catch(ca){ci(yt,ca),Ls(yt,ca)}}},cancel:function(){qu(yt)}},{highWaterMark:0});sr.allReady=at,J(sr)},function(sr){at.catch(function(){}),le(sr)},Ue);if(z&&z.signal){var Zt=z.signal,fr=function(){qu(yt,Zt.reason),Zt.removeEventListener("abort",fr)};Zt.addEventListener("abort",fr)}Lc(yt)})},nh.version="18.3.1",nh}var d4;function $Z(){if(d4)return eo;d4=1;var e,t;return e=MZ(),t=RZ(),eo.version=e.version,eo.renderToString=e.renderToString,eo.renderToStaticMarkup=e.renderToStaticMarkup,eo.renderToNodeStream=e.renderToNodeStream,eo.renderToStaticNodeStream=e.renderToStaticNodeStream,eo.renderToReadableStream=t.renderToReadableStream,eo}var hh=$Z();const H1=({settings:e,student:t,subjects:n,testName:a,enableRoomNumbers:s=!1,instructions:i=[],mode:l="preview",className:d=""})=>{const u=(p,f,g)=>{if(!p||!f||!g)return"Time not set";try{return`${p==="00"?"12":p}:${f} ${g}`}catch(N){return console.error("Error formatting 12-hour time:",N),"Time error"}},m=l==="print"?{fontFamily:"Arial, sans-serif",aspectRatio:"210/297",minHeight:"297mm",width:"210mm",padding:"20mm",boxSizing:"border-box",background:"white",display:"flex",flexDirection:"column",position:"relative",pageBreakAfter:"always",marginBottom:"20px"}:{};return r.jsxs("div",{className:`hall-ticket ${d} ${l==="print"?"":"w-full max-w-4xl mx-auto bg-white shadow-lg flex flex-col"}`,style:l==="print"?m:{fontFamily:"Arial, sans-serif",aspectRatio:"210/297",minHeight:"297mm",width:"210mm",padding:"20mm",boxSizing:"border-box",display:"flex",flexDirection:"column"},children:[r.jsx("div",{className:l==="print"?"":"flex justify-between items-start mb-4 pb-4 border-b-2 border-gray-300",style:l==="print"?{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px",paddingBottom:"16px",borderBottom:"2px solid #d1d5db"}:{},children:r.jsxs("div",{className:l==="print"?"":"flex items-center space-x-4",style:l==="print"?{display:"flex",alignItems:"center",gap:"16px"}:{},children:[e.logoUrl?r.jsx("img",{src:e.logoUrl,alt:"Logo",className:l==="print"?"":"w-16 h-16 object-contain",style:l==="print"?{width:"64px",height:"64px",objectFit:"contain"}:{}}):r.jsx("div",{className:l==="print"?"":"w-16 h-16 bg-gray-800 rounded-lg flex items-center justify-center",style:l==="print"?{width:"64px",height:"64px",backgroundColor:"#1f2937",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"}:{},children:r.jsx("div",{className:l==="print"?"":"w-10 h-10 border-2 border-white rounded transform rotate-45",style:l==="print"?{width:"40px",height:"40px",border:"2px solid white",borderRadius:"4px",transform:"rotate(45deg)"}:{}})}),r.jsxs("div",{children:[r.jsx("h1",{className:l==="print"?"":"text-2xl font-bold text-gray-800",style:l==="print"?{fontSize:"24px",fontWeight:"bold",color:"#1f2937",margin:0}:{},children:e.schoolName}),r.jsxs("p",{className:l==="print"?"":"text-sm text-gray-600",style:l==="print"?{fontSize:"14px",color:"#4b5563",margin:"4px 0"}:{},children:["School Code: ",e.schoolCode]}),r.jsx("p",{className:l==="print"?"":"text-sm text-gray-600",style:l==="print"?{fontSize:"14px",color:"#4b5563",margin:"4px 0"}:{},children:e.address})]})]})}),r.jsxs("div",{className:l==="print"?"":"text-center mb-4",style:l==="print"?{textAlign:"center",marginBottom:"16px"}:{},children:[r.jsx("h2",{className:l==="print"?"":"text-3xl font-bold text-gray-800",style:l==="print"?{fontSize:"28px",fontWeight:"bold",color:"#1f2937",margin:0}:{},children:"ADMIT CARD"}),r.jsx("p",{className:l==="print"?"":"text-lg font-semibold text-gray-700 mt-2",style:l==="print"?{fontSize:"16px",fontWeight:"600",color:"#374151",marginTop:"8px",margin:"8px 0 0 0"}:{},children:a})]}),r.jsxs("div",{className:l==="print"?"":"grid grid-cols-2 gap-6 mb-4 p-3 bg-gray-50 rounded-lg border",style:l==="print"?{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"24px",marginBottom:"16px",padding:"12px",backgroundColor:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"8px"}:{},children:[r.jsxs("div",{children:[r.jsx("h3",{className:l==="print"?"":"text-base font-semibold text-gray-800 mb-3 pb-2 border-b border-gray-300",style:l==="print"?{fontSize:"14px",fontWeight:"600",color:"#1f2937",marginBottom:"12px",paddingBottom:"8px",borderBottom:"1px solid #d1d5db"}:{},children:"Student Details"}),r.jsxs("div",{className:l==="print"?"":"space-y-2",style:l==="print"?{display:"flex",flexDirection:"column",gap:"8px"}:{},children:[r.jsxs("div",{style:l==="print"?{display:"flex",alignItems:"center",gap:"8px"}:{},children:[r.jsx("span",{style:l==="print"?{fontSize:"12px",fontWeight:"600",color:"#374151",minWidth:"80px"}:{},children:"Name:"}),r.jsx("span",{style:l==="print"?{fontSize:"12px",color:"#1f2937"}:{},children:t.name})]}),r.jsxs("div",{style:l==="print"?{display:"flex",alignItems:"center",gap:"8px"}:{},children:[r.jsx("span",{style:l==="print"?{fontSize:"12px",fontWeight:"600",color:"#374151",minWidth:"80px"}:{},children:"Class:"}),r.jsxs("span",{style:l==="print"?{fontSize:"12px",color:"#1f2937"}:{},children:[t.className," - Section ",t.section]})]}),r.jsxs("div",{style:l==="print"?{display:"flex",alignItems:"center",gap:"8px"}:{},children:[r.jsx("span",{style:l==="print"?{fontSize:"12px",fontWeight:"600",color:"#374151",minWidth:"80px"}:{},children:"Student ID:"}),r.jsx("span",{style:l==="print"?{fontSize:"12px",color:"#1f2937"}:{},children:t.sequenceId})]})]})]}),r.jsxs("div",{className:l==="print"?"":"flex flex-col items-center",style:l==="print"?{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"}:{},children:[r.jsx("h3",{className:l==="print"?"":"text-base font-semibold text-gray-800 mb-3 pb-2 border-b border-gray-300",style:l==="print"?{fontSize:"14px",fontWeight:"600",color:"#1f2937",marginBottom:"12px",paddingBottom:"8px",borderBottom:"1px solid #d1d5db",width:"100%",textAlign:"center"}:{},children:"Student Photo"}),r.jsx("div",{className:l==="print"?"":"w-28 h-32 border-2 border-gray-400 rounded-lg flex items-center justify-center bg-white shadow-sm",style:l==="print"?{width:"112px",height:"128px",border:"2px solid #9ca3af",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"white",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"}:{},children:t.profileImage?r.jsx("img",{src:t.profileImage,alt:"Student Photo",className:l==="print"?"":"w-full h-full object-cover rounded-lg",style:l==="print"?{width:"100%",height:"100%",objectFit:"cover",borderRadius:"6px"}:{}}):r.jsx("span",{className:l==="print"?"":"text-xs text-gray-500 text-center px-2",style:l==="print"?{fontSize:"10px",color:"#6b7280",textAlign:"center",padding:"0 8px"}:{},children:"Student Photo"})})]})]}),r.jsxs("div",{className:l==="print"?"":"mb-4",style:l==="print"?{marginBottom:"16px"}:{},children:[r.jsx("h3",{className:l==="print"?"":"text-base font-semibold text-gray-800 mb-3 pb-2 border-b-2 border-blue-200",style:l==="print"?{fontSize:"14px",fontWeight:"600",color:"#1f2937",marginBottom:"12px",paddingBottom:"8px",borderBottom:"2px solid #bfdbfe"}:{},children:"Examination Schedule"}),r.jsxs("table",{className:l==="print"?"":"w-full border-collapse border border-gray-300",style:l==="print"?{width:"100%",borderCollapse:"collapse",border:"1px solid #d1d5db"}:{},children:[r.jsx("thead",{children:r.jsxs("tr",{style:l==="print"?{backgroundColor:"#f3f4f6"}:{},children:[r.jsx("th",{className:l==="print"?"":"px-2 py-1 border border-gray-300 text-left font-semibold",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",textAlign:"left",fontWeight:"600",fontSize:"11px"}:{},children:"Date"}),r.jsx("th",{className:l==="print"?"":"px-2 py-1 border border-gray-300 text-left font-semibold",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",textAlign:"left",fontWeight:"600",fontSize:"11px"}:{},children:"Subject"}),r.jsx("th",{className:l==="print"?"":"px-2 py-1 border border-gray-300 text-left font-semibold",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",textAlign:"left",fontWeight:"600",fontSize:"11px"}:{},children:"Time"}),s&&r.jsx("th",{className:l==="print"?"":"px-2 py-1 border border-gray-300 text-left font-semibold",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",textAlign:"left",fontWeight:"600",fontSize:"11px"}:{},children:"Room"}),r.jsx("th",{className:l==="print"?"":"px-2 py-1 border border-gray-300 text-left font-semibold",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",textAlign:"left",fontWeight:"600",fontSize:"11px"}:{},children:"Invigilator Sign"})]})}),r.jsx("tbody",{children:n.map((p,f)=>r.jsxs("tr",{children:[r.jsx("td",{className:l==="print"?"":"px-2 py-1 border border-gray-300",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",fontSize:"10px"}:{},children:p.examDate}),r.jsx("td",{className:l==="print"?"":"px-2 py-1 border border-gray-300",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",fontSize:"10px"}:{},children:p.name}),r.jsx("td",{className:l==="print"?"":"px-2 py-1 border border-gray-300",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",fontSize:"10px"}:{},children:u(p.examHour,p.examMinute,p.examAmPm)}),s&&r.jsx("td",{className:l==="print"?"":"px-2 py-1 border border-gray-300",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",fontSize:"10px"}:{},children:p.roomNumber||"N/A"}),r.jsx("td",{className:l==="print"?"":"px-2 py-1 border border-gray-300",style:l==="print"?{padding:"4px 8px",border:"1px solid #d1d5db",height:"20px",minHeight:"20px"}:{}})]},p.id))})]})]}),r.jsxs("div",{className:l==="print"?"":"mb-4",style:l==="print"?{marginBottom:"16px",pageBreakInside:"avoid",display:"block",visibility:"visible"}:{},children:[r.jsx("h3",{className:l==="print"?"":"text-base font-semibold text-gray-800 mb-3",style:l==="print"?{fontSize:"14px",fontWeight:"600",color:"#1f2937",marginBottom:"12px"}:{},children:"Instructions"}),r.jsx("div",{className:l==="print"?"":"grid grid-cols-2 gap-x-4 gap-y-1",style:l==="print"?{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"11px",color:"#374151",lineHeight:"1.4"}:{},children:i&&i.length>0?i.map((p,f)=>r.jsxs("div",{className:l==="print"?"":"flex items-start",style:l==="print"?{display:"flex",alignItems:"flex-start",marginBottom:"2px",visibility:"visible",color:"#374151"}:{},children:[r.jsx("span",{style:l==="print"?{marginRight:"6px",fontSize:"11px",color:"#374151",flexShrink:0}:{},children:""}),r.jsx("span",{style:l==="print"?{fontSize:"11px",color:"#374151",lineHeight:"1.3"}:{},children:p})]},f)):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:l==="print"?"":"flex items-start",style:l==="print"?{display:"flex",alignItems:"flex-start",marginBottom:"2px",visibility:"visible",color:"#374151"}:{},children:[r.jsx("span",{style:l==="print"?{marginRight:"6px",fontSize:"11px",color:"#374151",flexShrink:0}:{},children:""}),r.jsx("span",{style:l==="print"?{fontSize:"11px",color:"#374151",lineHeight:"1.3"}:{},children:" Bring this admit card to the examination hall"})]}),r.jsxs("div",{className:l==="print"?"":"flex items-start",style:l==="print"?{display:"flex",alignItems:"flex-start",marginBottom:"2px",visibility:"visible",color:"#374151"}:{},children:[r.jsx("span",{style:l==="print"?{marginRight:"6px",fontSize:"11px",color:"#374151",flexShrink:0}:{},children:""}),r.jsx("span",{style:l==="print"?{fontSize:"11px",color:"#374151",lineHeight:"1.3"}:{},children:"Arrive at least 30 minutes before the exam starts"})]}),r.jsxs("div",{className:l==="print"?"":"flex items-start",style:l==="print"?{display:"flex",alignItems:"flex-start",marginBottom:"2px",visibility:"visible",color:"#374151"}:{},children:[r.jsx("span",{style:l==="print"?{marginRight:"6px",fontSize:"11px",color:"#374151",flexShrink:0}:{},children:""}),r.jsx("span",{style:l==="print"?{fontSize:"11px",color:"#374151",lineHeight:"1.3"}:{},children:"Carry a valid ID proof along with this admit card"})]}),r.jsxs("div",{className:l==="print"?"":"flex items-start",style:l==="print"?{display:"flex",alignItems:"flex-start",marginBottom:"2px",visibility:"visible",color:"#374151"}:{},children:[r.jsx("span",{style:l==="print"?{marginRight:"6px",fontSize:"11px",color:"#374151",flexShrink:0}:{},children:""}),r.jsx("span",{style:l==="print"?{fontSize:"11px",color:"#374151",lineHeight:"1.3"}:{},children:"Mobile phones and electronic devices are not allowed"})]}),r.jsxs("div",{className:l==="print"?"":"flex items-start",style:l==="print"?{display:"flex",alignItems:"flex-start",marginBottom:"2px",visibility:"visible",color:"#374151"}:{},children:[r.jsx("span",{style:l==="print"?{marginRight:"6px",fontSize:"11px",color:"#374151",flexShrink:0}:{},children:""}),r.jsx("span",{style:l==="print"?{fontSize:"11px",color:"#374151",lineHeight:"1.3"}:{},children:"Follow all examination rules and regulations"})]})]})})]}),r.jsx("div",{className:l==="print"?"":"flex justify-end mb-4 mt-4",style:l==="print"?{display:"flex",justifyContent:"flex-end",marginBottom:"80px",marginTop:"16px"}:{},children:r.jsxs("div",{className:l==="print"?"":"text-center",style:l==="print"?{textAlign:"center",minWidth:"150px"}:{},children:[r.jsx("div",{className:l==="print"?"":"border-b border-gray-400 mb-1 pb-4",style:l==="print"?{borderBottom:"1px solid #9ca3af",marginBottom:"4px",paddingBottom:"20px",minHeight:"25px"}:{}}),r.jsx("p",{className:l==="print"?"":"text-xs font-medium text-gray-700",style:l==="print"?{fontSize:"10px",fontWeight:"500",color:"#374151",margin:0}:{},children:"Principal Signature"})]})}),r.jsx("div",{className:l==="print"?"":"mt-auto bg-gray-50 px-8 py-4 border-t",style:l==="print"?{position:"absolute",bottom:"20mm",left:"20mm",right:"20mm",background:"#f9fafb",padding:"16px 32px",borderTop:"1px solid #e5e7eb"}:{marginTop:"auto",background:"#f9fafb",padding:"16px 32px",borderTop:"1px solid #e5e7eb"},children:r.jsxs("div",{className:l==="print"?"":"flex justify-between items-center text-sm text-gray-600",style:l==="print"?{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"12px",color:"#4b5563"}:{},children:[r.jsxs("div",{className:l==="print"?"":"flex items-center space-x-4",style:l==="print"?{display:"flex",alignItems:"center",gap:"16px"}:{},children:[r.jsx("span",{children:e.phone}),r.jsx("span",{children:e.email}),r.jsx("span",{children:e.website})]}),r.jsxs("div",{className:l==="print"?"":"flex items-center text-xs text-gray-500",style:l==="print"?{display:"flex",alignItems:"center",fontSize:"10px",color:"#6b7280"}:{},children:[r.jsx("span",{children:"Powered by"}),r.jsx("strong",{className:l==="print"?"":"ml-1",style:l==="print"?{marginLeft:"4px"}:{},children:"EduLogix"})]})]})})]})},u4=({settings:e,invoiceData:t,mode:n="preview",className:a=""})=>{const s=n==="print"?{fontFamily:"Arial, sans-serif",aspectRatio:"297/210",minHeight:"210mm",width:"297mm",padding:"10mm",boxSizing:"border-box",background:"white",fontSize:"10px"}:{},i=({copyType:l})=>r.jsxs("div",{className:n==="print"?"":"flex-1 border border-gray-300 p-3",style:n==="print"?{flex:"1",border:"1px solid #d1d5db",padding:"12px",marginBottom:"8px",fontSize:"10px"}:{},children:[r.jsx("div",{className:n==="print"?"":"text-center mb-2 pb-2 border-b border-gray-400",style:n==="print"?{textAlign:"center",marginBottom:"8px",paddingBottom:"8px",borderBottom:"1px solid #9ca3af"}:{},children:r.jsx("h3",{className:n==="print"?"":"text-sm font-bold text-gray-800",style:n==="print"?{fontSize:"12px",fontWeight:"bold",color:"#1f2937",margin:0}:{},children:l})}),r.jsxs("div",{className:n==="print"?"":"flex justify-between items-center mb-3 pb-2 border-b border-gray-300",style:n==="print"?{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px",paddingBottom:"8px",borderBottom:"1px solid #d1d5db"}:{},children:[r.jsxs("div",{className:n==="print"?"":"flex items-center space-x-2",style:n==="print"?{display:"flex",alignItems:"center",gap:"8px"}:{},children:[e.logoUrl?r.jsx("img",{src:e.logoUrl,alt:"Logo",className:n==="print"?"":"w-8 h-8 object-contain",style:n==="print"?{width:"32px",height:"32px",objectFit:"contain"}:{}}):r.jsx("div",{className:n==="print"?"":"w-8 h-8 bg-gray-800 rounded flex items-center justify-center",style:n==="print"?{width:"32px",height:"32px",background:"#1f2937",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"}:{},children:r.jsx("div",{className:n==="print"?"":"w-4 h-4 border border-white rounded transform rotate-45",style:n==="print"?{width:"16px",height:"16px",border:"1px solid white",borderRadius:"2px",transform:"rotate(45deg)"}:{}})}),r.jsxs("div",{children:[r.jsx("h1",{className:n==="print"?"":"text-sm font-bold text-gray-800",style:n==="print"?{fontSize:"12px",fontWeight:"bold",color:"#1f2937",margin:0}:{},children:e.schoolName}),r.jsx("p",{className:n==="print"?"":"text-xs text-gray-600",style:n==="print"?{fontSize:"8px",color:"#4b5563",margin:"1px 0"}:{},children:e.address})]})]}),r.jsx("div",{className:n==="print"?"":"text-right",style:n==="print"?{textAlign:"right"}:{}})]}),r.jsxs("div",{className:n==="print"?"":"text-center mb-3",style:n==="print"?{textAlign:"center",marginBottom:"12px"}:{},children:[r.jsx("h2",{className:n==="print"?"":"text-lg font-bold text-blue-600",style:n==="print"?{fontSize:"14px",fontWeight:"bold",color:"#2563eb",margin:0}:{},children:"INVOICE"}),r.jsxs("p",{className:n==="print"?"":"text-xs text-gray-600",style:n==="print"?{fontSize:"10px",color:"#4b5563",marginTop:"2px"}:{},children:["#",t.invoiceNumber]})]}),r.jsxs("div",{className:n==="print"?"":"grid grid-cols-2 gap-8 mb-8",style:n==="print"?{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px",marginBottom:"32px"}:{},children:[r.jsxs("div",{children:[r.jsx("h3",{className:n==="print"?"":"text-sm font-semibold text-gray-800 mb-2",style:n==="print"?{fontSize:"14px",fontWeight:"600",color:"#1f2937",marginBottom:"8px"}:{},children:"INVOICE TO:"}),r.jsxs("div",{className:n==="print"?"":"text-sm text-gray-700",style:n==="print"?{fontSize:"12px",color:"#374151"}:{},children:[r.jsx("p",{style:n==="print"?{margin:"4px 0",fontWeight:"bold"}:{},children:r.jsx("strong",{children:t.clientName})}),r.jsx("p",{style:n==="print"?{margin:"4px 0"}:{},children:t.clientAddress})]})]}),r.jsx("div",{className:n==="print"?"":"text-right",style:n==="print"?{textAlign:"right"}:{},children:r.jsxs("div",{className:n==="print"?"":"text-sm text-gray-700",style:n==="print"?{fontSize:"12px",color:"#374151"}:{},children:[r.jsxs("p",{style:n==="print"?{margin:"4px 0"}:{},children:[r.jsx("strong",{children:"Invoice Date:"})," ",t.date]}),r.jsxs("p",{style:n==="print"?{margin:"4px 0"}:{},children:[r.jsx("strong",{children:"Due Date:"})," ",t.dueDate]})]})})]}),r.jsxs("table",{className:n==="print"?"":"w-full border-collapse border border-gray-300 mb-8",style:n==="print"?{width:"100%",borderCollapse:"collapse",border:"1px solid #d1d5db",marginBottom:"32px"}:{},children:[r.jsx("thead",{children:r.jsxs("tr",{style:n==="print"?{backgroundColor:"#f3f4f6"}:{},children:[r.jsx("th",{className:n==="print"?"":"px-4 py-3 border border-gray-300 text-left font-semibold",style:n==="print"?{padding:"12px 16px",border:"1px solid #d1d5db",textAlign:"left",fontWeight:"600"}:{},children:"Description"}),r.jsx("th",{className:n==="print"?"":"px-4 py-3 border border-gray-300 text-center font-semibold",style:n==="print"?{padding:"12px 16px",border:"1px solid #d1d5db",textAlign:"center",fontWeight:"600"}:{},children:"Qty"}),r.jsx("th",{className:n==="print"?"":"px-4 py-3 border border-gray-300 text-right font-semibold",style:n==="print"?{padding:"12px 16px",border:"1px solid #d1d5db",textAlign:"right",fontWeight:"600"}:{},children:"Rate"}),r.jsx("th",{className:n==="print"?"":"px-4 py-3 border border-gray-300 text-right font-semibold",style:n==="print"?{padding:"12px 16px",border:"1px solid #d1d5db",textAlign:"right",fontWeight:"600"}:{},children:"Amount"})]})}),r.jsx("tbody",{children:t.items.map((d,u)=>r.jsxs("tr",{children:[r.jsx("td",{className:n==="print"?"":"px-4 py-3 border border-gray-300",style:n==="print"?{padding:"12px 16px",border:"1px solid #d1d5db"}:{},children:d.description}),r.jsx("td",{className:n==="print"?"":"px-4 py-3 border border-gray-300 text-center",style:n==="print"?{padding:"12px 16px",border:"1px solid #d1d5db",textAlign:"center"}:{},children:d.quantity}),r.jsxs("td",{className:n==="print"?"":"px-4 py-3 border border-gray-300 text-right",style:n==="print"?{padding:"12px 16px",border:"1px solid #d1d5db",textAlign:"right"}:{},children:["",d.rate.toFixed(2)]}),r.jsxs("td",{className:n==="print"?"":"px-4 py-3 border border-gray-300 text-right",style:n==="print"?{padding:"12px 16px",border:"1px solid #d1d5db",textAlign:"right"}:{},children:["",d.amount.toFixed(2)]})]},u))})]}),r.jsx("div",{className:n==="print"?"":"flex justify-end mb-8",style:n==="print"?{display:"flex",justifyContent:"flex-end",marginBottom:"32px"}:{},children:r.jsxs("div",{className:n==="print"?"":"w-64",style:n==="print"?{width:"256px"}:{},children:[r.jsxs("div",{className:n==="print"?"":"flex justify-between py-2 border-b border-gray-300",style:n==="print"?{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #d1d5db"}:{},children:[r.jsx("span",{children:"Subtotal:"}),r.jsxs("span",{children:["",t.subtotal.toFixed(2)]})]}),r.jsxs("div",{className:n==="print"?"":"flex justify-between py-2 border-b border-gray-300",style:n==="print"?{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #d1d5db"}:{},children:[r.jsx("span",{children:"Tax:"}),r.jsxs("span",{children:["",t.tax.toFixed(2)]})]}),r.jsxs("div",{className:n==="print"?"":"flex justify-between py-3 font-bold text-lg border-b-2 border-gray-800",style:n==="print"?{display:"flex",justifyContent:"space-between",padding:"12px 0",fontWeight:"bold",fontSize:"18px",borderBottom:"2px solid #1f2937"}:{},children:[r.jsx("span",{children:"Total:"}),r.jsxs("span",{children:["",t.total.toFixed(2)]})]})]})}),r.jsx("div",{className:n==="print"?"":"mt-auto pt-8 border-t border-gray-300",style:n==="print"?{marginTop:"auto",paddingTop:"32px",borderTop:"1px solid #d1d5db"}:{},children:r.jsxs("div",{className:n==="print"?"":"text-center text-sm text-gray-600",style:n==="print"?{textAlign:"center",fontSize:"12px",color:"#4b5563"}:{},children:[r.jsx("p",{style:n==="print"?{margin:"4px 0"}:{},children:"Thank you for your business!"}),r.jsxs("p",{style:n==="print"?{margin:"4px 0"}:{},children:["For any queries, contact us at ",e.phone," or ",e.email]})]})})]});return r.jsx("div",{className:`invoice-template ${a} ${n==="print"?"":"w-full max-w-6xl mx-auto bg-white shadow-lg"}`,style:n==="print"?s:{fontFamily:"Arial, sans-serif",aspectRatio:"297/210",minHeight:"210mm",width:"297mm",padding:"10mm",boxSizing:"border-box",fontSize:"10px"},children:r.jsxs("div",{className:n==="print"?"":"flex flex-row gap-4",style:n==="print"?{display:"flex",flexDirection:"row",gap:"16px"}:{},children:[r.jsx(i,{copyType:"ADMIN COPY"}),r.jsx(i,{copyType:"STUDENT COPY"})]})})},m4=({settings:e,certificateData:t,mode:n="preview",className:a=""})=>{const s=n==="print"?{fontFamily:"Arial, sans-serif",aspectRatio:"297/210",minHeight:"210mm",width:"297mm",padding:"20mm",boxSizing:"border-box",background:"white"}:{};return r.jsx("div",{className:`certificate-template ${a}`,style:s,children:r.jsxs("div",{className:n==="print"?"":"border-4 border-double border-gray-800 p-8 h-full",style:n==="print"?{border:"4px double #1f2937",padding:"32px",height:"100%"}:{},children:[r.jsxs("div",{className:n==="print"?"":"text-center mb-8",style:n==="print"?{textAlign:"center",marginBottom:"32px"}:{},children:[e.logoUrl&&r.jsx("img",{src:e.logoUrl,alt:"Logo",className:n==="print"?"":"w-20 h-20 mx-auto mb-4 object-contain",style:n==="print"?{width:"80px",height:"80px",margin:"0 auto 16px",objectFit:"contain"}:{}}),r.jsx("h1",{className:n==="print"?"":"text-3xl font-bold text-gray-800 mb-2",style:n==="print"?{fontSize:"28px",fontWeight:"bold",color:"#1f2937",marginBottom:"8px"}:{},children:e.schoolName}),r.jsx("p",{className:n==="print"?"":"text-lg text-gray-600",style:n==="print"?{fontSize:"16px",color:"#4b5563",margin:0}:{},children:e.address})]}),r.jsxs("div",{className:n==="print"?"":"text-center mb-12",style:n==="print"?{textAlign:"center",marginBottom:"48px"}:{},children:[r.jsx("h2",{className:n==="print"?"":"text-5xl font-bold text-blue-600 mb-4",style:n==="print"?{fontSize:"48px",fontWeight:"bold",color:"#2563eb",marginBottom:"16px"}:{},children:"CERTIFICATE"}),r.jsx("h3",{className:n==="print"?"":"text-2xl font-semibold text-gray-700",style:n==="print"?{fontSize:"24px",fontWeight:"600",color:"#374151",margin:0}:{},children:"OF COMPLETION"})]}),r.jsxs("div",{className:n==="print"?"":"text-center mb-12 space-y-6",style:n==="print"?{textAlign:"center",marginBottom:"48px"}:{},children:[r.jsx("p",{className:n==="print"?"":"text-lg text-gray-700",style:n==="print"?{fontSize:"18px",color:"#374151",marginBottom:"24px"}:{},children:"This is to certify that"}),r.jsx("div",{className:n==="print"?"":"border-b-2 border-gray-300 pb-2 mb-6",style:n==="print"?{borderBottom:"2px solid #d1d5db",paddingBottom:"8px",marginBottom:"24px"}:{},children:r.jsx("h4",{className:n==="print"?"":"text-3xl font-bold text-gray-800",style:n==="print"?{fontSize:"32px",fontWeight:"bold",color:"#1f2937",margin:0}:{},children:t.recipientName})}),r.jsx("p",{className:n==="print"?"":"text-lg text-gray-700 mb-4",style:n==="print"?{fontSize:"18px",color:"#374151",marginBottom:"16px"}:{},children:"has successfully completed the course"}),r.jsx("div",{className:n==="print"?"":"border-b-2 border-gray-300 pb-2 mb-6",style:n==="print"?{borderBottom:"2px solid #d1d5db",paddingBottom:"8px",marginBottom:"24px"}:{},children:r.jsx("h5",{className:n==="print"?"":"text-2xl font-semibold text-blue-600",style:n==="print"?{fontSize:"24px",fontWeight:"600",color:"#2563eb",margin:0}:{},children:t.courseName})}),r.jsxs("p",{className:n==="print"?"":"text-lg text-gray-700",style:n==="print"?{fontSize:"18px",color:"#374151",margin:0}:{},children:["on ",t.completionDate]})]}),r.jsxs("div",{className:n==="print"?"":"flex justify-between items-end mt-16",style:n==="print"?{display:"flex",justifyContent:"space-between",alignItems:"flex-end",marginTop:"64px"}:{},children:[r.jsxs("div",{className:n==="print"?"":"text-left",style:n==="print"?{textAlign:"left"}:{},children:[r.jsxs("p",{className:n==="print"?"":"text-sm text-gray-600 mb-1",style:n==="print"?{fontSize:"12px",color:"#4b5563",marginBottom:"4px"}:{},children:["Certificate No: ",t.certificateNumber]}),r.jsxs("p",{className:n==="print"?"":"text-sm text-gray-600",style:n==="print"?{fontSize:"12px",color:"#4b5563",margin:0}:{},children:["Date of Issue: ",t.completionDate]})]}),r.jsx("div",{className:n==="print"?"":"text-center",style:n==="print"?{textAlign:"center"}:{},children:r.jsxs("div",{className:n==="print"?"":"border-t-2 border-gray-800 pt-2",style:n==="print"?{borderTop:"2px solid #1f2937",paddingTop:"8px",minWidth:"200px"}:{},children:[r.jsx("p",{className:n==="print"?"":"font-semibold text-gray-800",style:n==="print"?{fontWeight:"600",color:"#1f2937",margin:"0 0 4px 0"}:{},children:t.signatory}),r.jsx("p",{className:n==="print"?"":"text-sm text-gray-600",style:n==="print"?{fontSize:"12px",color:"#4b5563",margin:0}:{},children:t.signatoryTitle})]})}),r.jsxs("div",{className:n==="print"?"":"text-right",style:n==="print"?{textAlign:"right"}:{},children:[r.jsx("p",{className:n==="print"?"":"text-sm text-gray-600",style:n==="print"?{fontSize:"12px",color:"#4b5563",margin:0}:{},children:e.phone}),r.jsx("p",{className:n==="print"?"":"text-sm text-gray-600",style:n==="print"?{fontSize:"12px",color:"#4b5563",margin:0}:{},children:e.email})]})]}),r.jsx("div",{className:n==="print"?"":"absolute top-4 left-4 w-16 h-16 border-4 border-blue-200 rounded-full opacity-20",style:n==="print"?{position:"absolute",top:"16px",left:"16px",width:"64px",height:"64px",border:"4px solid #dbeafe",borderRadius:"50%",opacity:.2}:{}}),r.jsx("div",{className:n==="print"?"":"absolute top-4 right-4 w-16 h-16 border-4 border-blue-200 rounded-full opacity-20",style:n==="print"?{position:"absolute",top:"16px",right:"16px",width:"64px",height:"64px",border:"4px solid #dbeafe",borderRadius:"50%",opacity:.2}:{}}),r.jsx("div",{className:n==="print"?"":"absolute bottom-4 left-4 w-16 h-16 border-4 border-blue-200 rounded-full opacity-20",style:n==="print"?{position:"absolute",bottom:"16px",left:"16px",width:"64px",height:"64px",border:"4px solid #dbeafe",borderRadius:"50%",opacity:.2}:{}}),r.jsx("div",{className:n==="print"?"":"absolute bottom-4 right-4 w-16 h-16 border-4 border-blue-200 rounded-full opacity-20",style:n==="print"?{position:"absolute",bottom:"16px",right:"16px",width:"64px",height:"64px",border:"4px solid #dbeafe",borderRadius:"50%",opacity:.2}:{}})]})})},LZ=()=>{const{user:e}=yr(),[t,n]=j.useState({schoolName:e?.schoolName||"School Name",schoolCode:e?.schoolCode||"SCH001",website:"www.edulogix.com",logoUrl:"",headerColor:"#1f2937",accentColor:"#3b82f6",address:"123 School Street, City, State 12345",phone:"+91-XXXXXXXXXX",email:"info@school.com"}),[a,s]=j.useState(!1),i=async()=>{if(e?.schoolCode){s(!0);try{const m=localStorage.getItem("erp.authToken"),p=localStorage.getItem("erp.schoolCode")||e?.schoolCode,g=(await zt.get("/schools/profile",{headers:{"X-School-Code":p}})).data;if(console.log(" Fetched school data for templates:",g),g.success&&g.data){const N=g.data;let v="";N.logo&&(N.logo.startsWith("/uploads")?v=`${"https://erp-backend-kfut.onrender.com/api".replace(/\/api\/?$/,"")}${N.logo}`:v=N.logo),n(w=>({...w,schoolName:N.name||N.schoolName||w.schoolName,schoolCode:N.code||N.schoolCode||w.schoolCode,address:N.address||w.address,phone:N.phone||N.contact?.phone||w.phone,email:N.email||N.contact?.email||w.email,logoUrl:v||w.logoUrl}))}}catch(m){console.error("Error fetching school data:",m)}finally{s(!1)}}},l=()=>{try{const m=localStorage.getItem("universalTemplate");if(m){const p=JSON.parse(m);n(f=>({...f,...p}))}}catch(m){console.error("Failed to load template settings:",m)}},d=m=>{try{return localStorage.setItem("universalTemplate",JSON.stringify(m)),n(m),!0}catch(p){return console.error("Failed to save template settings:",p),!1}},u=async m=>new Promise((p,f)=>{const g=new Image;g.crossOrigin="anonymous",g.onload=()=>{const N=document.createElement("canvas"),v=N.getContext("2d");if(!v){f(new Error("Could not get canvas context"));return}N.width=g.width,N.height=g.height,v.drawImage(g,0,0);try{const w=N.toDataURL("image/png");p(w)}catch(w){f(w)}},g.onerror=()=>f(new Error("Failed to load image")),g.src=m});return j.useEffect(()=>{l(),i()},[e?.schoolCode]),{templateSettings:t,setTemplateSettings:n,loading:a,fetchSchoolData:i,saveTemplateSettings:d,convertImageToBase64:u}},FZ=()=>{const{user:e}=yr(),[t,n]=j.useState({schoolName:e?.schoolName||"School Name",schoolCode:e?.schoolCode||"SCH001",website:"www.edulogix.com",logoUrl:"",headerColor:"#1f2937",accentColor:"#3b82f6",address:"123 School Street, City, State 12345",phone:"+91-XXXXXXXXXX",email:"info@school.com"}),[a,s]=j.useState(!1),[i,l]=j.useState("invoice"),[d,u]=j.useState(!1),m=()=>{switch(i){case"invoice":return{invoiceNumber:"INV-2024-001",date:new Date().toLocaleDateString(),dueDate:new Date(Date.now()+720*60*60*1e3).toLocaleDateString(),clientName:"John Doe",clientAddress:"123 Student Street, City, State 12345",items:[{description:"Tuition Fee",quantity:1,rate:5e3,amount:5e3},{description:"Library Fee",quantity:1,rate:500,amount:500},{description:"Lab Fee",quantity:1,rate:1e3,amount:1e3}],subtotal:6500,tax:650,total:7150};case"admit_card":return{student:{id:"1",name:"John Doe",rollNumber:"R001",sequenceId:"SEQ001",className:"10",section:"A",profileImage:""},subjects:[{id:"1",name:"Mathematics",examDate:"2024-03-15",examTime:"09:00 AM",examHour:"09",examMinute:"00",examAmPm:"AM"},{id:"2",name:"Science",examDate:"2024-03-16",examTime:"09:00 AM",examHour:"09",examMinute:"00",examAmPm:"AM"},{id:"3",name:"English",examDate:"2024-03-17",examTime:"09:00 AM",examHour:"09",examMinute:"00",examAmPm:"AM"}],testName:"Final Examination 2024",enableRoomNumbers:!0};case"certificate":return{recipientName:"John Doe",courseName:"Academic Excellence",completionDate:new Date().toLocaleDateString(),certificateNumber:"CERT-2024-001",signatory:"Principal Name",signatoryTitle:"Principal"};case"id_card_landscape_front":case"id_card_landscape_back":case"id_card_portrait_front":case"id_card_portrait_back":return{student:{id:"1",name:"John Doe",rollNumber:"R001",sequenceId:"STU001",className:"10",section:"A",profileImage:"",dateOfBirth:"15/01/2008",bloodGroup:"O+",fatherName:"Mr. Robert Doe",address:"123 Student Street, City, State 12345",phone:"+91-9876543210"}};default:return{}}},p=async()=>{try{localStorage.setItem("universalTemplate",JSON.stringify(t)),ge.success("Template settings saved successfully!")}catch{ge.error("Failed to save template settings")}},f=()=>{const w=window.open("","_blank","width=800,height=600");if(!w){alert("Please allow popups to print template");return}let y="";try{switch(i){case"invoice":{const O=m();y=hh.renderToString(xe.createElement(u4,{settings:t,invoiceData:O,mode:"print"}));break}case"certificate":{const O=m();y=hh.renderToString(xe.createElement(m4,{settings:t,certificateData:O,mode:"print"}));break}case"admit_card":{const O=m();y=hh.renderToString(xe.createElement(H1,{settings:t,student:O.student,subjects:O.subjects,testName:O.testName,enableRoomNumbers:O.enableRoomNumbers,instructions:["Bring this admit card to the examination hall","Arrive at least 30 minutes before the exam starts","Carry a valid ID proof along with this admit card","Mobile phones and electronic devices are not allowed","Follow all examination rules and regulations"],mode:"print"}));break}case"id_card_landscape_front":y=`
            <div style="text-align: center; padding: 20px;">
              <h2>ID Card Template - Landscape Front</h2>
              <img src="https://res.cloudinary.com/dbcutmb0z/image/upload/v1762088066/landscape-front_m59zcq.png" 
                   alt="Landscape Front Template" 
                   style="max-width: 100%; height: auto;" />
            </div>
          `;break;case"id_card_landscape_back":y=`
            <div style="text-align: center; padding: 20px;">
              <h2>ID Card Template - Landscape Back</h2>
              <img src="https://res.cloudinary.com/dbcutmb0z/image/upload/v1762088066/landscape-back_fqroxh.png" 
                   alt="Landscape Back Template" 
                   style="max-width: 100%; height: auto;" />
            </div>
          `;break;case"id_card_portrait_front":y=`
            <div style="text-align: center; padding: 20px;">
              <h2>ID Card Template - Portrait Front</h2>
              <img src="https://res.cloudinary.com/dbcutmb0z/image/upload/v1762088066/portrait-front_iqllye.png" 
                   alt="Portrait Front Template" 
                   style="max-width: 100%; height: auto;" />
            </div>
          `;break;case"id_card_portrait_back":y=`
            <div style="text-align: center; padding: 20px;">
              <h2>ID Card Template - Portrait Back</h2>
              <img src="https://res.cloudinary.com/dbcutmb0z/image/upload/v1762088066/portrait-back_m5wxzh.png" 
                   alt="Portrait Back Template" 
                   style="max-width: 100%; height: auto;" />
            </div>
          `;break;default:y=`
            <div style="font-family: Arial, sans-serif; padding: 40px; text-align: center;">
              <h1>Custom Template</h1>
              <p>Your content will appear here</p>
            </div>
          `}}catch(O){console.error("Error rendering component:",O),y=`
        <div style="font-family: Arial, sans-serif; padding: 40px; text-align: center;">
          <h1>Template Preview Error</h1>
          <p>There was an error rendering the template preview.</p>
        </div>
      `}const E=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Template Preview - ${i.replace("_"," ").toUpperCase()}</title>
          <style>
            @media print {
              body { margin: 0; padding: 0; }
              .no-print { display: none !important; }
            }
            @page {
              size: A4;
              margin: 0;
            }
            body {
              margin: 0;
              padding: 0;
              font-family: Arial, sans-serif;
            }
          </style>
        </head>
        <body>
          ${y}
          <script>
            window.onload = function() {
              setTimeout(function() {
                window.print();
              }, 500);
            };
          <\/script>
        </body>
      </html>
    `;w.document.write(E),w.document.close()},g=()=>{try{const w=localStorage.getItem("universalTemplate");w&&n(JSON.parse(w))}catch(w){console.error("Failed to load template settings:",w)}},N=async()=>{if(!(!e?.schoolCode&&!e?.schoolId))try{u(!0);const w=e?.schoolId||e?.schoolCode;if(w){const y=await ot.get(`/schools/${w}/info`),E=y?.data?.data||y?.data;if(E&&(E.name||E.schoolName)){let O="";if(E.logoUrl||E.logo){const A=E.logoUrl||E.logo;A.startsWith("/uploads")?O=`${"https://erp-backend-kfut.onrender.com/api".replace(/\/api\/?$/,"")}${A}`:O=A,console.log("Logo URL from API:",{rawLogoUrl:A,finalLogoUrl:O,apiBase:"https://erp-backend-kfut.onrender.com/api",schoolData:E})}else console.warn("No logo URL found in school data. Using empty string.");let T="123 School Street, City, State 12345";if(E.address){if(typeof E.address=="string")T=E.address;else if(typeof E.address=="object"){const A=E.address,I=[A.street||A.area,A.city,A.district||A.taluka,A.state,A.pinCode||A.zipCode].filter(Boolean);I.length>0&&(T=I.join(", "))}}n(A=>({...A,schoolName:E.name||E.schoolName||A.schoolName,schoolCode:E.code||E.schoolCode||A.schoolCode,address:T||A.address,phone:E.phone||E.contact?.phone||A.phone,email:E.email||E.contact?.email||A.email,website:E.website||E.contact?.website||A.website,logoUrl:O||A.logoUrl}))}}}catch(w){console.error("Failed to fetch school data:",w)}finally{u(!1)}};j.useEffect(()=>{g(),N()},[e?.schoolCode]);const v=()=>{const w=m();switch(i){case"invoice":return r.jsx("div",{className:"transform scale-75 origin-top-left",children:r.jsx(u4,{settings:t,invoiceData:w,mode:"preview"})});case"certificate":return r.jsx("div",{className:"transform scale-75 origin-top-left",children:r.jsx(m4,{settings:t,certificateData:w,mode:"preview"})});case"admit_card":return r.jsx("div",{className:"transform scale-75 origin-top-left",children:r.jsx(H1,{settings:t,student:w.student,subjects:w.subjects,testName:w.testName,enableRoomNumbers:w.enableRoomNumbers,instructions:["Bring this admit card to the examination hall","Arrive at least 30 minutes before the exam starts","Carry a valid ID proof along with this admit card","Mobile phones and electronic devices are not allowed","Follow all examination rules and regulations"],mode:"preview"})});case"id_card_landscape_front":return r.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"ID Card Template - Landscape Front"}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm flex items-center justify-center",style:{minHeight:"400px"},children:r.jsx("img",{src:"https://res.cloudinary.com/dbcutmb0z/image/upload/v1762088066/landscape-front_m59zcq.png",alt:"Landscape Front Template",className:"max-w-full h-auto",style:{maxHeight:"500px",objectFit:"contain"},onLoad:()=>console.log(" Landscape Front template loaded successfully"),onError:y=>{console.error(" Failed to load Landscape Front template image"),y.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5UZW1wbGF0ZSBOb3QgRm91bmQ8L3RleHQ+PC9zdmc+"}})}),r.jsxs("p",{className:"text-sm text-gray-600 mt-3",children:["Template: ",r.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Landscape Front (Horizontal)"})]}),r.jsx("p",{className:"text-xs text-blue-600 mt-2",children:' Tip: Click "Preview" button above and select this template from the dropdown to view it'})]});case"id_card_landscape_back":return r.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"ID Card Template - Landscape Back"}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm flex items-center justify-center",style:{minHeight:"400px"},children:r.jsx("img",{src:"https://res.cloudinary.com/dbcutmb0z/image/upload/v1762088066/landscape-back_fqroxh.png",alt:"Landscape Back Template",className:"max-w-full h-auto",style:{maxHeight:"500px",objectFit:"contain"},onError:y=>{y.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5UZW1wbGF0ZSBOb3QgRm91bmQ8L3RleHQ+PC9zdmc+"}})}),r.jsxs("p",{className:"text-sm text-gray-600 mt-3",children:["Template: ",r.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Landscape Back (Horizontal)"})]})]});case"id_card_portrait_front":return r.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"ID Card Template - Portrait Front"}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm flex items-center justify-center",style:{minHeight:"400px"},children:r.jsx("img",{src:"https://res.cloudinary.com/dbcutmb0z/image/upload/v1762088066/portrait-front_iqllye.png",alt:"Portrait Front Template",className:"max-w-full h-auto",style:{maxHeight:"500px",objectFit:"contain"},onError:y=>{y.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5UZW1wbGF0ZSBOb3QgRm91bmQ8L3RleHQ+PC9zdmc+"}})}),r.jsxs("p",{className:"text-sm text-gray-600 mt-3",children:["Template: ",r.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Portrait Front (Vertical)"})]})]});case"id_card_portrait_back":return r.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"ID Card Template - Portrait Back"}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm flex items-center justify-center",style:{minHeight:"400px"},children:r.jsx("img",{src:"https://res.cloudinary.com/dbcutmb0z/image/upload/v1762088066/portrait-back_m5wxzh.png",alt:"Portrait Back Template",className:"max-w-full h-auto",style:{maxHeight:"500px",objectFit:"contain"},onError:y=>{y.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5UZW1wbGF0ZSBOb3QgRm91bmQ8L3RleHQ+PC9zdmc+"}})}),r.jsxs("p",{className:"text-sm text-gray-600 mt-3",children:["Template: ",r.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Portrait Back (Vertical)"})]})]});default:return r.jsx("div",{className:"transform scale-75 origin-top-left",children:r.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-white shadow-lg flex flex-col",style:{fontFamily:"Arial, sans-serif",aspectRatio:"210/297",minHeight:"297mm",width:"210mm",padding:"20mm",boxSizing:"border-box"},children:[r.jsx("div",{className:"flex justify-between items-start mb-6 pb-4 border-b-2 border-gray-300",children:r.jsxs("div",{className:"flex items-center space-x-4",children:[t.logoUrl?r.jsx("img",{src:t.logoUrl,alt:"Logo",className:"w-16 h-16 object-contain"}):r.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"w-10 h-10 border-2 border-white rounded transform rotate-45"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.schoolName}),r.jsxs("p",{className:"text-sm text-gray-600",children:["School Code: ",t.schoolCode]}),r.jsx("p",{className:"text-sm text-gray-600",children:t.address})]})]})}),r.jsx("div",{className:"text-center mb-6",children:r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"CUSTOM DOCUMENT"})}),r.jsx("div",{className:"flex-1 flex items-center justify-center",children:r.jsxs("div",{className:"text-center text-gray-400",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsx("p",{className:"text-lg font-medium",children:"Template Preview"}),r.jsx("p",{className:"text-sm",children:"Content will appear here when documents are generated"})]})})]})})}};return a?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Template Preview - ",i.replace("_"," ").toUpperCase()]}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsxs("select",{value:i,onChange:w=>l(w.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"invoice",children:"Invoice"}),r.jsx("option",{value:"admit_card",children:"Admit Card"}),r.jsx("option",{value:"certificate",children:"Certificate"}),r.jsx("option",{value:"id_card_landscape_front",children:"ID Card - Landscape Front"}),r.jsx("option",{value:"id_card_landscape_back",children:"ID Card - Landscape Back"}),r.jsx("option",{value:"id_card_portrait_front",children:"ID Card - Portrait Front"}),r.jsx("option",{value:"id_card_portrait_back",children:"ID Card - Portrait Back"}),r.jsx("option",{value:"custom",children:"Custom Document"})]}),r.jsxs("button",{onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center",children:[r.jsx(yf,{className:"h-4 w-4 mr-2"}),"Edit Template"]}),r.jsxs("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center",children:[r.jsx(Ci,{className:"h-4 w-4 mr-2"}),"Print Template"]})]})]}),r.jsx("div",{className:"bg-gray-100 p-8 rounded-lg overflow-auto",children:r.jsx(v,{})})]}):r.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[r.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Universal Template Settings"}),r.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[r.jsxs("button",{onClick:()=>s(!0),className:"px-3 sm:px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center justify-center text-sm sm:text-base w-full sm:w-auto",children:[r.jsx(wn,{className:"h-4 w-4 mr-2"}),"Preview"]}),r.jsxs("button",{onClick:p,className:"px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center text-sm sm:text-base w-full sm:w-auto",children:[r.jsx(rs,{className:"h-4 w-4 mr-2"}),"Save Template"]})]})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-3",children:[r.jsx(Pn,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Universal Template System"}),r.jsx("p",{className:"text-xs sm:text-sm text-blue-700 mt-1",children:"Configure your school's universal template for all documents including invoices, admit cards, certificates, and more. This template will be used across the entire system."})]})]})}),r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 sm:p-6",children:[r.jsxs("h4",{className:"text-base sm:text-lg font-medium text-gray-900 mb-4",children:["School Information",d&&r.jsxs("span",{className:"ml-2 text-xs sm:text-sm text-blue-600",children:[r.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"Loading..."]})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 mb-4",children:r.jsxs("p",{className:"text-xs sm:text-sm text-blue-800",children:[r.jsx("strong",{children:"Note:"})," School information is automatically fetched from your database. Contact your administrator to update school details."]})}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Name"}),r.jsx("input",{type:"text",value:t.schoolName,readOnly:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 text-gray-600"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Code"}),r.jsx("input",{type:"text",value:t.schoolCode,readOnly:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 text-gray-600"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Address"}),r.jsx("input",{type:"text",value:t.address,readOnly:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 text-gray-600"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),r.jsx("input",{type:"text",value:t.phone,readOnly:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 text-gray-600"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),r.jsx("input",{type:"email",value:t.email,readOnly:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 text-gray-600"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),r.jsx("input",{type:"text",value:t.website,readOnly:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 text-gray-600"})]})]})]}),r.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Template Usage"}),r.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[r.jsx("li",{children:" This universal template will be used for all PDF documents"}),r.jsx("li",{children:" Supports invoices, admit cards, certificates, and custom documents"}),r.jsx("li",{children:" Maintains consistent branding across all school documents"}),r.jsx("li",{children:" Preview different document types before finalizing"}),r.jsx("li",{children:" Template is automatically applied to new documents"})]})]})]})},h4=()=>{const{refreshAcademicYear:e}=pn(),[t,n]=j.useState("academic"),[a,s]=j.useState([]),[i,l]=j.useState([]),[d,u]=j.useState(!1),[m,p]=j.useState({}),[f,g]=j.useState(new Set),[N,v]=j.useState("2024-2025"),[w,y]=j.useState("2024-04-01"),[E,O]=j.useState("2025-03-31"),[T,A]=j.useState("2024-25"),[I,C]=j.useState(""),[P,F]=j.useState(!1),[R,$]=j.useState("");j.useEffect(()=>{R&&N!==R&&F(!1)},[N,R]);const L=()=>{const Y=localStorage.getItem("erp.auth");if(Y){const H=JSON.parse(Y),te=H.user?.schoolCode||H.schoolCode||"SB",fe=H.token;return console.log(" Admin Auth Data:",H),console.log(" Extracted School Code:",te),console.log(" Token exists:",!!fe),{schoolCode:te,token:fe}}return console.error(" No auth data found in localStorage"),{schoolCode:null,token:null}},G=async()=>{const{schoolCode:Y,token:H}=L();if(!Y||!H){console.error(" Cannot fetch tests: School code or token not found"),ge.error("Authentication error. Please login again.");return}try{u(!0);const te=`/admin/classes/${Y}/tests`;console.log(" Fetching tests from endpoint:",te),console.log(" Using school code:",Y);const fe=await ot.get(te);if(console.log(" Tests API Response:",fe.data),fe.data.success){const Le=fe.data.data?.tests||fe.data.tests||[];Le.length>0&&(console.log(" First test structure:",Le[0]),console.log(" Test fields:",Object.keys(Le[0]))),s(Le),console.log(" Fetched tests:",Le),ge.success(`Loaded ${Le.length} tests`)}else console.error(" API returned success: false",fe.data),ge.error(fe.data.message||"Failed to fetch tests")}catch(te){console.error(" Error fetching tests:",te),console.error("Error details:",te.response?.data||te.message),ge.error(te.response?.data?.message||"Failed to fetch tests")}finally{u(!1)}},X=async()=>{const{schoolCode:Y,token:H}=L();if(!Y||!H){console.error(" Cannot fetch classes: School code or token not found"),ge.error("Authentication error. Please login again.");return}try{u(!0);const te=`/admin/classes/${Y}/classes-sections`;console.log(" Fetching classes from endpoint:",te),console.log(" Using school code:",Y);const fe=await ot.get(te);if(console.log(" Classes API Response:",fe.data),fe.data.success){const Le=fe.data.data?.classes||fe.data.classes||[];let he=[];try{const re=`/school-users/${Y}/users/role/student`,ie=await ot.get(re);ie.data.success&&(he=ie.data.data||ie.data.users||[],console.log(` Fetched ${he.length} total students`))}catch(re){console.error("Error fetching students:",re)}const be=Le.map(re=>{const ie=re.academicYear||N,ne=he.filter(We=>{const Ie=We.academicInfo?.class||We.studentDetails?.academic?.currentClass||We.studentDetails?.currentClass||We.studentDetails?.class||We.class||We.className,je=We.academicInfo?.section||We.studentDetails?.academic?.currentSection||We.studentDetails?.currentSection||We.studentDetails?.section||We.section,oe=We.studentDetails?.academicYear||We.studentDetails?.academic?.academicYear||We.academicYear||We.academicInfo?.academicYear,$e=String(Ie||"").trim()===String(re.className).trim(),et=!ie||!oe||String(oe).trim()===String(ie).trim();return $e&&et&&!!je}),Te={};re.sections.forEach(We=>{Te[We]=ne.filter(Ie=>{const je=Ie.academicInfo?.section||Ie.studentDetails?.academic?.currentSection||Ie.studentDetails?.currentSection||Ie.studentDetails?.section||Ie.section;return String(je||"").trim().toUpperCase()===String(We).trim().toUpperCase()}).length});const ve=Object.values(Te).reduce((We,Ie)=>We+Ie,0);return{...re,studentCount:ve,sectionCounts:Te}}).sort((re,ie)=>{const ne=["LKG","UKG","1","2","3","4","5","6","7","8","9","10","11","12"],Te=ne.indexOf(re.className),ve=ne.indexOf(ie.className);return Te!==-1&&ve!==-1?Te-ve:Te!==-1?-1:ve!==-1?1:re.className.localeCompare(ie.className)});be.forEach(re=>{re.sections&&re.sections.length>0&&re.sections.sort((ie,ne)=>ie.localeCompare(ne))}),l(be),console.log(" Fetched classes with student counts (sorted):",be),ge.success(`Loaded ${Le.length} classes`)}else console.error(" API returned success: false",fe.data),ge.error(fe.data.message||"Failed to fetch classes")}catch(te){console.error(" Error fetching classes:",te),console.error("Error details:",te.response?.data||te.message),ge.error(te.response?.data?.message||"Failed to fetch classes")}finally{u(!1)}},me=Y=>{g(H=>{const te=new Set(H);return te.has(Y)?te.delete(Y):te.add(Y),te})},se=(Y,H,te)=>{p(fe=>({...fe,[Y]:{...fe[Y],[H]:te}}))},ee=async()=>{const{schoolCode:Y,token:H}=L();if(!Y||!H){ge.error("Authentication error. Please login again.");return}const te=a.filter(fe=>m[fe._id]?.maxMarks);if(te.length===0){ge.error("Please configure at least one test before saving.");return}try{console.log("Saving scoring configuration:",m),console.log(`Saving ${te.length} configured test(s)`);const fe=te.map(K=>({testId:K._id,testName:K.testName,className:K.className,maxMarks:m[K._id]?.maxMarks,weightage:m[K._id]?.weightage})),Le=`/admin/classes/${Y}/test-scoring`,he=await ot.post(Le,{scoring:fe});if(he.data.success){const K=a.length-te.length,be=K>0?`Saved ${te.length} test(s). ${K} test(s) not configured yet.`:`All ${te.length} test(s) configured successfully!`;ge.success(be),console.log(" Saved scoring:",he.data),await G()}else ge.error(he.data.message||"Failed to save scoring")}catch(fe){console.error(" Error saving scoring:",fe),ge.error(fe.response?.data?.message||"Failed to save scoring configuration")}},W=async()=>{const{schoolCode:Y,token:H}=L();if(!(!Y||!H))try{const te=await ot.get(`/admin/academic-year/${Y}`);if(te.data.success){const{currentYear:fe,startDate:Le,endDate:he}=te.data.data;v(fe||"2024-2025"),y(Le?Le.split("T")[0]:"2024-04-01"),O(he?he.split("T")[0]:"2025-03-31"),A(fe||"2024-2025"),$(fe||"2024-2025"),F(!0)}}catch(te){console.error("Error fetching academic year:",te)}},U=async()=>{const{schoolCode:Y,token:H}=L();if(!Y||!H){ge.error("Authentication error");return}try{if(u(!0),(await ot.put(`/admin/academic-year/${Y}`,{currentYear:N,startDate:w,endDate:E})).data.success){const fe=await ot.post(`/admin/migration/${Y}/students/academic-year`,{academicYear:N});if(fe.data.success){const Le=fe.data.data?.updated||0;ge.success(`Academic year updated! ${Le} student(s) updated.`),A(N),$(N),F(!0)}else ge.success("Academic year updated successfully!"),A(N),$(N),F(!0);await e()}}catch(te){console.error("Error saving academic year:",te),ge.error("Failed to save academic year")}finally{u(!1)}};j.useEffect(()=>{t==="academic"?W():t==="scoring"?G():t==="classes"?X():t==="promotion"&&(X(),W())},[t]),j.useEffect(()=>{if(T){const[Y,H]=T.split("-").map(Number),te=Y+1,fe=H+1;H<100?C(`${te}-${fe.toString().slice(-2)}`):C(`${te}-${fe}`)}},[T]),j.useEffect(()=>{if(a.length>0){const Y={};a.forEach(H=>{console.log(` Checking test ${H.testName||H._id}:`,{maxMarks:H.maxMarks,weightage:H.weightage,hasMaxMarks:!!H.maxMarks,hasWeightage:!!H.weightage}),(H.maxMarks||H.weightage)&&(Y[H._id]={maxMarks:H.maxMarks||0,weightage:H.weightage||0},console.log(" Added to initialScoring:",Y[H._id]))}),p(Y),console.log(" Initialized test scoring with existing values:",Y)}},[a]);const Q=[{id:"academic",name:"Academic Year",icon:an},{id:"promotion",name:"Promotion",icon:Jo,disabled:!P},{id:"scoring",name:"Scoring System",icon:Jo},{id:"classes",name:"Class Structure",icon:$n},{id:"templates",name:"Templates",icon:Pn}];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"School Settings"}),t==="scoring"&&r.jsxs("button",{onClick:ee,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors",children:[r.jsx(rs,{className:"h-4 w-4 mr-2"}),"Save Scoring"]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsx("nav",{className:"flex space-x-8 px-6",children:Q.map(Y=>r.jsxs("button",{onClick:()=>!Y.disabled&&n(Y.id),disabled:Y.disabled,className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center transition-colors ${t===Y.id?"border-blue-500 text-blue-600":Y.disabled?"border-transparent text-gray-400 cursor-not-allowed":"border-transparent text-gray-500 hover:text-gray-700"}`,title:Y.disabled?"Please save Academic Year first":"",children:[r.jsx(Y.icon,{className:"h-4 w-4 mr-2"}),Y.name,Y.disabled&&r.jsx("span",{className:"ml-1 text-xs",children:""})]},Y.id))})}),r.jsxs("div",{className:"p-6",children:[t==="academic"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Academic Year Configuration"}),P&&r.jsxs("span",{className:"flex items-center text-sm text-green-600",children:[r.jsx(ba,{className:"h-4 w-4 mr-1"}),"Saved: ",R]})]}),!P&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:" Important:"})," Please save the academic year before proceeding to promotion. This ensures all students are properly assigned to the correct academic year."]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Academic Year"}),r.jsx("input",{type:"text",value:N,onChange:Y=>v(Y.target.value),placeholder:"2024-2025",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year Start"}),r.jsx("input",{type:"date",value:w,onChange:Y=>y(Y.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year End"}),r.jsx("input",{type:"date",value:E,onChange:Y=>O(Y.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),r.jsx("button",{onClick:U,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Save Academic Year"})]}),t==="promotion"&&r.jsx(r.Fragment,{children:P?r.jsx(_Z,{fromYear:T,setFromYear:A,toYear:I,classes:i,loading:d}):r.jsxs("div",{className:"text-center py-12",children:[r.jsx(an,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Academic Year Not Set"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Please save the academic year in the Academic Year tab before proceeding with promotion."}),r.jsx("button",{onClick:()=>n("academic"),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Go to Academic Year Settings"})]})}),t==="scoring"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Scoring System"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Configure max marks and weightage for tests"})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:r.jsxs("p",{className:"text-sm text-blue-800",children:[r.jsx("strong",{children:"Note:"})," Tests are created by SuperAdmin. Here you can configure the scoring parameters (Max Marks and Weightage) for each test."]})}),d?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading tests..."})]}):a.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(iv,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Tests Found"}),r.jsx("p",{className:"text-gray-600",children:"Tests created by SuperAdmin will appear here."}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Ask your SuperAdmin to create tests in the Academics section."})]}):r.jsx("div",{className:"space-y-4",children:a.sort((Y,H)=>{const te=["LKG","UKG","1","2","3","4","5","6","7","8","9","10","11","12"],fe=Y.className,Le=H.className,he=te.indexOf(fe),K=te.indexOf(Le);return he!==-1&&K!==-1?he-K:he!==-1?-1:K!==-1?1:fe.localeCompare(Le)}).map(Y=>{const H=m[Y._id]?.maxMarks||Y.maxMarks,te=f.has(Y._id),fe=Y.testName||Y.name||"Unnamed Test";return!Y.testName&&!Y.name&&console.warn(" Test missing name:",Y),r.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow",children:[r.jsxs("div",{onClick:()=>me(Y._id),className:"flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50 transition-colors",children:[r.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[te?r.jsx(Gs,{className:"h-5 w-5 text-gray-500 flex-shrink-0"}):r.jsx(lv,{className:"h-5 w-5 text-gray-500 flex-shrink-0"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"flex items-baseline gap-2",children:r.jsx("h3",{className:"text-base font-semibold text-gray-900",children:fe})}),r.jsxs("p",{className:"text-sm text-gray-600 mt-0.5",children:["Class ",Y.className]})]})]}),r.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full flex-shrink-0 ${H?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:H?"Configured":"Not Configured"})]}),te&&r.jsx("div",{className:"p-4 pt-0 border-t border-gray-100",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Marks"}),r.jsxs("select",{value:m[Y._id]?.maxMarks||Y.maxMarks||"",onChange:Le=>se(Y._id,"maxMarks",parseInt(Le.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[r.jsx("option",{value:"",children:"Select max marks"}),r.jsx("option",{value:"20",children:"20"}),r.jsx("option",{value:"25",children:"25"}),r.jsx("option",{value:"30",children:"30"}),r.jsx("option",{value:"40",children:"40"}),r.jsx("option",{value:"50",children:"50"}),r.jsx("option",{value:"60",children:"60"}),r.jsx("option",{value:"70",children:"70"}),r.jsx("option",{value:"80",children:"80"}),r.jsx("option",{value:"90",children:"90"}),r.jsx("option",{value:"100",children:"100"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Weightage (%)"}),r.jsxs("select",{value:m[Y._id]?.weightage||Y.weightage||"",onChange:Le=>se(Y._id,"weightage",parseInt(Le.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[r.jsx("option",{value:"",children:"Select weightage"}),r.jsx("option",{value:"5",children:"5%"}),r.jsx("option",{value:"10",children:"10%"}),r.jsx("option",{value:"15",children:"15%"}),r.jsx("option",{value:"20",children:"20%"}),r.jsx("option",{value:"25",children:"25%"}),r.jsx("option",{value:"30",children:"30%"}),r.jsx("option",{value:"35",children:"35%"}),r.jsx("option",{value:"40",children:"40%"}),r.jsx("option",{value:"50",children:"50%"}),r.jsx("option",{value:"60",children:"60%"}),r.jsx("option",{value:"70",children:"70%"}),r.jsx("option",{value:"80",children:"80%"}),r.jsx("option",{value:"100",children:"100%"})]})]})]})})]},Y._id)})}),r.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"How it works:"}),' SuperAdmin creates tests (e.g., "Maths for Class 1"). You configure the scoring parameters here. Tests will appear automatically when SuperAdmin adds them.']})})]}),t==="classes"&&r.jsxs("div",{className:"space-y-6",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Class Structure"}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:r.jsxs("p",{className:"text-sm text-blue-800",children:[r.jsx("strong",{children:"Note:"})," Classes and sections are managed by SuperAdmin. This is a read-only view."]})}),d?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading classes..."})]}):i.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(xs,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Classes Found"}),r.jsx("p",{className:"text-gray-600",children:"Classes created by SuperAdmin will appear here."}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Ask your SuperAdmin to create classes in the Academics section."})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:i.map(Y=>r.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("h4",{className:"font-medium text-gray-900",children:["Class ",Y.className]}),r.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[Y.sections.length," sections"]})]}),r.jsx("div",{className:"mb-3 p-2 bg-gray-50 rounded-md",children:r.jsxs("p",{className:"text-sm font-medium text-gray-700 flex items-center",children:[r.jsx($n,{className:"h-4 w-4 mr-1"}),"Total Students: ",Y.studentCount!==void 0?Y.studentCount:"..."]})}),Y.sections.length>0?r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Sections"}),Y.sections.map((H,te)=>r.jsxs("div",{className:"flex items-center justify-between text-sm bg-white border border-gray-100 rounded-md p-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),r.jsxs("span",{className:"text-gray-700",children:["Section ",H]})]}),r.jsxs("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded-full font-medium",children:[Y.sectionCounts?.[H]!==void 0?Y.sectionCounts[H]:"..."," students"]})]},te))]}):r.jsx("p",{className:"text-sm text-gray-500 italic",children:"No sections added"})]},Y._id))})]}),t==="templates"&&r.jsx(FZ,{})]})]})]})},BZ=({selectedStudents:e,onClose:t,initialOrientation:n="landscape",lockOrientation:a=!1})=>{const[s,i]=j.useState(n),[l,d]=j.useState(!0),[u,m]=j.useState(!1),[p,f]=j.useState(!1),[g,N]=j.useState([]),[v,w]=j.useState(!1),[y,E]=j.useState(null),[O,T]=j.useState(!1),[A,I]=j.useState(a),C="https://erp-backend-kfut.onrender.com/api",P=async()=>{if(e.length===0){_t.error("Please select at least one student");return}try{m(!0);const L=localStorage.getItem("erp.auth"),G=L?JSON.parse(L).token:null,X=e.map(ee=>ee._id||ee.id),me=localStorage.getItem("erp.schoolCode")||"";console.log(" Generating ID cards for students:",{studentIds:X.map((ee,W)=>({id:ee,isValidObjectId:/^[0-9a-fA-F]{24}$/.test(ee),studentName:e[W]?.name})),students:e,orientation:s,orientationType:typeof s,orientationValue:`"${s}"`,includeBack:l,apiUrl:`${C}/id-card-templates/generate`,schoolCode:me,hasToken:!!G}),console.log(" CRITICAL - ORIENTATION VALUE:",s),console.log(" IS PORTRAIT?",s==="portrait"),console.log(" IS LANDSCAPE?",s==="landscape");const se=await tn.post(`${C}/id-card-templates/generate`,{studentIds:X,orientation:s,includeBack:l},{headers:{Authorization:`Bearer ${G}`,"X-School-Code":me}});if(console.log(" ID cards generated successfully:",se.data),se.data.success){const ee=e.slice(0,se.data.data.totalGenerated).map((W,U)=>({studentId:W._id||W.id,studentName:W.name,sequenceId:W.sequenceId||`STU${String(U+1).padStart(3,"0")}`,frontCard:null,backCard:null,success:!0}));N(ee),w(!0),I(!0),_t.success(se.data.message)}}catch(L){console.error(" Error generating ID cards:",L),console.error("Error details:",{message:L.message,response:L.response?.data,status:L.response?.status});const G=L.response?.data?.message||"Failed to generate ID cards",X=L.response?.data?.debug?.hint;X?_t.error(`${G}

${X}`,{duration:6e3}):_t.error(G)}finally{m(!1)}},F=async()=>{if(e.length===0){_t.error("Please select at least one student");return}try{f(!0);const L=localStorage.getItem("erp.auth"),G=L?JSON.parse(L).token:null,X=e.map(U=>U._id||U.id),me=localStorage.getItem("erp.schoolCode")||"";console.log(" Downloading ID cards (Bulk ZIP) for students:",{count:e.length,studentIds:X,orientation:s,includeBack:l,schoolCode:me});const se=await tn.post(`${C}/id-card-templates/download`,{studentIds:X,orientation:s,includeBack:l},{headers:{Authorization:`Bearer ${G}`,"X-School-Code":me},responseType:"blob"}),ee=window.URL.createObjectURL(new Blob([se.data])),W=document.createElement("a");W.href=ee,W.setAttribute("download",`IDCards_Bulk_${Date.now()}.zip`),document.body.appendChild(W),W.click(),W.remove(),window.URL.revokeObjectURL(ee),_t.success(`ID cards downloaded successfully (${e.length} students in folders)`)}catch(L){console.error(" Error downloading ID cards:",L),console.error("Error details:",{message:L.message,response:L.response?.data,status:L.response?.status});const G=L.response?.data?.message||"Failed to download ID cards",X=L.response?.data?.debug?.hint;X?_t.error(`${G}

${X}`,{duration:6e3}):_t.error(G)}finally{f(!1)}},R=async L=>{try{const G=localStorage.getItem("erp.auth"),X=G?JSON.parse(G).token:null,me=localStorage.getItem("erp.schoolCode")||"";console.log(" Downloading ID card for individual student:",L.name);const se=await tn.post(`${C}/id-card-templates/download`,{studentIds:[L._id||L.id],orientation:s,includeBack:l},{headers:{Authorization:`Bearer ${X}`,"X-School-Code":me},responseType:"blob"}),ee=window.URL.createObjectURL(new Blob([se.data])),W=document.createElement("a");W.href=ee,W.setAttribute("download",`IDCard_${L.name.replace(/[^a-zA-Z0-9]/g,"_")}.zip`),document.body.appendChild(W),W.click(),W.remove(),window.URL.revokeObjectURL(ee),_t.success(`ID card downloaded for ${L.name}`)}catch(G){console.error(" Error downloading individual ID card:",G),_t.error(`Failed to download ID card for ${L.name}`)}},$=async(L,G="front")=>{try{const X=localStorage.getItem("erp.auth"),me=X?JSON.parse(X).token:null,se=localStorage.getItem("erp.schoolCode")||"";console.log(" Previewing ID card:",{studentId:L,side:G,orientation:s});const ee=`${C}/id-card-templates/preview?studentId=${L}&orientation=${s}&side=${G}`,W=await fetch(ee,{headers:{Authorization:`Bearer ${me}`,"X-School-Code":se}});if(W.ok){const U=await W.blob(),Q=URL.createObjectURL(U);E(Q),T(!0)}else _t.error("Failed to load preview")}catch(X){console.error("Error loading preview:",X),_t.error("Failed to load preview")}};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Generate ID Cards (",e.length," students)"]}),r.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-2xl leading-none",children:""})]}),r.jsx("div",{className:"p-6",children:v?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-6",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(ba,{className:"w-6 h-6 text-green-600"}),r.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"ID Cards Generated Successfully!"})]}),r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:r.jsxs("p",{className:"text-sm text-green-800",children:["Generated ",g.length," ID cards in ",r.jsx("strong",{children:s})," orientation. You can preview them below or download all as ZIP."]})}),r.jsx("div",{className:"max-h-96 overflow-y-auto border border-gray-200 rounded-lg",children:g.map((L,G)=>{const X=e.find(me=>(me._id||me.id)===L.studentId);return r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 last:border-0",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:L.studentName}),r.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",L.studentId]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>$(L.studentId,"front"),className:"text-xs px-3 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"View Front"}),l&&r.jsx("button",{onClick:()=>$(L.studentId,"back"),className:"text-xs px-3 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"View Back"}),X&&r.jsxs("button",{onClick:()=>R(X),className:"text-xs px-3 py-1 bg-green-50 text-green-600 rounded hover:bg-green-100 flex items-center gap-1",children:[r.jsx(Ci,{className:"w-3 h-3"}),"Download"]})]})]},G)})})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{w(!1),N([]),I(!1)},className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Generate Again"}),r.jsx("button",{onClick:F,disabled:p,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p?r.jsxs(r.Fragment,{children:[r.jsx(Hl,{className:"w-5 h-5 animate-spin"}),"Downloading..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Ci,{className:"w-5 h-5"}),"Download All (Bulk ZIP with Folders)"]})})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[r.jsx(sa,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),r.jsxs("div",{className:"text-sm text-blue-800",children:[r.jsx("p",{className:"font-medium mb-1",children:"Template Setup Required"}),r.jsx("p",{children:"Make sure you have placed your ID card template PNG files in:"}),r.jsx("code",{className:"block mt-1 bg-blue-100 px-2 py-1 rounded text-xs",children:"backend/idcard-templates/"}),r.jsxs("p",{className:"mt-2",children:["Required files: ",s,"-front.png",l&&", "+s+"-back.png"]})]})]}),r.jsxs("div",{className:"space-y-4 mb-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Choose ID Card Orientation"}),r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg transition-all ${s==="landscape"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${A?"opacity-60 cursor-not-allowed":"cursor-pointer"}`,children:[r.jsx("input",{type:"radio",value:"landscape",checked:s==="landscape",onChange:L=>i(L.target.value),disabled:A,className:"mr-3"}),r.jsx(F4,{className:"w-8 h-8 mr-3 text-blue-600"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:"Landscape"}),r.jsx("div",{className:"text-sm text-gray-500",children:"Horizontal ID card (85.6mm  54mm) - Credit card style layout"})]})]}),r.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg transition-all ${s==="portrait"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${A?"opacity-60 cursor-not-allowed":"cursor-pointer"}`,children:[r.jsx("input",{type:"radio",value:"portrait",checked:s==="portrait",onChange:L=>i(L.target.value),disabled:A,className:"mr-3"}),r.jsx(B4,{className:"w-8 h-8 mr-3 text-blue-600"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:"Portrait"}),r.jsx("div",{className:"text-sm text-gray-500",children:"Vertical ID card (54mm  85.6mm) - Vertical layout with larger photo"})]})]})]}),A&&r.jsx("p",{className:"text-xs text-blue-600 mt-2",children:" Orientation is locked as selected from the previous page"})]}),r.jsx("div",{children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:l,onChange:L=>d(L.target.checked),className:"mr-2"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Include back side"})]})})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Selected Students:"}),r.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3",children:e.map(L=>r.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-0",children:[r.jsx("span",{className:"text-sm text-gray-900",children:L.name}),r.jsxs("span",{className:"text-xs text-gray-500",children:[L.className," - ",L.section]})]},L._id))})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:P,disabled:u,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?r.jsxs(r.Fragment,{children:[r.jsx(Hl,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(wn,{className:"w-5 h-5"}),"Generate & Preview"]})}),r.jsx("button",{onClick:F,disabled:p,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p?r.jsxs(r.Fragment,{children:[r.jsx(Hl,{className:"w-5 h-5 animate-spin"}),"Downloading..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Ci,{className:"w-5 h-5"}),"Download ZIP"]})})]})]})})]})}),O&&y&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:`bg-white rounded-lg w-full overflow-auto ${s==="portrait"?"max-w-2xl max-h-[95vh]":"max-w-5xl max-h-[90vh]"}`,children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["ID Card Preview (",s==="portrait"?"Portrait":"Landscape",")"]}),r.jsx("button",{onClick:()=>{T(!1),y&&URL.revokeObjectURL(y),E(null)},className:"text-gray-500 hover:text-gray-700 text-2xl leading-none",children:""})]}),r.jsx("div",{className:"p-6 flex justify-center bg-gray-50",children:r.jsx("img",{src:y,alt:"ID Card Preview",className:`${s==="portrait"?"w-auto h-auto max-h-[80vh]":"max-w-full h-auto"} shadow-lg`})})]})})]})},UZ=()=>{const{token:e,user:t}=yr(),{currentAcademicYear:n,viewingAcademicYear:a,isViewingHistoricalYear:s,setViewingYear:i,availableYears:l,loading:d}=pn(),{classesData:u,loading:m,error:p,getSectionsByClass:f,hasClasses:g}=Ea(),[N,v]=j.useState("subjects"),[w,y]=j.useState([]),[E,O]=j.useState(""),[T,A]=j.useState(""),[I,C]=j.useState([]),[P,F]=j.useState(""),[R,$]=j.useState(""),[L,G]=j.useState(!1),[X,me]=j.useState(""),[se,ee]=j.useState(""),[W,U]=j.useState(""),[Q,Y]=j.useState(""),[H,te]=j.useState(!1),[fe,Le]=j.useState(["Bring this admit card to the examination hall","Report 30 minutes before the exam","Carry valid ID proof with this admit card","Mobile phones strictly prohibited","Follow all examination rules","Malpractice leads to disqualification"]),[he,K]=j.useState(""),[be,re]=j.useState(""),[ie,ne]=j.useState(""),[Te,ve]=j.useState(""),[We,Ie]=j.useState([]),je=[{id:"landscape",name:"Landscape",description:"Horizontal ID card (85.6mm  54mm)",preview:"Credit card style layout"},{id:"portrait",name:"Portrait",description:"Vertical ID card (54mm  85.6mm)",preview:"Vertical layout with larger photo"}],[oe,$e]=j.useState(""),[et,lt]=j.useState(null),[rt,Lt]=j.useState(!1),[kt,Oe]=j.useState(!1);LZ();const[Nt,Mt]=j.useState([]),[rr,Ft]=j.useState([]),[cr,or]=j.useState([]),[ke,ht]=j.useState({}),[_e,tt]=j.useState([]),[gt,Pt]=j.useState(!1);j.useEffect(()=>{if(E&&u){const ae=f(E);C(ae),ae.length>0?A(ae[0].value):A("")}else C([]),A("")},[E,u]),j.useEffect(()=>{if(se&&u){const ae=f(se);tt(ae),ae.length>0?U(ae[0].value):U("")}else tt([]),U("")},[se,u]),j.useEffect(()=>{se&&W&&u?b():Mt([])},[se,W,u]);const Ot=(u?.classes?.map(ae=>ae.className)||[]).sort((ae,ct)=>{const st=parseInt(ae),dt=parseInt(ct);return!isNaN(st)&&!isNaN(dt)?st-dt:ae.localeCompare(ct)});console.log(" Classes sorted in ascending order:",Ot);const vt=async()=>{G(!0);try{const ae=localStorage.getItem("erp.schoolCode")||t?.schoolCode||"";console.log("Fetching subjects with school code:",ae);const st=(await ot.get("/class-subjects/classes")).data;st&&st.data&&st.data.classes?y(st.data.classes||[]):(console.log("Regular API failed, trying direct test endpoints..."),await nr())}catch(ae){console.error("Error fetching class subjects:",ae),_t.error("Error connecting to server, trying fallback..."),await nr()}finally{G(!1)}},nr=async()=>{try{const ae=localStorage.getItem("erp.schoolCode")||t?.schoolCode||"";if(!ae){_t.error("School code not available");return}console.log("Trying direct endpoints with school code:",ae);const st=(await Promise.all(Ot.map(async dt=>{try{const xt=(await ot.get(`/direct-test/class-subjects/${dt}?schoolCode=${ae}`)).data;return xt&&xt.data?xt.data:(console.log(`No subjects found for class ${dt}`),null)}catch(it){return console.error(`Error fetching class ${dt}:`,it),null}}))).filter(Boolean);y(st),st.length>0?_t.success(`Found ${st.length} classes using fallback method`):_t.error("No class data available")}catch(ae){console.error("Error in fallback method:",ae),_t.error("Failed to fetch class data")}};j.useEffect(()=>{vt()},[]);const Yt=async()=>{if(!E){_t.error("Please select a class first");return}if(!T){_t.error("Please select a section first");return}if(!X.trim()){_t.error("Please enter a subject name");return}try{const ae=localStorage.getItem("erp.schoolCode")||t?.schoolCode||"";console.log("Adding subject with school code:",ae,"class:",E,"section:",T);const st=(await ot.post("/class-subjects/add-subject",{className:E,grade:E,section:T,subjectName:X.trim()})).data;_t.success(st.message),me(""),vt()}catch(ae){console.error("Error adding subject:",ae),_t.error("Network error while adding subject")}},Or=async(ae,ct,st)=>{try{const dt=localStorage.getItem("erp.schoolCode")||t?.schoolCode||"",xt=(await ot.delete("/class-subjects/remove-subject",{data:{className:ae,section:ct,subjectName:st}})).data;_t.success(xt.message||"Subject removed successfully"),vt()}catch(dt){console.error("Error removing subject:",dt),_t.error(dt.response?.data?.message||"Error removing subject")}},Sr=ae=>{ae.key==="Enter"&&Yt()},$t=(ae,ct)=>w.find(dt=>dt.className===ae&&dt.section===ct)?.subjects||[],gr=ae=>{F(P===ae?"":ae)},kr=(ae,ct)=>{const st=`${ae}-${ct}`;$(R===st?"":st)},b=async()=>{try{if(!u){console.log(" Classes data not loaded yet, waiting...");return}console.log(" Using tests from useSchoolClasses hook"),console.log(" Available tests data:",u.tests),console.log(" Tests by class:",u.testsByClass),console.log(" Looking for tests in class:",se);let ae=u.testsByClass[se]||[];if(console.log(" Raw class tests for class",se,":",ae),console.log(" Available class keys:",Object.keys(u.testsByClass)),ae.length===0){const st=String(se);ae=u.testsByClass[st]||[],console.log(" Trying alternative key format:",st,"Result:",ae),ae.length===0&&(ae=(u.tests||[]).filter(it=>it.className===se||it.className===String(se)||String(it.className)===String(se)),console.log(" Trying direct filter from all tests:",ae))}const ct=ae.map(st=>({id:st._id||st.testId,name:st.testName||st.displayName||st.name,className:st.className,section:W,subjects:[]}));Mt(ct),console.log(" Fetched tests for class from hook:",ct),console.log(" Transformed tests count:",ct.length),ct.length===0?(console.log(` No tests configured for Class ${se}`),_t.success(`No tests configured for Class ${se}. Please configure tests in the scoring system first.`)):_t.success(`Found ${ct.length} test(s) for Class ${se}`)}catch(ae){console.error("Error fetching tests:",ae),_t.error("Failed to fetch available tests"),Mt([{id:"mock-1",name:"Unit Test 1",className:se,section:W,subjects:[]},{id:"mock-2",name:"Mid Term Exam",className:se,section:W,subjects:[]}])}},B=async()=>{if(!se||!W||!Q){_t.error("Please select class, section, and test");return}Pt(!0);try{const ae=localStorage.getItem("erp.schoolCode")||t?.schoolCode||"";try{const ct=await ot.get("/class-subjects/classes"),st=ct.data;if(console.log(" Class-subjects API response:",st),st&&st.data){const dt=st?.data?.classes?.find(it=>it.className===se&&it.section===W);if(dt&&dt.subjects){const it=dt.subjects.filter(qt=>qt.isActive!==!1);console.log(" Total subjects:",dt.subjects.length,"Active subjects:",it.length);const xt=it.map((qt,Ar)=>({id:`${se}-${W}-${qt.name}-${Q}`,name:qt.name,className:se,section:W,testName:Nt.find(Ir=>Ir.id===Q)?.name||"Test"}));or(xt);const Bt={};xt.forEach(qt=>{Bt[qt.id]={subjectId:qt.id,examDate:"",examTime:"",examHour:"00",examMinute:"00",examAmPm:"AM",roomNumber:""}}),ht(Bt),await Pe(),_t.success(`Found ${xt.length} subjects`);return}else console.log(" No subjects found for class-section combination in primary API")}else console.log(" Primary API response not OK:",ct.status)}catch(ct){console.log(" Primary API failed, using fallback method...",ct)}try{console.log(" Trying fallback endpoint for subjects...");const st=(await ot.get(`/direct-test/class-subjects/${se}?schoolCode=${ae}`)).data;if(console.log(" Fallback API response:",st),st&&st.data)if(st.data&&st.data.subjects&&st.data.subjects.length>0){const dt=st.data.subjects.map((xt,Bt)=>({id:`${se}-${W}-${xt.name}-${Q}`,name:xt.name,className:se,section:W,testName:Nt.find(qt=>qt.id===Q)?.name||"Test"}));or(dt);const it={};dt.forEach(xt=>{it[xt.id]={subjectId:xt.id,examDate:"",examTime:"",examHour:"00",examMinute:"00",examAmPm:"AM",roomNumber:""}}),ht(it),await Pe(),_t.success(`Found ${dt.length} subjects via fallback`);return}else console.log(" Fallback API returned no subjects");else console.log(" Fallback API response not OK")}catch(ct){console.error(" Fallback API also failed:",ct)}console.log(" No subjects found for class-section combination"),_t.error(`No subjects configured for Class ${se} Section ${W}. Please add subjects first in the "Class Subjects Management" tab.`),or([]),ht({})}catch(ae){console.error("Error fetching subjects:",ae),_t.error("Failed to fetch subjects")}finally{Pt(!1)}},Pe=async()=>{if(!se||!W){_t.error("Please select class and section first");return}try{const ae=localStorage.getItem("erp.schoolCode")||t?.schoolCode||"",ct=e||localStorage.getItem("erp.authToken");if(!ae||!ct){_t.error("Authentication required. Please login again."),console.error(" Missing credentials:",{schoolCode:!!ae,token:!!ct});return}console.log(` Fetching students for Hall Tickets - Class ${se} Section ${W}`);let st=[];const dt=(xt,Bt)=>({id:xt._id||xt.id,name:xt.name?.displayName||`${xt.name?.firstName||""} ${xt.name?.lastName||""}`.trim()||xt.firstname+" "+xt.lastname||"Unknown Student",rollNumber:xt.studentDetails?.rollNumber||xt.rollNumber||xt.sequenceId||`${ae}-${W}-${String(Bt+1).padStart(4,"0")}`,sequenceId:xt.userId||xt.studentDetails?.admissionNumber||xt.sequenceId||`${ae}-${W}-${String(Bt+1).padStart(4,"0")}`,className:se,section:W,profileImage:(()=>{const qt=xt.profileImage||xt.profilePicture;return qt?qt.startsWith("/uploads")?`${"https://erp-backend-kfut.onrender.com/api".replace(/\/api\/?$/,"")}${qt}`:qt:null})()}),it=(xt,Bt,qt,Ar)=>{const Ir=xt.studentDetails?.currentClass||xt.currentclass||xt.class||xt.className||xt.academicInfo?.class||"",gn=xt.studentDetails?.currentSection||xt.currentsection||xt.section||xt.academicInfo?.section||"",sn=String(Ir).trim()===String(Bt).trim(),Ht=String(gn).trim().toUpperCase()===String(qt).trim().toUpperCase();return(!sn||!Ht)&&console.log(` Student ${xt.name?.displayName||xt.userId} filtered out (${Ar}). Class: '${Ir}' (Req: '${Bt}'), Section: '${gn}' (Req: '${qt}')`),sn&&Ht};try{console.log(" Trying school-users (by role) endpoint first...");const Bt=(await ot.get(`/school-users/${ae}/users/role/student`)).data;if(Bt&&Bt.success&&Bt.data&&Bt.data.length>0){const qt=Bt.data.filter(Ar=>it(Ar,se,W,"Primary API"));qt.length>0?(console.log(` Found ${qt.length} students via (by role) endpoint.`),st=qt.map(dt)):console.log(` No students found for Class ${se} Section ${W} in ${Bt.data.length} total students from (by role) endpoint. Will try fallback.`)}}catch(xt){console.log(" Students API (/role/student) failed, trying fallback:",xt)}if(st.length===0){console.log(" Trying school-users (get all) endpoint as fallback...");try{const Bt=(await ot.get(`/school-users/${ae}/users`)).data;if(Bt&&Bt.success&&Bt.data&&Bt.data.length>0){const qt=Bt.data.filter(Ar=>Ar.role==="student"?it(Ar,se,W,"Fallback API"):!1);qt.length>0?(console.log(` Found ${qt.length} students via (get all) fallback endpoint.`),st=qt.map(dt)):console.log(" Fallback (get all) endpoint also found no matching students.")}}catch(xt){console.log(" School-users (get all) API also failed:",xt)}}st.length>0?(Ft(st),_t.success(`Loaded ${st.length} students for Class ${se} Section ${W}`),console.log(" Real students loaded:",st)):(console.log(" No students found for the selected class and section after all attempts."),Ft([]),_t.error(`No students found for Class ${se} Section ${W}. Please check student data.`))}catch(ae){console.error("Error in fetchStudentsForClass:",ae),Ft([])}},Se=async()=>{try{const ae=localStorage.getItem("erp.schoolCode")||t?.schoolCode||"";if(!ae||!e){_t.error("Authentication error. Please login again.");return}console.log(` Fetching students for ID Cards - Class ${be} Section ${ie}`);let ct=[];const st=(it,xt)=>({_id:it._id||it.id,id:it._id||it.id,name:it.name?.displayName||`${it.name?.firstName||""} ${it.name?.lastName||""}`.trim()||"Unknown Student",rollNumber:it.studentDetails?.rollNumber||it.rollNumber||`${ae}-${ie}-${String(xt+1).padStart(4,"0")}`,sequenceId:it.userId||it.studentDetails?.admissionNumber||`${ae}-${ie}-${String(xt+1).padStart(4,"0")}`,className:be,section:ie,profileImage:it.profileImage||it.profilePicture||null,fatherName:it.parentDetails?.fatherName||it.fatherName||it.parent?.father?.name||"Not Available",motherName:it.parentDetails?.motherName||it.motherName||it.parent?.mother?.name||"Not Available",dateOfBirth:it.personalDetails?.dateOfBirth||it.dateOfBirth||it.dob||it.personal?.dateOfBirth||"Not Available",bloodGroup:it.personalDetails?.bloodGroup||it.bloodGroup||it.personal?.bloodGroup||it.medicalInfo?.bloodGroup||"Not Available",address:it.address?.permanent?.street||it.address?.street||it.personalDetails?.address||it.address||"Not Available",phone:it.contact?.primaryPhone||it.contact?.phone||it.phone||it.personalDetails?.phone||"Not Available"}),dt=(it,xt,Bt,qt)=>{const Ar=it.studentDetails?.currentClass||it.currentclass||it.class||it.className||it.academicInfo?.class||"",Ir=it.studentDetails?.currentSection||it.currentsection||it.section||it.academicInfo?.section||"",gn=String(Ar).trim()===String(xt).trim(),sn=String(Ir).trim().toUpperCase()===String(Bt).trim().toUpperCase();return(!gn||!sn)&&console.log(` Student ${it.name?.displayName||it.userId} filtered out (${qt}). Class: '${Ar}' (Req: '${xt}'), Section: '${Ir}' (Req: '${Bt}')`),gn&&sn};try{console.log(" Trying school-users (by role) endpoint first for ID Cards...");const xt=(await ot.get(`/school-users/${ae}/users/role/student`)).data;if(xt&&xt.success&&xt.data&&xt.data.length>0){const Bt=xt.data.filter(qt=>dt(qt,be,ie,"Primary API"));Bt.length>0?(console.log(` Found ${Bt.length} students via (by role) endpoint.`),ct=Bt.map(st)):console.log(` No students found for Class ${be} Section ${ie} in ${xt.data.length} total students from (by role) endpoint. Will try fallback.`)}}catch(it){console.log(" ID Card Students API (/role/student) failed, trying fallback:",it)}if(ct.length===0){console.log(" Trying school-users (get all) endpoint for ID Cards...");try{const xt=(await ot.get(`/school-users/${ae}/users`)).data;if(xt&&xt.success&&xt.data&&xt.data.length>0){const Bt=xt.data.filter(qt=>qt.role==="student"?dt(qt,be,ie,"Fallback API"):!1);Bt.length>0?(console.log(` Found ${Bt.length} students via (get all) fallback endpoint.`),ct=Bt.map(st)):console.log(" Fallback (get all) endpoint also found no matching students.")}}catch(it){console.log(" School-users (get all) API also failed:",it)}}ct.length>0?(Ie(ct),_t.success(`Loaded ${ct.length} students for ID card generation`),console.log(" ID Card students loaded:",ct)):(console.log(" No students found for the selected class and section after all attempts."),Ie([]),_t.error(`No students found for Class ${be} Section ${ie}. Please add students to this class first.`))}catch(ae){console.error("Error in fetchStudentsForIdCards:",ae),Ie([])}},Ae=(ae,ct,st)=>{ht(dt=>{const it=dt[ae]||{},xt={...it,[ct]:st};if(ct==="examHour"||ct==="examMinute"||ct==="examAmPm"){const Bt=ct==="examHour"?st:it.examHour||"00",qt=ct==="examMinute"?st:it.examMinute||"00",Ar=ct==="examAmPm"?st:it.examAmPm||"AM";let Ir=parseInt(Bt);Bt==="00"&&(Ir=12),Ar==="AM"&&Ir===12&&(Ir=0),Ar==="PM"&&Ir!==12&&(Ir+=12),xt.examTime=`${Ir.toString().padStart(2,"0")}:${qt}`,console.log(` Auto-updating examTime: ${Bt}:${qt} ${Ar}  ${xt.examTime}`)}return{...dt,[ae]:xt}})},Xe=()=>{he.trim()&&!fe.includes(he.trim())?(Le(ae=>[...ae,he.trim()]),K(""),_t.success("Instruction added successfully")):fe.includes(he.trim())&&_t.error("This instruction already exists")},Ke=ae=>{Le(ct=>ct.filter((st,dt)=>dt!==ae)),_t.success("Instruction removed successfully")},Ve=()=>{Le(["Bring this admit card to the examination hall","Report 30 minutes before the exam","Carry valid ID proof with this admit card","Mobile phones strictly prohibited","Follow all examination rules","Malpractice leads to disqualification"]),_t.success("Instructions reset to default")},ut=ae=>new Promise((ct,st)=>{console.log(" Starting image conversion for URL:",ae);const dt=new Image;dt.crossOrigin="anonymous",dt.onload=()=>{console.log(" Image loaded successfully, converting to base64...");try{const it=document.createElement("canvas"),xt=it.getContext("2d");if(!xt){st(new Error("Failed to get canvas context"));return}it.width=dt.width,it.height=dt.height,xt.drawImage(dt,0,0);const Bt=it.toDataURL("image/png");console.log(" Base64 conversion successful, length:",Bt.length),ct(Bt)}catch(it){console.error(" Canvas conversion error:",it),st(it)}},dt.onerror=it=>{console.error(" Image load error:",it),console.error(" Failed URL:",ae),st(new Error("Failed to load image from URL"))},dt.src=ae,console.log(" Image src set, waiting for load...")}),Je=async()=>{const ae=cr.filter(st=>{const dt=ke[st.id],it=dt?.examDate&&dt?.examHour&&dt?.examMinute&&dt?.examAmPm;return console.log(` Checking subject ${st.name}:`,{examDate:dt?.examDate,examHour:dt?.examHour,examMinute:dt?.examMinute,examAmPm:dt?.examAmPm,roomNumber:dt?.roomNumber,hasRequiredFields:it}),H?it&&dt?.roomNumber:it});if(ae.length===0){const st=H?"exam date, time, and room number":"exam date and time";_t.error(`Please fill ${st} for at least one subject`);return}if(rr.length===0){_t.error("No students found for hall ticket generation");return}const ct=_t.loading("Preparing admit cards with school information...");try{const st=Nt.find(Ht=>Ht.id===Q)?.name||"Exam";let dt={schoolName:t?.schoolName||"School Name",schoolCode:t?.schoolCode||"SCH001",website:"www.edulogix.com",logoUrl:"",headerColor:"#1f2937",accentColor:"#3b82f6",address:"123 School Street, City, State 12345",phone:"+91-XXXXXXXXXX",email:"info@school.com"};const it=localStorage.getItem("universalTemplate");if(console.log(" Raw localStorage data:",it),it)try{const Ht=JSON.parse(it);console.log(" Parsed template data:",Ht),dt={...dt,...Ht},console.log(" Using saved UniversalTemplate settings:",dt)}catch(Ht){console.log(" Failed to parse saved template data:",Ht)}else console.log(" No universalTemplate found in localStorage"),console.log(" Available localStorage keys:",Object.keys(localStorage));const xt=dt.schoolCode==="SCH001"||dt.schoolName==="School Name";if((!it||xt)&&(t?.schoolCode||t?.schoolId)){console.log("No saved template, fetching school data using UniversalTemplate logic...");let Ht=null;try{console.log("Fetching school info using school API...");let Dr;const dr=t?.schoolId||t?.schoolCode;if(dr)try{Dr=await ot.get(`/schools/${dr}/info`),console.log("Success with school info endpoint:",Dr?.data)}catch{console.log("School info endpoint failed, trying original endpoint..."),Dr=await Kn.getSchoolById(dr),console.log("Success with original endpoint:",Dr?.data)}const Vt=Dr?.data?.data||Dr?.data;if(Vt&&(Vt.name||Vt.schoolName)){console.log("School data found:",Vt);let er="123 School Street, City, State 12345";if(Vt.address){const dn=Vt.address;er=[dn.area||dn.street?.substring(0,30),dn.city,dn.state,dn.pinCode||dn.zipCode].filter(Boolean).join(", "),er.length>60&&(er=er.substring(0,57)+"...")}let Nr=Vt.contact?.website||Vt.website||"www.edulogix.com";Nr.length>25&&(Nr=Nr.replace(/^https?:\/\//,"").replace(/^www\./,""),Nr.length>25&&(Nr=Nr.substring(0,22)+"..."));let xn="";Vt.logoUrl&&(Vt.logoUrl.startsWith("/uploads")?(xn=`${"https://erp-backend-kfut.onrender.com/api".replace(/\/api\/?$/,"")}${Vt.logoUrl}`,console.log(" Constructed logo URL:",xn)):(xn=Vt.logoUrl,console.log(" Using direct logo URL:",xn))),Ht={schoolName:Vt.name||Vt.schoolName||t?.schoolName,schoolCode:Vt.code||Vt.schoolCode||t?.schoolCode,address:er,phone:Vt.contact?.phone||Vt.phone||Vt.contactNumber||dt.phone,email:Vt.contact?.email||Vt.email||Vt.contactEmail||Vt.principalEmail||dt.email,website:Nr,logoUrl:xn}}Ht?dt={...dt,schoolName:Ht.schoolName||dt.schoolName,schoolCode:Ht.schoolCode||dt.schoolCode,address:Ht.address||dt.address,phone:Ht.phone||dt.phone,email:Ht.email||dt.email,website:Ht.website||dt.website,logoUrl:Ht.logoUrl||dt.logoUrl}:(console.log("Using fallback data from user context"),dt={...dt,schoolName:t?.schoolName||dt.schoolName,schoolCode:t?.schoolCode||dt.schoolCode})}catch(Dr){console.log("Failed to fetch from school API:",Dr.response?.status||Dr.message)}}(dt.schoolCode==="SCH001"||dt.schoolName==="School Name")&&(console.log(" Still have default values, trying user context..."),console.log(" User context:",t),t?.schoolCode&&t.schoolCode!=="SCH001"&&(dt.schoolCode=t.schoolCode),t?.schoolName&&t.schoolName!=="School Name"&&(dt.schoolName=t.schoolName),t?.schoolCode==="SB"&&(dt={...dt,schoolName:"South Bridge School",schoolCode:"SB",address:"Vijayanagar, Bengaluru, Karnataka, 560040",phone:"+91-1234567890",email:"revathi.sb@gmail.com",website:"www.southbridgeschool.com"},console.log(" Applied SB school data override")),console.log(" Updated templateSettings from user context:",dt)),console.log(" Final templateSettings for admit cards:",dt),console.log(" Logo URL being used:",dt.logoUrl||"No logo URL found");let Bt="";if(dt.logoUrl)try{console.log(" Converting logo to base64 for print compatibility..."),Bt=await ut(dt.logoUrl),console.log(" Logo converted to base64 successfully"),Bt&&(dt.logoUrl=Bt,console.log(" Using base64 logo for hall tickets"))}catch(Ht){console.log(" Failed to convert logo to base64:",Ht),console.log(" Will use original URL as fallback")}_t.dismiss(ct);const qt=window.open("","_blank","width=800,height=600");if(!qt){_t.error("Please allow popups to generate hall tickets");return}console.log(" School data being used in admit cards:",{source:it?"localStorage (UniversalTemplate)":"API or defaults",data:dt});const Ar=(Ht,Dr,dr)=>{if(!Ht||!Dr||!dr)return"Time not set";try{const er=`${Ht==="00"?"12":Ht}:${Dr} ${dr}`;return console.log(` Formatting 12-hour time: ${Ht}:${Dr} ${dr}  ${er}`),er}catch(Vt){return console.error("Error formatting 12-hour time:",Vt),"Time error"}},Ir=[...ae].sort((Ht,Dr)=>{const dr=ke[Ht.id],Vt=ke[Dr.id];console.log(` Sorting: ${Ht.name} (${dr.examDate} ${dr.examTime}) vs ${Dr.name} (${Vt.examDate} ${Vt.examTime})`);const er=new Date(dr.examDate),Nr=new Date(Vt.examDate);if(er.getTime()!==Nr.getTime()){const jn=er.getTime()-Nr.getTime();return console.log(` Date comparison: ${dr.examDate} vs ${Vt.examDate} = ${jn}`),jn}const xn=(jn,Fn,yn)=>{if(!jn||!Fn||!yn)return 0;let Tn=parseInt(jn);const on=parseInt(Fn);return Tn===0&&(Tn=12),yn==="AM"&&Tn===12&&(Tn=0),yn==="PM"&&Tn!==12&&(Tn+=12),Tn*60+on},dn=xn(dr.examHour,dr.examMinute,dr.examAmPm),Qn=xn(Vt.examHour,Vt.examMinute,Vt.examAmPm),js=dn-Qn;return console.log(` Time comparison: ${dr.examHour}:${dr.examMinute} ${dr.examAmPm} (${dn}min) vs ${Vt.examHour}:${Vt.examMinute} ${Vt.examAmPm} (${Qn}min) = ${js}`),js});console.log(" Final sorted subjects:",Ir.map(Ht=>({name:Ht.name,date:ke[Ht.id].examDate,time:ke[Ht.id].examTime})));const gn=rr.map(Ht=>{const Dr=Ir.map(dr=>{const Vt=ke[dr.id];return{id:dr.id,name:dr.name,examDate:Vt.examDate,examTime:Vt.examTime,examHour:Vt.examHour,examMinute:Vt.examMinute,examAmPm:Vt.examAmPm,roomNumber:Vt.roomNumber}});try{return hh.renderToString(xe.createElement(H1,{settings:dt,student:Ht,subjects:Dr,testName:st,enableRoomNumbers:H,instructions:fe.length>0?fe:void 0,mode:"print"}))}catch(dr){return console.error("Error rendering AdmitCardTemplate:",dr),`
            <div style="page-break-after: always; padding: 20px; font-family: Arial, sans-serif;">
              <h1>${dt.schoolName}</h1>
              <h2>ADMIT CARD</h2>
              <p><strong>Student:</strong> ${Ht.name}</p>
              <p><strong>Class:</strong> ${Ht.className} - Section ${Ht.section}</p>
              <p><strong>Roll Number:</strong> ${Ht.rollNumber}</p>
              <p>Error rendering template. Please try again.</p>
            </div>
          `}}).join(""),sn=`
        <!DOCTYPE html>
        <html>
          <head>
            <title>Hall Tickets - ${st}</title>
            <style>
              @media print {
                body { margin: 0; padding: 0; }
                .no-print { display: none !important; }
              }
              @page {
                size: A4;
                margin: 0;
              }
              body {
                margin: 0;
                padding: 0;
                font-family: Arial, sans-serif;
                line-height: 1.3;
                font-size: 12px;
              }
            </style>
          </head>
          <body>
            ${gn}
            <script>
              window.onload = function() {
                setTimeout(function() {
                  window.print();
                }, 500);
              };
            <\/script>
          </body>
        </html>
      `;qt.document.write(sn),qt.document.close(),_t.success(`Admit cards generated for ${rr.length} students with ${ae.length} subjects`),console.log("Admit cards generated successfully:",{students:rr.length,subjects:ae.length,testName:st})}catch(st){console.error("Error generating admit cards:",st),_t.dismiss(ct),_t.error("Failed to generate admit cards")}};return kt&&We.length>0?r.jsx(BZ,{selectedStudents:We.map(ae=>({id:ae.id,_id:ae.id,name:ae.name,sequenceId:ae.sequenceId||ae.rollNumber||`STU${ae.id}`,rollNumber:ae.rollNumber,className:ae.className,section:ae.section,profileImage:ae.profileImage,dateOfBirth:ae.dateOfBirth,bloodGroup:ae.bloodGroup,fatherName:ae.fatherName,motherName:ae.motherName,address:ae.address,phone:ae.phone,email:ae.email})),onClose:()=>Oe(!1),initialOrientation:oe,lockOrientation:!0}):r.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:r.jsxs("div",{className:"max-w-5xl mx-auto",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx(xs,{className:"h-6 w-6 text-blue-600"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Academic Management"})]}),r.jsx("p",{className:"text-gray-600",children:"Manage subjects and generate hall tickets for your school"})]}),r.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"flex space-x-8 px-6",children:[r.jsx("button",{onClick:()=>v("subjects"),className:`py-4 px-1 border-b-2 font-medium text-sm ${N==="subjects"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(xs,{className:"h-4 w-4"}),"Class Subjects Management"]})}),r.jsx("button",{onClick:()=>v("hallticket"),className:`py-4 px-1 border-b-2 font-medium text-sm ${N==="hallticket"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Pn,{className:"h-4 w-4"}),"Hall Ticket Generation"]})}),r.jsx("button",{onClick:()=>v("idcard"),className:`py-4 px-1 border-b-2 font-medium text-sm ${N==="idcard"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Gl,{className:"h-4 w-4"}),"School ID Card Generation"]})})]})})}),p&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:r.jsxs("p",{className:"text-red-800 text-sm",children:["Error loading classes: ",p]})}),!m&&!g()&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:r.jsx("p",{className:"text-yellow-800 text-sm",children:"No classes have been configured for your school yet. Please contact your super admin to add classes."})}),N==="subjects"&&r.jsxs("div",{children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Class ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:E,onChange:ae=>O(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Choose a class..."}),Ot.map(ae=>r.jsxs("option",{value:ae,children:["Class ",ae]},ae))]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Section ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:T,onChange:ae=>A(ae.target.value),disabled:!E||I.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[r.jsx("option",{value:"",children:"Choose section..."}),I.map(ae=>r.jsxs("option",{value:ae.value,children:["Section ",ae.section]},ae.value))]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Subject Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:X,onChange:ae=>me(ae.target.value),onKeyPress:Sr,placeholder:"Enter subject name...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsx("div",{className:"flex items-end",children:r.jsxs("button",{onClick:Yt,disabled:!E||!T||!X.trim(),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[r.jsx(Os,{className:"h-4 w-4"}),"Add Subject"]})})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Classes & Subjects"}),L||m?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Loading classes..."})]}):Ot.length===0?r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-gray-500",children:"No classes configured. Please contact your super admin."})}):r.jsx("div",{className:"space-y-3",children:Ot.map(ae=>{const ct=P===ae,st=u?.sectionsByClass?.[ae]||[];return r.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[r.jsx("div",{onClick:()=>gr(ae),className:"flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50",children:r.jsxs("div",{className:"flex items-center gap-3",children:[ct?r.jsx(Gs,{className:"h-4 w-4 text-gray-600"}):r.jsx(lv,{className:"h-4 w-4 text-gray-600"}),r.jsxs("h3",{className:"text-lg font-medium text-gray-800",children:["Class ",ae]}),r.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm px-2 py-1 rounded-full",children:[st.length," section",st.length!==1?"s":""]})]})}),ct&&r.jsx("div",{className:"border-t border-gray-200 bg-gray-50",children:st.length===0?r.jsxs("p",{className:"text-gray-500 text-center py-4",children:["No sections configured for Class ",ae]}):r.jsx("div",{className:"space-y-2 p-4",children:st.map(dt=>{const it=dt.section,xt=`${ae}-${it}`,Bt=R===xt,qt=$t(ae,it);return r.jsxs("div",{className:"border border-gray-300 rounded-lg bg-white",children:[r.jsx("div",{onClick:()=>kr(ae,it),className:"flex items-center justify-between p-3 cursor-pointer hover:bg-gray-50",children:r.jsxs("div",{className:"flex items-center gap-2",children:[Bt?r.jsx(Gs,{className:"h-3 w-3 text-gray-600"}):r.jsx(lv,{className:"h-3 w-3 text-gray-600"}),r.jsxs("h4",{className:"text-base font-medium text-gray-700",children:["Section ",it]}),r.jsxs("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full",children:[qt.length," subject",qt.length!==1?"s":""]})]})}),Bt&&r.jsx("div",{className:"border-t border-gray-200 p-3",children:qt.length===0?r.jsxs("p",{className:"text-gray-500 text-center py-3 text-sm",children:["No subjects added yet for Class ",ae," Section ",it]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:qt.map((Ar,Ir)=>r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg border border-gray-200",children:[r.jsx("span",{className:"text-gray-800 font-medium text-sm",children:Ar.name}),r.jsx("button",{onClick:gn=>{gn.stopPropagation(),Or(ae,it,Ar.name)},className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Remove subject",children:r.jsx(Ba,{className:"h-3 w-3"})})]},Ir))})})]},xt)})})})]},ae)})})]})]}),N==="hallticket"&&r.jsxs("div",{children:[s&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-4 mb-6",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:" Viewing Historical Data:"})," You are viewing data from ",a,". This data is read-only."]})}),u&&r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[r.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Debug Info:"}),r.jsxs("div",{className:"text-xs text-yellow-700 space-y-1",children:[r.jsx("p",{children:"Classes Data Loaded: "}),r.jsxs("p",{children:["Total Tests: ",u.tests?.length||0]}),r.jsxs("p",{children:["Tests by Class Keys: ",Object.keys(u.testsByClass||{}).join(", ")]}),r.jsxs("p",{children:["Selected Class: ",se]}),r.jsxs("p",{children:["Selected Section: ",W]}),r.jsxs("p",{children:["Available Tests: ",Nt.length]}),r.jsxs("p",{children:["Selected Test: ",Q]}),r.jsxs("p",{children:["Subjects Found: ",cr.length]})]}),se&&W&&cr.length===0&&r.jsxs("div",{className:"mt-3 p-2 bg-red-50 border border-red-200 rounded",children:[r.jsxs("p",{className:"text-xs text-red-700",children:[" No subjects found for Class ",se," Section ",W,'. Please add subjects in the "Class Subjects Management" tab first.']}),r.jsx("p",{className:"text-xs text-red-600 mt-1",children:" Available classes in database: Check console for details"})]})]}),r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Generate Hall Tickets"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Academic Year ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("select",{value:a,onChange:ae=>i(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:l.map(ae=>r.jsxs("option",{value:ae,children:[ae," ",ae===n&&"(Current)"]},ae))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Class ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:se,onChange:ae=>ee(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Choose a class..."}),Ot.map(ae=>r.jsxs("option",{value:ae,children:["Class ",ae]},ae))]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Section ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:W,onChange:ae=>U(ae.target.value),disabled:!se||_e.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[r.jsx("option",{value:"",children:"Choose section..."}),_e.map(ae=>r.jsxs("option",{value:ae.value,children:["Section ",ae.section]},ae.value))]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Test Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:Q,onChange:ae=>Y(ae.target.value),disabled:!se||!W||Nt.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[r.jsx("option",{value:"",children:"Choose test..."}),Nt.map(ae=>r.jsx("option",{value:ae.id,children:ae.name},ae.id))]})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"checkbox",id:"enableRoomNumbers",checked:H,onChange:ae=>te(ae.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"enableRoomNumbers",className:"text-sm font-medium text-gray-700",children:"Include Room Numbers in Hall Tickets"})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-7",children:H?"Room numbers will be required and displayed in the hall tickets":"Room numbers will be optional and not displayed in the hall tickets"})]}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Manage Hall Ticket Instructions"}),r.jsxs("div",{className:"flex gap-2 mb-3",children:[r.jsx("input",{type:"text",value:he,onChange:ae=>K(ae.target.value),placeholder:"Enter new instruction...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:ae=>ae.key==="Enter"&&Xe()}),r.jsx("button",{onClick:Xe,disabled:!he.trim(),className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Add"})]}),r.jsxs("div",{className:"space-y-2 mb-3",children:[r.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Current Instructions:"}),fe.map((ae,ct)=>r.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border",children:[r.jsx("span",{className:"text-xs text-gray-700 flex-1",children:ae}),r.jsx("button",{onClick:()=>Ke(ct),className:"ml-2 px-2 py-1 bg-red-100 text-red-600 text-xs rounded hover:bg-red-200",children:"Remove"})]},ct))]}),r.jsx("button",{onClick:Ve,className:"px-3 py-1 bg-gray-600 text-white text-xs rounded-md hover:bg-gray-700",children:"Reset to Default Instructions"})]}),r.jsx("div",{className:"grid grid-cols-1 gap-4",children:r.jsx("div",{className:"flex items-end",children:r.jsxs("button",{onClick:B,disabled:!se||!W||!Q,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[r.jsx(va,{className:"h-4 w-4"}),"Search Subjects"]})})})]})}),cr.length>0&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["Subjects for ",Nt.find(ae=>ae.id===Q)?.name," - Class ",se," Section ",W]}),r.jsxs("button",{onClick:Je,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center gap-2",children:[r.jsx(Pn,{className:"h-4 w-4"}),"Generate Hall Tickets"]})]}),gt?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Loading subjects..."})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exam Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exam Time"}),H&&r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Room Number"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:cr.map(ae=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ae.name}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(an,{className:"h-4 w-4 text-gray-400"}),r.jsx("input",{type:"date",value:ke[ae.id]?.examDate||"",onChange:ct=>Ae(ae.id,"examDate",ct.target.value),className:"px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsxs("select",{value:ke[ae.id]?.examHour||"00",onChange:ct=>Ae(ae.id,"examHour",ct.target.value),className:"px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{width:"60px"},children:[r.jsx("option",{value:"00",children:"00"}),[1,2,3,4,5,6,7,8,9,10,11,12].map(ct=>r.jsx("option",{value:ct.toString(),children:ct},ct))]}),r.jsx("span",{className:"text-gray-500",children:":"}),r.jsx("select",{value:ke[ae.id]?.examMinute||"00",onChange:ct=>Ae(ae.id,"examMinute",ct.target.value),className:"px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{width:"60px"},children:Array.from({length:60},(ct,st)=>st.toString().padStart(2,"0")).map(ct=>r.jsx("option",{value:ct,children:ct},ct))}),r.jsxs("select",{value:ke[ae.id]?.examAmPm||"AM",onChange:ct=>Ae(ae.id,"examAmPm",ct.target.value),className:"px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{width:"60px"},children:[r.jsx("option",{value:"AM",children:"AM"}),r.jsx("option",{value:"PM",children:"PM"})]})]})}),H&&r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx($4,{className:"h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",value:ke[ae.id]?.roomNumber||"",onChange:ct=>Ae(ae.id,"roomNumber",ct.target.value),placeholder:"Room No.",className:"px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})})]},ae.id))})]})})]}),rr.length>0&&r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Eligible Students (",rr.length,")"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:rr.map(ae=>r.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:ae.name}),r.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:["Sequence ID: ",ae.sequenceId||ae.rollNumber]}),r.jsxs("p",{className:"text-xs text-gray-500",children:["Class ",ae.className," - Section ",ae.section]})]}),r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-blue-600 font-bold text-xs",children:(ae.sequenceId||ae.rollNumber).split("-").pop()})})]})},ae.id))})]})]})]}),N==="idcard"&&r.jsxs("div",{children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Generate School ID Cards"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Class ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:be,onChange:ae=>{re(ae.target.value),ne(""),Ie([])},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Choose a class..."}),Ot.map(ae=>r.jsxs("option",{value:ae,children:["Class ",ae]},ae))]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Section ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{value:ie,onChange:ae=>{ne(ae.target.value),Ie([])},disabled:!be,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[r.jsx("option",{value:"",children:"Choose section..."}),be&&f(be).map(ae=>r.jsxs("option",{value:ae.value,children:["Section ",ae.section]},ae.value))]})]})]}),r.jsx("div",{className:"mb-6",children:r.jsxs("button",{onClick:Se,disabled:!be||!ie,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:[r.jsx(va,{className:"h-4 w-4"}),"Load Students"]})}),We.length>0&&r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Choose ID Card Orientation"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:je.map(ae=>r.jsx("div",{onClick:()=>{$e(ae.id),ve(ae.id)},className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${oe===ae.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:`w-full h-24 rounded-lg mb-3 flex items-center justify-center ${ae.id==="landscape"?"bg-blue-100":"bg-green-100"}`,children:ae.id==="landscape"?r.jsx(F4,{className:"h-12 w-12 text-blue-600"}):r.jsx(B4,{className:"h-12 w-12 text-green-600"})}),r.jsx("h4",{className:"font-semibold text-sm text-gray-800 mb-1",children:ae.name}),r.jsx("p",{className:"text-xs text-gray-600 mb-2",children:ae.description}),r.jsx("p",{className:"text-xs text-gray-500",children:ae.preview})]})},ae.id))})]}),We.length>0&&oe&&r.jsxs("div",{className:"text-center",children:[r.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Ready to Generate ID Cards"}),r.jsx("div",{className:"flex gap-4 justify-center",children:r.jsxs("button",{onClick:()=>Oe(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[r.jsx(Gl,{className:"h-5 w-5"}),"Preview & Generate ID Cards (",We.length," students)"]})}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Preview individual cards and download as PNG images organized in folders"})]})]}),We.length>0&&r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Eligible Students (",We.length,")"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:We.map(ae=>r.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:ae.name}),r.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:["Sequence ID: ",ae.sequenceId||ae.rollNumber]}),r.jsxs("p",{className:"text-xs text-gray-500",children:["Class ",ae.className," - Section ",ae.section]})]}),r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-blue-600 font-bold text-xs",children:(ae.sequenceId||ae.rollNumber).split("-").pop()})})]})},ae.id))})]})]})]})})},zZ=()=>{const[e,t]=j.useState({"landscape-front":null,"landscape-back":null,"portrait-front":null,"portrait-back":null}),[n,a]=j.useState(!1),[s,i]=j.useState("landscape-front"),[l,d]=j.useState(!1),u="https://erp-backend-kfut.onrender.com/api",m=async()=>{a(!0);const g={};for(const N of Object.keys(e))try{const v=`/idcard-templates/${N}.png`;(await fetch(`${u.replace("/api","")}${v}`)).ok?g[N]=v:g[N]=null}catch{g[N]=null}t(g),a(!1)};j.useEffect(()=>{m()},[]);const f=[{key:"landscape-front",name:"Landscape Front",description:"Front side of landscape ID card (85.6mm  54mm)",size:"1020  648 pixels"},{key:"landscape-back",name:"Landscape Back",description:"Back side of landscape ID card (85.6mm  54mm)",size:"1020  648 pixels"},{key:"portrait-front",name:"Portrait Front",description:"Front side of portrait ID card (54mm  85.6mm)",size:"648  1020 pixels"},{key:"portrait-back",name:"Portrait Back",description:"Back side of portrait ID card (54mm  85.6mm)",size:"648  1020 pixels"}].find(g=>g.key===s);return r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Template Preview"}),r.jsxs("button",{onClick:m,disabled:n,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[r.jsx(xf,{className:`w-4 h-4 ${n?"animate-spin":""}`}),"Refresh"]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Template to Preview"}),r.jsxs("div",{className:"relative",children:[r.jsxs("select",{value:s,onChange:g=>i(g.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white",children:[r.jsx("option",{value:"landscape-front",children:"Landscape - Front Side"}),r.jsx("option",{value:"landscape-back",children:"Landscape - Back Side"}),r.jsx("option",{value:"portrait-front",children:"Portrait - Front Side"}),r.jsx("option",{value:"portrait-back",children:"Portrait - Back Side"})]}),r.jsx(Gs,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"})]})]}),r.jsx("div",{className:"border border-gray-200 rounded-lg p-6 bg-white",children:f&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:f.name}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:f.description}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Recommended size: ",f.size]})]}),e[f.key]?r.jsx(ba,{className:"w-6 h-6 text-green-600 flex-shrink-0"}):r.jsx(sa,{className:"w-6 h-6 text-red-600 flex-shrink-0"})]}),e[f.key]?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mb-4 bg-gray-50 rounded-lg overflow-hidden border border-gray-200 flex items-center justify-center",style:{minHeight:"400px"},children:r.jsx("img",{src:`${u.replace("/api","")}${e[f.key]}`,alt:f.name,className:"max-w-full h-auto",style:{maxHeight:"500px",objectFit:"contain"}})}),r.jsxs("button",{onClick:()=>d(!0),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[r.jsx(wn,{className:"w-4 h-4"}),"View Full Size"]})]}):r.jsxs("div",{className:"text-center py-12",children:[r.jsx(sa,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),r.jsx("p",{className:"text-red-600 font-medium mb-2",children:"Template Not Found"}),r.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Please add ",r.jsxs("code",{className:"bg-red-100 px-2 py-1 rounded font-mono text-xs",children:[f.key,".png"]})," to:"]}),r.jsx("code",{className:"block bg-gray-100 px-3 py-2 rounded text-xs font-mono text-gray-700",children:"backend/idcard-templates/"})]})]})}),l&&e[s]&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-auto",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Template Preview"}),r.jsx("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700 text-2xl leading-none",children:""})]}),r.jsx("div",{className:"p-6 flex justify-center bg-gray-100",children:r.jsx("img",{src:`${u.replace("/api","")}${e[s]}`,alt:"Template Preview",className:"max-w-full h-auto shadow-lg"})})]})}),n&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40",children:r.jsxs("div",{className:"bg-white rounded-lg p-6",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-700",children:"Checking templates..."})]})})]})};async function r5(e){console.log(" Marking session attendance:",e);const t=await zt.post("/attendance/mark-session",e);return console.log(" Session attendance marked:",t.data),t.data}async function mp(e){console.log(" Getting attendance with params:",e);const t=await zt.get("/attendance",{params:e});return console.log(" Attendance retrieved:",t.data),t.data}async function V1(e){console.log(" Checking session status with params:",e);const t=await zt.get("/attendance/session-status",{params:e});return console.log(" Session status checked:",t.data),t.data}const qZ=()=>{const{token:e,user:t}=yr(),{currentAcademicYear:n,viewingAcademicYear:a,isViewingHistoricalYear:s,setViewingYear:i,availableYears:l,loading:d}=pn(),{classesData:u,loading:m,getSectionsByClass:p,hasClasses:f}=Ea(),[g,N]=j.useState(new Date().toISOString().split("T")[0]),[v,w]=j.useState(""),[y,E]=j.useState(""),[O,T]=j.useState([]),[A,I]=j.useState("morning"),[C,P]=j.useState([]),[F,R]=j.useState([]),[$,L]=j.useState(""),[G,X]=j.useState(!1),[me,se]=j.useState(""),[ee,W]=j.useState(""),[U,Q]=j.useState({morning:{isMarked:!1,isFrozen:!1,canModify:!0},afternoon:{isMarked:!1,isFrozen:!1,canModify:!0}}),Y=u?.classes?.map(je=>je.className)||[];j.useEffect(()=>{if(v&&u){const je=p(v);T(je),je.length>0?E(je[0].value):E("")}else T([]),E("")},[v,u]),j.useEffect(()=>{v&&y&&e&&t?.schoolCode?te():P([])},[v,y,e,t?.schoolCode]),j.useEffect(()=>{v&&y&&g&&H()},[v,y,g,A]),j.useEffect(()=>{C.length>0&&g&&Le()},[C.length,g,A]),j.useEffect(()=>{fe()},[C,$]);const H=async()=>{if(!(!v||!y||!g))try{const je=await V1({class:v,section:y,date:g,session:"morning"}),oe=await V1({class:v,section:y,date:g,session:"afternoon"});Q({morning:{isMarked:je.isMarked||!1,isFrozen:je.isFrozen||!1,canModify:je.canModify!==!1,data:je.data},afternoon:{isMarked:oe.isMarked||!1,isFrozen:oe.isFrozen||!1,canModify:oe.canModify!==!1,data:oe.data}})}catch(je){console.warn("Could not check session status:",je),Q({morning:{isMarked:!1,isFrozen:!1,canModify:!0},afternoon:{isMarked:!1,isFrozen:!1,canModify:!0}})}},te=async()=>{if(!v||!y){P([]);return}if(!e||!t?.schoolCode){se("Authentication required");return}try{X(!0),se(""),console.log(" Fetching students for:",{class:v,section:y,schoolCode:t.schoolCode});const oe=(await zt.get(`/users/role/student?class=${v}&section=${y}`,{headers:{"x-school-code":t.schoolCode}})).data;console.log(" API Response:",oe);const $e=oe.data||oe||[];console.log(` Total users received: ${$e.length}`);const et=$e.filter(rt=>{const Lt=rt.role==="student",kt=rt.academicInfo?.class||rt.studentDetails?.academic?.currentClass||rt.studentDetails?.currentClass||rt.studentDetails?.class||rt.class,Oe=rt.academicInfo?.section||rt.studentDetails?.academic?.currentSection||rt.studentDetails?.currentSection||rt.studentDetails?.section||rt.section,Nt=String(kt).trim()===String(v).trim(),Mt=String(Oe).trim().toUpperCase()===String(y).trim().toUpperCase(),rr=rt.studentDetails?.academicYear||rt.studentDetails?.academic?.academicYear||rt.academicYear||rt.academicInfo?.academicYear,Ft=!rr||String(rr).trim()===String(a).trim();return Lt&&Nt&&Mt&&Ft});console.log(` Filtered students: ${et.length}`);const lt=et.map(rt=>({_id:rt._id,userId:rt.userId,name:rt.name?.displayName||rt.name||"Unknown",class:rt.academicInfo?.class||rt.studentDetails?.academic?.currentClass||rt.studentDetails?.currentClass||rt.studentDetails?.class||rt.class||v,section:rt.academicInfo?.section||rt.studentDetails?.academic?.currentSection||rt.studentDetails?.currentSection||rt.studentDetails?.section||rt.section||y,morningStatus:null,afternoonStatus:null}));P(lt),lt.length===0&&se(`No students found for Class ${v} Section ${y}`)}catch(je){se("Failed to fetch students"),console.error(" Error fetching students:",je)}finally{X(!1)}},fe=()=>{if(!$){R(C);return}const je=C.filter(oe=>oe.name.toLowerCase().includes($.toLowerCase())||oe.userId.toLowerCase().includes($.toLowerCase()));R(je)},Le=async()=>{if(!(!v||!y||!g))try{const je=await mp({class:v,section:y,date:g,session:A});if(je.success&&je.data&&je.data.length>0){const oe=je.data.find($e=>$e.session===A&&$e.dateString===g);oe&&oe.students&&P($e=>$e.map(et=>{const lt=oe.students.find(rt=>rt.studentId===et.userId);return lt?{...et,[A==="morning"?"morningStatus":"afternoonStatus"]:lt.status}:et}))}}catch(je){console.warn("Could not load existing attendance:",je)}},he=je=>{w(je.target.value),E(""),P([])},K=je=>{E(je.target.value)},be=je=>je==="LKG"||je==="UKG"?je:`Class ${je}`,re=(je,oe)=>{P($e=>$e.map(et=>et._id===je?{...et,[A==="morning"?"morningStatus":"afternoonStatus"]:oe}:et))},ie=()=>{const je=A==="morning"?"morningStatus":"afternoonStatus";P(oe=>oe.map($e=>({...$e,[je]:"present"})))},ne=()=>{const je=A==="morning"?"morningStatus":"afternoonStatus";P(oe=>oe.map($e=>({...$e,[je]:"absent"})))},Te=je=>A==="morning"?je.morningStatus:je.afternoonStatus,We=(()=>{const je=A==="morning"?"morningStatus":"afternoonStatus",oe=C.filter(lt=>lt[je]==="present").length,$e=C.filter(lt=>lt[je]==="absent").length,et=C.filter(lt=>lt[je]===null).length;return{present:oe,absent:$e,unmarked:et,total:C.length}})(),Ie=async()=>{try{if(X(!0),se(""),W(""),U[A].isFrozen){se(`${A.charAt(0).toUpperCase()+A.slice(1)} attendance has already been marked and is frozen. Cannot modify existing attendance.`),X(!1);return}const oe=C.map(lt=>({studentId:lt.userId,userId:lt.userId,status:Te(lt)})).filter(lt=>lt.status!==null);if(oe.length===0){se("Please mark attendance for at least one student");return}const $e={date:g,class:v,section:y,session:A,students:oe};console.log("Saving attendance data:",$e);const et=await r5($e);et.success?(W(` ${A.charAt(0).toUpperCase()+A.slice(1)} attendance saved successfully! ${et.data.successCount} students marked.`),await H(),setTimeout(()=>W(""),5e3)):se(et.message||"Failed to save attendance")}catch(je){console.error("Error saving attendance:",je),se(je.response?.data?.message||je.message||"Failed to save attendance. Please try again.")}finally{X(!1)}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mark Attendance"}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsxs("button",{onClick:ie,disabled:U[A].isFrozen,className:`bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors ${U[A].isFrozen?"opacity-50 cursor-not-allowed":""}`,title:U[A].isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(_s,{className:"h-4 w-4 mr-2"}),"Mark All Present"]}),r.jsxs("button",{onClick:ne,disabled:U[A].isFrozen,className:`bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors ${U[A].isFrozen?"opacity-50 cursor-not-allowed":""}`,title:U[A].isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(dv,{className:"h-4 w-4 mr-2"}),"Mark All Absent"]}),r.jsxs("button",{onClick:Ie,disabled:G||!v||!y||U[A].isFrozen,className:`bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg flex items-center transition-colors ${U[A].isFrozen?"opacity-50 cursor-not-allowed":""}`,title:U[A].isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(rs,{className:"h-4 w-4 mr-2"}),U[A].isFrozen?"Attendance Frozen":G?"Saving...":"Save Attendance"]})]})]}),ee&&r.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:ee}),me&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:me}),s&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-4",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:" Viewing Historical Data:"})," You are viewing data from ",a,". This data is read-only."]})}),r.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),r.jsx("select",{value:a,onChange:je=>i(je.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:l.map(je=>r.jsxs("option",{value:je,children:[je," ",je===n&&"(Current)"]},je))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),r.jsxs("div",{className:"relative",children:[r.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"date",value:g,onChange:je=>N(je.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),r.jsxs("select",{value:v,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:m||!f(),children:[r.jsx("option",{value:"",children:m?"Loading...":"Select Class"}),Y.map(je=>r.jsx("option",{value:je,children:be(je)},je))]}),!m&&!f()&&r.jsx("span",{className:"text-xs text-red-500 mt-1",children:"No classes configured"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),r.jsxs("select",{value:y,onChange:K,disabled:!v||O.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",children:[r.jsx("option",{value:"",children:v?"Select Section":"Select Class First"}),O.map(je=>r.jsxs("option",{value:je.value,children:["Section ",je.section]},je.value))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session"}),r.jsxs("div",{className:"flex rounded-lg border border-gray-300",children:[r.jsxs("button",{type:"button",onClick:()=>I("morning"),className:`flex-1 py-2 px-3 text-sm font-medium rounded-l-lg flex items-center justify-center relative ${A==="morning"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"} ${U.morning.isFrozen?"opacity-75":""}`,children:[r.jsx(bf,{className:"h-4 w-4 mr-1"}),"Morning",U.morning.isFrozen&&r.jsx("div",{className:"absolute top-0 right-0 -mt-1 -mr-1",children:r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full border border-white",title:"Attendance marked and frozen"})})]}),r.jsxs("button",{type:"button",onClick:()=>I("afternoon"),className:`flex-1 py-2 px-3 text-sm font-medium rounded-r-lg flex items-center justify-center relative ${A==="afternoon"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"} ${U.afternoon.isFrozen?"opacity-75":""}`,children:[r.jsx(gf,{className:"h-4 w-4 mr-1"}),"Afternoon",U.afternoon.isFrozen&&r.jsx("div",{className:"absolute top-0 right-0 -mt-1 -mr-1",children:r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full border border-white",title:"Attendance marked and frozen"})})]})]}),v&&y&&r.jsx("div",{className:"mt-2 text-sm",children:U[A].isFrozen?r.jsxs("div",{className:"flex items-center text-green-600",children:[r.jsx(ba,{className:"h-4 w-4 mr-1"}),r.jsxs("span",{children:[A.charAt(0).toUpperCase()+A.slice(1)," attendance is marked and frozen",U[A].data?.markedAt&&r.jsxs("span",{className:"text-gray-500 ml-1",children:["(marked on ",new Date(U[A].data.markedAt).toLocaleString(),")"]})]})]}):r.jsxs("div",{className:"flex items-center text-blue-600",children:[r.jsx(sa,{className:"h-4 w-4 mr-1"}),r.jsxs("span",{children:[A.charAt(0).toUpperCase()+A.slice(1)," attendance can be marked"]})]})})]})]})}),v&&y&&r.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"relative max-w-md",children:[r.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search by name or user ID...",value:$,onChange:je=>L(je.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),v&&y&&r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Present"}),r.jsx("div",{className:"text-2xl font-bold text-green-600",children:We.present})]}),r.jsx(ba,{className:"h-8 w-8 text-green-600"})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Absent"}),r.jsx("div",{className:"text-2xl font-bold text-red-600",children:We.absent})]}),r.jsx(Ii,{className:"h-8 w-8 text-red-600"})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Unmarked"}),r.jsx("div",{className:"text-2xl font-bold text-gray-600",children:We.unmarked})]}),r.jsx(bs,{className:"h-8 w-8 text-gray-600"})]})})]}),v&&y&&r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[A.charAt(0).toUpperCase()+A.slice(1)," Attendance - ",be(v)," Section ",y]}),r.jsxs("div",{className:"text-sm text-gray-600",children:["Progress: ",We.present+We.absent,"/",We.total," marked"]})]}),G?r.jsx("div",{className:"text-center py-4",children:"Loading students..."}):F.length===0?r.jsx("div",{className:"text-center py-4 text-gray-500",children:C.length===0?"No students found in this class and section":"No students match your search criteria"}):r.jsx("div",{className:"space-y-3",children:F.map(je=>r.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx($n,{className:"h-5 w-5 text-blue-600"})})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:je.name}),r.jsxs("div",{className:"text-sm text-gray-500",children:["User ID: ",je.userId]}),r.jsxs("div",{className:"text-sm text-gray-500",children:[je.class," - Section ",je.section]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs("button",{onClick:()=>re(je._id,"present"),disabled:U[A].isFrozen,className:`px-4 py-2 rounded-lg border text-sm font-medium transition-colors flex items-center space-x-1 ${Te(je)==="present"?"bg-green-100 text-green-800 border-green-200":"bg-white text-gray-700 border-gray-300 hover:bg-green-50"} ${U[A].isFrozen?"opacity-50 cursor-not-allowed":""}`,title:U[A].isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(ba,{className:"h-4 w-4"}),r.jsx("span",{children:"Present"})]}),r.jsxs("button",{onClick:()=>re(je._id,"absent"),disabled:U[A].isFrozen,className:`px-4 py-2 rounded-lg border text-sm font-medium transition-colors flex items-center space-x-1 ${Te(je)==="absent"?"bg-red-100 text-red-800 border-red-200":"bg-white text-gray-700 border-gray-300 hover:bg-red-50"} ${U[A].isFrozen?"opacity-50 cursor-not-allowed":""}`,title:U[A].isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(Ii,{className:"h-4 w-4"}),r.jsx("span",{children:"Absent"})]})]})]},je._id))})]})}),!v||!y?r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx($n,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Get Started"}),r.jsx("div",{className:"mt-2 text-sm text-blue-700",children:r.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[r.jsx("li",{children:"Select a date for attendance"}),r.jsx("li",{children:"Choose a class from the dropdown"}),r.jsx("li",{children:"Select a section to view students"}),r.jsx("li",{children:"Choose morning or afternoon session"}),r.jsx("li",{children:"Mark attendance for each student"}),r.jsx("li",{children:"Save the attendance record"})]})})]})]})}):null]})},HZ=()=>{const{token:e,user:t}=yr(),{currentAcademicYear:n,viewingAcademicYear:a,isViewingHistoricalYear:s,setViewingYear:i,availableYears:l,loading:d}=pn(),{classesData:u,loading:m,getSectionsByClass:p,hasClasses:f}=Ea(),[g,N]=j.useState(new Date().toISOString().split("T")[0]),[v,w]=j.useState(""),[y,E]=j.useState(""),[O,T]=j.useState([]),[A,I]=j.useState("morning"),[C,P]=j.useState([]),[F,R]=j.useState([]),[$,L]=j.useState(""),[G,X]=j.useState(!1),[me,se]=j.useState(""),ee=u?.classes?.map(he=>he.className)||[];j.useEffect(()=>{if(v&&u){const he=p(v);T(he),he.length>0?E(he[0].value):E("")}else T([]),E("")},[v,u]),j.useEffect(()=>{v&&y&&W()},[v,y,g,A]),j.useEffect(()=>{U()},[C,$]);const W=async()=>{if(!v||!y){P([]);return}if(!e||!t?.schoolCode){se("Authentication required");return}try{X(!0),se(""),console.log(" Fetching students for:",{class:v,section:y,schoolCode:t.schoolCode});const K=(await zt.get(`/users/role/student?class=${v}&section=${y}`,{headers:{"x-school-code":t.schoolCode}})).data;console.log(" API Response:",K);const be=K.data||K||[];console.log(` Total users received: ${be.length}`);const re=be.filter(ne=>{const Te=ne.role==="student",ve=ne.academicInfo?.class||ne.studentDetails?.academic?.currentClass||ne.studentDetails?.currentClass||ne.studentDetails?.class||ne.class,We=ne.academicInfo?.section||ne.studentDetails?.academic?.currentSection||ne.studentDetails?.currentSection||ne.studentDetails?.section||ne.section,Ie=String(ve).trim()===String(v).trim(),je=String(We).trim().toUpperCase()===String(y).trim().toUpperCase(),oe=ne.studentDetails?.academicYear||ne.studentDetails?.academic?.academicYear||ne.academicYear||ne.academicInfo?.academicYear,$e=!oe||String(oe).trim()===String(a).trim();return Te&&Ie&&je&&$e});console.log(` Filtered students: ${re.length}`);let ie=re.map(ne=>({_id:ne._id,userId:ne.userId,name:ne.name?.displayName||ne.name||"Unknown",class:ne.academicInfo?.class||ne.studentDetails?.academic?.currentClass||ne.studentDetails?.currentClass||ne.studentDetails?.class||ne.class||v,section:ne.academicInfo?.section||ne.studentDetails?.academic?.currentSection||ne.studentDetails?.currentSection||ne.studentDetails?.section||ne.section||y,morningStatus:null,afternoonStatus:null}));if(g)try{const ne=await mp({class:v,section:y,date:g,session:A});if(ne.success&&ne.data&&ne.data.length>0){const Te=ne.data.find(ve=>ve.session===A&&ve.dateString===g);Te&&Te.students&&(ie=ie.map(ve=>{const We=Te.students.find(Ie=>Ie.studentId===ve.userId);return We?{...ve,[A==="morning"?"morningStatus":"afternoonStatus"]:We.status}:ve}))}}catch(ne){console.warn("Could not load existing attendance:",ne)}P(ie),ie.length===0&&se(`No students found for Class ${v} Section ${y}`)}catch(he){se("Failed to fetch students"),console.error(" Error fetching students:",he)}finally{X(!1)}},U=()=>{if(!$){R(C);return}const he=C.filter(K=>K.name.toLowerCase().includes($.toLowerCase())||K.userId.toLowerCase().includes($.toLowerCase()));R(he)},Q=he=>{w(he.target.value),E(""),P([])},Y=he=>{E(he.target.value)},H=he=>he==="LKG"||he==="UKG"?he:`Class ${he}`,te=he=>A==="morning"?he.morningStatus:he.afternoonStatus,Le=(()=>{const he=A==="morning"?"morningStatus":"afternoonStatus",K=F.filter(ie=>ie[he]==="present").length,be=F.filter(ie=>ie[he]==="absent").length,re=F.filter(ie=>ie[he]===null).length;return{present:K,absent:be,unmarked:re,total:F.length}})();return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"View Attendance Records"})}),me&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:me}),s&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-4",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:" Viewing Historical Data:"})," You are viewing data from ",a,". This data is read-only."]})}),r.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),r.jsx("select",{value:a,onChange:he=>i(he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:l.map(he=>r.jsxs("option",{value:he,children:[he," ",he===n&&"(Current)"]},he))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),r.jsxs("div",{className:"relative",children:[r.jsx(an,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"date",value:g,onChange:he=>N(he.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),r.jsxs("select",{value:v,onChange:Q,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:m||!f(),children:[r.jsx("option",{value:"",children:m?"Loading...":"Select Class"}),ee.map(he=>r.jsx("option",{value:he,children:H(he)},he))]}),!m&&!f()&&r.jsx("span",{className:"text-xs text-red-500 mt-1",children:"No classes configured"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),r.jsxs("select",{value:y,onChange:Y,disabled:!v||O.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",children:[r.jsx("option",{value:"",children:v?"Select Section":"Select Class First"}),O.map(he=>r.jsxs("option",{value:he.value,children:["Section ",he.section]},he.value))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session"}),r.jsxs("div",{className:"flex rounded-lg border border-gray-300",children:[r.jsxs("button",{type:"button",onClick:()=>I("morning"),className:`flex-1 py-2 px-3 text-sm font-medium rounded-l-lg flex items-center justify-center ${A==="morning"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(bf,{className:"h-4 w-4 mr-1"}),"Morning"]}),r.jsxs("button",{type:"button",onClick:()=>I("afternoon"),className:`flex-1 py-2 px-3 text-sm font-medium rounded-r-lg flex items-center justify-center ${A==="afternoon"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(gf,{className:"h-4 w-4 mr-1"}),"Afternoon"]})]})]})]})}),v&&y&&r.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"relative max-w-md",children:[r.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search by name or user ID...",value:$,onChange:he=>L(he.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),v&&y&&r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Present"}),r.jsx("div",{className:"text-2xl font-bold text-green-600",children:Le.present})]}),r.jsx(ba,{className:"h-8 w-8 text-green-600"})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Absent"}),r.jsx("div",{className:"text-2xl font-bold text-red-600",children:Le.absent})]}),r.jsx(Ii,{className:"h-8 w-8 text-red-600"})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Not Marked"}),r.jsx("div",{className:"text-2xl font-bold text-gray-600",children:Le.unmarked})]}),r.jsx(bs,{className:"h-8 w-8 text-gray-600"})]})})]}),v&&y&&r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[A.charAt(0).toUpperCase()+A.slice(1)," Attendance - ",H(v)," Section ",y]}),r.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",Le.total," students"]})]}),G?r.jsx("div",{className:"text-center py-4",children:"Loading students..."}):F.length===0?r.jsx("div",{className:"text-center py-4 text-gray-500",children:C.length===0?"No students found in this class and section":"No students match your search criteria"}):r.jsx("div",{className:"space-y-3",children:F.map(he=>{const K=te(he);return r.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-gray-50",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx($n,{className:"h-5 w-5 text-blue-600"})})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:he.name}),r.jsxs("div",{className:"text-sm text-gray-500",children:["User ID: ",he.userId]}),r.jsxs("div",{className:"text-sm text-gray-500",children:[he.class," - Section ",he.section]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[K==="present"&&r.jsxs("span",{className:"px-4 py-2 rounded-lg bg-green-100 text-green-800 border border-green-200 text-sm font-medium flex items-center space-x-1",children:[r.jsx(ba,{className:"h-4 w-4"}),r.jsx("span",{children:"Present"})]}),K==="absent"&&r.jsxs("span",{className:"px-4 py-2 rounded-lg bg-red-100 text-red-800 border border-red-200 text-sm font-medium flex items-center space-x-1",children:[r.jsx(Ii,{className:"h-4 w-4"}),r.jsx("span",{children:"Absent"})]}),K===null&&r.jsxs("span",{className:"px-4 py-2 rounded-lg bg-gray-100 text-gray-600 border border-gray-200 text-sm font-medium flex items-center space-x-1",children:[r.jsx(bs,{className:"h-4 w-4"}),r.jsx("span",{children:"Not Marked"})]})]})]},he._id)})})]})}),!v||!y?r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx($n,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Get Started"}),r.jsx("div",{className:"mt-2 text-sm text-blue-700",children:r.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[r.jsx("li",{children:"Select a date to view attendance"}),r.jsx("li",{children:"Choose a class from the dropdown"}),r.jsx("li",{children:"Select a section to view students"}),r.jsx("li",{children:"Choose morning or afternoon session"}),r.jsx("li",{children:"View the attendance records for that day"})]})})]})]})}):null]})},Zb=()=>{const e=ni(),t=()=>e.pathname.includes("/attendance/mark")?"mark":e.pathname.includes("/attendance/view")?"view":"mark",[n,a]=j.useState(t()),s=[{id:"mark",name:"Mark Attendance",icon:_s,href:"/admin/attendance/mark",description:"Mark daily attendance for students"},{id:"view",name:"View Attendance",icon:wn,href:"/admin/attendance/view",description:"View and analyze attendance records"}];return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(an,{className:"h-8 w-8 text-blue-600"}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Attendance Management"})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:s.map(i=>{const l=i.icon,d=n===i.id;return r.jsx("button",{onClick:()=>{a(i.id),window.history.pushState({},"",i.href)},className:`py-4 px-1 border-b-2 font-medium text-sm ${d?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(l,{className:"h-5 w-5"}),r.jsx("span",{children:i.name})]})},i.id)})})}),r.jsxs("div",{className:"p-6",children:[n==="mark"&&r.jsx(qZ,{}),n==="view"&&r.jsx(HZ,{})]})]})]})};async function n5(e){return(await zt.post("/assignments",e,{headers:{"Content-Type":"multipart/form-data"}})).data}async function VZ(e){return(await zt.get(`/assignments/${e}`)).data}async function a5(e,t){const n=t instanceof FormData?{"Content-Type":"multipart/form-data"}:{};return(await zt.put(`/assignments/${e}`,t,{headers:n})).data}async function s5(e){return(await zt.delete(`/assignments/${e}`)).data}const WZ=({isOpen:e,onClose:t,onSuccess:n})=>{const{token:a,user:s}=yr(),{getClassOptions:i,getSectionsByClass:l}=Ea(),[d,u]=j.useState({title:"",subject:"",class:"",section:"",startDate:"",dueDate:"",instructions:"",attachments:[]}),[m,p]=j.useState({}),[f,g]=j.useState(!1),[N,v]=j.useState(""),[w,y]=j.useState([]);j.useEffect(()=>{e&&d.class&&d.section&&E(d.class,d.section)},[e,d.class,d.section]);const E=async(C,P)=>{if(!C||!P){y([]);return}try{console.log(` [CREATE MODAL] Fetching subjects for class: ${C}, section: ${P}`);const F=localStorage.getItem("erp.schoolCode")||s?.schoolCode||"";if(!F){console.error(" [CREATE MODAL] School code not available"),y([]);return}console.log(" [CREATE MODAL] Using school code:",F);try{console.log(" [CREATE MODAL] Trying primary API: /class-subjects/classes");const R=await zt.get("/class-subjects/classes",{headers:{"x-school-code":F.toUpperCase()}});if(console.log(" [CREATE MODAL] Primary API response:",R.data),R.data?.success&&R.data?.data?.classes){const $=R.data.data.classes.find(L=>L.className===C&&L.section===P);if(console.log(" [CREATE MODAL] Found class data:",$),$?.subjects){const G=$.subjects.filter(X=>X.isActive!==!1).map(X=>X.name||X.subjectName).filter(Boolean);console.log(" [CREATE MODAL] Extracted subject names:",G),y(G);return}}}catch(R){console.error(" [CREATE MODAL] Primary API failed:",R)}try{console.log(" [CREATE MODAL] Trying fallback API: /direct-test/class-subjects");const R=await zt.get(`/direct-test/class-subjects/${C}`,{params:{schoolCode:F},headers:{"x-school-code":F.toUpperCase()}});if(console.log(" [CREATE MODAL] Fallback API response:",R.data),R.data?.success&&R.data?.data?.subjects){const $=R.data.data.subjects.map(L=>L.name||L.subjectName).filter(Boolean);console.log(" [CREATE MODAL] Extracted subject names from fallback:",$),y($);return}}catch(R){console.error(" [CREATE MODAL] Fallback API failed:",R)}console.warn(" [CREATE MODAL] No subjects found for class/section"),y([]),y([])}catch(F){console.error(" Error fetching subjects:",F),y([])}},O=()=>{const C={};if(d.title.trim()||(C.title="Please enter assignment title"),d.subject||(C.subject="Please select a subject"),d.class||(C.class="Please select a class"),d.section||(C.section="Please select a section"),d.startDate||(C.startDate="Please set a start date"),d.dueDate||(C.dueDate="Please set a due date"),d.instructions.trim()||(C.instructions="Please write assignment instructions"),d.startDate&&d.dueDate){const P=new Date(d.startDate);new Date(d.dueDate)<=P&&(C.dueDate="Due date must be after start date")}return p(C),Object.keys(C).length===0},T=C=>{const P=Array.from(C.target.files||[]);u({...d,attachments:[...d.attachments,...P]})},A=C=>{const P=d.attachments.filter((F,R)=>R!==C);u({...d,attachments:P})},I=async C=>{if(C.preventDefault(),!!O()){g(!0);try{const P=new FormData;P.append("title",d.title),P.append("subject",d.subject),P.append("class",d.class),P.append("section",d.section),P.append("startDate",d.startDate),P.append("dueDate",d.dueDate),P.append("instructions",d.instructions),console.log(" Sending assignment data:",{title:d.title,subject:d.subject,class:d.class,section:d.section,startDate:d.startDate,dueDate:d.dueDate,hasInstructions:!!d.instructions,attachmentsCount:d.attachments.length}),d.attachments.forEach($=>{P.append("attachments",$)});let F="";try{const $=localStorage.getItem("erp.auth");$&&(F=JSON.parse($).user?.schoolCode||"",console.log(` Using school code for assignment: "${F}"`))}catch($){console.error("Error parsing auth data:",$)}F?(P.append("schoolCode",F),console.log(" Added schoolCode to request:",F)):console.warn(" No school code found in auth context");const R=await n5(P);console.log(" Assignment created successfully:",R),v(R.message||`Assignment created for ${d.class}  Section ${d.section}`),setTimeout(()=>{n(),t(),v(""),u({title:"",subject:"",class:"",section:"",startDate:"",dueDate:"",instructions:"",attachments:[]})},2e3)}catch(P){console.error(" Error creating assignment:",P),console.error("Error response:",P.response?.data||P.message),p({submit:P.response?.data?.message||"Failed to create assignment"})}finally{g(!1)}}};return e?r.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:r.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center",children:[r.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),r.jsxs("div",{className:"relative w-full max-w-4xl mx-auto bg-white rounded-lg shadow-xl",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create Assignment"}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:r.jsx(Ur,{className:"w-6 h-6"})})]}),N&&r.jsx("div",{className:"p-4 bg-green-50 border-l-4 border-green-400",children:r.jsxs("p",{className:"text-sm text-green-700 font-medium",children:[" ",N]})}),r.jsxs("form",{onSubmit:I,className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignment Title *"}),r.jsx("input",{type:"text",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.title?"border-red-300":"border-gray-300"}`,value:d.title,onChange:C=>u({...d,title:C.target.value}),placeholder:"Enter assignment title"}),m.title&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.title})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class *"}),r.jsxs("select",{className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.class?"border-red-300":"border-gray-300"}`,value:d.class,onChange:C=>{const P=C.target.value;u({...d,class:P,subject:"",section:""}),y([])},children:[r.jsx("option",{value:"",children:"Select Class"}),i().map(C=>r.jsx("option",{value:C.value,children:C.label},C.value))]}),m.class&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.class})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section *"}),r.jsxs("select",{className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.section?"border-red-300":"border-gray-300"}`,value:d.section,onChange:C=>u({...d,section:C.target.value}),children:[r.jsx("option",{value:"",children:"Select Section"}),(d.class?l(d.class):[]).map(C=>r.jsx("option",{value:C.value,children:C.label},C.value))]}),m.section&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.section})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),r.jsxs("select",{className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.subject?"border-red-300":"border-gray-300"}`,value:d.subject,onChange:C=>u({...d,subject:C.target.value}),disabled:!d.class,children:[r.jsx("option",{value:"",children:d.class?"Select Subject":"Select Class First"}),w.map(C=>r.jsx("option",{value:C,children:C},C))]}),m.subject&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.subject})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(an,{className:"w-4 h-4 inline mr-1"}),"Start Date *"]}),r.jsx("input",{type:"date",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.startDate?"border-red-300":"border-gray-300"}`,value:d.startDate,onChange:C=>u({...d,startDate:C.target.value}),min:new Date().toISOString().split("T")[0]}),m.startDate&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.startDate})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(an,{className:"w-4 h-4 inline mr-1"}),"Due Date *"]}),r.jsx("input",{type:"date",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.dueDate?"border-red-300":"border-gray-300"}`,value:d.dueDate,onChange:C=>u({...d,dueDate:C.target.value}),min:d.startDate||new Date().toISOString().split("T")[0]}),m.dueDate&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.dueDate})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Pn,{className:"w-4 h-4 inline mr-1"}),"Assignment Instructions *"]}),r.jsx("textarea",{rows:4,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.instructions?"border-red-300":"border-gray-300"}`,value:d.instructions,onChange:C=>u({...d,instructions:C.target.value}),placeholder:"Write detailed instructions for the assignment..."}),m.instructions&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.instructions})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Xl,{className:"w-4 h-4 inline mr-1"}),"Attachments (Optional)"]}),r.jsx("input",{type:"file",multiple:!0,accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif",onChange:T,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),d.attachments.length>0&&r.jsx("div",{className:"mt-2 space-y-2",children:d.attachments.map((C,P)=>r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[r.jsx("span",{className:"text-sm text-gray-700",children:C.name}),r.jsx("button",{type:"button",onClick:()=>A(P),className:"text-red-600 hover:text-red-700",children:r.jsx(Ur,{className:"w-4 h-4"})})]},P))})]}),m.submit&&r.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-red-700 text-sm",children:m.submit})}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[r.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),r.jsxs("button",{type:"submit",disabled:f,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[r.jsx($n,{className:"w-4 h-4"}),r.jsx("span",{children:f?"Creating...":"Create Assignment"})]})]})]})]})]})}):null},YZ=({isOpen:e,onClose:t,onSuccess:n,assignmentId:a})=>{const{token:s}=yr(),{getClassOptions:i,getSectionsByClass:l}=Ea(),[d,u]=j.useState({title:"",subject:"",class:"",section:"",startDate:"",dueDate:"",instructions:"",attachments:[],existingAttachments:[]}),[m,p]=j.useState({}),[f,g]=j.useState(!1),[N,v]=j.useState(!1),[w,y]=j.useState(""),[E,O]=j.useState([]);j.useEffect(()=>{e&&a&&T()},[e,a]),j.useEffect(()=>{e&&d.class&&A(d.class)},[e,d.class]);const T=async()=>{v(!0),p({});try{console.log(" Fetching assignment data for:",a);const R=await VZ(a);console.log(" Assignment data loaded:",R);const $=L=>L?new Date(L).toISOString().split("T")[0]:"";u({title:R.title||"",subject:R.subject||"",class:R.class||"",section:R.section||"",startDate:$(R.startDate),dueDate:$(R.dueDate),instructions:R.instructions||R.description||"",attachments:[],existingAttachments:R.attachments||[]}),R.class&&await A(R.class)}catch(R){console.error(" Error fetching assignment:",R),console.error("Error details:",R.response?.data||R.message);const $=R.response?.data?.message||R.message||"Failed to load assignment data";p({submit:$}),alert(`Error loading assignment: ${$}`)}finally{v(!1)}},A=async R=>{try{console.log(` Fetching subjects for class: ${R}`);const $=localStorage.getItem("erp.schoolCode")||"",L=localStorage.getItem("erp.auth");let G="";L&&(G=JSON.parse(L).token||"");const X=await fetch(`/api/class-subjects/class/${encodeURIComponent(R)}`,{headers:{Authorization:`Bearer ${G}`,"x-school-code":$.toUpperCase(),"Content-Type":"application/json"}});if(X.ok){const se=((await X.json())?.data?.subjects||[]).filter(ee=>ee.isActive!==!1).map(ee=>ee.name).filter(Boolean);O(se),console.log(" Subjects loaded:",se)}else console.warn("Failed to fetch subjects:",X.status),O([])}catch($){console.error("Error fetching subjects:",$),O([])}},I=()=>{const R={};if(d.title.trim()||(R.title="Title is required"),d.subject||(R.subject="Subject is required"),d.class||(R.class="Class is required"),d.section||(R.section="Section is required"),d.startDate||(R.startDate="Start date is required"),d.dueDate||(R.dueDate="Due date is required"),d.startDate&&d.dueDate){const $=new Date(d.startDate);new Date(d.dueDate)<=$&&(R.dueDate="Due date must be after start date")}return p(R),Object.keys(R).length===0},C=R=>{if(R.target.files){const $=Array.from(R.target.files);u({...d,attachments:$})}},P=R=>{const $=[...d.existingAttachments];$.splice(R,1),u({...d,existingAttachments:$})},F=async R=>{if(R.preventDefault(),!!I()){g(!0);try{const $=new FormData;$.append("title",d.title),$.append("subject",d.subject),$.append("class",d.class),$.append("section",d.section),$.append("startDate",d.startDate),$.append("dueDate",d.dueDate),$.append("instructions",d.instructions),console.log(" Updating assignment:",{id:a,title:d.title,subject:d.subject,class:d.class,section:d.section}),d.attachments.forEach(X=>{$.append("attachments",X)}),$.append("existingAttachments",JSON.stringify(d.existingAttachments));let L="";try{const X=localStorage.getItem("erp.auth");X&&(L=JSON.parse(X).user?.schoolCode||"")}catch(X){console.error("Error parsing auth data:",X)}L&&$.append("schoolCode",L);const G=await a5(a,$);console.log(" Assignment updated successfully:",G),y("Assignment updated successfully!"),setTimeout(()=>{n(),t(),y("")},2e3)}catch($){console.error(" Error updating assignment:",$),console.error("Error response:",$.response?.data),console.error("Error status:",$.response?.status);const L=$.response?.data?.message||$.message||"Failed to update assignment";p({submit:L}),alert(`Failed to update assignment:
${L}

Please check the console for more details.`)}finally{g(!1)}}};return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Assignment"}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Ur,{className:"h-6 w-6"})})]}),N?r.jsxs("div",{className:"p-8 text-center",children:[r.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading assignment data..."})]}):r.jsxs("form",{onSubmit:F,className:"p-6 space-y-6",children:[w&&r.jsx("div",{className:"bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg",children:w}),m.submit&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg",children:m.submit}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Pn,{className:"w-4 h-4 inline mr-1"}),"Assignment Title *"]}),r.jsx("input",{type:"text",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.title?"border-red-300":"border-gray-300"}`,value:d.title,onChange:R=>u({...d,title:R.target.value}),placeholder:"e.g., Math Homework - Chapter 5"}),m.title&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.title})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class *"}),r.jsxs("select",{className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.class?"border-red-300":"border-gray-300"}`,value:d.class,onChange:R=>{const $=R.target.value;u({...d,class:$,subject:""}),$?A($):O([])},children:[r.jsx("option",{value:"",children:"Select Class"}),i().map(R=>r.jsx("option",{value:R.value,children:R.label},R.value))]}),m.class&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.class})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section *"}),r.jsxs("select",{className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.section?"border-red-300":"border-gray-300"}`,value:d.section,onChange:R=>u({...d,section:R.target.value}),children:[r.jsx("option",{value:"",children:"Select Section"}),(d.class?l(d.class):[]).map(R=>r.jsx("option",{value:R.value,children:R.label},R.value))]}),m.section&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.section})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),r.jsxs("select",{className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.subject?"border-red-300":"border-gray-300"}`,value:d.subject,onChange:R=>u({...d,subject:R.target.value}),disabled:!d.class,children:[r.jsx("option",{value:"",children:d.class?"Select Subject":"Select Class First"}),E.map(R=>r.jsx("option",{value:R,children:R},R))]}),m.subject&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.subject})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(an,{className:"w-4 h-4 inline mr-1"}),"Start Date *"]}),r.jsx("input",{type:"date",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.startDate?"border-red-300":"border-gray-300"}`,value:d.startDate,onChange:R=>u({...d,startDate:R.target.value})}),m.startDate&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.startDate})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(an,{className:"w-4 h-4 inline mr-1"}),"Due Date *"]}),r.jsx("input",{type:"date",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${m.dueDate?"border-red-300":"border-gray-300"}`,value:d.dueDate,onChange:R=>u({...d,dueDate:R.target.value})}),m.dueDate&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.dueDate})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructions"}),r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:4,value:d.instructions,onChange:R=>u({...d,instructions:R.target.value}),placeholder:"Enter assignment instructions..."})]}),d.existingAttachments.length>0&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Attachments"}),r.jsx("div",{className:"space-y-2",children:d.existingAttachments.map((R,$)=>r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[r.jsx("span",{className:"text-sm text-gray-700",children:R.originalName||R.filename}),r.jsx("button",{type:"button",onClick:()=>P($),className:"text-red-600 hover:text-red-800",children:r.jsx(Ba,{className:"h-4 w-4"})})]},$))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Xl,{className:"w-4 h-4 inline mr-1"}),"Add New Attachments"]}),r.jsx("input",{type:"file",multiple:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",onChange:C,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.zip,.jpg,.jpeg,.png"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Max 5 files, 10MB each. Supported: PDF, DOC, XLS, PPT, TXT, ZIP, Images"})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[r.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:f,children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:f?"Updating...":"Update Assignment"})]})]})]})}):null},KZ=()=>{const{getClassOptions:e,getSectionsByClass:t}=Ea(),{currentAcademicYear:n,viewingAcademicYear:a,isViewingHistoricalYear:s,setViewingYear:i,availableYears:l}=pn(),[d,u]=j.useState(""),[m,p]=j.useState("all"),[f,g]=j.useState(""),[N,v]=j.useState(""),[w,y]=j.useState(""),[E,O]=j.useState(!1),[T,A]=j.useState(!1),[I,C]=j.useState(""),[P,F]=j.useState([]),[R,$]=j.useState(!1),[L,G]=j.useState(""),[X,me]=j.useState([]),[se,ee]=j.useState({total:0,active:0,completed:0,overdue:0,dueThisWeek:0});j.useEffect(()=>{W()},[a]),j.useEffect(()=>{P.length>0&&U()},[P]),j.useEffect(()=>{f?Q(f):(me([]),y(""))},[f,N,a]);const W=async()=>{try{$(!0),G(""),console.log(" Fetching assignments for academic year:",a);let K;try{K=(await ot.get("/assignments",{params:{academicYear:a}})).data,console.log(" Assignments fetched from regular endpoint:",K)}catch(ie){console.error(" Error with regular endpoint:",ie),console.log(" Trying direct test endpoint...");let ne="";try{const We=localStorage.getItem("erp.auth");We&&(ne=JSON.parse(We).user?.schoolCode||"",console.log(` Using school code from auth: "${ne}"`))}catch(We){console.error("Error parsing auth data:",We)}const Te=new URLSearchParams({schoolCode:ne,...a&&{academicYear:a}});K=(await ot.get(`/direct-test/assignments?${Te.toString()}`)).data,console.log(" Assignments fetched from direct endpoint:",K)}const be=K.assignments||K||[],re=be.filter(ie=>{if(!ie||typeof ie!="object")return!1;const ne=ie.title&&ie.title.trim()!=="",Te=ie.class&&ie.class.trim()!=="",ve=ie.subject&&ie.subject.trim()!=="";return ne&&Te&&ve});console.log(` Processed ${re.length} valid assignments (filtered out ${be.length-re.length} incomplete)`),F(re)}catch(K){console.error(" Error fetching assignments:",K),G(K.response?.data?.message||K.message||"Failed to fetch assignments"),F([])}finally{$(!1)}},U=()=>{if(!P||P.length===0){ee({total:0,active:0,completed:0,overdue:0,dueThisWeek:0});return}const K=new Date,be=new Date;be.setDate(be.getDate()+7);const re={total:P.length,active:0,completed:0,overdue:0,dueThisWeek:0};P.forEach(ie=>{const ne=new Date(ie.dueDate);ie.status==="active"&&re.active++,ie.status==="completed"&&re.completed++,ie.status==="overdue"&&re.overdue++,ne>=K&&ne<=be&&re.dueThisWeek++}),ee(re)},Q=async K=>{if(!K||!N){me([]),y("");return}try{console.log(` Fetching subjects for class: ${K}, section: ${N}, academic year: ${a}`);const be=localStorage.getItem("erp.schoolCode")||"";if(!be){console.error(" School code not available"),me([]);return}console.log(" Using school code:",be);try{console.log(" Trying primary API: /class-subjects/classes");const re=await ot.get("/class-subjects/classes",{headers:{"x-school-code":be.toUpperCase()}});if(console.log(" Primary API response:",re.data),re.data?.success&&re.data?.data?.classes){const ie=re.data.data.classes.find(ne=>ne.className===K&&ne.section===N);if(console.log(" Found class data:",ie),ie?.subjects){const Te=ie.subjects.filter(ve=>ve.isActive!==!1).map(ve=>ve.name||ve.subjectName).filter(Boolean);console.log(" Extracted subject names:",Te),me(Te),y(Te[0]||"");return}}}catch(re){console.error(" Primary API failed:",re)}try{console.log(" Trying fallback API: /direct-test/class-subjects");const re=await ot.get(`/direct-test/class-subjects/${K}`,{params:{schoolCode:be},headers:{"x-school-code":be.toUpperCase()}});if(console.log(" Fallback API response:",re.data),re.data?.success&&re.data?.data?.subjects){const ie=re.data.data.subjects.map(ne=>ne.name||ne.subjectName).filter(Boolean);console.log(" Extracted subject names from fallback:",ie),me(ie),y(ie[0]||"");return}}catch(re){console.error(" Fallback API failed:",re)}console.warn(" No subjects found for class/section"),me([]),y("")}catch(be){console.error(" Error fetching subjects:",be),me([]),y("")}},Y=()=>{O(!0)},H=()=>{W()},te=K=>{console.log(" Edit assignment:",K),C(K),A(!0)},fe=()=>{W(),A(!1),C("")},Le=async(K,be)=>{if(window.confirm(`Are you sure you want to delete "${be}"?

This action cannot be undone.`))try{console.log(" Deleting assignment:",K),await s5(K),console.log(" Assignment deleted successfully"),alert("Assignment deleted successfully!"),W()}catch(ie){console.error(" Error deleting assignment:",ie),alert(ie.response?.data?.message||"Failed to delete assignment")}},he=P.filter(K=>{const be=K?.title||"",re=K?.subject||"",ie=K?.status||"",ne=K?.class||"",Te=be.toLowerCase().includes(d.toLowerCase())||re.toLowerCase().includes(d.toLowerCase()),ve=m==="all"||ie===m,We=!f||ne===f,Ie=!w||re===w,je=!a||K.academicYear===a;return Te&&ve&&We&&Ie&&je});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Assignments"}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsxs("button",{className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors",children:[r.jsx(Ci,{className:"h-4 w-4 mr-2"}),"Export Data"]}),r.jsxs("button",{onClick:Y,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[r.jsx(Os,{className:"h-4 w-4 mr-2"}),"Add Assignment"]})]})]}),L&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:L}),R&&r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading assignments..."})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"bg-blue-500 p-3 rounded-lg",children:r.jsx(Pn,{className:"h-6 w-6 text-white"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Assignments"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:se.total})]})]})}),r.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"bg-purple-500 p-3 rounded-lg",children:r.jsx(an,{className:"h-6 w-6 text-white"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Due This Week"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:se.dueThisWeek})]})]})})]}),r.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsxs("div",{className:"relative w-full md:w-64",children:[r.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),r.jsx("input",{type:"text",placeholder:"Search assignments...",value:d,onChange:K=>u(K.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{className:"flex flex-1 gap-3",children:[r.jsx("select",{value:a,onChange:K=>i(K.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:l.map(K=>r.jsxs("option",{value:K,children:[K," ",K===n&&"(Current)"]},K))}),r.jsxs("select",{value:f,onChange:K=>g(K.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Classes"}),e().map(K=>r.jsx("option",{value:K.value,children:K.label},K.value))]}),r.jsxs("select",{value:N,onChange:K=>v(K.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Sections"}),(f?t(f):[]).map(K=>r.jsx("option",{value:K.value,children:K.label},K.value))]}),r.jsxs("select",{value:w,onChange:K=>y(K.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Subjects"}),X.map(K=>r.jsx("option",{value:K,children:K},K))]})]})]})}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assignment"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Section"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:he.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:r.jsxs("div",{className:"flex flex-col items-center justify-center",children:[r.jsx(Pn,{className:"h-12 w-12 text-gray-400 mb-3"}),r.jsx("p",{className:"text-gray-500 text-lg font-medium",children:"No assignments found"}),r.jsx("p",{className:"text-gray-400 text-sm mt-1",children:d||f||N||w||m!=="all"?"Try adjusting your filters":"Create your first assignment to get started"})]})})}):he.map(K=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"text-sm font-medium text-gray-900",children:K.title||"Untitled Assignment"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:K.class||"N/A"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:K.section||"N/A"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:K.subject||"N/A"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(an,{className:"h-4 w-4 mr-1 text-gray-400"}),K.dueDate?new Date(K.dueDate).toLocaleDateString():"No due date"]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>te(K._id),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"Edit assignment",children:r.jsx(Qs,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>Le(K._id,K.title),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",title:"Delete assignment",children:r.jsx(Ba,{className:"h-4 w-4"})})]})})]},K._id))})]})})}),r.jsx(WZ,{isOpen:E,onClose:()=>O(!1),onSuccess:H}),I&&r.jsx(YZ,{isOpen:T,onClose:()=>{A(!1),C("")},onSuccess:fe,assignmentId:I})]})},GZ=()=>{const{user:e,token:t}=yr(),{currentAcademicYear:n,viewingAcademicYear:a,isViewingHistoricalYear:s,setViewingYear:i,availableYears:l,loading:d}=pn(),{classesData:u,loading:m,getSectionsByClass:p,hasClasses:f}=Ea(),[g,N]=j.useState(""),[v,w]=j.useState(""),[y,E]=j.useState([]),[O,T]=j.useState(!1),[A,I]=j.useState(""),[C,P]=j.useState(null),[F,R]=j.useState([]),[$,L]=j.useState(""),[G,X]=j.useState(100),[me,se]=j.useState(!1),[ee,W]=j.useState(!1),[U,Q]=j.useState(null),[Y,H]=j.useState([]),[te,fe]=j.useState(!1),[Le,he]=j.useState({}),[K,be]=j.useState([]),[re,ie]=j.useState([]),[ne,Te]=j.useState(!1),[ve,We]=j.useState([]),[Ie,je]=j.useState(!1),[oe,$e]=j.useState(!1),[et,lt]=j.useState(null),[rt,Lt]=j.useState(null),[kt,Oe]=j.useState(null),[Nt,Mt]=j.useState(!1),[rr,Ft]=j.useState(!1);j.useEffect(()=>{Mt(!1),$e(!1),se(!1)},[g,v,$,A]);const cr=j.useCallback(B=>{const Pe=Ae=>new Date(Ae.updatedAt||Ae.createdAt||0).getTime(),Se=new Map;for(const Ae of B||[]){const Xe=String(Ae.studentId||Ae.student_id||Ae.id||"");if(!Xe)continue;const Ke=String(Ae.subject||$||""),Ve=String(Ae.testType||A||""),ut=String(Ae.className||Ae.class||g||""),Je=String(Ae.section||v||""),ae=`${Xe}::${ut}::${Je}::${Ke}::${Ve}`,ct=Se.get(ae);(!ct||Pe(Ae)>=Pe(ct))&&Se.set(ae,Ae)}return Array.from(Se.values())},[$,A,g,v]),or=j.useCallback((B,Pe)=>{const Se=ut=>String(ut||"").toUpperCase().trim(),Ae=ut=>{const Je=Se(ut),ae=Je.match(/^(.*?)(\d+)$/);return ae?{p:ae[1],n:parseInt(ae[2],10)}:{p:Je,n:Number.MAX_SAFE_INTEGER}},Xe=Ae(B),Ke=Ae(Pe),Ve=Xe.p.localeCompare(Ke.p);return Ve!==0?Ve:Xe.n-Ke.n},[]),ke=j.useCallback(B=>[...B].sort((Pe,Se)=>or(Pe.userId,Se.userId)),[or]),ht=j.useCallback(B=>[...B].sort((Pe,Se)=>or(Pe?.userId,Se?.userId)),[or]),_e=j.useCallback(async B=>{try{const Se=(localStorage.getItem("erp.schoolCode")||e?.schoolCode||"").toUpperCase();if(!Se||!g||!v)return B;const Xe=(await Gn.getStudents(Se,{class:g,section:v}))?.data?.data||[],Ke=new Map,Ve=new Map,ut=new Map;for(const ae of Xe){const ct=String(ae._id||ae.id||""),st=String(ae.userId||ae.user_id||""),dt=String(ae.name?.displayName||`${ae.name?.firstName||""} ${ae.name?.lastName||""}`.trim()||ae.fullName||"").toLowerCase();ct&&Ke.set(ct,ae),st&&Ve.set(st,ae),dt&&ut.set(dt,ae)}return B.map(ae=>{if(ae.rollNumber&&ae.rollNumber!=="-")return ae;const ct=String(ae.name||"").toLowerCase(),st=Ke.get(String(ae.id))||Ve.get(String(ae.userId))||ut.get(ct),dt=st?.studentDetails?.rollNumber||st?.studentDetails?.currentRollNumber||st?.studentDetails?.rollNo||st?.rollNumber||st?.sequenceId||ae.rollNumber||"";return{...ae,rollNumber:dt}})}catch{return B}},[g,v,e?.schoolCode]),tt=u?.classes?.map(B=>B.className)||[],gt=j.useCallback(async B=>{if(!B){be([]);return}Te(!0);try{if(u&&u.testsByClass){let Se=u.testsByClass[B]||u.testsByClass[String(B)]||[];Se.length===0&&u.tests&&(Se=u.tests.filter(Xe=>String(Xe.className)===String(B)));const Ae=(Se||[]).filter(Xe=>typeof Xe?.maxMarks=="number"&&Xe.maxMarks>0);if(Ae.length>0){const Xe=Ae.map(Ve=>Ve.testName||Ve.displayName||Ve.name||Ve.testType).filter(Boolean),Ke=[...new Set(Xe)];be(Ke),Te(!1);return}}if(!(localStorage.getItem("erp.schoolCode")||e?.schoolCode||"")){ge.error("School code not available");return}be([])}catch(Pe){console.error("Error fetching test types:",Pe),ge.error("Failed to load test types"),be([])}finally{Te(!1)}},[e?.schoolCode,u]);j.useEffect(()=>{if(g&&u){const B=p(g);E(B),B.length>0?w(B[0].value):w(""),L(""),R([])}else E([]),w(""),L(""),R([])},[g,u]),j.useEffect(()=>{g?(gt(g),I(""),P(null),X("")):be([])},[g,gt]),j.useEffect(()=>{if(!g||!A||!u){P(null);return}const Pe=(u.testsByClass?.[g]||u.tests||[]).find(Ae=>(Ae.testName||Ae.displayName||Ae.name||Ae.testType)===A),Se=typeof Pe?.maxMarks=="number"?Pe.maxMarks:null;P(Se),Se!==null&&X(Se)},[g,A,u]),j.useEffect(()=>{(async()=>{if(!g||!v){R([]),L("");return}T(!0),console.log(" Fetching subjects for class:",g,"section:",v);try{const Pe=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(!Pe){console.error(" School code not available"),ge.error("School code not available");return}console.log(" Using school code:",Pe);try{console.log(" Trying primary API: /class-subjects/classes");const Se=await ot.get("/class-subjects/classes",{headers:{"x-school-code":Pe.toUpperCase()}});if(console.log(" Primary API response:",Se.data),Se.data?.success&&Se.data?.data?.classes){const Ae=Se.data.data.classes.find(Xe=>Xe.className===g&&Xe.section===v);if(console.log(" Found class data:",Ae),Ae?.subjects){const Ke=Ae.subjects.filter(Ve=>Ve.isActive!==!1).map(Ve=>Ve.name||Ve.subjectName).filter(Boolean);console.log(" Extracted subject names:",Ke),R(Ke),L(Ke[0]||""),T(!1);return}}}catch(Se){console.error(" Primary API failed:",Se)}try{console.log(" Trying fallback API: /direct-test/class-subjects");const Se=await ot.get(`/direct-test/class-subjects/${g}`,{params:{schoolCode:Pe},headers:{"x-school-code":Pe.toUpperCase()}});if(console.log(" Fallback API response:",Se.data),Se.data?.success&&Se.data?.data?.subjects){const Ae=Se.data.data.subjects.map(Xe=>Xe.name||Xe.subjectName).filter(Boolean);console.log(" Extracted subject names from fallback:",Ae),R(Ae),L(Ae[0]||""),T(!1);return}}catch(Se){console.error(" Fallback API failed:",Se)}console.warn(" No subjects found for class/section"),R([]),L(""),ge.error("No subjects found for selected class and section")}catch(Pe){console.error(" Error fetching subjects:",Pe),ge.error("Failed to load subjects"),R([]),L("")}finally{T(!1)}})()},[g,v,e?.schoolCode]);const Pt=j.useCallback(async()=>{W(!0),Q(null);try{const Pe=(localStorage.getItem("erp.schoolCode")||e?.schoolCode||"").toUpperCase();if(!Pe){ge.error("School code not available");return}const Se=await Gn.getStudents(Pe,{class:g,section:v});if(Se.data.success&&Se.data.data){const Ke=Se.data.data.filter(Ve=>{const ut=Ve.academicInfo?.class||Ve.studentDetails?.academic?.currentClass||Ve.studentDetails?.currentClass||Ve.studentDetails?.class||Ve.currentclass||Ve.class||Ve.className,Je=Ve.academicInfo?.section||Ve.studentDetails?.academic?.currentSection||Ve.studentDetails?.currentSection||Ve.studentDetails?.section||Ve.currentsection||Ve.section,ae=Ve.studentDetails?.academicYear||Ve.studentDetails?.academic?.academicYear||Ve.academicYear||Ve.academicInfo?.academicYear,ct=!ae||String(ae).trim()===String(a).trim();return String(ut).trim()===String(g).trim()&&String(Je).trim().toUpperCase()===String(v).trim().toUpperCase()&&ct}).map((Ve,ut)=>({id:Ve._id||Ve.id,name:Ve.name?.displayName||`${Ve.name?.firstName||""} ${Ve.name?.lastName||""}`.trim()||Ve.fullName||"Unknown",userId:Ve.userId||Ve.user_id||"N/A",rollNumber:Ve.studentDetails?.rollNumber||Ve.studentDetails?.currentRollNumber||Ve.rollNumber||Ve.sequenceId||`${Pe}-${v}-${String(ut+1).padStart(4,"0")}`,class:g,section:v,totalMarks:C,obtainedMarks:null,grade:null}));if(Ke.length>0){H(ke(Ke)),se(!0);const Ve={};Ke.forEach(ut=>{Ve[ut.id]=!1}),he(Ve),ge.success(`Found ${Ke.length} students in ${g}-${v}`);return}}else console.warn("Primary students API did not return data or success=false",Se.data);try{const ut=((await ot.get(`/school-users/${Pe}/users`)).data?.data||[]).filter(Je=>{const ae=Je.role==="student",ct=Je.studentDetails?.currentClass||Je.currentclass||Je.class||Je.className,st=Je.studentDetails?.currentSection||Je.currentsection||Je.section;return ae&&String(ct)===String(g)&&String(st).toUpperCase()===String(v).toUpperCase()}).map((Je,ae)=>({id:Je._id||Je.id,name:Je.name?.displayName||`${Je.name?.firstName||""} ${Je.name?.lastName||""}`.trim()||Je.fullName||"Unknown",userId:Je.userId||Je.user_id||"N/A",rollNumber:Je.studentDetails?.rollNumber||Je.studentDetails?.currentRollNumber||Je.rollNumber||Je.sequenceId||`${Pe}-${v}-${String(ae+1).padStart(4,"0")}`,class:g,section:v,totalMarks:C,obtainedMarks:null,grade:null}));if(ut.length>0){H(ke(ut)),se(!0);const Je={};ut.forEach(ae=>{Je[ae.id]=!1}),he(Je),ge.success(`Loaded ${ut.length} students via fallback API`);return}}catch(Ae){console.error("Fallback school-users API error:",Ae)}Q("No students found for the selected class and section"),H([]),se(!1)}catch(B){console.error("Error fetching students:",B),Q("Failed to load students. Please try again."),H([]),se(!1)}finally{W(!1)}},[g,v,C,e?.schoolCode]),Ot=j.useCallback(async()=>{W(!0),Q(null);try{const B=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(!B){ge.error("School code not available");return}const Pe=await Gn.getResults({schoolCode:B,class:g,section:v,subject:$,testType:A});if(Pe.data?.success&&Array.isArray(Pe.data?.data)&&Pe.data.data.length>0){const Se=cr(Pe.data.data),Xe=Se[0]?.frozen||!1;Mt(Xe);let Ke=Se.map(ut=>({id:ut.studentId,name:ut.studentName,userId:ut.userId,rollNumber:ut.rollNumber||ut.sequenceId||"",class:ut.className||g,section:ut.section||v,totalMarks:typeof ut.totalMarks=="number"?ut.totalMarks:C,obtainedMarks:ut.obtainedMarks??null,grade:b(ut.obtainedMarks,typeof ut.totalMarks=="number"?ut.totalMarks:C),resultId:ut._id||ut.id}));Ke=await _e(Ke),H(ke(Ke)),se(!0);const Ve={};Ke.forEach(ut=>{Ve[ut.id]=!0}),he(Ve),Xe?ge.error(` Results are FROZEN and cannot be edited. Loaded ${Ke.length} result(s).`,{duration:5e3}):ge.success(`Loaded ${Ke.length} saved result(s)`);return}await Pt()}catch(B){console.error("Error fetching results/students:",B),Q("Failed to load results/students. Please try again."),H([]),se(!1)}finally{W(!1)}},[g,v,$,A,C,e?.schoolCode,Pt]),vt=j.useCallback(async()=>{if(!g||!v){ge.error("Please select class and section first");return}if(!$){ge.error("Please select a subject first");return}if(!A){ge.error("Please select a test type first");return}je(!0);try{const B=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(!B){ge.error("School code not available");return}const Pe=await Gn.getResults({schoolCode:B,class:g,section:v,subject:$,testType:A});if(Pe.data.success&&Pe.data.data){const Se=cr(Pe.data.data),Xe=Se[0]?.frozen||!1;Mt(Xe);const Ke=await _e(Se.map(Je=>({id:Je.studentId,name:Je.studentName,userId:Je.userId,rollNumber:Je.rollNumber||Je.sequenceId||"",class:Je.className||g,section:Je.section||v,totalMarks:Je.totalMarks??C,obtainedMarks:Je.obtainedMarks??null,grade:Je.grade??null,resultId:Je._id||Je.id}))),Ve=new Map(Ke.map(Je=>[String(Je.id),Je.rollNumber])),ut=Se.map(Je=>({...Je,rollNumber:Je.rollNumber||Ve.get(String(Je.studentId))||Je.sequenceId||"",grade:b(Je.obtainedMarks,Je.totalMarks),frozen:Je.frozen||!1}));We(ht(ut)),$e(!0),se(!1),ge.success(`Found ${ut.length} existing results for ${g}-${v}`)}else We([]),$e(!1),await Pt(),fe(!0),ge.success("No existing results found. Loaded students for entering marks.")}catch(B){console.error("Error fetching existing results:",B),ge.error("Failed to load existing results"),We([]),$e(!1)}finally{je(!1)}},[g,v,$,A,C,e?.schoolCode,_e,ht,cr,Pt]),nr=B=>{lt(B._id),Lt(B.obtainedMarks)},Yt=()=>{lt(null),Lt(null)},Or=async B=>{if(rt==null){ge.error("Please enter valid marks");return}Oe(B._id);try{const Pe=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";await Gn.updateResult(B._id,{schoolCode:Pe,class:B.className,section:B.section,subject:B.subject,testType:B.testType,maxMarks:B.maxMarks||B.totalMarks,obtainedMarks:rt,totalMarks:B.totalMarks,studentId:B.studentId,studentName:B.studentName,userId:B.userId});const Se=b(rt,B.totalMarks);We(Ae=>Ae.map(Xe=>Xe._id===B._id?{...Xe,obtainedMarks:rt,grade:Se}:Xe)),lt(null),Lt(null),ge.success("Result updated successfully!")}catch(Pe){console.error("Error updating result:",Pe),ge.error("Failed to update result")}finally{Oe(null)}},Sr=async()=>{if(!g||!v||!$||!A){ge.error("Please ensure all filters are selected");return}if(window.confirm(`Are you sure you want to FREEZE results for ${g}-${v}, ${$} (${A})?

Once frozen, marks CANNOT be edited anymore!`)){Ft(!0);try{const Pe=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";await Gn.freezeResults({schoolCode:Pe,class:g,section:v,subject:$,testType:A,academicYear:"2024-25"}),We(Se=>Se.map(Ae=>({...Ae,frozen:!0}))),Mt(!0),ge.success("Results frozen successfully! Marks can no longer be edited.")}catch(Pe){console.error("Error freezing results:",Pe),ge.error("Failed to freeze results")}finally{Ft(!1)}}},$t=()=>{if(!g){ge.error("Please select a class");return}if(!v){ge.error("Please select a section");return}if(!$){ge.error("Please select a subject");return}if(!A){ge.error("Please select a test type");return}if(!C||C<=0){ge.error("Configured max marks not found for this test. Please configure in Admin > Settings.");return}$e(!1),fe(!0),Ot()},gr=async()=>{try{const B=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(console.log(" Starting save process...",{schoolCode:B,selectedClass:g,selectedSection:v,selectedSubject:$,selectedTestType:A,configuredMaxMarks:C,totalStudents:Y.length}),!B){ge.error("School code not available");return}const Pe=Y.filter(Ke=>Ke.obtainedMarks!==null&&Ke.obtainedMarks!==void 0);if(console.log(" Valid results to save:",Pe.length,Pe),Pe.length===0){ge.error("Please enter obtained marks for at least one student");return}const Se=Pe.filter(Ke=>!!Ke.resultId),Ae=Pe.filter(Ke=>!Ke.resultId);if(console.log(" Split results:",{toUpdate:Se.length,toCreate:Ae.length}),Se.length>0&&(console.log(" Updating existing results:",Se),await Promise.all(Se.map(async Ke=>{const Ve={schoolCode:B,class:g,section:v,subject:$,testType:A,maxMarks:C,totalMarks:Ke.totalMarks??C,obtainedMarks:Ke.obtainedMarks,studentId:Ke.id,studentName:Ke.name,userId:Ke.userId};try{await Gn.updateResult(Ke.resultId,Ve)}catch(ut){console.warn("Update failed for result, attempting upsert via saveResults",Ke.resultId,ut);const Je={schoolCode:B,class:g,section:v,testType:A,subject:$,maxMarks:C,academicYear:"2024-25",results:[{studentId:Ke.id,studentName:Ke.name,userId:Ke.userId,obtainedMarks:Ke.obtainedMarks,totalMarks:Ke.totalMarks??C,grade:Ke.grade}]};try{await Gn.saveResults(Je)}catch(ae){console.error("Upsert via saveResults also failed for student",Ke.id,ae)}}}))),Ae.length>0){const Ke={schoolCode:B,class:g,section:v,testType:A,subject:$,maxMarks:C,academicYear:"2024-25",results:Ae.map(ut=>({studentId:ut.id,studentName:ut.name,userId:ut.userId,obtainedMarks:ut.obtainedMarks,totalMarks:ut.totalMarks??C,grade:ut.grade}))};console.log(" Creating new results:",Ke);const Ve=await Gn.saveResults(Ke);if(console.log(" Create response:",Ve.data),!Ve.data?.success){ge.error(Ve.data?.message||"Failed to create new results");return}}console.log(" Save completed successfully!"),ge.success(`Saved ${Se.length} update(s)${Ae.length?` and created ${Ae.length}`:""}`);const Xe={};Y.forEach(Ke=>{Xe[Ke.id]=!0}),he(Xe),fe(!1),console.log(" Refreshing results..."),await Ot()}catch(B){console.error("Error saving results:",B),ge.error("Failed to save results. Please try again.")}},kr=(B,Pe,Se)=>{H(Ae=>Ae.map(Xe=>{if(Xe.id===B){const Ke={...Xe,[Pe]:Se};return Ke.grade=b(Se,Xe.totalMarks),Ke}return Xe})),he(Ae=>({...Ae,[B]:!1}))},b=(B,Pe)=>{if(B==null||!Pe||Pe===0)return"N/A";const Se=B/Pe*100;return Se>=91?"A1":Se>=81?"A2":Se>=71?"B1":Se>=61?"B2":Se>=51?"C1":Se>=41?"C2":Se>=33?"D":Se>=21?"E1":"E2"};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Academic Results"}),me&&!Nt&&r.jsx("div",{className:"flex space-x-3",children:r.jsxs("button",{onClick:gr,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors",children:[r.jsx(rs,{className:"h-4 w-4 mr-2"}),"Save All Changes"]})})]}),s&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-4",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:" Viewing Historical Data:"})," You are viewing data from ",a,". This data is read-only."]})}),r.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex flex-wrap gap-4",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"year-select",className:"text-sm font-medium text-gray-700",children:"Academic Year"}),r.jsx("select",{id:"year-select",value:a,onChange:B=>i(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",children:l.map(B=>r.jsxs("option",{value:B,children:[B," ",B===n&&"(Current)"]},B))})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"class-select",className:"text-sm font-medium text-gray-700",children:"Class"}),r.jsxs("select",{id:"class-select",value:g,onChange:B=>N(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",disabled:m||!f(),children:[r.jsx("option",{value:"",children:m?"Loading...":"Select Class"}),tt.map(B=>r.jsxs("option",{value:B,children:["Class ",B]},B))]}),!m&&!f()&&r.jsx("span",{className:"text-xs text-red-500 mt-1",children:"No classes configured"})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"section-select",className:"text-sm font-medium text-gray-700",children:"Section"}),r.jsxs("select",{id:"section-select",value:v,onChange:B=>w(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",disabled:!g||y.length===0,children:[r.jsx("option",{value:"",children:g?"Select Section":"Select Class First"}),y.map(B=>r.jsxs("option",{value:B.value,children:["Section ",B.section]},B.value))]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"subject-select",className:"text-sm font-medium text-gray-700",children:"Subject"}),r.jsxs("select",{id:"subject-select",value:$,onChange:B=>L(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[180px]",disabled:!g||!v||O,children:[r.jsx("option",{value:"",children:!g||!v?"Select Class & Section":O?"Loading...":F.length===0?"No Subjects":"Select Subject"}),F.map(B=>r.jsx("option",{value:B,children:B},B))]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"test-type-select",className:"text-sm font-medium text-gray-700",children:"Test Type"}),r.jsxs("select",{id:"test-type-select",value:A,onChange:B=>I(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",disabled:!g||ne,children:[r.jsx("option",{value:"",children:g?ne?"Loading...":"Select Test":"Select Class First"}),K.map((B,Pe)=>r.jsx("option",{value:B,children:B},`${B}-${Pe}`))]}),!g&&r.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Select a class to see available tests"})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Total Marks"}),r.jsx("input",{type:"number",value:C??"",readOnly:!0,className:"px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-700 min-w-[120px]",placeholder:"Configured"})]}),r.jsxs("button",{onClick:$t,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors self-end",disabled:ee,children:[ee?r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r.jsx(va,{className:"h-4 w-4 mr-2"}),"Search"]}),r.jsxs("button",{onClick:vt,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors self-end disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:Ie||!g||!v||!$||!A,children:[Ie?r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"View Existing Results"]})]})}),U&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsx("p",{className:"text-red-700",children:U})}),oe&&r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:["Existing Results for ",g,"-",v,$&&` - ${$}`,A&&` (${A})`,Nt&&r.jsxs("span",{className:"px-3 py-1 bg-red-100 text-red-700 text-xs font-semibold rounded-full flex items-center gap-1",children:[r.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"FROZEN"]})]}),r.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Found ",ve.length," results. ",Nt?"Results are frozen and cannot be edited.":"Click on a result to edit it."]})]}),!Nt&&ve.length>0&&r.jsx("button",{onClick:Sr,disabled:rr,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors disabled:opacity-50",children:rr?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Freezing..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Freeze Results"]})})]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User ID"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Obtained Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ve.map((B,Pe)=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B.userId||"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:B.studentName}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-md text-xs font-medium",children:B.subject||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:r.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded-md text-xs font-medium",children:B.testType})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:et===B._id?r.jsx("input",{type:"number",value:rt||"",onChange:Se=>{const Ae=Se.target.value;(Ae===""||Ae.length<=3&&parseInt(Ae)<=B.totalMarks)&&Lt(Ae===""?null:parseInt(Ae))},className:"w-20 px-2 py-1 border border-blue-500 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Marks",min:"0",max:B.totalMarks,maxLength:3,autoFocus:!0}):B.obtainedMarks}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B.totalMarks}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:r.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${["A1","A2"].includes(et===B._id?b(rt,B.totalMarks):B.grade)?"bg-green-100 text-green-800":["B1","B2"].includes(et===B._id?b(rt,B.totalMarks):B.grade)?"bg-blue-100 text-blue-800":["C1","C2"].includes(et===B._id?b(rt,B.totalMarks):B.grade)?"bg-yellow-100 text-yellow-800":(et===B._id?b(rt,B.totalMarks):B.grade)==="D"?"bg-orange-100 text-orange-800":["E1","E2"].includes(et===B._id?b(rt,B.totalMarks):B.grade)?"bg-red-100 text-red-800":"bg-gray-100 text-gray-600"}`,children:et===B._id?b(rt,B.totalMarks):B.grade||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(B.createdAt).toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:et===B._id?r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>Or(B),disabled:kt===B._id,className:"text-green-600 hover:text-green-900 disabled:opacity-50",title:"Save",children:kt===B._id?r.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r.jsx(rs,{className:"h-5 w-5"})}),r.jsx("button",{onClick:Yt,disabled:kt===B._id,className:"text-red-600 hover:text-red-900 disabled:opacity-50",title:"Cancel",children:r.jsx(Ur,{className:"h-5 w-5"})})]}):r.jsx("button",{onClick:()=>nr(B),disabled:Nt||B.frozen,className:"text-blue-600 hover:text-blue-900 disabled:text-gray-400 disabled:cursor-not-allowed",title:Nt||B.frozen?"Results are frozen":"Edit",children:Nt||B.frozen?r.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}):r.jsx(Qs,{className:"h-5 w-5"})})})]},B._id||Pe))})]})})]}),me&&r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[Nt&&r.jsxs("div",{className:"px-6 py-3 bg-red-50 border-b border-red-200 flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),r.jsx("span",{className:"text-red-700 font-semibold",children:"Results are FROZEN - Editing is disabled"})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User ID"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Obtained Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Y.map(B=>r.jsxs("tr",{className:Nt?"bg-gray-50":"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B.userId||"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:B.name}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B.totalMarks??C??"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.jsx("input",{type:"number",value:B.obtainedMarks||"",onChange:Pe=>{const Se=Pe.target.value,Ae=B.totalMarks??C??100;(Se===""||Se.length<=3&&parseInt(Se)<=Ae)&&kr(B.id,"obtainedMarks",Se===""?null:parseInt(Se))},disabled:Nt,className:"w-20 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter marks",min:"0",max:B.totalMarks??C??100,maxLength:3})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:r.jsx("span",{className:`px-3 py-1 rounded-md text-sm font-semibold ${B.grade&&["A1","A2"].includes(B.grade)?"bg-green-100 text-green-800":B.grade&&["B1","B2"].includes(B.grade)?"bg-blue-100 text-blue-800":B.grade&&["C1","C2"].includes(B.grade)?"bg-yellow-100 text-yellow-800":B.grade==="D"?"bg-orange-100 text-orange-800":B.grade&&["E1","E2"].includes(B.grade)?"bg-red-100 text-red-800":"bg-gray-100 text-gray-600"}`,children:B.grade||"N/A"})})]},B.id))})]})})]})]})},to={getBySchoolCode:()=>"/test-details/",updateSchoolTestDetails:()=>"/test-details/",addTestType:e=>`/test-details/class/${e}/test-type`,removeTestType:(e,t)=>`/test-details/class/${e}/test-type/${t}`,getBySchoolCodeSuperadmin:e=>`/test-details/school/${e}`,updateSchoolTestDetailsSuperadmin:e=>`/test-details/school/${e}`,addTestTypeSuperadmin:(e,t)=>`/test-details/school/${e}/class/${t}/test-type`,removeTestTypeSuperadmin:(e,t,n)=>`/test-details/school/${e}/class/${t}/test-type/${n}`,getBySchoolId:e=>`/test-details/${e}`},vi={defaultAcademicYear:"2024-25"},XZ={async getTestDetailsBySchoolCode(e){console.log("[DEBUG] getTestDetailsBySchoolCode called with academicYear:",e),console.log("[DEBUG] TEST_DETAILS_CONFIG.defaultAcademicYear:",vi.defaultAcademicYear);const t=e?{academicYear:e}:{academicYear:vi.defaultAcademicYear};return console.log("[DEBUG] Final params:",t),(await zt.get(to.getBySchoolCode(),{params:t})).data},async addTestTypeToClass(e,t,n){const a={testType:t,academicYear:n||vi.defaultAcademicYear};return(await zt.post(to.addTestType(e),a)).data},async removeTestTypeFromClass(e,t,n){const a=n?{academicYear:n}:{academicYear:vi.defaultAcademicYear};return(await zt.delete(to.removeTestType(e,t),{params:a})).data},async updateSchoolTestDetails(e,t){const n={classTestTypes:e,academicYear:t||vi.defaultAcademicYear};return(await zt.put(to.updateSchoolTestDetails(),n)).data},async getTestDetailsBySchoolCodeSuperadmin(e,t){const n=t?{academicYear:t}:{academicYear:vi.defaultAcademicYear};return(await zt.get(to.getBySchoolCodeSuperadmin(e),{params:n})).data},async addTestTypeToClassSuperadmin(e,t,n,a){const s={testType:n,academicYear:a||vi.defaultAcademicYear};return(await zt.post(to.addTestTypeSuperadmin(e,t),s)).data},async removeTestTypeFromClassSuperadmin(e,t,n,a){const s=a?{academicYear:a}:{academicYear:vi.defaultAcademicYear};return(await zt.delete(to.removeTestTypeSuperadmin(e,t,n),{params:s})).data},async updateSchoolTestDetailsSuperadmin(e,t,n){const a={classTestTypes:t,academicYear:n||vi.defaultAcademicYear};return(await zt.put(to.updateSchoolTestDetailsSuperadmin(e),a)).data}},JZ=()=>{const{user:e,token:t}=yr(),[n,a]=j.useState(""),[s,i]=j.useState(""),[l,d]=j.useState(""),[u,m]=j.useState(!1),[p,f]=j.useState(!1),[g,N]=j.useState(null),[v,w]=j.useState([]),[y,E]=j.useState(!1),[O,T]=j.useState({}),[A,I]=j.useState([]),[C,P]=j.useState([]),[F,R]=j.useState(!1),$=["A","B","C","D","E","F","G","H","I","J","K","L","M"],L=j.useCallback(async U=>{if(!U){I([]);return}R(!0);try{const Q=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(!Q){ge.error("School code not available");return}console.log("Fetching test types for school code:",Q,"class:",U);const Y=await XZ.getTestDetailsBySchoolCode();if(Y.success&&Y.data?.classTestTypes){const H=Y.data.classTestTypes,te=H[U];if(te&&Array.isArray(te)){const Le=te.map(he=>he.name).filter(Boolean);I(Le),console.log("Test types loaded for class",U,":",Le)}else I([]),console.log("No test types found for class:",U);const fe=Object.keys(H);P(fe)}else I([]),console.log("No test data found for school")}catch(Q){console.error("Error fetching test types:",Q),ge.error("Failed to load test types"),I([])}finally{R(!1)}},[e?.schoolCode]);j.useEffect(()=>{n?(L(n),d("")):I([])},[n,L]);const G=j.useCallback(async()=>{f(!0),N(null);try{const U=[{id:"1",name:"John Doe",rollNumber:"001",class:n,section:s,totalMarks:null,obtainedMarks:null,grade:null},{id:"2",name:"Jane Smith",rollNumber:"002",class:n,section:s,totalMarks:null,obtainedMarks:null,grade:null}];w(U),m(!0);const Q={};U.forEach(Y=>{Q[Y.id]=!1}),T(Q)}catch(U){console.error("Error fetching students:",U),N("Failed to load students. Please try again.")}finally{f(!1)}},[n,s]),X=()=>{if(!n){ge.error("Please select a class");return}if(!s){ge.error("Please select a section");return}if(!l){ge.error("Please select a test type");return}G()},me=()=>{E(!0);const U={};v.forEach(Q=>{U[Q.id]=!1}),T(U)},se=async()=>{try{console.log("Saving all results:",v),ge.success("All results saved successfully");const U={};v.forEach(Q=>{U[Q.id]=!0}),T(U),E(!1)}catch(U){console.error("Error saving results:",U),ge.error("Failed to save results")}},ee=(U,Q,Y)=>{w(H=>H.map(te=>te.id===U?{...te,[Q]:Y}:te)),T(H=>({...H,[U]:!1}))},W=(U,Q)=>{if(!U||!Q||Q===0)return"N/A";const Y=U/Q*100;return Y>=90?"A+":Y>=80?"A":Y>=70?"B":Y>=60?"C":Y>=50?"D":"F"};return j.useEffect(()=>{w(U=>U.map(Q=>({...Q,grade:W(Q.obtainedMarks,Q.totalMarks)})))},[v.map(U=>`${U.obtainedMarks}-${U.totalMarks}`).join(",")]),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Results Entry"}),u&&r.jsx("div",{className:"flex space-x-3",children:y?r.jsxs("button",{onClick:se,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors",children:[r.jsx(rs,{className:"h-4 w-4 mr-2"}),"Save All Changes"]}):r.jsxs("button",{onClick:me,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors",children:[r.jsx(Qs,{className:"h-4 w-4 mr-2"}),"Edit All"]})})]}),r.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex flex-wrap gap-4",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"class-select",className:"text-sm font-medium text-gray-700",children:"Class"}),r.jsxs("select",{id:"class-select",value:n,onChange:U=>a(U.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",children:[r.jsx("option",{value:"",children:"Select Class"}),C.length>0?C.map(U=>r.jsx("option",{value:U,children:U},U)):r.jsxs(r.Fragment,{children:[r.jsx("option",{value:"LKG",children:"LKG"}),r.jsx("option",{value:"UKG",children:"UKG"}),r.jsx("option",{value:"1",children:"1"}),r.jsx("option",{value:"2",children:"2"}),r.jsx("option",{value:"3",children:"3"}),r.jsx("option",{value:"4",children:"4"}),r.jsx("option",{value:"5",children:"5"}),r.jsx("option",{value:"6",children:"6"}),r.jsx("option",{value:"7",children:"7"}),r.jsx("option",{value:"8",children:"8"}),r.jsx("option",{value:"9",children:"9"}),r.jsx("option",{value:"10",children:"10"}),r.jsx("option",{value:"11",children:"11"}),r.jsx("option",{value:"12",children:"12"})]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"section-select",className:"text-sm font-medium text-gray-700",children:"Section"}),r.jsxs("select",{id:"section-select",value:s,onChange:U=>i(U.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",children:[r.jsx("option",{value:"",children:"Select Section"}),$.map(U=>r.jsx("option",{value:U,children:U},U))]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"test-type-select",className:"text-sm font-medium text-gray-700",children:"Test Type"}),r.jsxs("select",{id:"test-type-select",value:l,onChange:U=>d(U.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",disabled:!n||F,children:[r.jsx("option",{value:"",children:n?F?"Loading...":"Select Test":"Select Class First"}),A.map(U=>r.jsx("option",{value:U,children:U},U))]}),!n&&r.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Select a class to see available tests"})]}),r.jsxs("button",{onClick:X,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors self-end",disabled:p,children:[p?r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r.jsx(va,{className:"h-4 w-4 mr-2"}),"Search"]})]})}),g&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsx("p",{className:"text-red-700",children:g})}),u&&r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Roll Number"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Obtained Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(U=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:U.name}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:U.rollNumber}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y?r.jsx("input",{type:"number",value:U.totalMarks||"",onChange:Q=>ee(U.id,"totalMarks",parseInt(Q.target.value)||null),className:"w-20 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Total"}):U.totalMarks||"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y?r.jsx("input",{type:"number",value:U.obtainedMarks||"",onChange:Q=>ee(U.id,"obtainedMarks",parseInt(Q.target.value)||null),className:"w-20 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Obtained"}):U.obtainedMarks||"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${U.grade==="A+"?"bg-green-100 text-green-800":U.grade==="A"?"bg-blue-100 text-blue-800":U.grade==="B"?"bg-yellow-100 text-yellow-800":U.grade==="C"?"bg-orange-100 text-orange-800":U.grade==="D"?"bg-red-100 text-red-800":U.grade==="F"?"bg-red-200 text-red-900":"bg-gray-100 text-gray-800"}`,children:U.grade||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O[U.id]?r.jsxs("span",{className:"inline-flex items-center text-green-600",children:[r.jsx(Ld,{className:"h-4 w-4 mr-1"}),"Saved"]}):y?r.jsxs("span",{className:"inline-flex items-center text-orange-600",children:[r.jsx(Ur,{className:"h-4 w-4 mr-1"}),"Unsaved"]}):r.jsx("span",{className:"text-gray-400",children:"-"})})]},U.id))})]})})})]})};async function ZZ(e){return(await zt.get("/messages",{params:e})).data}async function QZ(e){return(await zt.post("/messages/send",e)).data}async function eQ(e){return(await zt.post("/messages/preview",e)).data}async function tQ(e){return(await zt.delete(`/messages/${e}`)).data}const rQ=()=>{const{user:e}=yr(),{classesData:t,loading:n,error:a,hasClasses:s}=Ea(),{currentAcademicYear:i,viewingAcademicYear:l,isViewingHistoricalYear:d,setViewingYear:u,availableYears:m}=pn(),[p,f]=j.useState(""),[g,N]=j.useState(""),[v,w]=j.useState(""),[y,E]=j.useState(""),[O,T]=j.useState(""),[A,I]=j.useState([]),[C,P]=j.useState(0),[F,R]=j.useState("ALL"),[$,L]=j.useState("ALL"),[G,X]=j.useState([]),[me,se]=j.useState(!0),[ee,W]=j.useState(null),[U,Q]=j.useState(1),[Y,H]=j.useState(1),te=5,[fe,Le]=j.useState(!1),[he,K]=j.useState(null),[be,re]=j.useState(null),[ie,ne]=j.useState(!1),[Te,ve]=j.useState(null),[We,Ie]=j.useState(null),[je,oe]=j.useState(null),$e=t?.classes?.map(_e=>_e.className)||[],et=_e=>{if(!_e)return"N/A";try{const tt=new Date(_e);return tt.toLocaleDateString()+" "+tt.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Date"}},lt=j.useCallback(async(_e,tt,gt)=>{console.log(" [FRONTEND] fetchMessages called with:",{page:_e,currentClass:tt,currentSection:gt,viewingAcademicYear:l}),se(!0),W(null);try{const Pt={page:_e,limit:te,class:tt==="ALL"?void 0:tt,section:gt==="ALL"?void 0:gt,academicYear:l};console.log(" [FRONTEND] Fetching messages with params:",Pt);const Ot=await ZZ(Pt);console.log(" [FRONTEND] API Response:",Ot),console.log(" [FRONTEND] Messages received:",Ot.data?.messages?.length||0);let vt=Ot.data.messages||[];console.log(" [FRONTEND] All messages from API:",vt),console.log(` [FRONTEND] Received ${vt.length} messages for academic year: ${l}`),vt.forEach((nr,Yt)=>{console.log(` [FRONTEND] Message ${Yt+1}:`,{title:nr.title,class:nr.class,section:nr.section,academicYear:nr.academicYear||"NONE (treated as current year)",createdAt:nr.createdAt})}),X(vt),Q(Ot.data.pagination?.page||1),H(Ot.data.pagination?.pages||1)}catch(Pt){console.error(" [FRONTEND] Error fetching messages:",Pt),console.error(" [FRONTEND] Error response:",Pt.response),W("Failed to load sent messages."),ge.error("Failed to load sent messages.")}finally{se(!1)}},[l,i]);j.useEffect(()=>{lt(1,F,$)},[lt,F,$]),j.useEffect(()=>{if(!y||y==="ALL"){I([]),T("");return}if(t){const _e=t.classes.find(tt=>tt.className===y);if(_e){const gt=(_e.sections||[]).map(Ot=>{const vt=Ot.sectionName||Ot;return{value:vt,section:vt}});I(gt);const Pt=gt.map(Ot=>Ot.value);O&&!Pt.includes(O)&&T("")}else I([]),T("")}},[y,t]),j.useEffect(()=>{y&&O&&y!=="ALL"&&O!=="ALL"?rt(y,O):P(0)},[y,O]);const rt=async(_e,tt)=>{try{const gt=await eQ({class:_e,section:tt});P(gt.data?.estimatedRecipients||0)}catch(gt){console.error("Error previewing recipients:",gt),P(0)}},Lt=()=>{if(!p.trim()||!g.trim()||!v.trim()){K("Please fill in all fields");return}if(!y||y==="ALL"){K("Please select a specific Class to send a message");return}if(!O||O==="ALL"){K("Please select a specific Section to send a message");return}K(null),ne(!0)},kt=async()=>{try{if(Le(!0),K(null),re(null),ne(!1),!y||y==="ALL"||!O||O==="ALL")throw new Error("Please select a specific Class and Section to send a message.");const _e={class:y,section:O,title:p,subject:g,message:v,academicYear:i};console.log(" Sending message with payload:",_e),console.log(" Academic Year being sent (from school settings):",i);const tt=await QZ(_e);if(console.log(" Backend response:",tt),tt.success)re("Message sent successfully!"),f(""),N(""),w(""),E(""),T(""),P(0),lt(1,F,$),ge.success("Message sent successfully!");else throw new Error(tt.message||"Failed to send message")}catch(_e){K(_e.message||"Failed to send message"),ge.error(_e.message||"Failed to send message")}finally{Le(!1)}},Oe=async _e=>{try{ve(_e);const tt=await tQ(_e);if(tt.success)ge.success("Message deleted successfully!"),lt(U,F,$);else throw new Error(tt.message||"Failed to delete message")}catch(tt){console.error("Error deleting message:",tt),ge.error(tt.message||"Failed to delete message")}finally{ve(null),Ie(null)}},Nt=_e=>{Ie(_e)},Mt=()=>{Ie(null),ve(null)},rr=_e=>{const tt={..._e,title:_e.title||"No Title",subject:_e.subject||"No Subject",message:_e.message||"No Message Content",class:_e.class||"N/A",section:_e.section||"N/A",createdAt:_e.createdAt||"",messageAge:_e.messageAge||"Unknown",urgencyIndicator:_e.urgencyIndicator||"normal"};oe(tt)},Ft=()=>{oe(null)},cr=_e=>{_e>0&&_e<=Y&&(Q(_e),lt(_e,F,$))},or=(_e,tt)=>!_e||typeof _e!="string"?"":_e.length<=tt?_e:_e.substring(0,tt)+"...",ke=()=>{if(n)return r.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border",children:r.jsxs("div",{className:"flex items-center justify-center py-2",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),r.jsx("span",{className:"ml-2 text-gray-600",children:"Loading classes..."})]})});if(a)return r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(sa,{className:"h-5 w-5 text-red-500 mr-2"}),r.jsx("h3",{className:"text-red-800 font-medium",children:"Error Loading Classes"})]}),r.jsx("p",{className:"text-red-700 mt-1 text-sm",children:a})]});if(!s()||$e.length===0)return r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(sa,{className:"h-5 w-5 text-yellow-500 mr-2"}),r.jsx("h3",{className:"text-yellow-800 font-medium",children:"No Classes Configured"})]}),r.jsx("p",{className:"text-yellow-700 mt-1 text-sm",children:"No classes have been defined for this school. Please contact the Super Admin to add classes and sections."})]});const _e=()=>y?A.length===0?"No Sections Available":"Select Section":"Select Class First";return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"class-select",className:"block text-sm font-medium text-gray-700 mb-2",children:["Class ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"class-select",value:y,onChange:tt=>E(tt.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"Select Class"}),$e.map(tt=>r.jsxs("option",{value:tt,children:["Class ",tt]},tt))]})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"section-select",className:"block text-sm font-medium text-gray-700 mb-2",children:["Section ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"section-select",value:O,onChange:tt=>T(tt.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!y,children:[r.jsx("option",{value:"",children:_e()}),y&&A.map(tt=>r.jsxs("option",{value:tt.value,children:["Section ",tt.section]},tt.value))]})]})]}),C>0&&y&&O&&r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 flex items-center",children:[r.jsx($n,{className:"h-5 w-5 text-blue-600 mr-2"}),r.jsxs("span",{className:"text-sm text-blue-800",children:["This message will be sent to ",r.jsx("strong",{children:C})," student",C!==1?"s":""," in Class ",y," - Section ",O]})]}),C===0&&y&&O&&r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-center",children:[r.jsx(sa,{className:"h-5 w-5 text-yellow-600 mr-2"}),r.jsxs("span",{className:"text-sm text-yellow-800",children:["No students found matching Class ",r.jsx("strong",{children:y})," - Section ",r.jsx("strong",{children:O}),"."]})]})]})},ht=()=>{const _e=[{name:"ALL Classes",value:"ALL"},...$e.map(gt=>({name:`Class ${gt}`,value:gt}))];let tt=[{name:"ALL Sections",value:"ALL"}];if(F!=="ALL"&&t){const gt=t.classes.find(Pt=>Pt.className===F);if(gt){const Ot=(gt.sections||[]).map(vt=>{const nr=vt.sectionName||vt;return{name:`Section ${nr}`,value:nr}});tt=[...tt,...Ot]}}return r.jsxs("div",{className:"flex space-x-4 mb-4",children:[r.jsxs("div",{className:"w-1/3",children:[r.jsx("label",{htmlFor:"filter-academic-year",className:"block text-xs font-medium text-gray-500 mb-1",children:"Filter by Academic Year"}),r.jsx("select",{id:"filter-academic-year",value:l,onChange:gt=>u(gt.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:m.map(gt=>r.jsxs("option",{value:gt,children:[gt," ",gt===i&&"(Current)"]},`filter-year-${gt}`))})]}),r.jsxs("div",{className:"w-1/3",children:[r.jsx("label",{htmlFor:"filter-class",className:"block text-xs font-medium text-gray-500 mb-1",children:"Filter by Class"}),r.jsx("select",{id:"filter-class",value:F,onChange:gt=>{R(gt.target.value),L("ALL")},className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:_e.map(gt=>r.jsx("option",{value:gt.value,children:gt.name},`filter-class-${gt.value}`))})]}),r.jsxs("div",{className:"w-1/3",children:[r.jsx("label",{htmlFor:"filter-section",className:"block text-xs font-medium text-gray-500 mb-1",children:"Filter by Section"}),r.jsx("select",{id:"filter-section",value:$,onChange:gt=>L(gt.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:F==="ALL"&&tt.length===1,children:tt.map(gt=>r.jsx("option",{value:gt.value,children:gt.name},`filter-section-${gt.value}`))})]})]})};return r.jsxs("div",{className:"space-y-6 p-6 bg-white rounded-lg shadow",children:[r.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[r.jsx(pf,{className:"mr-3 h-8 w-8 text-blue-600"})," Messages"]}),he&&r.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[r.jsx("strong",{className:"font-bold",children:"Error!"}),r.jsxs("span",{className:"block sm:inline",children:[" ",he]})]}),be&&r.jsxs("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",role:"alert",children:[r.jsx("strong",{className:"font-bold",children:"Success!"}),r.jsxs("span",{className:"block sm:inline",children:[" ",be]})]}),r.jsxs("div",{className:"border-b pb-4 mb-4",children:[r.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Send New Message"}),r.jsx("div",{className:"mb-6",children:ke()}),r.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:["Title ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"title",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:p,onChange:_e=>f(_e.target.value),placeholder:"Enter message title",disabled:!s()||$e.length===0})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700",children:["Subject ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"subject",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:g,onChange:_e=>N(_e.target.value),placeholder:"Enter message subject",disabled:!s()||$e.length===0})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700",children:["Message Body ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("textarea",{id:"message",rows:5,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:v,onChange:_e=>w(_e.target.value),placeholder:"Type your message here...",disabled:!s()||$e.length===0})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsxs("button",{onClick:Lt,disabled:!s()||$e.length===0||!p||!v||!y||!O,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(wn,{className:"h-5 w-5 mr-2"})," Preview"]}),r.jsx("button",{onClick:kt,disabled:fe||!s()||$e.length===0||!p||!v||!y||!O,className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ${fe||!s()||$e.length===0||!p||!v||!y||!O?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors`,children:fe?"Sending...":r.jsxs(r.Fragment,{children:[r.jsx(U4,{className:"h-5 w-5 mr-2"}),"Send Message"]})})]})]}),ie&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 overflow-y-auto h-full w-full z-50 flex justify-center items-center",children:r.jsxs("div",{className:"relative p-8 border w-full max-w-md md:max-w-lg lg:max-w-xl shadow-lg rounded-md bg-white",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Message Preview"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Title:"}),r.jsx("p",{className:"text-gray-900 font-semibold",children:p})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Subject:"}),r.jsx("p",{className:"text-gray-900 font-semibold",children:g})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Message Body:"}),r.jsx("p",{className:"text-gray-800 whitespace-pre-wrap",children:v})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Target Audience:"}),r.jsxs("p",{className:"text-gray-800",children:["Class ",y," - Section ",O,C>0&&r.jsxs("span",{className:"text-blue-600 font-semibold",children:[" (",C," students)"]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:()=>ne(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:kt,disabled:fe,className:`px-4 py-2 text-white rounded-md ${fe?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} transition-colors`,children:fe?"Sending...":"Confirm & Send"})]})]})}),r.jsx("hr",{className:"my-6"}),r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-4 flex items-center",children:[r.jsx(q6,{className:"h-6 w-6 mr-2 text-blue-600"})," Sent Messages"]}),ht(),ee&&r.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[r.jsx("strong",{className:"font-bold",children:"Error!"}),r.jsxs("span",{className:"block sm:inline",children:[" ",ee]}),r.jsx("button",{onClick:()=>lt(U,F,$),className:"ml-4 text-sm font-semibold underline",children:"Retry"})]}),me?r.jsxs("div",{className:"flex justify-center items-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),r.jsx("span",{className:"ml-3 text-gray-600",children:"Loading messages..."})]}):G.length===0?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No sent messages found matching the selected filters."}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto shadow-sm border border-gray-200 rounded-lg",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title & Subject"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class & Section"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sent"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Message"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Age"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:G.map(_e=>{const tt=_e.title||"",gt=_e.subject||"",Pt=_e.message||"",Ot=_e.class||"",vt=_e.section||"",nr=_e.createdAt||"",Yt=_e.messageAge||"",Or=_e.urgencyIndicator||"normal";tt.length,gt.length;const Sr=Pt.length;return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:or(tt,20)}),r.jsx("div",{className:"text-xs text-gray-500",children:or(gt,20)})]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[r.jsxs("div",{className:"font-semibold text-gray-700",children:["Class ",Ot]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Section ",vt]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[r.jsx(bs,{className:"h-3 w-3 mr-1"})," ",et(nr)]})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-700 max-w-xs truncate",children:or(Pt,20)}),Sr>30&&r.jsxs("button",{onClick:()=>rr(_e),className:"mt-1 text-blue-600 hover:text-blue-800 text-xs flex items-center gap-1",title:"View full message",children:[r.jsx(H6,{className:"h-3 w-3"}),"View full"]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Or==="urgent"?"bg-red-100 text-red-800":Or==="high"?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"}`,children:Yt})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>rr(_e),className:"text-blue-600 hover:text-blue-900 transition-colors p-1 rounded hover:bg-blue-50",title:"Preview message",children:r.jsx(wn,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>Nt(_e),disabled:Te===_e.id,className:"text-red-600 hover:text-red-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors p-1 rounded hover:bg-red-50",title:"Delete message",children:Te===_e.id?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):r.jsx(Ba,{className:"h-4 w-4"})})]})})]},_e.id)})})]})}),Y>1&&r.jsxs("div",{className:"flex justify-between items-center mt-4",children:[r.jsx("button",{onClick:()=>cr(U-1),disabled:U===1,className:"px-4 py-2 border rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),r.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",U," of ",Y]}),r.jsx("button",{onClick:()=>cr(U+1),disabled:U===Y,className:"px-4 py-2 border rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),We&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 overflow-y-auto h-full w-full z-50 flex justify-center items-center",children:r.jsxs("div",{className:"relative p-6 border w-full max-w-md shadow-lg rounded-md bg-white mx-4",children:[r.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-4 rounded",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(sa,{className:"h-5 w-5 text-red-400 mr-2"}),r.jsx("h3",{className:"text-lg font-bold text-red-800",children:"Confirm Delete"})]})}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm text-gray-700",children:"Are you sure you want to delete this message?"}),r.jsxs("div",{className:"mt-2 p-3 bg-red-50 rounded-md border border-red-200",children:[r.jsx("p",{className:"font-semibold text-gray-900 break-words",children:We.title}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Class ",We.class," - Section ",We.section]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1 break-words",children:We.message})]}),r.jsx("p",{className:"text-xs text-red-600 mt-2",children:"This action cannot be undone."})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:Mt,disabled:Te===We.id,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors disabled:opacity-50",children:"Cancel"}),r.jsx("button",{onClick:()=>Oe(We.id),disabled:Te===We.id,className:`px-4 py-2 text-white rounded-md ${Te===We.id?"bg-red-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"} transition-colors`,children:Te===We.id?"Deleting...":"Delete"})]})]})}),je&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 overflow-y-auto h-full w-full z-50 flex justify-center items-center",children:r.jsxs("div",{className:"relative p-8 border w-full max-w-2xl shadow-lg rounded-md bg-white mx-4",children:[r.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 mb-4 rounded",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(wn,{className:"h-5 w-5 text-green-400 mr-2"}),r.jsx("h3",{className:"text-xl font-bold text-green-800",children:"Message Details"})]})}),r.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Title:"}),r.jsx("p",{className:"text-gray-900 font-semibold break-words",children:je.title})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Subject:"}),r.jsx("p",{className:"text-gray-900 font-semibold break-words",children:je.subject})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Class & Section:"}),r.jsxs("p",{className:"text-gray-800",children:["Class ",je.class," - Section ",je.section]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Sent:"}),r.jsx("p",{className:"text-gray-800",children:et(je.createdAt)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Message Body:"}),r.jsx("div",{className:"mt-1 p-3 bg-green-50 rounded-md border border-green-200",children:r.jsx("p",{className:"text-gray-800 whitespace-pre-wrap break-words",children:je.message})})]})]}),r.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:r.jsx("button",{onClick:Ft,className:"px-4 py-2 bg-green-100 text-green-800 border border-green-300 rounded-md hover:bg-green-200 transition-colors",children:"Close"})})]})})]})},bj=({schoolCode:e,valueClass:t,valueSection:n,onClassChange:a,onSectionChange:s,includeAllOptions:i=!0,disabled:l=!1,showSection:d=!0})=>{const{user:u}=yr(),[m,p]=j.useState(!1),[f,g]=j.useState(!1),[N,v]=j.useState([]),[w,y]=j.useState(!1),[E,O]=j.useState(null),T=e||u?.schoolCode,A=async()=>{if(!T){O("No school code available");return}try{y(!0),O(null),console.log(" Fetching classes for school code:",T);const R=await AR.getSchoolClasses(T);console.log(" Classes API Response:",R);let $=[];if(R?.data?.success&&R.data?.data){const L=R.data.data;L.classes&&Array.isArray(L.classes)?$=L.classes:Array.isArray(L)&&($=L)}else if(R?.data?.success&&R.data?.classes)$=R.data.classes;else if(R?.success&&R?.data){const L=R.data;L.classes&&Array.isArray(L.classes)?$=L.classes:Array.isArray(L)&&($=L)}else R?.success&&R?.classes?$=R.classes:R?.data?.classes&&Array.isArray(R.data.classes)?$=R.data.classes:Array.isArray(R?.data)?$=R.data:Array.isArray(R)&&($=R);if(console.log(" Processed payload:",$),$&&Array.isArray($)&&$.length>0){v($);const L=$.map(G=>G.className);t!=="ALL"&&!L.includes(t)&&(a("ALL"),s("ALL"))}else console.warn(" No classes found in response"),v([])}catch(R){console.error("Error fetching classes:",R),O("Failed to load classes and sections"),v([])}finally{y(!1)}};j.useEffect(()=>{A()},[T]);const I=R=>{if(a(R),R==="ALL")s("ALL");else{const $=N.find(L=>L.className===R);if($){const L=$.sections.map(G=>G.sectionName);n!=="ALL"&&!L.includes(n)&&s("ALL")}else s("ALL")}p(!1)},C=R=>{s(R),g(!1)},P=()=>{if(t==="ALL")return[{sectionId:"ALL",sectionName:"ALL"}];const R=N.find($=>$.className===t);return R?R.sections:[]},F=()=>{if(n==="ALL")return"All Sections";const R=P().find($=>$.sectionName===n);return R?`Section ${R.sectionName}`:"Select Section"};return w?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.jsxs("div",{className:"flex items-center justify-center py-4",children:[r.jsx(xf,{className:"h-5 w-5 animate-spin text-blue-600 mr-2"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Loading classes..."})]})}):E?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.jsxs("div",{className:"col-span-2 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded flex items-center",children:[r.jsx(sa,{className:"h-5 w-5 mr-2"}),r.jsx("span",{className:"text-sm",children:E}),r.jsx("button",{onClick:A,className:"ml-auto text-red-600 hover:text-red-800 underline text-sm",children:"Retry"})]})}):N.length===0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.jsxs("div",{className:"col-span-2 bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded flex items-center",children:[r.jsx(sa,{className:"h-5 w-5 mr-2"}),r.jsx("span",{className:"text-sm",children:"No classes defined for this school. Ask Super Admin to add classes/sections."}),r.jsx("button",{onClick:A,className:"ml-auto text-yellow-600 hover:text-yellow-800 underline text-sm",children:"Refresh"})]})},"no-data-state"):r.jsxs("div",{className:`grid grid-cols-1 ${d?"md:grid-cols-2":"md:grid-cols-1"} gap-4`,children:[r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{type:"button",onClick:()=>p(!m),disabled:l,className:"relative w-full bg-white border border-gray-300 rounded-md shadow-sm pl-3 pr-10 py-2 text-left cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[r.jsx("span",{className:"block truncate",children:t==="ALL"?"All Classes":`Class ${t}`}),r.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:r.jsx(Gs,{className:"h-5 w-5 text-gray-400"})})]}),m&&r.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none",children:[i&&r.jsx("div",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-blue-50",onClick:()=>I("ALL"),children:r.jsx("span",{className:"font-normal block truncate",children:"All Classes"})},"all-classes"),N.map(R=>r.jsxs("div",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-blue-50",onClick:()=>I(R.className),children:[r.jsxs("span",{className:"font-normal block truncate",children:["Class ",R.className]}),r.jsxs("span",{className:"text-xs text-gray-500 block",children:[R.sections.length," section",R.sections.length!==1?"s":""]})]},`class-${R.className||R._id}`))]},"class-dropdown")]})]},"class-selector"),d?r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{type:"button",onClick:()=>g(!f),disabled:l||t==="ALL",className:"relative w-full bg-white border border-gray-300 rounded-md shadow-sm pl-3 pr-10 py-2 text-left cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[r.jsx("span",{className:"block truncate",children:F()}),r.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:r.jsx(Gs,{className:"h-5 w-5 text-gray-400"})})]}),f&&r.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none",children:[i&&r.jsx("div",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-blue-50",onClick:()=>C("ALL"),children:r.jsx("span",{className:"font-normal block truncate",children:"All Sections"})},"all-sections"),P().filter(R=>R.sectionId!=="ALL").map(R=>r.jsx("div",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-blue-50",onClick:()=>C(R.sectionName),children:r.jsxs("span",{className:"font-normal block truncate",children:["Section ",R.sectionName]})},`section-${R.sectionId}`))]},"section-dropdown")]})]},"section-selector"):null]},"class-section-select")},nQ=()=>{const{user:e}=yr(),{currentAcademicYear:t,availableYears:n,loading:a}=pn(),[s,i]=j.useState("ALL"),[l,d]=j.useState("ALL"),[u,m]=j.useState(""),[p,f]=j.useState(""),[g,N]=j.useState(""),[v,w]=j.useState(t||"2024-25"),[y,E]=j.useState([{name:"",amount:0,dueDate:"",description:""}]),[O,T]=j.useState(1),[A,I]=j.useState(!0),[C,P]=j.useState(!1),[F,R]=j.useState([]),[$,L]=j.useState(!1),[G,X]=j.useState(null),[me,se]=j.useState(null),[ee,W]=j.useState(null),[U,Q]=j.useState({isOpen:!1,id:"",name:""});console.log("FeeStructureTab render"),xe.useEffect(()=>{t&&w(t)},[t]),xe.useEffect(()=>{(async()=>{try{const ie=await Ws.getFeeStructures({class:s,section:l});ie.data?.success?R(ie.data.data||[]):Array.isArray(ie)?R(ie||[]):R([])}catch{R([])}})()},[s,l]);const Y=re=>{y.length>1&&E(y.filter((ie,ne)=>ne!==re))},H=(re,ie,ne)=>{const Te=[...y];Te[re]={...Te[re],[ie]:ne},E(Te)},te=y.reduce((re,ie)=>re+(ie.amount||0),0),fe=()=>{const re=Number(g||0),ie=Math.max(1,Math.min(12,Number(O)||1));if(!re||re<=0)return;if(A&&ie>1){if(re<100*(ie-1)){X(`Total amount must be at least ${100*(ie-1)} to split ${ie} installments with first ${ie-1} multiples of 100.`);return}const Ie=Math.floor(re/ie/100)*100,je=Array.from({length:ie-1}).map(()=>({name:"",amount:Ie,dueDate:"",description:""})),oe=Ie*(ie-1),$e=re-oe,et=[...je,{name:"",amount:$e,dueDate:"",description:""}].map((lt,rt)=>({...lt,name:`Installment ${rt+1}`}));E(et);return}const ne=Math.floor(re/ie),Te=re-ne*ie,ve=Array.from({length:ie}).map((We,Ie)=>({name:`Installment ${Ie+1}`,amount:Ie<Te?ne+1:ne,dueDate:"",description:""}));E(ve)},Le=async()=>{if(X(null),se(null),!u||!g||y.some(ie=>!ie.name||!ie.amount||!ie.dueDate)){X("Please fill all required fields");return}if(te!==Number(g)){X("Sum of installment amounts must match total amount");return}const re=F.find(ie=>ie.class===s&&ie.academicYear===v);if(re){X(`A fee structure "${re.name}" already exists for class ${s} in academic year ${v}. Please delete it first or choose a different class.`);return}try{L(!0);const ie={name:u,description:p,class:s,section:l,totalAmount:Number(g),installments:y.map(ve=>({name:ve.name,amount:Number(ve.amount||0),dueDate:ve.dueDate,description:ve.description})),academicYear:v,applyToStudents:C},Te=(await Ws.createFeeStructure(ie)).data?.data?.appliedToStudents;se(Te!==void 0?`Fee structure saved successfully. Applied to ${Te} students.`:"Fee structure saved successfully.");try{const ve=await Ws.getFeeStructures({});ve.data?.success&&R(ve.data.data||[])}catch{}m(""),f(""),N(""),i("ALL"),d("ALL"),E([{name:"",amount:0,dueDate:"",description:""}]),P(!1)}catch(ie){X(ie?.response?.data?.message||"Failed to save fee structure")}finally{L(!1)}},he=(re,ie)=>{Q({isOpen:!0,id:re,name:ie})},K=()=>{Q({isOpen:!1,id:"",name:""})},be=async()=>{const{id:re,name:ie}=U;try{W(re),X(null),se(null),K();const Te=(await Ws.deleteFeeStructure(re)).data?.deletedStudentRecords||0;se(Te>0?`Fee structure deleted successfully. Removed from ${Te} student(s).`:"Fee structure deleted successfully.");const ve=await Ws.getFeeStructures({class:s,section:l});ve.data?.success?R(ve.data.data||[]):Array.isArray(ve)?R(ve||[]):R([])}catch(ne){X(ne?.response?.data?.message||"Failed to delete fee structure")}finally{W(null)}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Create Fee Structure"}),G&&r.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded flex items-center",children:[r.jsx(sa,{className:"h-5 w-5 mr-2"}),G]}),me&&r.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded",children:me}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fee Structure Name *"}),r.jsx("input",{type:"text",value:u,onChange:re=>m(re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Annual Fee 2024-25"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),r.jsx("textarea",{value:p,onChange:re=>f(re.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional description"})]}),r.jsx(bj,{schoolCode:e?.schoolCode,valueClass:s,valueSection:l,onClassChange:i,onSectionChange:d,showSection:!1}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year *"}),r.jsx("select",{value:v,onChange:re=>w(re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",disabled:a,children:n.map(re=>r.jsxs("option",{value:re,children:[re," ",re===t&&"(Current)"]},re))})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Amount *"}),r.jsx("input",{type:"number",value:g,onChange:re=>N(re.target.value),inputMode:"numeric",pattern:"[0-9]*",onKeyDown:re=>{["Backspace","Delete","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab","Home","End"].includes(re.key)||(re.ctrlKey||re.metaKey)&&["a","c","v","x"].includes(re.key.toLowerCase())||/^[0-9]$/.test(re.key)||re.preventDefault()},onPaste:re=>{const ne=(re.clipboardData||window.clipboardData).getData("text").replace(/\D+/g,"");re.preventDefault(),N(Te=>(window.getSelection?.(),ne))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter total amount"})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-md",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("h3",{className:"font-medium text-gray-900",children:"Installments"}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("input",{type:"number",min:1,max:12,value:O,onChange:re=>T(Number(re.target.value)),className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"}),r.jsx("button",{type:"button",onClick:fe,className:"flex items-center px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"Generate"})]})]}),r.jsx("div",{className:"space-y-3",children:y.map((re,ie)=>r.jsxs("div",{className:"bg-white p-3 rounded border",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Installment ",ie+1]}),y.length>1&&r.jsx("button",{type:"button",onClick:()=>Y(ie),className:"text-red-600 hover:text-red-800",children:r.jsx(Ba,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("input",{type:"text",placeholder:"Name",value:re.name,onChange:ne=>H(ie,"name",ne.target.value),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"}),r.jsx("input",{type:"number",placeholder:"Amount",value:re.amount||"",onChange:ne=>H(ie,"amount",Number(ne.target.value)),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"}),r.jsx("input",{type:"date",value:re.dueDate,onChange:ne=>H(ie,"dueDate",ne.target.value),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"}),r.jsx("input",{type:"text",placeholder:"Description",value:re.description,onChange:ne=>H(ie,"description",ne.target.value),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]},ie))}),r.jsxs("div",{className:"mt-3 p-2 bg-blue-50 rounded",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"font-medium",children:"Calculated Total:"}),r.jsxs("span",{className:"font-bold",children:["",te.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"font-medium",children:"Expected Total:"}),r.jsxs("span",{className:"font-bold",children:["",g?Number(g).toLocaleString():"0"]})]})]})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"applyToStudents",checked:C,onChange:re=>P(re.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"applyToStudents",className:"ml-2 block text-sm text-gray-900",children:"Apply this fee structure to all students in the selected class"})]}),r.jsx("button",{onClick:Le,disabled:$,className:`w-full flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ${$?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,children:$?"Saving...":r.jsxs(r.Fragment,{children:[r.jsx(rs,{className:"h-4 w-4 mr-2"}),"Save Fee Structure"]})})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Existing Fee Structures"}),F.length===0?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No fee structures found."}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Installments"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Applied"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Year"}),r.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(re=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:re.name}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:re.class}),r.jsxs("td",{className:"px-4 py-2 text-sm text-gray-900",children:["",(re.totalAmount||0).toLocaleString()]}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:re.installmentsCount}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:re.appliedToStudents||0}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:re.academicYear}),r.jsx("td",{className:"px-4 py-2 text-sm text-right",children:r.jsxs("button",{onClick:()=>he(re.id,re.name),disabled:ee===re.id,className:`text-red-600 hover:text-red-900 inline-flex items-center ${ee===re.id?"opacity-50 cursor-not-allowed":""}`,title:"Delete fee structure",children:[r.jsx(Ba,{className:"h-4 w-4 mr-1"}),ee===re.id?"Deleting...":"Delete"]})})]},re.id))})]})})]}),U.isOpen&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:r.jsx(sa,{className:"h-6 w-6 text-red-600"})}),r.jsx("div",{className:"ml-4",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Fee Structure"})})]}),r.jsx("div",{className:"mb-6",children:r.jsxs("p",{className:"text-sm text-gray-600",children:["Are you sure you want to delete the fee structure"," ",r.jsxs("span",{className:"font-semibold text-gray-900",children:['"',U.name,'"']}),"?"]})}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:K,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),r.jsx("button",{onClick:be,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete"})]})]})})]})},aQ=({schoolData:e,studentData:t,paymentData:n,installments:a,totalAmount:s,totalPaid:i,totalRemaining:l})=>{const d=f=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(f),u=f=>{if(!f)return"-";try{const g=new Date(f);if(isNaN(g.getTime()))return"-";const N=g.toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"}),v=g.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0});return`${N} at ${v}`}catch(g){return console.error("DateTime formatting error:",g),"-"}},m=()=>{const f=p(),g=window.open("","_blank");g&&(g.document.write(f),g.document.close(),setTimeout(()=>{g.focus(),g.print()},500))},p=()=>`
      <!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Payment Receipt - ${n.receiptNumber}</title>
    <style>
        /* Base styles matching the component's 'print' mode and image aesthetics */
        @page {
            size: A4 landscape;
            margin: 8mm;
        }
        body {
            font-family: Arial, sans-serif; /* Changed font to match reference */
            font-size: 10px; /* Base font size */
            margin: 0;
            padding: 0;
            background: white;
            color: #000; /* Primary text color */
        }
        .receipt-container {
            display: flex;
            flex-direction: row;
            gap: 16px; /* Space between the two copies - matched reference */
            width: 100%;
            min-height: 200mm; /* A bit less than A4 height for safety */
            box-sizing: border-box;
            padding: 10mm; /* Padding around the container, adjusting for margin */
        }
        .receipt-copy {
            flex: 1;
            border: 1px solid #d1d5db; /* Light grey border - matched reference */
            padding: 12px; /* Increased internal padding - matched reference */
            display: flex;
            flex-direction: column;
            border-radius: 0; /* Removing border-radius for cleaner print look */
        }

        /* --- Header Section (Refactored to match Invoice structure) --- */

        .copy-type-section {
            text-align: center;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid #9ca3af; /* Darker border for section break */
        }
        .copy-header-title {
            font-size: 12px;
            font-weight: bold;
            color: #1f2937;
            margin: 0;
        }
        
        /* School Info (Refactored to match Invoice logo/address section) */
        .school-logo-section {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #d1d5db;
        }
        .school-logo-placeholder { /* For dynamic logo or simple text */
            width: 32px;
            height: 32px;
            background: #c53030; /* Example red for placeholder/accent */
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .school-logo-placeholder > div {
            width: 16px;
            height: 16px;
            border: 1px solid white;
            border-radius: 2px;
            transform: rotate(45deg);
        }
        .school-logo-actual {
            max-width: 40px; 
            max-height: 40px; 
            object-fit: contain;
        }

        .school-name-title {
            font-size: 14px; /* Slightly larger for prominence */
            font-weight: 900; /* Ultra bold */
            color: #000; /* Dark black */
            margin: 0;
        }
        .school-address {
            font-size: 8px;
            color: #4b5563;
            margin: 1px 0;
        }
        
        /* Document Title (RECEIPT) */
        .doc-title-section {
            text-align: center;
            margin-bottom: 24px; /* Increased space before details */
        }
        .doc-title {
            font-size: 14px;
            font-weight: bold;
            color: #2563eb; /* Blue color for RECEIPT/INVOICE */
            margin: 0;
        }
        .receipt-number {
            font-size: 10px;
            color: #4b5563;
            margin-top: 2px;
        }

        /* --- Details Section (Matching Invoice Details Grid) --- */
        
        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 32px;
            font-size: 10px;
            color: #374151;
        }
        .details-box-title {
            font-size: 12px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 8px;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 4px;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
            font-size: 10px;
        }
        .info-label {
            color: #6b7280;
            font-weight: normal;
        }
        .info-value {
            color: #1f2937;
            font-weight: 600;
        }

        /* --- Table Section (Matching Invoice Table) --- */
        
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 32px;
            font-size: 10px;
        }
        .items-table th, .items-table td {
            padding: 8px 12px; /* Adjusted padding for better fit */
            border: 1px solid #d1d5db;
            text-align: left;
        }
        .items-table th {
            background-color: #f3f4f6; /* Light grey header background */
            font-weight: 600;
        }
        .text-center { text-align: center !important; }
        .text-right { text-align: right !important; }
        .text-green { color: #047857; font-weight: 600; }
        .text-red { color: #dc2626; font-weight: 600; }

        /* --- Totals/Payment Section (Matching Invoice Totals) --- */

        .totals-section-container {
            display: flex;
            justify-content: flex-end;
        }
        .totals-box {
            width: 256px; /* Matched width from reference */
        }
        .total-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #d1d5db;
        }
        .current-payment-row { 
            padding: 12px 0;
            font-weight: bold;
            font-size: 18px;
            border-bottom: 2px solid #1f2937;
            color: #1d4ed8;
        }
        .current-payment-label {
            font-size: 14px;
            color: #4b5563;
        }
        .current-payment-amount {
            font-weight: bold;
        }

        /* --- Footer (Matching Invoice Footer) --- */

        .receipt-footer {
            margin-top: auto;
            padding-top: 32px;
            border-top: 1px solid #d1d5db;
            text-align: center;
            font-size: 10px; /* Slightly larger footer text */
            color: #4b5563;
        }
        .footer-line {
            margin: 2px 0;
        }
        .footer-bold {
            font-weight: 600;
            color: #1f2937;
        }
        .footer-blue {
            color: #2563eb;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="receipt-container">
        <div class="receipt-copy">
            
            <div class="copy-type-section">
                <h3 class="copy-header-title">ADMIN COPY</h3>
            </div>
            
            <div class="school-logo-section">
                ${e.hasSchoolLogo&&e.schoolLogo?`<img src="${e.schoolLogo}" alt="${e.schoolName} Logo" class="school-logo-actual" />`:'<div class="school-logo-placeholder"><div></div></div>'}
                <div>
                    <h1 class="school-name-title">${e.schoolName}</h1>
                    <p class="school-address">${e.address}</p>
                </div>
                <div style="flex-grow: 1; text-align: right;"></div>
            </div>

            <div class="doc-title-section">
                <h2 class="doc-title">PAYMENT RECEIPT</h2>
                <p class="receipt-number">#${n.receiptNumber}</p>
            </div>

            <div class="details-grid">
                <div>
                    <h3 class="details-box-title">PAID BY:</h3>
                    <div class="info-row">
                        <span class="info-label">Student Name:</span>
                        <span class="info-value">${t.name}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Student ID:</span>
                        <span class="info-value">${t.userId||t.studentId}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Class & Section:</span>
                        <span class="info-value">${t.class}-${t.section}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Academic Year:</span>
                        <span class="info-value">${t.academicYear}</span>
                    </div>
                </div>
                
                <div>
                    <h3 class="details-box-title" style="text-align: right;">PAYMENT INFO:</h3>
                    <div class="info-row" style="justify-content: flex-end;">
                        <span class="info-label" style="margin-right: 8px;">Payment Date:</span>
                        <span class="info-value">${u(n.paymentDate)}</span>
                    </div>
                    <div class="info-row" style="justify-content: flex-end;">
                        <span class="info-label" style="margin-right: 8px;">Payment Method:</span>
                        <span class="info-value">${n.paymentMethod}</span>
                    </div>
                    <div class="info-row" style="justify-content: flex-end;">
                        <span class="info-label" style="margin-right: 8px;">Reference:</span>
                        <span class="info-value">${n.paymentReference||"-"}</span>
                    </div>
                    <div class="info-row" style="justify-content: flex-end;">
                        <span class="info-label" style="margin-right: 8px;">Installment Paid:</span>
                        <span class="info-value">${n.installmentName}</span>
                    </div>
                </div>
            </div>
            
            <h3 class="details-box-title" style="margin-bottom: 8px;">FEE & INSTALLMENT DETAILS</h3>

            <table class="items-table">
                <thead>
                    <tr>
                        <th style="width: 50%;">Installment / Fee Head</th>
                        <th style="width: 25%;" class="text-right">Amount Due</th>
                        <th style="width: 25%;" class="text-right">Paid to Date</th>
                    </tr>
                </thead>
                <tbody>
                    ${a.map(f=>`
                        <tr>
                            <td>${f.isCurrent?f.name+" (Current Payment)":f.name}</td>
                            <td class="text-right">${d(f.amount)}</td>
                            <td class="text-right text-green">${d(f.paid)}</td>
                        </tr>
                    `).join("")}
                    <tr style="background: #f9fafb; font-weight: 600;">
                        <td>Overall Total</td>
                        <td class="text-right">${d(s)}</td>
                        <td class="text-right text-green">${d(i)}</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="receipt-footer">
                <div class="footer-line footer-bold">Thank you for your payment!</div>
                <div class="footer-line">Powered by <span class="footer-blue">EduLogix</span></div>
                <div class="footer-line">This is a computer generated receipt.</div>
            </div>
        </div>

        <div class="receipt-copy">
            
            <div class="copy-type-section">
                <h3 class="copy-header-title">STUDENT COPY</h3>
            </div>
            
            <div class="school-logo-section">
                ${e.hasSchoolLogo&&e.schoolLogo?`<img src="${e.schoolLogo}" alt="${e.schoolName} Logo" class="school-logo-actual" />`:'<div class="school-logo-placeholder"><div></div></div>'}
                <div>
                    <h1 class="school-name-title">${e.schoolName}</h1>
                    <p class="school-address">${e.address}</p>
                </div>
                <div style="flex-grow: 1; text-align: right;"></div>
            </div>

            <div class="doc-title-section">
                <h2 class="doc-title">PAYMENT RECEIPT</h2>
                <p class="receipt-number">#${n.receiptNumber}</p>
            </div>

            <div class="details-grid">
                <div>
                    <h3 class="details-box-title">PAID BY:</h3>
                    <div class="info-row">
                        <span class="info-label">Student Name:</span>
                        <span class="info-value">${t.name}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Student ID:</span>
                        <span class="info-value">${t.userId||t.studentId}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Class & Section:</span>
                        <span class="info-value">${t.class}-${t.section}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Academic Year:</span>
                        <span class="info-value">${t.academicYear}</span>
                    </div>
                </div>
                
                <div>
                    <h3 class="details-box-title" style="text-align: right;">PAYMENT INFO:</h3>
                    <div class="info-row" style="justify-content: flex-end;">
                        <span class="info-label" style="margin-right: 8px;">Payment Date:</span>
                        <span class="info-value">${u(n.paymentDate)}</span>
                    </div>
                    <div class="info-row" style="justify-content: flex-end;">
                        <span class="info-label" style="margin-right: 8px;">Payment Method:</span>
                        <span class="info-value">${n.paymentMethod}</span>
                    </div>
                    <div class="info-row" style="justify-content: flex-end;">
                        <span class="info-label" style="margin-right: 8px;">Reference:</span>
                        <span class="info-value">${n.paymentReference||"-"}</span>
                    </div>
                    <div class="info-row" style="justify-content: flex-end;">
                        <span class="info-label" style="margin-right: 8px;">Installment Paid:</span>
                        <span class="info-value">${n.installmentName}</span>
                    </div>
                </div>
            </div>
            
            <h3 class="details-box-title" style="margin-bottom: 8px;">FEE & INSTALLMENT DETAILS</h3>

            <table class="items-table">
                <thead>
                    <tr>
                        <th style="width: 50%;">Installment / Fee Head</th>
                        <th style="width: 25%;" class="text-right">Amount Due</th>
                        <th style="width: 25%;" class="text-right">Paid to Date</th>
                    </tr>
                </thead>
                <tbody>
                    ${a.map(f=>`
                        <tr>
                            <td>${f.isCurrent?f.name+" (Current Payment)":f.name}</td>
                            <td class="text-right">${d(f.amount)}</td>
                            <td class="text-right text-green">${d(f.paid)}</td>
                        </tr>
                    `).join("")}
                    <tr style="background: #f9fafb; font-weight: 600;">
                        <td>Overall Total</td>
                        <td class="text-right">${d(s)}</td>
                        <td class="text-right text-green">${d(i)}</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="receipt-footer">
                <div class="footer-line footer-bold">Thank you for your payment!</div>
                <div class="footer-line">Powered by <span class="footer-blue">EduLogix</span></div>
                <div class="footer-line">This is a computer generated receipt.</div>
            </div>
        </div>
    </div>
</body>
</html>
    `;return r.jsxs("div",{className:"max-w-7xl mx-auto bg-white",children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:`
          @media print {
            @page {
              size: A4 landscape;
              margin: 8mm;
            }
            * {
              -webkit-print-color-adjust: exact !important;
              color-adjust: exact !important;
              print-color-adjust: exact !important;
            }
            body {
              margin: 0 !important;
              padding: 0 !important;
              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
            }
            .print-hidden {
              display: none !important;
            }
            .receipt-container {
              display: flex !important;
              gap: 8mm !important;
              width: 100% !important;
              height: 100vh !important;
              margin: 0 !important;
              padding: 0 !important;
            }
            .receipt-copy {
              flex: 1 !important;
              border: 1px solid #d1d5db !important;
              border-radius: 4px !important;
              overflow: hidden !important;
              display: flex !important;
              flex-direction: column !important;
              page-break-inside: avoid !important;
            }
            .receipt-header {
              background: #f9fafb !important;
              padding: 6px 8px !important;
              border-bottom: 1px solid #d1d5db !important;
              text-align: center !important;
            }
            .receipt-title {
              font-size: 12px !important;
              font-weight: 700 !important;
              color: #111827 !important;
              margin-bottom: 2px !important;
            }
            .school-info {
              font-size: 10px !important;
              color: #6b7280 !important;
              margin-bottom: 3px !important;
            }
            .copy-badge {
              background: #3b82f6 !important;
              color: white !important;
              padding: 2px 6px !important;
              border-radius: 3px !important;
              font-size: 8px !important;
              font-weight: 600 !important;
              display: inline-block !important;
              margin-top: 2px !important;
            }
            .receipt-number {
              background: #dbeafe !important;
              color: #1e40af !important;
              padding: 3px 8px !important;
              border-radius: 3px !important;
              font-size: 9px !important;
              font-weight: 600 !important;
              display: inline-block !important;
              margin-top: 3px !important;
            }
            .receipt-content {
              flex: 1 !important;
              padding: 6px 8px !important;
              display: flex !important;
              flex-direction: column !important;
            }
            .student-info, .payment-info {
              background: #f9fafb !important;
              padding: 6px !important;
              border-radius: 3px !important;
              margin-bottom: 6px !important;
              border: 1px solid #e5e7eb !important;
            }
            .info-row {
              display: flex !important;
              justify-content: space-between !important;
              margin-bottom: 2px !important;
              font-size: 9px !important;
            }
            .info-label {
              color: #6b7280 !important;
              font-weight: 500 !important;
            }
            .info-value {
              color: #111827 !important;
              font-weight: 600 !important;
            }
            .installment-table {
              width: 100% !important;
              border-collapse: collapse !important;
              margin: 6px 0 !important;
              font-size: 9px !important;
            }
            .installment-table th {
              background: #f3f4f6 !important;
              padding: 4px 6px !important;
              border: 1px solid #d1d5db !important;
              font-weight: 600 !important;
              text-align: left !important;
            }
            .installment-table td {
              padding: 4px 6px !important;
              border: 1px solid #d1d5db !important;
            }
            .installment-table .text-right {
              text-align: right !important;
            }
            .current-payment {
              background: #dbeafe !important;
              padding: 8px !important;
              border-radius: 4px !important;
              text-align: center !important;
              margin: 6px 0 !important;
            }
            .current-payment-label {
              font-size: 9px !important;
              color: #6b7280 !important;
              margin-bottom: 2px !important;
            }
            .current-payment-amount {
              font-size: 14px !important;
              font-weight: 700 !important;
              color: #1d4ed8 !important;
            }
            .receipt-footer {
              background: #f9fafb !important;
              padding: 6px 8px !important;
              border-top: 1px solid #d1d5db !important;
              text-align: center !important;
              font-size: 8px !important;
              color: #6b7280 !important;
              margin-top: auto !important;
            }
            .footer-line {
              margin-bottom: 1px !important;
            }
            .footer-bold {
              font-weight: 600 !important;
            }
            .footer-blue {
              color: #2563eb !important;
              font-weight: 600 !important;
            }
            .text-green {
              color: #047857 !important;
              font-weight: 600 !important;
            }
            .text-red {
              color: #dc2626 !important;
              font-weight: 600 !important;
            }
          }
        `}}),r.jsx("div",{className:"flex justify-end gap-3 mb-6 print:hidden",children:r.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[r.jsx(cv,{size:16}),"Print Receipt"]})}),r.jsxs("div",{className:"receipt-container flex gap-4 print:gap-2",children:[r.jsxs("div",{className:"receipt-copy flex-1 border border-gray-300 rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"flex items-center justify-center gap-4 mb-2",children:[e.hasSchoolLogo&&e.schoolLogo&&r.jsx("img",{src:e.schoolLogo,alt:`${e.schoolName} Logo`,className:"h-16 w-auto object-contain",onError:f=>{const g=f.target;g.style.display="none"}}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-gray-800",children:e.schoolName}),r.jsxs("p",{className:"text-sm text-gray-600",children:["School Code: ",e.schoolCode]}),e.address&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.address})]})]}),r.jsx("div",{className:"mt-2",children:r.jsx("span",{className:"inline-block bg-blue-600 text-white px-3 py-1 rounded text-xs font-semibold",children:"ADMIN COPY"})}),r.jsxs("div",{className:"mt-3",children:[r.jsx("div",{className:"text-sm text-gray-600",children:u(n.paymentDate)}),r.jsx("div",{className:"mt-1",children:r.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded text-xs font-semibold",children:["Receipt #",n.receiptNumber]})})]})]})}),r.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Student Name"}),r.jsx("span",{className:"font-medium",children:t.name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Student ID"}),r.jsx("span",{className:"font-medium",children:t.userId||t.studentId})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Class & Section"}),r.jsxs("span",{className:"font-medium",children:[t.class,"-",t.section]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Academic Year"}),r.jsx("span",{className:"font-medium",children:t.academicYear})]})]})]})}),r.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Payment Date"}),r.jsx("span",{className:"font-medium",children:u(n.paymentDate)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Payment Method"}),r.jsx("span",{className:"font-medium",children:n.paymentMethod})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Reference"}),r.jsx("span",{className:"font-medium",children:n.paymentReference||"-"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Installment"}),r.jsx("span",{className:"font-medium",children:n.installmentName})]})]})]})}),r.jsxs("div",{className:"px-4 py-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3 bg-gray-100 px-3 py-2 rounded",children:"Installment Details"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-100",children:[r.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Installment"}),r.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Amount"}),r.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Paid"}),r.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Remaining"})]})}),r.jsxs("tbody",{children:[a.map((f,g)=>r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("td",{className:"px-3 py-2",children:f.isCurrent?r.jsxs("span",{className:"font-medium",children:[f.name," (Current)"]}):f.name}),r.jsx("td",{className:"px-3 py-2 text-right font-medium",children:d(f.amount)}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx("span",{className:"text-green-600 font-medium",children:d(f.paid)})}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx("span",{className:"text-red-600 font-medium",children:d(f.remaining)})})]},g)),r.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[r.jsx("td",{className:"px-3 py-2",children:"Total"}),r.jsx("td",{className:"px-3 py-2 text-right",children:d(s)}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx("span",{className:"text-green-600",children:d(i)})}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx("span",{className:"text-red-600",children:d(l)})})]})]})]})})]}),r.jsxs("div",{className:"px-4 py-3",children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2 bg-gray-100 px-3 py-2 rounded",children:"Fee Summary"}),r.jsxs("table",{className:"w-full text-sm border border-gray-200 rounded",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-blue-50",children:[r.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-b border-gray-200",children:"Description"}),r.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700 border-b border-gray-200",children:"Amount ()"})]})}),r.jsxs("tbody",{children:[r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("td",{className:"px-3 py-2 font-medium",children:"Total Annual Fee"}),r.jsx("td",{className:"px-3 py-2 text-right font-semibold",children:d(s)})]}),r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("td",{className:"px-3 py-2 font-medium text-green-700",children:"Total Amount Paid"}),r.jsx("td",{className:"px-3 py-2 text-right font-semibold text-green-700",children:d(i)})]}),r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("td",{className:"px-3 py-2 font-medium text-red-700",children:"Total Remaining"}),r.jsx("td",{className:"px-3 py-2 text-right font-semibold text-red-700",children:d(l)})]}),r.jsxs("tr",{className:"bg-gray-50 font-bold",children:[r.jsx("td",{className:"px-3 py-2",children:"Balance Due"}),r.jsx("td",{className:"px-3 py-2 text-right text-red-700",children:d(l)})]})]})]})]}),r.jsx("div",{className:"px-4 py-3 bg-blue-50 border-t border-gray-200",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Payment"}),r.jsx("div",{className:"text-2xl font-bold text-blue-800",children:d(n.amount)})]})}),r.jsxs("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-600 border-t border-gray-200",children:[r.jsx("div",{className:"font-semibold",children:"This is a computer generated copy."}),r.jsxs("div",{className:"mt-1",children:["Powered by ",r.jsx("span",{className:"font-semibold text-blue-600",children:"EduLogix"})]}),r.jsxs("div",{className:"mt-1",children:["Thank you for your payment!  ",e.website]}),r.jsxs("div",{className:"mt-1",children:[e.phone,"  ",e.email]})]})]}),r.jsxs("div",{className:"flex-1 border border-gray-300 rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"flex items-center justify-center gap-4 mb-2",children:[e.hasSchoolLogo&&e.schoolLogo&&r.jsx("img",{src:e.schoolLogo,alt:`${e.schoolName} Logo`,className:"h-16 w-auto object-contain",onError:f=>{const g=f.target;g.style.display="none"}}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-gray-800",children:e.schoolName}),r.jsxs("p",{className:"text-sm text-gray-600",children:["School Code: ",e.schoolCode]}),e.address&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.address})]})]}),r.jsx("div",{className:"mt-2",children:r.jsx("span",{className:"inline-block bg-blue-600 text-white px-3 py-1 rounded text-xs font-semibold",children:"STUDENT COPY"})}),r.jsxs("div",{className:"mt-3",children:[r.jsx("div",{className:"text-sm text-gray-600",children:u(n.paymentDate)}),r.jsx("div",{className:"mt-1",children:r.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded text-xs font-semibold",children:["Receipt #",n.receiptNumber]})})]})]})}),r.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Student Name"}),r.jsx("span",{className:"font-medium",children:t.name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Student ID"}),r.jsx("span",{className:"font-medium",children:t.userId||t.studentId})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Class & Section"}),r.jsxs("span",{className:"font-medium",children:[t.class,"-",t.section]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Academic Year"}),r.jsx("span",{className:"font-medium",children:t.academicYear})]})]})]})}),r.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Payment Date"}),r.jsx("span",{className:"font-medium",children:u(n.paymentDate)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Payment Method"}),r.jsx("span",{className:"font-medium",children:n.paymentMethod})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Reference"}),r.jsx("span",{className:"font-medium",children:n.paymentReference||"-"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Installment"}),r.jsx("span",{className:"font-medium",children:n.installmentName})]})]})]})}),r.jsxs("div",{className:"px-4 py-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3 bg-gray-100 px-3 py-2 rounded",children:"Installment Details"}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-100",children:[r.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Installment"}),r.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Amount"}),r.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Paid"}),r.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Remaining"})]})}),r.jsxs("tbody",{children:[a.map((f,g)=>r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("td",{className:"px-3 py-2",children:f.isCurrent?r.jsxs("span",{className:"font-medium",children:[f.name," (Current)"]}):f.name}),r.jsx("td",{className:"px-3 py-2 text-right font-medium",children:d(f.amount)}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx("span",{className:"text-green-600 font-medium",children:d(f.paid)})}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx("span",{className:"text-red-600 font-medium",children:d(f.remaining)})})]},g)),r.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[r.jsx("td",{className:"px-3 py-2",children:"Total"}),r.jsx("td",{className:"px-3 py-2 text-right",children:d(s)}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx("span",{className:"text-green-600",children:d(i)})}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx("span",{className:"text-red-600",children:d(l)})})]})]})]})})]}),r.jsxs("div",{className:"px-4 py-3",children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2 bg-gray-100 px-3 py-2 rounded",children:"Fee Summary"}),r.jsxs("table",{className:"w-full text-sm border border-gray-200 rounded",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-blue-50",children:[r.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-b border-gray-200",children:"Description"}),r.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700 border-b border-gray-200",children:"Amount ()"})]})}),r.jsxs("tbody",{children:[r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("td",{className:"px-3 py-2 font-medium",children:"Total Annual Fee"}),r.jsx("td",{className:"px-3 py-2 text-right font-semibold",children:d(s)})]}),r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("td",{className:"px-3 py-2 font-medium text-green-700",children:"Total Amount Paid"}),r.jsx("td",{className:"px-3 py-2 text-right font-semibold text-green-700",children:d(i)})]}),r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("td",{className:"px-3 py-2 font-medium text-red-700",children:"Total Remaining"}),r.jsx("td",{className:"px-3 py-2 text-right font-semibold text-red-700",children:d(l)})]}),r.jsxs("tr",{className:"bg-gray-50 font-bold",children:[r.jsx("td",{className:"px-3 py-2",children:"Balance Due"}),r.jsx("td",{className:"px-3 py-2 text-right text-red-700",children:d(l)})]})]})]})]}),r.jsx("div",{className:"px-4 py-3 bg-blue-50 border-t border-gray-200",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Payment"}),r.jsx("div",{className:"text-2xl font-bold text-blue-800",children:d(n.amount)})]})}),r.jsxs("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-600 border-t border-gray-200",children:[r.jsx("div",{className:"font-semibold",children:"This is a computer generated copy."}),r.jsxs("div",{className:"mt-1",children:["Powered by ",r.jsx("span",{className:"font-semibold text-blue-600",children:"EduLogix"})]}),r.jsxs("div",{className:"mt-1",children:["Thank you for your payment!  ",e.website]}),r.jsxs("div",{className:"mt-1",children:[e.phone,"  ",e.email]})]})]})]})]})},W1=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("en-GB")}catch(t){return console.error("Error formatting date:",t),""}},Y1=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),sQ=e=>{const[t,n]=j.useState(""),[a,s]=j.useState(!1),i=j.useCallback(()=>(new Date().getTime(),`CRN-TEMP-${Math.floor(Math.random()*1e3)}`),[]);return j.useEffect(()=>{const l=async()=>{if(e.chalanNumber&&e.chalanNumber.trim()!==""){n(e.chalanNumber.trim().toUpperCase());return}s(!0);try{const d=await ot.get("/chalans/next-chalan-number");if(d?.data?.success&&d?.data?.chalanNumber){n(d.data.chalanNumber);return}const u=i();n(u)}catch(d){console.error("Error fetching chalan number:",d);const u=i();n(u)}finally{s(!1)}};e.chalanNumber?n(e.chalanNumber):l()},[e.chalanNumber,i]),{chalanNumber:t,isLoading:a}},iQ=({chalan:e,copyType:t})=>{const n=e;xe.useEffect(()=>{console.group("Chalan props in ChalanCopy"),console.log("School Logo:",n?.schoolLogo),console.log("School Code:",n?.schoolCode),console.log("School Name:",n?.schoolName),console.log("Chalan Number:",n?.chalanNumber),console.log("Has Bank Details:",!!n?.bankDetails),console.log("Bank Details:",JSON.stringify(n?.bankDetails,null,2)),console.log("Has School Data Bank Details:",!!n?.schoolData?.bankDetails),console.log("School Data Bank Details:",JSON.stringify(n?.schoolData?.bankDetails,null,2)),console.groupEnd()},[n]);const a=j.useCallback(l=>l?l.startsWith("http")?l:l.startsWith("/uploads")?`${"https://erp-backend-kfut.onrender.com/api".replace(/\/api\/?$/,"")}${l}`:l:"",[]),s=j.useCallback(()=>{if(n?.schoolLogo)return a(n.schoolLogo);const l=n?.schoolData?.logo||n?.schoolData?.logoUrl;return a(l||"/default-school-logo.svg")},[n?.schoolLogo,n?.schoolData,a]),i=j.useCallback(l=>{const d=l.target,m=a("/default-school-logo.svg");d.src!==m?d.src=m:(console.error("All logo loading attempts failed"),d.style.display="none")},[]);return r.jsxs("div",{className:"w-[90%] max-w-md mx-auto border-2 border-gray-400 p-4 mb-4",children:[r.jsxs("div",{className:"mb-4 border-b border-gray-200 pb-3",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"h-16 w-16 flex items-center justify-center border border-gray-200 rounded overflow-hidden",children:r.jsx("img",{src:s(),alt:`${n.schoolName||"School"} Logo`,className:"w-full h-full object-contain p-1",onError:i})})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-gray-900",children:n.schoolName||"School Name"}),r.jsx("p",{className:"text-sm text-gray-600",children:K1(n.schoolAddress||n.schoolData?.address)||"Address not available"})]})]}),r.jsxs("div",{className:"text-center mt-3",children:[r.jsx("p",{className:"text-sm font-bold uppercase tracking-wide",children:"FEE PAYMENT CHALAN"}),r.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Academic Year: 2024-25"}),r.jsx("p",{className:"text-xs font-semibold text-blue-600 mt-1",children:t.toUpperCase()}),r.jsxs("p",{className:"text-sm font-semibold text-gray-700 mt-2",children:["Chalan: ",n.chalanNumber||"N/A"]})]})]}),r.jsx("div",{className:"border-t border-gray-200 my-2"}),r.jsxs("div",{className:"mt-2 px-4 text-xs",children:[r.jsx("div",{className:"mb-2",children:r.jsx("p",{className:"text-xs font-medium",children:"Student Details"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center mb-1",children:[r.jsx("span",{className:"w-28 text-xs text-gray-600 font-medium",children:"Name:"}),r.jsx("div",{className:"flex-1",children:r.jsx("span",{className:"text-sm font-medium text-gray-800",children:n.studentName||"N/A"})})]}),r.jsxs("div",{className:"flex items-center mb-1",children:[r.jsx("span",{className:"w-28 text-xs text-gray-600 font-medium",children:"Student ID:"}),r.jsx("div",{className:"flex-1",children:r.jsx("span",{className:"text-sm font-mono text-gray-800",children:(console.log("[ViewChalan Preview] Student ID values:",{userId:n.userId,admissionNumber:n.admissionNumber,studentId:n.studentId,mongoId:n.mongoId}),n.userId||n.admissionNumber||(n.studentId?.startsWith("KVS-")?n.studentId:n.studentId?.match(/^[0-9a-fA-F]{24}$/)?"N/A":n.studentId||"N/A"))})})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"w-28 text-xs text-gray-600 font-medium",children:"Class & Sec:"}),r.jsx("div",{className:"flex-1",children:r.jsxs("span",{className:"text-sm text-gray-800",children:[n.className||"N/A"," ",n.section?`- ${n.section}`:""]})})]})]}),r.jsx("div",{className:"border-t border-gray-100 my-2"}),r.jsxs("div",{className:"mt-4",children:[r.jsx("p",{className:"font-semibold mb-2 text-sm",children:"Payment Details:"}),r.jsxs("div",{className:"space-y-2 text-xs",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"w-28 text-xs text-gray-600 font-medium",children:"Installment:"}),r.jsx("div",{className:"flex-1",children:r.jsx("span",{className:"text-sm text-gray-900",children:n.installmentName||"N/A"})})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"w-28 text-xs text-gray-600 font-medium",children:"Amount:"}),r.jsx("span",{className:"text-sm font-bold text-blue-700",children:Y1(n.amount)})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"w-28 text-xs text-gray-600 font-medium",children:"Due Date:"}),r.jsx("div",{className:"flex-1",children:r.jsx("span",{className:"text-sm text-gray-900",children:W1(n.dueDate)||"N/A"})})]})]})]})]}),r.jsxs("div",{className:"mt-4 border-t border-gray-200 pt-3",children:[r.jsx("p",{className:"font-semibold mb-2 text-left text-xs",children:"School Bank Details:"}),r.jsxs("div",{className:"space-y-2 text-xs",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"Bank Name:"}),r.jsx("p",{className:"text-sm text-gray-900",children:n.schoolData?.bankDetails?.bankName||n.bankDetails?.bankName||"Not Available"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"Account Holder:"}),r.jsx("p",{className:"text-sm font-medium text-gray-800",children:n.schoolData?.bankDetails?.accountHolderName||n.bankDetails?.accountHolderName||"Not Available"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"A/c No:"}),r.jsx("p",{className:"text-sm font-mono text-gray-900",children:n.schoolData?.bankDetails?.accountNumber||n.bankDetails?.accountNumber||"Not Available"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"IFSC Code:"}),r.jsx("p",{className:"text-sm font-mono text-gray-900",children:n.schoolData?.bankDetails?.ifscCode||n.bankDetails?.ifscCode||"Not Available"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"Branch:"}),r.jsx("p",{className:"text-sm text-gray-900",children:n.schoolData?.bankDetails?.branch||n.bankDetails?.branch||"Not Available"})]})]})]})]})]})},K1=e=>{if(!e)return"School Address, City, State - Pincode";if(typeof e=="string")return e;if(typeof e=="object"){const{street:t="",area:n="",city:a="",state:s="",country:i="",pinCode:l="",district:d=""}=e;return[t,n,a,s,i,l||""].filter(Boolean).join(", ")}return String(e)},oQ=({isOpen:e,onClose:t,chalan:n})=>{const{user:a}=yr(),[s,i]=j.useState(()=>({chalanNumber:n?.chalanNumber||"",chalanDate:"",chalanStatus:"generated",installmentName:"",amount:0,dueDate:"",studentName:"",studentId:"",className:"",section:"",academicYear:"",schoolName:"",schoolAddress:"",schoolPhone:"",schoolEmail:"",schoolLogo:"",schoolData:{},bankDetails:{bankName:"",accountNumber:"",ifscCode:"",branch:"",accountHolderName:""}}));j.useEffect(()=>{n&&(console.group("ViewChalan - Initial Chalan Data"),console.log("Received chalan data:",{chalanNumber:n.chalanNumber,studentName:n.studentName,studentId:n.studentId,amount:n.amount,status:n.status||n.chalanStatus,_id:n._id}),console.log("Full chalan object:",JSON.parse(JSON.stringify(n))),console.groupEnd())},[n]);const{chalanNumber:l}=sQ(s);j.useEffect(()=>{console.log("[ViewChalan] Fetched chalan number:",l)},[l]),j.useEffect(()=>{l&&e&&i(f=>{const g={...f,chalanNumber:l};return console.log("[ViewChalan] Updating chalan number:",l),g})},[l,e]),j.useEffect(()=>{console.log("Chalan data updated:",{hasUserId:!!s.userId,hasStudentId:!!s.studentId,chalanNumber:s.chalanNumber,rawChalan:s})},[s]),j.useEffect(()=>{console.log("Chalan data:",{userId:n.userId,studentId:n.studentId,rawChalan:n})},[n]),j.useEffect(()=>{if(console.log("=== DEBUG: Starting student ID resolution ==="),console.log("Initial chalan data:",{userId:s.userId,studentId:s.studentId,rawChalan:JSON.parse(JSON.stringify(s))}),s.userId){console.log("Using userId directly from chalan data:",s.userId);return}const f=async()=>{if(!s.studentId||s.studentId==="N/A"){console.warn("No valid student ID available");return}try{console.log(`Attempting to fetch student data for studentId: ${s.studentId}`);const g=await ot.get(`/students/${s.studentId}`);console.log("Student API response:",g.data);const N=g.data?.data||g.data;if(console.log("Processed student data:",N),N?.userId){console.log("Using userId from student data:",N.userId);return}if(N?.user?._id){console.log("Fetching user record for ID:",N.user._id);const v=await ot.get(`/users/${N.user._id}`);if(v.data?.data?.userId){console.log("Found userId in user record:",v.data.data.userId);return}}if(N?.user){const v=N.user._id||N.user.id;if(console.log("Using ID from user object:",v),v)return}if(N?.studentId){console.log("Using studentId from student data:",N.studentId);return}if(N?._id){console.log("Using _id from student data as fallback:",N._id);return}console.warn("No suitable ID found in student data, using studentId as fallback:",s.studentId)}catch(g){console.error("Error in fetchStudentData:",{message:g.message,response:g.response?.data,status:g.response?.status});const N=s.userId||s.studentId;console.warn("Using fallback ID:",N||"N/A")}};s.userId?console.log("Using userId directly from chalan data:",s.userId):s.studentId?(console.log("No userId found, will try to fetch using studentId:",s.studentId),f()):s.userId?console.log("Using provided userId:",s.userId):console.warn("No student ID or user ID found in chalan data")},[s.studentId,s.userId]);const[d,u]=j.useState(!0);if(j.useEffect(()=>{(async()=>{if(!(!n||!e))try{u(!0);let g={...n};console.log("[ViewChalan] Initial chalan received:",{studentId:n.studentId,userId:n.userId,studentName:n.studentName,hasBankDetails:!!n.bankDetails,bankDetails:JSON.stringify(n.bankDetails,null,2),hasSchoolData:!!n.schoolData,schoolDataBankDetails:JSON.stringify(n.schoolData?.bankDetails,null,2),allKeys:Object.keys(n)}),console.log("[ViewChalan] Starting to fetch school data...");const N=await ot.get("/schools/database/school-info");console.log("[ViewChalan] API Response:",N),console.log("[ViewChalan] Response data structure:",{hasData:!!N?.data,hasDataData:!!N?.data?.data,dataKeys:N?.data?Object.keys(N.data):[],dataDataKeys:N?.data?.data?Object.keys(N.data.data):[]});const v=N?.data?.data||N?.data;if(console.log("[ViewChalan] Fetched school data:",{hasData:!!v,hasBankDetails:!!v?.bankDetails,bankDetails:JSON.stringify(v?.bankDetails,null,2),schoolDataKeys:v?Object.keys(v):[]}),v){let w="";if(v.logoUrl||v.logo){const y=v.logoUrl||v.logo;y.startsWith("/uploads")?w=`${"https://erp-backend-kfut.onrender.com/api".replace(/\/api\/?$/,"")}${y}`:w=y,console.log("School logo URL:",{rawLogoUrl:y,finalLogoUrl:w,apiBase:"https://erp-backend-kfut.onrender.com/api",schoolData:v})}g={...g,schoolName:g.schoolName||v.name||v.schoolName||"School Name",schoolCode:g.schoolCode||v.code||v.schoolCode||"SCH001",schoolAddress:K1(v.address)||g.schoolAddress,schoolEmail:v.contact?.email||v.email||g.schoolEmail,schoolPhone:v.contact?.phone||v.phone||g.schoolPhone,schoolLogo:w||g.schoolLogo,bankDetails:v.bankDetails,schoolData:v},console.log("Bank details after fetch:",{fromSchoolData:v.bankDetails,inUpdatedChalan:g.bankDetails,hasData:!!g.bankDetails?.bankName})}g.studentId&&g.studentId.match(/^[0-9a-fA-F]{24}$/)&&g._id===g.studentId&&(g.studentId="N/A"),console.log("[ViewChalan] About to set chalan with bank details:",{hasBankDetails:!!g.bankDetails,bankDetailsPreview:g.bankDetails,hasSchoolData:!!g.schoolData}),i(g)}catch(g){console.error("Error fetching school data:",g),i({...n,schoolName:n.schoolName||"School Name",schoolCode:n.schoolCode||"SCH001"})}finally{u(!1)}})()},[e]),!e||!s||d)return null;const m=()=>{const f=new Date().toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),g=s?.dueDate?new Date(s.dueDate).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",N=s?.schoolData?.name||s?.schoolName||"School",v=K1(s?.schoolData?.address||s?.schoolAddress),w=s?.schoolData?.phone||s?.schoolData?.contact?.phone||s?.schoolPhone||"",y=s?.schoolData?.email||s?.schoolData?.contact?.email||s?.schoolEmail||"",E=s?.academicYear||new Date().getFullYear()+"-"+(new Date().getFullYear()+1),O=s?.chalanNumber||n?.chalanNumber||"N/A";console.log("[Print] Using chalan number:",O);const T=s?.studentName||"N/A",A=s?.userId||s?.admissionNumber||(s?.studentId?.startsWith("KVS-")?s.studentId:s?.studentId?.match(/^[0-9a-fA-F]{24}$/)?"N/A":s?.studentId||"N/A"),I=`${s?.className||""}${s?.section?"-"+s.section:""}`,C=s?.installmentName||"N/A",P=s?.amount?`${s.amount.toLocaleString("en-IN")}`:"0";String(s?.status||s?.chalanStatus||"Status").toUpperCase(),console.log("[Print] Bank details check:",{hasSchoolDataBankDetails:!!s?.schoolData?.bankDetails,hasChalanBankDetails:!!s?.bankDetails,schoolDataBankDetails:s?.schoolData?.bankDetails,chalanBankDetails:s?.bankDetails});const F=s?.schoolData?.bankDetails?.accountHolderName||s?.bankDetails?.accountHolderName||"Not Available",R=s?.schoolData?.bankDetails?.bankName||s?.bankDetails?.bankName||"Not Available",$=s?.schoolData?.bankDetails?.accountNumber||s?.bankDetails?.accountNumber||"Not Available",L=s?.schoolData?.bankDetails?.ifscCode||s?.bankDetails?.ifscCode||"Not Available",G=s?.schoolData?.bankDetails?.branch||s?.bankDetails?.branch||"Not Available",X=U=>U.startsWith("http")?U:U.startsWith("/uploads")?`${"https://erp-backend-kfut.onrender.com/api".replace(/\/api\/?$/,"")}${U}`:U,me=s?.schoolLogo||s?.schoolData?.logo||s?.schoolData?.logoUrl||"/default-school-logo.svg",se=X(me),ee=`
      <!DOCTYPE html>
      <html lang="en">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Fee Payment Challan</title>
        <style>
          .header-row { display: flex; flex-direction: row; align-items: flex-start; }
          .logo-box { flex: 0 0 60px; }
          .school-logo { height: 50px; width: 50px; object-fit: contain; border-radius: 4px; border: 1px solid #eee; background: #fff; }
          .school-info-block { display: flex; flex-direction: column; justify-content: flex-start; margin-left: 12px; }
          .school-info { font-size: 11px; color: #2c3e50; font-weight: bold; text-align: left; }
          .school-details { font-size: 10px; color: #555; line-height: 1.4; text-align: left; }
          .title-row { text-align: center; margin: 10px 0 2px 0; }
          .challan-title { font-size: 13px; font-weight: bold; color: #2c3e50; }
          .academic-year { font-size: 9px; color: #666; margin-bottom: 2px; }
          .copy-type { display: inline-block; padding: 2px 8px; font-size: 8px; font-weight: bold; border-radius: 2px; color: white; margin-top: 3px; }
          .student-copy .copy-type { background: #3498db; }
          .office-copy .copy-type { background: #e74c3c; }
          .admin-copy .copy-type { background: #27ae60; }
          .challan-number { font-weight: 600; font-size: 14px; color: #555; text-align: left; margin-top: 6px; padding-left: 4px; }
          .header { margin-bottom: 8px; }
          @page { size: A4 portrait; margin: 0; }
          body { font-family: Arial, sans-serif; background-color: white; margin: 0; padding: 0; }
          .challan-container { width: 250mm; min-height: 320mm; display: flex; flex-direction: row; padding: 16mm; gap: 8mm; page-break-after: avoid; }
          .challan-copy { flex: 1; border: 2px solid #333; padding: 16px; background: white; display: flex; flex-direction: column; height: fit-content; max-height: 300mm; }
          .content-section { display: flex; flex-direction: column; gap: 12px; }
          .info-group { margin-bottom: 12px; }
          .info-title { font-size: 16px; font-weight: bold; color: #2c3e50; margin-bottom: 6px; border-bottom: 1px solid #ddd; padding-bottom: 4px; }
          .info-row { display: flex; padding: 2px 0; font-size: 14px; line-height: 1.5; }
          .info-label { font-weight: 600; color: #555; min-width: 90px; font-size: 14px; }
          .info-value { color: #333; flex: 1; word-break: break-word; font-size: 14px; }
          .payment-status { margin-top: 16px; padding: 10px; border: 1px dashed #95a5a6; text-align: center; font-weight: bold; color: #7f8c8d; font-size: 14px; }
          .branding { text-align: center; font-size: 12px; color: #95a5a6; margin-top: 8px; padding-top: 6px; border-top: 1px solid #ecf0f1; }
          @media print { body { margin: 0; padding: 0; } .challan-container { page-break-after: avoid; } .challan-copy { page-break-inside: avoid; } }
        </style>
      </head>
      <body>
        <div class="challan-container">

          <!-- STUDENT COPY -->
          <div class="challan-copy student-copy">
            <div class="header">
              <div class="header-row">
                <div class="logo-box"><img src="${se}" alt="School Logo" class="school-logo" /></div>
                <div class="school-info-block">
                  <div class="school-info">${N}</div>
                  <div class="school-details">${v}<br>${w?`Phone: ${w}<br>`:""}${y?`Email: ${y}`:""}</div>
                </div>
              </div>
              <div class="title-row">
                <div class="challan-title">FEE PAYMENT CHALAN</div>
                <div class="academic-year">Academic Year: ${E}</div>
                <span class="copy-type">STUDENT COPY</span>
                <div class="challan-number">Chalan: ${O}</div>
              </div>
            </div>
        
            <div class="content-section">
              <div class="info-group">
                <div class="info-title">Bank Details:</div>
                <div class="info-row"><span class="info-label">Bank Name:</span><span class="info-value">${R}</span></div>
                <div class="info-row"><span class="info-label">Account Holder:</span><span class="info-value">${F}</span></div>
                <div class="info-row"><span class="info-label">A/c No:</span><span class="info-value">${$}</span></div>
                <div class="info-row"><span class="info-label">IFSC Code:</span><span class="info-value">${L}</span></div>
                <div class="info-row"><span class="info-label">Branch:</span><span class="info-value">${G}</span></div>
                <div class="info-row"><span class="info-label">Date:</span><span class="info-value">${f}</span></div>
              </div>
              <div class="info-group">
                <div class="info-title">Student Details</div>
                <div class="info-row"><span class="info-label">Name:</span><span class="info-value">${T}</span></div>
                <div class="info-row"><span class="info-label">Student ID:</span><span class="info-value">${A}</span></div>
                <div class="info-row"><span class="info-label">Class & Sec:</span><span class="info-value">${I}</span></div>
                <div class="info-row"><span class="info-label">Academic Year:</span><span class="info-value">${E}</span></div>
              </div>
              <div class="info-group">
                <div class="info-title">Payment Details:</div>
                <div class="info-row"><span class="info-label">Installment:</span><span class="info-value">${C}</span></div>
                <div class="info-row"><span class="info-label">Amount:</span><span class="info-value">${P}</span></div>
                <div class="info-row"><span class="info-label">Due Date:</span><span class="info-value">${g}</span></div>
              </div>
            </div>
            <div class="branding">EduLogix - Institute Management System</div>
          </div>

          <!-- OFFICE COPY -->
          <div class="challan-copy office-copy">
            <div class="header">
              <div class="header-row">
                <div class="logo-box"><img src="${se}" alt="School Logo" class="school-logo" /></div>
                <div class="school-info-block">
                  <div class="school-info">${N}</div>
                  <div class="school-details">${v}<br>${w?`Phone: ${w}<br>`:""}${y?`Email: ${y}`:""}</div>
                </div>
              </div>
              <div class="title-row">
                <div class="challan-title">FEE PAYMENT CHALAN</div>
                <div class="academic-year">Academic Year: ${E}</div>
                <span class="copy-type">OFFICE COPY</span>
                <div class="challan-number">Chalan: ${O}</div>
              </div>
            </div>
         
            <div class="content-section">
              <div class="info-group">
                <div class="info-title">Bank Details:</div>
                <div class="info-row"><span class="info-label">Bank Name:</span><span class="info-value">${R}</span></div>
                <div class="info-row"><span class="info-label">Account Holder:</span><span class="info-value">${F}</span></div>
                <div class="info-row"><span class="info-label">A/c No:</span><span class="info-value">${$}</span></div>
                <div class="info-row"><span class="info-label">IFSC Code:</span><span class="info-value">${L}</span></div>
                <div class="info-row"><span class="info-label">Branch:</span><span class="info-value">${G}</span></div>
                <div class="info-row"><span class="info-label">Date:</span><span class="info-value">${f}</span></div>
              </div>
              <div class="info-group">
                <div class="info-title">Student Details</div>
                <div class="info-row"><span class="info-label">Name:</span><span class="info-value">${T}</span></div>
                <div class="info-row"><span class="info-label">Student ID:</span><span class="info-value">${A}</span></div>
                <div class="info-row"><span class="info-label">Class & Sec:</span><span class="info-value">${I}</span></div>
                <div class="info-row"><span class="info-label">Academic Year:</span><span class="info-value">${E}</span></div>
              </div>
              <div class="info-group">
                <div class="info-title">Payment Details:</div>
                <div class="info-row"><span class="info-label">Installment:</span><span class="info-value">${C}</span></div>
                <div class="info-row"><span class="info-label">Amount:</span><span class="info-value">${P}</span></div>
                <div class="info-row"><span class="info-label">Due Date:</span><span class="info-value">${g}</span></div>
              </div>
            </div>
            <div class="branding">EduLogix - Institute Management System</div>
          </div>

          <!-- ADMIN COPY -->
          <div class="challan-copy admin-copy">
            <div class="header">
              <div class="header-row">
                <div class="logo-box"><img src="${se}" alt="School Logo" class="school-logo" /></div>
                <div class="school-info-block">
                  <div class="school-info">${N}</div>
                  <div class="school-details">${v}<br>${w?`Phone: ${w}<br>`:""}${y?`Email: ${y}`:""}</div>
                </div>
              </div>
              <div class="title-row">
                <div class="challan-title">FEE PAYMENT CHALAN</div>
                <div class="academic-year">Academic Year: ${E}</div>
                <span class="copy-type">ADMIN COPY</span>
                <div class="challan-number">Chalan: ${O}</div>
              </div>
            </div>
           
            <div class="content-section">
              <div class="info-group">
                <div class="info-title">Bank Details:</div>
                <div class="info-row"><span class="info-label">Bank Name:</span><span class="info-value">${R}</span></div>
                <div class="info-row"><span class="info-label">Account Holder:</span><span class="info-value">${F}</span></div>
                <div class="info-row"><span class="info-label">A/c No:</span><span class="info-value">${$}</span></div>
                <div class="info-row"><span class="info-label">IFSC Code:</span><span class="info-value">${L}</span></div>
                <div class="info-row"><span class="info-label">Branch:</span><span class="info-value">${G}</span></div>
                <div class="info-row"><span class="info-label">Date:</span><span class="info-value">${f}</span></div>
              </div>
              <div class="info-group">
                <div class="info-title">Student Details</div>
                <div class="info-row"><span class="info-label">Name:</span><span class="info-value">${T}</span></div>
                <div class="info-row"><span class="info-label">Student ID:</span><span class="info-value">${A}</span></div>
                <div class="info-row"><span class="info-label">Class & Sec:</span><span class="info-value">${I}</span></div>
                <div class="info-row"><span class="info-label">Academic Year:</span><span class="info-value">${E}</span></div>
              </div>
              <div class="info-group">
                <div class="info-title">Payment Details:</div>
                <div class="info-row"><span class="info-label">Installment:</span><span class="info-value">${C}</span></div>
                <div class="info-row"><span class="info-label">Amount:</span><span class="info-value">${P}</span></div>
                <div class="info-row"><span class="info-label">Due Date:</span><span class="info-value">${g}</span></div>
              </div>
            </div>
            <div class="branding">EduLogix - Institute Management System</div>
          </div>
        </div>
      </body>
      </html>
    `,W=window.open("","_blank","width=900,height=900");W?(W.document.write(ee),W.document.close(),W.onload=()=>{setTimeout(()=>{W.focus(),W.print()},250)}):alert("Please allow popups to print the challan")},p=[{type:"Student Copy",bgColor:"bg-blue-50"},{type:"Office Copy",bgColor:"bg-green-50"},{type:"Admin Copy",bgColor:"bg-purple-50"}];return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-auto",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl",children:[r.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 p-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Chalan Details"}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:m,className:"p-2 text-gray-600 hover:text-blue-600",title:"Print",children:r.jsx(cv,{className:"h-5 w-5"})}),r.jsx("button",{onClick:t,className:"p-2 text-gray-600 hover:text-red-600",children:""})]})]}),r.jsxs("div",{className:"p-6 print:p-0",children:[r.jsx("style",{children:`
            @page {
              size: A4 landscape;
              margin: 0;
            }
            @media print {
              body * {
                visibility: hidden;
              }
              #chalan-print, #chalan-print * {
                visibility: visible;
              }
              #chalan-print {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 0;
                margin: 0;
              }
              .chalan-copy {
                page-break-inside: avoid;
                break-inside: avoid;
              }
              .no-print {
                display: none !important;
              }
            }
          `}),r.jsx("div",{id:"chalan-print",className:"space-y-6",children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 print:grid-cols-3 print:gap-2 print:px-4 print:py-2",children:p.map((f,g)=>r.jsx("div",{className:`chalan-copy ${f.bgColor} print:bg-transparent print:border`,children:r.jsx(iQ,{chalan:s,copyType:f.type})},g))})}),r.jsx("div",{className:"border border-gray-200 rounded-lg p-4 mb-6",children:r.jsxs("div",{className:"grid grid-cols-3 gap-1 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Class"}),r.jsx("p",{className:"font-medium",children:s.className})]}),r.jsx("div",{children:r.jsxs("p",{className:"text-sm text-gray-600",children:["Date: ",r.jsx("span",{className:"font-medium",children:s.chalanDate?W1(s.chalanDate):""})]})})]})}),r.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden mb-6",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),r.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount ()"})]})}),r.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[r.jsxs("tr",{children:[r.jsxs("td",{className:"px-4 py-2",children:[s.installmentName," - ",W1(s.dueDate)]}),r.jsx("td",{className:"px-4 py-2 text-right",children:Y1(s.amount)})]}),r.jsxs("tr",{className:"bg-gray-50",children:[r.jsx("td",{className:"px-4 py-2 font-semibold",children:"Total Amount"}),r.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:Y1(s.amount)})]})]})]})}),r.jsxs("div",{className:"mt-4 border-t border-gray-200 pt-3",children:[r.jsx("p",{className:"font-semibold mb-3 text-left text-sm",children:"Payment Instructions"}),r.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4 rounded",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0 pt-0.5",children:r.jsx("svg",{className:"h-5 w-5 text-yellow-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),r.jsx("div",{className:"ml-3",children:r.jsx("p",{className:"text-sm text-yellow-700 mb-3",children:"Please deposit the fee in the following bank account and keep this chalan for future reference."})})]})}),r.jsxs("div",{className:"space-y-2 text-xs",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"Account Name:"}),r.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.schoolData?.bankDetails?.accountHolderName||s.bankDetails?.accountHolderName||s.schoolData?.bankDetails?.accountName||s.bankDetails?.accountHolderName||"School Account"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"Account No:"}),r.jsx("p",{className:"text-sm font-mono text-gray-900",children:s.schoolData?.bankDetails?.accountNumber||s.bankDetails?.accountNumber||"XXXXXXXXXXXX"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"Bank Name:"}),r.jsx("p",{className:"text-sm text-gray-900",children:s.schoolData?.bankDetails?.bankName||s.bankDetails?.bankName||"Bank Name"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"IFSC Code:"}),r.jsx("p",{className:"text-sm font-mono text-gray-900",children:s.schoolData?.bankDetails?.ifscCode||s.bankDetails?.ifscCode||"XXXX0000000"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("p",{className:"w-28 text-xs text-gray-600 font-medium",children:"Branch:"}),r.jsx("p",{className:"text-sm text-gray-900",children:s.schoolData?.bankDetails?.branch||s.bankDetails?.branch||"Branch Name"})]})]})]}),r.jsxs("div",{className:"mt-8 pt-4 border-t border-gray-200 text-center text-xs text-gray-500",children:[r.jsx("p",{children:"This is a computer-generated chalan. No signature is required."}),r.jsx("p",{className:"mt-1",children:"For any queries, please contact the school office."})]})]}),r.jsxs("div",{className:"bg-gray-50 px-4 py-3 flex justify-end space-x-3 border-t border-gray-200 rounded-b-lg",children:[r.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Close"}),r.jsxs("button",{type:"button",onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[r.jsx(cv,{className:"h-4 w-4 mr-2"}),"Print Chalan"]})]})]})})},lQ=()=>{const{user:e}=yr(),{currentAcademicYear:t,viewingAcademicYear:n,setViewingYear:a,availableYears:s,loading:i}=pn(),[l,d]=j.useState("ALL"),[u,m]=j.useState("ALL"),[p,f]=j.useState(""),[g,N]=j.useState({});j.useEffect(()=>{(async()=>{if(e?.schoolId)try{console.log("Fetching school details for:",e.schoolId);const _e=(await Kn.getSchoolById(e.schoolId))?.data?.data||{};console.log("School API response:",_e);const tt={schoolName:_e.name||_e.schoolName||"School Name",schoolCode:_e.code||_e.schoolCode||"SCH",address:{addressLine1:_e.address?.street||_e.address?.addressLine1||"School Address",city:_e.address?.city||"City",state:_e.address?.state||"State",pincode:_e.address?.pincode||"000000",area:_e.address?.area||"",district:_e.address?.district||"",country:_e.address?.country||"India"},contact:{phone:_e.contact?.phone||_e.mobile||"+91 XXXXXXXXXX",email:_e.contact?.email||_e.principalEmail||"info@school.edu.in",website:_e.website||""},logo:{finalLogoUrl:_e.logoUrl?_e.logoUrl.startsWith("http")?_e.logoUrl:`${"https://erp-backend-kfut.onrender.com/api".replace("/api","")||""}${_e.logoUrl}`:"",rawLogoUrl:_e.logoUrl||"",apiBase:"https://erp-backend-kfut.onrender.com/api"},bankDetails:_e.bankDetails||{accountName:"School Account",accountNumber:"",bankName:"",ifscCode:"",branch:"",accountType:"Savings"}};console.log("Formatted school data:",tt),N(tt)}catch(ht){console.error("Error fetching school:",ht),N({schoolName:"School Name",schoolCode:"SC",address:{addressLine1:"School Address",city:"City",state:"State",pincode:"000000"},contact:{phone:"+91 XXXXXXXXXX",email:"info@school.edu.in"},logo:{rawLogoUrl:null,apiBase:null},bankDetails:{accountName:"School Account",accountNumber:"XXXXXXXXXXXX",bankName:"Bank Name",ifscCode:"IFSCXXXXXXX",branch:"Branch Name"}})}})()},[e?.schoolId]),console.log("FeePaymentsTab render",{schoolDetails:g});const[v,w]=j.useState([]),[y,E]=j.useState(!1),[O,T]=j.useState(null),[A,I]=j.useState(!1),[C,P]=j.useState(null),[F,R]=j.useState(""),[$,L]=j.useState(null),[G,X]=j.useState(!1);xe.useEffect(()=>{console.log("Chalan modal state changed:",{isChalanModalOpen:G,viewingChalan:$})},[G,$]);const[me,se]=j.useState(""),[ee,W]=j.useState("cash"),[U,Q]=j.useState(""),[Y,H]=j.useState(""),[te,fe]=j.useState(!1),[Le,he]=j.useState(!1),[K,be]=j.useState(!1),[re,ie]=j.useState(null),[ne,Te]=j.useState(""),[ve,We]=j.useState(null),[Ie,je]=j.useState(!1),[oe,$e]=j.useState(null),[et,lt]=j.useState(""),rt=async()=>{try{E(!0),T(null),console.log("Fetching fee records with params:",{class:l,section:u,search:p,academicYear:n});const ke={search:p,limit:50,fields:"_id,userId,name,studentId,class,section,admissionNumber",academicYear:n};l&&l!=="ALL"&&(ke.class=l),u&&u!=="ALL"&&(ke.section=u);const[ht,_e]=await Promise.all([Ws.getStudentFeeRecords({class:l,section:u,search:p,academicYear:n,limit:50,fields:"studentId,installments,totalAmount,paidAmount,balance"}),kR.getUsersByRole("student",ke)]);console.log("Fee records response:",ht),console.log("Students API response:",_e),console.log("Students API response.data:",_e.data),console.log("Students API response.data.data:",_e.data?.data);const tt=new Map;let gt=[];Array.isArray(_e.data)?(gt=_e.data,console.log("Using studentsRes.data (array)")):_e.data?.data&&(gt=Array.isArray(_e.data.data)?_e.data.data:_e.data.data?.students||[],console.log("Using studentsRes.data.data, count:",gt.length)),console.log("===== STUDENTS DATA ====="),console.log("Total students fetched:",gt.length),console.log("First student sample:",gt[0]),console.log("First 3 students:",gt.slice(0,3).map(vt=>({_id:vt._id,userId:vt.userId,name:vt.name?.displayName||vt.name}))),gt.forEach(vt=>{const nr=vt.userId,Yt=vt._id;Yt&&nr&&tt.set(Yt.toString(),nr.toString())}),console.log("Student details map created with",tt.size,"entries"),console.log("Sample map entries:",Array.from(tt.entries()).slice(0,3)),console.log("Student details map:",Object.fromEntries(tt));const Ot=(ht.data?.data?.records||[]).map(vt=>{const nr=gt.find($t=>$t._id?.toString()===vt.studentId?.toString()),Yt=nr?.userId||vt.userId||vt.studentId;console.log("Resolving userId for student:",{feeRecordStudentId:vt.studentId,matchingStudentFound:!!nr,matchingStudentUserId:nr?.userId,matchingStudentName:nr?.name?.displayName,finalUserId:Yt});const Or=(vt.installments||[]).map($t=>({...$t,chalanNumber:$t.chalanNumber||"",chalanDate:$t.chalanDate||"",chalanBank:$t.chalanBank||"",chalanStatus:$t.chalanStatus||"pending"})),Sr=Yt||vt.userId||(vt.user?vt.user.userId||vt.user._id:null)||tt.get(vt.studentId?.toString());return console.log("Student record:",{name:vt.studentName,studentId:vt.studentId,userId:Sr,r_userId:vt.userId,class:vt.studentClass,section:vt.studentSection,userIdSource:Sr===vt.userId?"r.userId":vt.user&&(Sr===vt.user.userId||Sr===vt.user._id)?"r.user":tt.has(vt.studentId?.toString())?"studentDetails map":"Not found",rawData:{...vt,_id:vt._id,userId:vt.userId,studentId:vt.studentId,user:vt.user?{_id:vt.user._id,userId:vt.user.userId,...Object.entries(vt.user).reduce(($t,[gr,kr])=>(typeof kr!="object"&&!Array.isArray(kr)?$t[gr]=kr:gr==="studentDetails"&&($t.studentDetails=kr?"[...]":null),$t),{})}:"No user object",studentDetails:vt.studentDetails?"[...]":"No studentDetails"},studentDetailsMapEntry:tt.get(vt.studentId?.toString())?{userId:tt.get(vt.studentId?.toString())}:"Not in studentDetails map"}),{id:vt.id,studentId:Yt||vt.studentId,userId:Yt,mongoId:vt.studentId,name:vt.studentName,class:vt.studentClass,section:vt.studentSection,rollNumber:vt.rollNumber,totalAmount:vt.totalAmount,totalPaid:vt.totalPaid,balance:vt.totalPending,status:vt.status,installments:Or}});w(Ot)}catch(ke){const ht=ke?.response?.data?.message||ke.message||"Failed to load fee records";console.error("Error in fetchRecords:",{error:ke,message:ke.message,response:ke.response?.data,stack:ke.stack}),T(ht),w([])}finally{E(!1)}},Lt=async ke=>{try{if(!re){_t.error("No payment history available");return}let ht=null,_e=null;for(const Pe of re.installments||[]){for(const Se of Pe.payments||[])if(Se.receiptNumber===ke){ht=Se,_e=Pe;break}if(ht)break}if(!ht&&re.payments){for(const Pe of re.payments)if(Pe.receiptNumber===ke){ht=Pe,_e=(re.installments||[]).find(Se=>Se.name===Pe.installmentName);break}}if(!ht){_t.error("Payment not found");return}let tt={schoolName:e?.schoolName||"School Name",schoolCode:e?.schoolCode||"SCH001",address:"123 School Street, City, State 12345",phone:"+91-XXXXXXXXXX",email:"info@school.com",website:"www.edulogix.com",hasSchoolLogo:!1,schoolLogo:""};try{const Pe=e?.schoolId||e?.schoolCode;if(Pe){const Se=await Kn.getSchoolById(Pe),Ae=Se?.data?.data||Se?.data;if(Ae){console.log("School data fetched from API:",Ae);let Xe="";Ae.address&&(typeof Ae.address=="string"?Xe=Ae.address:Xe=[Ae.address.street,Ae.address.area,Ae.address.city,Ae.address.district,Ae.address.state,Ae.address.pincode?`- ${Ae.address.pincode}`:"",Ae.address.country].filter(Boolean).join(", ")),tt={schoolName:Ae.name||Ae.schoolName||tt.schoolName,schoolCode:Ae.code||Ae.schoolCode||tt.schoolCode,address:Xe||tt.address,phone:Ae.phone||Ae.contact?.phone||Ae.mobile||tt.phone,email:Ae.email||Ae.contact?.email||Ae.principalEmail||tt.email,website:Ae.website||tt.website,hasSchoolLogo:!!(Ae.logoUrl||Ae.logo||tt.schoolLogo),schoolLogo:Ae.logoUrl?Ae.logoUrl.startsWith("http")?Ae.logoUrl:`${"https://erp-backend-kfut.onrender.com/api".replace("/api","")||""}${Ae.logoUrl}`:tt.schoolLogo,principalName:Ae.principalName||""},console.log("Processed school data for receipt:",tt)}}}catch(Pe){console.log("Failed to fetch school from API, trying template settings...",Pe);try{const Se=localStorage.getItem("universalTemplate");if(Se){const Ae=JSON.parse(Se);tt.schoolName=Ae.schoolName||tt.schoolName,tt.schoolCode=Ae.schoolCode||tt.schoolCode,tt.address=Ae.address||tt.address,tt.phone=Ae.phone||tt.phone,tt.email=Ae.email||tt.email,tt.website=Ae.website||tt.website;const Xe=Ae.logoUrl;tt.schoolLogo=Xe?Xe.startsWith("http")?Xe:`${"https://erp-backend-kfut.onrender.com/api".replace("/api","")||""}${Xe}`:tt.schoolLogo,tt.hasSchoolLogo=!!tt.schoolLogo}}catch{console.log("Failed to load template settings, using defaults")}}let gt="";console.log("Student ID Debug - historyRecord:",{sequenceNumber:re.sequenceNumber,studentUniqueId:re.studentUniqueId,enrollmentNo:re.enrollmentNo,admissionNo:re.admissionNo,studentId:re.studentId,userId:re.userId,rollNumber:re.rollNumber,studentRollNumber:re.studentRollNumber,studentName:re.studentName}),console.log("Student ID Debug - historyStudent:",ve);let Pt=ve;console.log("Student ID Debug - Available userId sources:",{"historyRecord.userId":re.userId,"historyStudent?.userId":ve?.userId,"historyRecord.studentId":re.studentId,"historyRecord._id":re._id});const Ot=re.userId||re.studentId||re._id;if(re.userId&&re.userId!=="undefined"&&re.userId!=="null")console.log("Student ID Debug - Found userId in fee record:",re.userId),Pt={userId:re.userId};else if(Ot&&!ve?.userId)try{console.log("Fetching complete student data using userId:",Ot);const Ae=((await Ws.getStudentFeeRecords({})).data?.data||[]).find(Xe=>Xe.userId===Ot||Xe.studentId===Ot||Xe._id===Ot);if(Ae?(console.log("Found matching student in fee records:",Ae),Pt=Ae):(Pt=(await Ws.getStudentByUserId(Ot)).data?.data,console.log("Complete student data from students collection:",Pt)),!Pt?.userId&&Pt){const Xe=Pt;console.log("Student data structure:",{userId:Xe.userId,_id:Xe._id,studentId:Xe.studentId,allKeys:Object.keys(Xe)})}}catch(Pe){console.log("Failed to fetch complete student data:",Pe),console.log("Using existing data:",ve)}const vt=[Pt?.userId,re.userId,re.sequenceNumber,re.studentUniqueId,re.enrollmentNo,re.admissionNo,re.studentId,re.rollNumber,re.studentRollNumber,Pt?.studentId,Pt?.studentDetails?.studentId,Pt?.rollNumber,Pt?.studentDetails?.rollNumber].filter(Pe=>Pe&&Pe!=="undefined"&&Pe!=="null"&&!/^[a-fA-F0-9]{24}$/.test(Pe));if(console.log("Student ID Debug - possibleIds:",vt),console.log("Student ID Debug - completeStudentData:",Pt),vt.length>0)gt=String(vt[0]).trim(),console.log("Student ID Debug - Using found ID:",gt);else{console.log("Student ID Debug - No valid IDs found, using fallback logic");const Pe=((tt.schoolCode||"SC").toString().trim()||"SC").toUpperCase();let Se="";const Ae=[re.rollNumber,re.studentRollNumber,Pt?.rollNumber,Pt?.studentDetails?.rollNumber];for(const Xe of Ae)if(Xe&&Xe!=="undefined"&&Xe!=="null"){Se=String(Xe).trim();break}if(Se||(Se=(String(re.admissionNo||re.enrollmentNo||"").match(/\d+/g)||[]).join("").slice(-4)),Se){const Xe=parseInt(Se,10),Ke=Number.isFinite(Xe)?Xe.toString().padStart(4,"0"):Se.padStart(4,"0");gt=`${Pe}-S-${Ke}`,console.log("Student ID Debug - Generated from roll number:",gt)}else{const Xe=(re.studentName||"STU").split(" ").map(Ve=>Ve[0]).join("").toUpperCase().slice(0,2),Ke=Date.now().toString().slice(-4);gt=`${Pe}-${Xe}-${Ke}`,console.log("Student ID Debug - Generated from name initials:",gt,"from name:",re.studentName)}}console.log("Student ID Debug - Final studentId:",gt);const nr={name:re.studentName,studentId:gt,class:re.studentClass,section:re.studentSection,academicYear:re.academicYear||`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`},Yt=ht.paymentDate||ht.date,Or=new Date;let Sr;if(Yt){const Pe=new Date(Yt);!isNaN(Pe.getTime())&&Pe<=Or?Sr=Yt:Sr=Or.toISOString()}else Sr=Or.toISOString();const $t={receiptNumber:ke,paymentDate:Sr,paymentMethod:ht.paymentMethod||ht.method||"Cash",paymentReference:ht.paymentReference||ht.reference||"-",amount:ht.amount||0,installmentName:_e?.name||ht.installmentName||"N/A"};console.log("Payment date from database:",Yt),console.log("Final payment date:",$t.paymentDate),console.log("Current date:",Or.toISOString());const gr=(re.installments||[]).map(Pe=>({name:Pe.name,amount:Pe.amount||0,paid:Pe.paidAmount||0,remaining:Math.max(0,(Pe.amount||0)-(Pe.paidAmount||0)),isCurrent:Pe.name===_e?.name})),kr=re.totalAmount||0,b=re.totalPaid||0,B=Math.max(0,kr-b);$e({schoolData:tt,studentData:nr,paymentData:$t,installments:gr,totalAmount:kr,totalPaid:b,totalRemaining:B}),lt(ke),je(!0)}catch(ht){_t.error(ht?.response?.data?.message||"Failed to generate receipt data")}},kt=async ke=>{await Lt(ke)},Oe=async ke=>{try{be(!0),he(!0),We(ke),console.log("Student data:",JSON.stringify(ke,null,2));const ht=[{type:"admissionNumber",value:ke.admissionNumber},{type:"_id",value:ke._id},{type:"id",value:ke.id},{type:"userId",value:ke.userId},{type:"studentId",value:ke.studentId}].filter(Ot=>Ot.value);if(console.log("Trying identifiers in order:",ht),ht.length===0)throw new Error("No valid student identifier found. Available fields: "+Object.keys(ke).join(", "));let _e,tt;for(const{type:Ot,value:vt}of ht)try{console.log(`Attempting to fetch fee record using ${Ot}:`,vt),_e=await Ws.getStudentFeeRecord(vt),console.log(`Successfully fetched fee record using ${Ot}`,_e);break}catch(nr){if(tt=nr,console.warn(`Failed to fetch with ${Ot} ${vt}:`,nr.message),Ot===ht[ht.length-1].type){console.log("All identifiers failed, trying chalan API...");try{const Yt=await api.get(`/api/chalans/student/${vt}`);if(Yt.data){console.log("Successfully fetched chalan data:",Yt.data),_e={data:{data:Yt.data}};break}}catch(Yt){throw console.error("Chalan API also failed:",Yt),new Error(`Failed to fetch fee records. Last error: ${tt?.message||"Unknown error"}`)}}}const gt=_e?.data?.data||_e?.data;ie(gt||null);const Pt=(gt?.installments||[])[0];if(Te(Pt?.name||""),ke?.rollNumber)return;try{const Ot=gt?.student?.rollNumber||gt?.studentDetails?.rollNumber;if(Ot){We(Yt=>({...Yt||{},rollNumber:Ot}));return}if(!(gt?.userId||gt?.student?.userId||gt?.studentId||ke.id))return;const nr=gt?.rollNumber||gt?.student?.rollNumber||gt?.studentDetails?.rollNumber||String(gt?.admissionNo||"").slice(-4)||String(gt?.enrollmentNo||"").slice(-4);nr&&We(Yt=>({...Yt||{},rollNumber:nr}))}catch(Ot){console.log("Error processing roll number:",Ot)}}catch(ht){console.error("Error in openHistoryModal:",ht),_t.error(ht?.response?.data?.message||"Failed to load payment history"),he(!1)}finally{be(!1)}};xe.useEffect(()=>{(async()=>{if(e?.schoolId)try{const ht=await Kn.getSchoolById(e.schoolId);N(ht.data||{}),console.log("School details loaded:",ht.data)}catch(ht){console.error("Error fetching school details:",ht),N({})}})(),rt()},[e?.schoolId,l,u,p,n]),xe.useEffect(()=>{const ke=setTimeout(()=>rt(),400);return()=>clearTimeout(ke)},[p,n]);const Nt=ke=>{switch(ke){case"paid":return"text-green-600 bg-green-100";case"partial":return"text-yellow-600 bg-yellow-100";case"pending":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},Mt=ke=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(ke),rr=ke=>{P(ke),W("cash"),Q(new Date().toISOString().split("T")[0]),H("");const ht=ke.installments||[],_e=ht.find(tt=>Math.max(0,(tt.amount||0)-(tt.paidAmount||0))>0)||ht[0];if(_e){const tt=Math.max(0,(_e.amount||0)-(_e.paidAmount||0));R(_e.name||""),se(String(tt||""))}else R(""),se("");I(!0)},Ft=()=>{te||(I(!1),P(null))},cr=ke=>{const ht=Math.max(0,(ke.amount||0)-(ke.paidAmount||0));R(ke.name),se(String(ht||""))},or=async()=>{if(!C)return;const ke=Number(me);if(!F)return _t.error("Select an installment");if(Number.isNaN(ke)||ke<=0)return _t.error("Enter a valid amount");if(!U||U.trim()==="")return _t.error("Payment date is required");const ht=new Date(U),_e=new Date;if(_e.setHours(23,59,59,999),ht>_e)return _t.error("Payment date cannot be in the future");const tt=(C.installments||[]).find(Pt=>Pt.name===F);if(tt){const Pt=Math.max(0,(tt.amount||0)-(tt.paidAmount||0));if(ke>Pt)return _t.error(`Amount cannot exceed pending (${Mt(Pt)})`)}if(["cheque","bank_transfer","online"].includes(ee)&&!String(Y||"").trim())return _t.error("Reference / Remarks is required for Cheque, Bank Transfer, and Online payments");try{fe(!0),await Ws.recordOfflinePayment(C.id,{installmentName:F,amount:ke,paymentMethod:ee,paymentDate:U,paymentReference:Y||void 0}),await rt(),I(!1),_t.success("Payment recorded successfully")}catch(Pt){_t.error(Pt?.response?.data?.message||"Failed to record payment")}finally{fe(!1)}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Fee Payments Management"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx(ew,{className:"inline h-4 w-4 mr-1"}),"Academic Year"]}),r.jsx("select",{value:n,onChange:ke=>a(ke.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",disabled:i,children:s.map(ke=>r.jsxs("option",{value:ke,children:[ke," ",ke===t&&"(Current)"]},ke))})]}),r.jsx(bj,{schoolCode:e?.schoolCode,valueClass:l,valueSection:u,onClassChange:d,onSectionChange:m}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",style:{top:"28px"},children:r.jsx(va,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{type:"text",value:p,onChange:ke=>f(ke.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Search students..."})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Payment Summary"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Assigned"}),r.jsx("p",{className:"text-2xl font-semibold text-blue-900",children:Mt(v.reduce((ke,ht)=>ke+(ht.totalAmount||0),0))})]})})}),r.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Collected"}),r.jsx("p",{className:"text-2xl font-semibold text-green-900",children:Mt(v.reduce((ke,ht)=>ke+(ht.totalPaid||0),0))})]})})}),r.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Outstanding"}),r.jsx("p",{className:"text-2xl font-semibold text-orange-900",children:Mt(v.reduce((ke,ht)=>ke+(ht.balance||0),0))})]})})})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Student Fee Records"})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Assigned"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Paid"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Chalan"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(ke=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{children:[r.jsxs("button",{type:"button",onClick:()=>Oe(ke),className:"text-left text-sm font-medium text-blue-600 hover:underline flex items-center gap-1",children:[r.jsx(Y6,{size:14}),ke.name]}),(ke.class||ke.section||ke.rollNumber)&&r.jsx("div",{className:"text-sm text-gray-500",children:[ke.class&&ke.section?`${ke.class} - ${ke.section}`:ke.class||ke.section||"",ke.rollNumber?`(${ke.rollNumber})`:""].filter(Boolean).join(" ")}),Le&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Payment History",re?.studentName?` - ${re.studentName}`:""]}),r.jsx("button",{onClick:()=>he(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"p-4 space-y-3",children:[K&&r.jsx("div",{className:"text-sm text-gray-500",children:"Loading history..."}),!K&&re&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("label",{className:"text-sm text-gray-700",children:"Installment:"}),r.jsx("select",{className:"px-2 py-1 border rounded text-sm",value:ne,onChange:ht=>Te(ht.target.value),children:(re.installments||[]).map(ht=>r.jsx("option",{value:ht.name,children:ht.name},ht.name))})]}),r.jsx("div",{className:"overflow-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Reference"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Day"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Receipt"})]})}),r.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[(re.payments||[]).filter(ht=>!ne||ht.installmentName===ne).map(ht=>{const _e=ht.paymentDate?new Date(ht.paymentDate):null,tt=_e?_e.toLocaleDateString():"-",gt=_e?_e.toLocaleDateString("en-IN",{weekday:"long"}):"-";return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:Mt(ht.amount||0)}),r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:ht.paymentMethod}),r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:ht.paymentReference||"-"}),r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:tt}),r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:gt}),r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:ht.receiptNumber?r.jsx("button",{type:"button",onClick:()=>kt(ht.receiptNumber),className:"text-blue-600 hover:underline",children:ht.receiptNumber}):"-"})]},String(ht.paymentId))}),(!re.payments||re.payments.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-3 text-sm text-gray-500",children:"No payments found for this installment."})})]})]})})]})]})]})})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Mt(ke.totalAmount)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Mt(ke.totalPaid)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Mt(ke.balance)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Nt(ke.status)}`,children:ke.status})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsx("div",{className:"flex space-x-2",children:r.jsxs("button",{onClick:()=>rr(ke),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[r.jsx(Os,{className:"h-4 w-4 mr-1"}),"Record Payment"]})})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:ke.installments?.length>0&&ke.installments.some(ht=>ht.status!=="paid")&&r.jsxs("button",{onClick:()=>{console.log("=== DEBUG: Student Object ===",ke),console.log("=== DEBUG: Student ID Fields ===",{"student.userId":ke.userId,"student.studentId":ke.studentId,"student.admissionNumber":ke.admissionNumber,"student._id":ke._id,"student.sequenceId":ke.sequenceId,"student.rollNumber":ke.rollNumber,"All available fields":Object.keys(ke)}),console.log("=== DEBUG: Student Installments ===",ke.installments),!ke.userId&&ke.studentDetails&&(console.log("=== DEBUG: student.studentDetails ===",ke.studentDetails),console.log("student.studentDetails.userId:",ke.studentDetails.userId),console.log("student.studentDetails.admissionNumber:",ke.studentDetails.admissionNumber));const ht=ke.installments.filter(tt=>tt.status!=="paid"),_e=ht.find(tt=>tt.chalanNumber)||ht[0];if(console.log("Selected installment for chalan:",_e),_e){console.log("=== DEBUG: Student Object ==="),console.log(JSON.stringify(ke,null,2)),console.log("Potential ID fields:",{userId:ke.userId,studentId:ke.studentId,admissionNumber:ke.admissionNumber,rollNumber:ke.rollNumber,id:ke.id,_id:ke._id,studentDetails:ke.studentDetails?{userId:ke.studentDetails.userId,admissionNumber:ke.studentDetails.admissionNumber,rollNumber:ke.studentDetails.rollNumber}:"No studentDetails",student:ke.student?{userId:ke.student.userId,studentId:ke.student.studentId,admissionNumber:ke.student.admissionNumber}:"No nested student object"});const tt={..._e,studentName:ke.name,studentId:ke.userId||ke.studentId||ke.admissionNumber||ke.rollNumber||ke.id||ke._id||"N/A",userId:ke.userId,className:ke.class||"N/A",section:ke.section||"N/A",academicYear:ke.academicYear||"2024-25",schoolName:g.name||g.schoolName||"School Name",schoolAddress:[g.address?.addressLine1,g.address?.city,g.address?.state,g.address?.pincode].filter(Boolean).join(", "),schoolPhone:g.contact?.phone,schoolEmail:g.contact?.email,bankDetails:g.bankDetails?{bankName:g.bankDetails.bankName||"Bank not specified",accountNumber:g.bankDetails.accountNumber||"Not specified",ifscCode:g.bankDetails.ifscCode||"Not specified",branch:g.bankDetails.branch||"Not specified",accountHolderName:g.bankDetails.accountHolderName||g.bankDetails.accountName||g.schoolName||"School Account"}:{bankName:"Bank not specified",accountNumber:"Not specified",ifscCode:"Not specified",branch:"Not specified",accountHolderName:g.schoolName||"School Account"},schoolData:{bankDetails:g.bankDetails?{bankName:g.bankDetails.bankName,accountNumber:g.bankDetails.accountNumber,ifscCode:g.bankDetails.ifscCode,branch:g.bankDetails.branch,accountHolderName:g.bankDetails.accountHolderName||g.bankDetails.accountName}:null},chalanNumber:_e.chalanNumber||null,chalanDate:_e.chalanDate||_e.dueDate||new Date().toISOString().split("T")[0],chalanBank:_e.chalanBank||"School Bank",chalanStatus:_e.chalanStatus||"generated",installmentName:_e.name||"Fee Installment",amount:_e.amount||0,dueDate:_e.dueDate||""};console.log("Setting chalan data:",tt),L(tt),console.log("Opening chalan modal"),X(!0)}},className:"bg-green-100 hover:bg-green-200 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded flex items-center border border-green-200",title:"View Chalan",children:[r.jsx(wn,{className:"h-3 w-3 mr-1"}),"Chalan"]})})]},ke.id))})]})})]}),A&&C&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Record Payment - ",C.name]}),r.jsx("button",{onClick:Ft,className:"text-gray-500 hover:text-gray-700",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx("div",{className:"overflow-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Installment"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Due"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Paid"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Pending"}),r.jsx("th",{className:"px-3 py-2"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(C.installments||[]).length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-3 py-3 text-sm text-gray-500",children:"No installments data available."})}):C.installments.map((ke,ht)=>{const _e=Math.max(0,(ke.amount||0)-(ke.paidAmount||0));return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:ke.name}),r.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:ke.dueDate?new Date(ke.dueDate).toLocaleDateString():"-"}),r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:Mt(ke.amount||0)}),r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:Mt(ke.paidAmount||0)}),r.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:Mt(_e)}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx("button",{onClick:()=>cr(ke),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Select"})})]},ht)})})]})}),r.jsx("div",{children:r.jsxs("div",{className:"space-y-3",children:[r.jsx("div",{className:"text-sm text-gray-600",children:F?`Selected installment: ${F}`:"Select an installment from the table to proceed."}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount to collect"}),r.jsx("input",{type:"number",inputMode:"numeric",value:me,onChange:ke=>se(ke.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Select an installment first"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),r.jsxs("select",{value:ee,onChange:ke=>W(ke.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"chalan",children:"Chalan"}),r.jsx("option",{value:"cheque",children:"Cheque"}),r.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),r.jsx("option",{value:"online",children:"Online"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),r.jsx("input",{type:"date",value:U,onChange:ke=>Q(ke.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["cheque","bank_transfer","online","chalan"].includes(ee)?"Reference / Remarks (required)":"Reference / Remarks (optional)"}),r.jsx("input",{type:"text",value:Y,onChange:ke=>H(ke.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:ee==="chalan"?"Chalan number":"txn id, cheque no, note, etc.",required:["cheque","bank_transfer","online","chalan"].includes(ee)})]}),r.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[r.jsx("button",{onClick:Ft,disabled:te,className:"px-4 py-2 rounded border text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),r.jsx("button",{onClick:or,disabled:te||!F,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:te?"Recording...":"Record Payment"})]})]})})]})]})}),y&&r.jsx("div",{className:"text-sm text-gray-500",children:"Loading records..."}),O&&r.jsx("div",{className:"text-sm text-red-600",children:O}),G&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-auto",children:r.jsx(oQ,{isOpen:G,onClose:()=>{console.log("Closing chalan modal"),X(!1),L(null)},chalan:$})})}),Ie&&oe&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-7xl mx-4 max-h-[90vh] overflow-auto",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Payment Receipt - ",oe.studentData.name]}),r.jsx("button",{onClick:()=>je(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsx("div",{className:"p-4",children:r.jsx(aQ,{schoolData:oe.schoolData,studentData:oe.studentData,paymentData:oe.paymentData,installments:oe.installments,totalAmount:oe.totalAmount,totalPaid:oe.totalPaid,totalRemaining:oe.totalRemaining})})]})})]})},f4=()=>{const e=ni(),t=()=>e.pathname.includes("/fees/structure")?"structure":e.pathname.includes("/fees/payments")?"payments":"structure",[n,a]=j.useState(t()),s=[{id:"structure",name:"Fee Structure",icon:Pn,href:"/admin/fees/structure",description:"Create and manage fee structures"},{id:"payments",name:"Fee Payments",icon:Pn,href:"/admin/fees/payments",description:"Record and track fee payments"}];return r.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[r.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:r.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[r.jsx(Gl,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600"}),r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Fees Management"})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsx("nav",{className:"-mb-px flex flex-col sm:flex-row sm:space-x-8 px-4 sm:px-6",children:s.map(i=>{const l=i.icon,d=n===i.id;return r.jsx("button",{onClick:()=>{a(i.id),window.history.pushState({},"",i.href)},className:`py-3 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm w-full sm:w-auto text-left ${d?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(l,{className:"h-4 w-4 sm:h-5 sm:w-5"}),r.jsx("span",{children:i.name})]})},i.id)})})}),r.jsxs("div",{className:"p-4 sm:p-6",children:[n==="structure"&&r.jsx(nQ,{}),n==="payments"&&r.jsx(lQ,{})]})]})]})},cQ=async e=>(await zt.get("/reports/dues",{params:e})).data;async function dQ(e){const t={type:"dues",academicYear:e.academicYear,class:e.class,section:e.section,status:e.status};e.search&&(t.search=e.search);const n=await zt.get("/reports/export",{params:t,responseType:"blob",headers:{Accept:"text/csv"}});if(n.data instanceof Blob)return n.data;if(n.data&&typeof n.data=="object"&&!(n.data instanceof Blob)){const a=n.data;throw new Error(a.message||"Failed to export data")}throw new Error("Unexpected response format from server")}const p4=async e=>(await zt.get("/reports/students-by-class",{params:e})).data,Qb=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),uQ=({status:e})=>{const n={paid:{bg:"bg-green-100",text:"text-green-800"},pending:{bg:"bg-yellow-100",text:"text-yellow-800"},overdue:{bg:"bg-red-100",text:"text-red-800"},partial:{bg:"bg-blue-100",text:"text-blue-800"}}[e.toLowerCase()]||{bg:"bg-gray-100",text:"text-gray-800"};return r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n.bg} ${n.text}`,children:e.charAt(0).toUpperCase()+e.slice(1)})},mQ=()=>{const{user:e}=yr(),{currentAcademicYear:t,viewingAcademicYear:n,isViewingHistoricalYear:a,setViewingYear:s,availableYears:i,loading:l}=pn(),[d,u]=j.useState("ALL"),[m,p]=j.useState("ALL"),[f,g]=j.useState(""),[N,v]=j.useState(""),[w,y]=j.useState(!0),[E,O]=j.useState(null),[T,A]=j.useState("overview"),[I,C]=j.useState({totalStudents:0,avgAttendance:0,avgMarks:0,classWiseDues:[]}),[P,F]=j.useState(!1),[R,$]=j.useState([]),[L,G]=j.useState(new Set),[X,me]=j.useState(new Map),[se,ee]=j.useState(new Set),[W,U]=j.useState([]),[Q,Y]=j.useState(!1),[H,te]=j.useState({page:1,limit:10,total:0,pages:1}),[fe,Le]=j.useState(""),[he,K]=j.useState("ALL"),be=async()=>{try{const je=await dQ({academicYear:n,class:d!=="ALL"?d:void 0,section:m!=="ALL"?m:void 0,search:fe||void 0,status:he!=="ALL"?he:void 0}),oe=window.URL.createObjectURL(je),$e=document.createElement("a"),et=new Date().toISOString().replace(/[:.]/g,"-");$e.href=oe,$e.setAttribute("download",`fee-due-report-${et}.csv`),document.body.appendChild($e),$e.click(),$e.parentNode&&$e.parentNode.removeChild($e),window.URL.revokeObjectURL(oe)}catch(Ie){console.error("Error exporting to CSV:",Ie),O("Failed to export data. Please try again.")}},re=j.useCallback(async()=>{try{Y(!0),O(null);const Ie={academicYear:n,class:d!=="ALL"?d:void 0,section:m!=="ALL"?m:void 0,page:H.page,limit:H.limit,search:fe||void 0,status:he!=="ALL"?he:void 0},je=await cQ(Ie);if(je.success)U(je.data.records),te(oe=>({...oe,total:je.data.pagination.total,pages:je.data.pagination.pages}));else throw new Error("Failed to fetch dues list")}catch(Ie){console.error("Error fetching dues list:",Ie),O("Failed to load dues data. Please try again.")}finally{Y(!1)}},[n,d,m,H.page,H.limit,fe,he]),ie=j.useCallback(async()=>{console.log(" [fetchClassWiseCounts] Starting fetch with filters:",{class:d,section:m});try{const Ie=localStorage.getItem("erp.auth"),je=Ie?JSON.parse(Ie).token:null,oe=e?.schoolCode;if(!je||!oe){O("Authentication required");return}console.log("Fetching students from school-users endpoint...");const $e=await pa.getAllUsers(oe,je);let et=[];$e.data&&Array.isArray($e.data)?et=$e.data.filter(Oe=>Oe.role==="student"):$e.students&&Array.isArray($e.students)&&(et=$e.students),console.log(`Found ${et.length} students`);let lt=et;lt=lt.filter(Oe=>{const Nt=Oe.studentDetails?.academicYear||Oe.studentDetails?.academic?.academicYear||Oe.academicYear||Oe.academicInfo?.academicYear;return Nt?String(Nt).trim()===String(n).trim():!0}),d!=="ALL"&&(lt=lt.filter(Oe=>{const Nt=Oe.academicInfo?.class||Oe.studentDetails?.academic?.currentClass||Oe.studentDetails?.currentClass||Oe.studentDetails?.class||Oe.class;return String(Nt).trim()===String(d).trim()})),m!=="ALL"&&(lt=lt.filter(Oe=>{const Nt=Oe.academicInfo?.section||Oe.studentDetails?.academic?.currentSection||Oe.studentDetails?.currentSection||Oe.studentDetails?.section||Oe.section;return String(Nt).trim().toUpperCase()===String(m).trim().toUpperCase()}));const rt=new Map;lt.forEach(Oe=>{const Nt=Oe.academicInfo?.class||Oe.studentDetails?.academic?.currentClass||Oe.studentDetails?.currentClass||Oe.studentDetails?.class||Oe.class||"Unknown",Mt=Oe.academicInfo?.section||Oe.studentDetails?.academic?.currentSection||Oe.studentDetails?.currentSection||Oe.studentDetails?.section||Oe.section||"Not Assigned";rt.has(Nt)||rt.set(Nt,{className:Nt,sections:new Map,total:0});const rr=rt.get(Nt);rr.total++,rr.sections.has(Mt)||rr.sections.set(Mt,{count:0,students:[]});const Ft=rr.sections.get(Mt);Ft.count++,Ft.students.push(Oe)}),console.log(" Fetching attendance and results stats for each class-section...");const Lt=Array.from(rt.values()).map(async Oe=>{const Nt=await Promise.all(Array.from(Oe.sections.entries()).map(async([Mt,rr])=>{let Ft=0,cr=0;try{const or={class:Oe.className,section:Mt,academicYear:n};console.log(` Fetching attendance for Class ${Oe.className} Section ${Mt}:`,or),Ft=(await zt.get("/attendance/stats",{params:or})).data?.averageAttendance||0,console.log(` Class ${Oe.className} Section ${Mt}: ${Ft}% attendance`)}catch(or){console.error(` Error fetching attendance for ${Oe.className}-${Mt}:`,or)}try{const or={class:Oe.className,section:Mt,academicYear:n};cr=(await zt.get("/results/stats",{params:or})).data?.averagePercentage||0,console.log(` Class ${Oe.className} Section ${Mt}: ${cr}% marks`)}catch(or){console.error(` Error fetching results for ${Oe.className}-${Mt}:`,or)}return{name:Mt,count:rr.count,avgMarks:cr,avgAttendance:Ft}}));return{className:Oe.className,sections:Nt,total:Oe.total}}),kt=await Promise.all(Lt);console.log("Formatted class-wise data with stats:",kt),$(kt),O(null)}catch(Ie){console.error(" Error fetching class data:",{message:Ie.message,response:Ie.response?.data,stack:Ie.stack}),O("Failed to load class distribution data"),$([])}},[n,d,m,e?.schoolCode]),ne=j.useCallback(async()=>{try{y(!0),F(!0),O(null),console.log("Fetching school summary with params:",{class:d,section:m});const Ie=localStorage.getItem("erp.auth"),je=Ie?JSON.parse(Ie).token:null,oe=e?.schoolCode;if(!je||!oe){O("Authentication required"),y(!1),F(!1);return}const $e=await pa.getAllUsers(oe,je);let et=[];$e.data&&Array.isArray($e.data)?et=$e.data.filter(Oe=>Oe.role==="student"):$e.students&&Array.isArray($e.students)&&(et=$e.students);let lt=et;lt=lt.filter(Oe=>{const Nt=Oe.studentDetails?.academicYear||Oe.studentDetails?.academic?.academicYear||Oe.academicYear||Oe.academicInfo?.academicYear;return Nt?String(Nt).trim()===String(n).trim():!0}),d!=="ALL"&&(lt=lt.filter(Oe=>{const Nt=Oe.academicInfo?.class||Oe.studentDetails?.academic?.currentClass||Oe.studentDetails?.currentClass||Oe.studentDetails?.class||Oe.class;return String(Nt).trim()===String(d).trim()})),m!=="ALL"&&(lt=lt.filter(Oe=>{const Nt=Oe.academicInfo?.section||Oe.studentDetails?.academic?.currentSection||Oe.studentDetails?.currentSection||Oe.studentDetails?.section||Oe.section;return String(Nt).trim().toUpperCase()===String(m).trim().toUpperCase()}));const rt=lt.length;let Lt=0;try{const Oe={academicYear:n};d!=="ALL"&&(Oe.class=d),m!=="ALL"&&(Oe.section=m),console.log(" Fetching overall attendance stats:",Oe),Lt=(await zt.get("/attendance/stats",{params:Oe})).data?.averageAttendance||0,console.log(" Overall attendance:",Lt)}catch(Oe){console.error(" Error fetching overall attendance:",Oe)}let kt=0;try{const Oe={academicYear:n};d!=="ALL"&&(Oe.class=d),m!=="ALL"&&(Oe.section=m),console.log(" Fetching overall results stats:",Oe),kt=(await zt.get("/results/stats",{params:Oe})).data?.averagePercentage||0,console.log(" Overall average marks:",kt)}catch(Oe){console.error(" Error fetching overall results:",Oe)}C({totalStudents:rt,avgAttendance:Lt,avgMarks:kt,classWiseDues:[]}),console.log("Updated summary state:",{totalStudents:rt,avgAttendance:Lt,avgMarks:kt})}catch(Ie){console.error("Error in fetchSchoolSummary:",Ie),O("Failed to load school summary data. Please check the console for details.")}finally{y(!1),F(!1)}},[n,d,m,e?.schoolCode]),Te=j.useCallback(async(Ie,je)=>{const oe=`${n}-${Ie}-${je}`;if(!X.has(oe))try{ee(et=>new Set(et).add(oe)),console.log(` Fetching students with stats for class ${Ie}, section: ${je}, academicYear: ${n}`);const $e=await p4({className:Ie,section:je,academicYear:n});$e.success&&$e.students?(console.log(` Fetched ${$e.students.length} students with stats for ${Ie}-${je}`),me(et=>new Map(et).set(oe,$e.students))):(console.warn(` No students found for ${Ie}-${je}`),me(et=>new Map(et).set(oe,[])))}catch($e){console.error(` Error fetching students for ${Ie}-${je}:`,$e),me(et=>new Map(et).set(oe,[]))}finally{ee($e=>{const et=new Set($e);return et.delete(oe),et})}},[X,n]),ve=j.useCallback((Ie,je)=>{const oe=`${n}-${Ie}-${je}`;G($e=>{const et=new Set($e);return et.has(oe)?et.delete(oe):(et.add(oe),Te(Ie,je)),et})},[Te,n]),We=j.useCallback(async()=>{try{const Ie=[];Ie.push("Class,Section,Students,Avg. Marks (%),Avg. Attendance (%)");for(const lt of R)for(const rt of lt.sections){Ie.push(`Class ${lt.className},${rt.name},${rt.count},${rt.avgMarks?.toFixed(1)||"N/A"},${rt.avgAttendance?.toFixed(1)||"N/A"}`);const Lt=`${n}-${lt.className}-${rt.name}`;let kt=X.get(Lt);if(!kt)try{const Oe=await p4({className:lt.className,section:rt.name,academicYear:n});Oe.success&&Oe.students?kt=Oe.students:kt=[]}catch(Oe){console.error("Error fetching students for export:",Oe),kt=[]}kt&&kt.length>0&&(Ie.push("Student Details"),Ie.push("Student Name,Avg. Marks (%),Avg. Attendance (%)"),kt.forEach(Oe=>{Ie.push(`"${Oe.studentName}",${Oe.avgMarks>0?Oe.avgMarks.toFixed(1):"N/A"},${Oe.avgAttendance>0?Oe.avgAttendance.toFixed(1):"N/A"}`)})),Ie.push("")}const je=Ie.join(`
`),oe=new Blob([je],{type:"text/csv;charset=utf-8;"}),$e=document.createElement("a"),et=URL.createObjectURL(oe);$e.setAttribute("href",et),$e.setAttribute("download",`school_report_detailed_${new Date().toISOString().split("T")[0]}.csv`),$e.style.visibility="hidden",document.body.appendChild($e),$e.click(),document.body.removeChild($e)}catch(Ie){console.error("Error exporting data:",Ie),O("Failed to export data")}},[R,X]);return j.useEffect(()=>{T==="dues"?re():T==="overview"&&(ne(),ie())},[T,re,ne,ie]),j.useEffect(()=>{console.log(" Filters changed, clearing student details cache"),me(new Map),G(new Set)},[n,d,m]),j.useEffect(()=>{T==="dues"&&te(Ie=>({...Ie,page:1}))},[d,m,fe,he,T]),r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(z2,{className:"h-8 w-8 text-blue-600"}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"School Reports"})]})}),r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[E&&r.jsxs("div",{className:"flex-1 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg flex items-center",children:[r.jsx(sa,{className:"h-5 w-5 mr-2"}),E]}),T==="overview"&&r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:We,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 flex items-center whitespace-nowrap",disabled:R.length===0,children:[r.jsx(Ci,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),r.jsx("button",{onClick:ne,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center whitespace-nowrap",disabled:P,children:P?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Stats"]})})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"-mb-px flex space-x-8 px-6",children:[r.jsx("button",{onClick:()=>A("overview"),className:`py-4 px-1 border-b-2 font-medium text-sm ${T==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Overview"}),r.jsx("button",{onClick:()=>A("dues"),className:`py-4 px-1 border-b-2 font-medium text-sm ${T==="dues"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Dues List"})]})}),r.jsxs("div",{className:"p-6",children:[a&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-4 mb-6",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:" Viewing Historical Data:"})," You are viewing data from ",n,". This data is read-only."]})}),r.jsx("div",{className:"mb-6",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[r.jsxs("div",{className:"flex flex-col md:col-span-1",children:[r.jsx("label",{htmlFor:"year-select",className:"text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),r.jsx("select",{id:"year-select",value:n,onChange:Ie=>s(Ie.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:i.map(Ie=>r.jsxs("option",{value:Ie,children:[Ie," ",Ie===t&&"(Current)"]},Ie))})]}),r.jsx("div",{className:"md:col-span-2 lg:col-span-4",children:r.jsx(bj,{schoolId:e?.schoolId,valueClass:d,valueSection:m,onClassChange:u,onSectionChange:p})})]})}),T==="overview"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Total Students"}),r.jsx("p",{className:"mt-2 text-3xl font-bold text-blue-600",children:P?r.jsx("span",{className:"inline-block h-8 w-16 bg-gray-200 rounded animate-pulse"}):I.totalStudents.toLocaleString()})]}),r.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:r.jsx($n,{className:"h-6 w-6 text-blue-600"})})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Avg. Attendance"}),r.jsx("p",{className:"mt-2 text-3xl font-bold text-green-600",children:P?r.jsx("span",{className:"inline-block h-8 w-16 bg-gray-200 rounded animate-pulse"}):`${I.avgAttendance.toFixed(1)}%`})]}),r.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:r.jsx(_s,{className:"h-6 w-6 text-green-600"})})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Avg. Marks"}),r.jsx("p",{className:"mt-2 text-3xl font-bold text-yellow-600",children:P?r.jsx("span",{className:"inline-block h-8 w-16 bg-gray-200 rounded animate-pulse"}):`${I.avgMarks.toFixed(1)}%`}),r.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"current term"})]}),r.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:r.jsx(z2,{className:"h-6 w-6 text-yellow-600"})})]})})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow mt-6",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Students by Class & Section"})}),r.jsx("div",{className:"overflow-x-auto",children:w?r.jsx("div",{className:"p-6 space-y-4",children:[1,2,3].map(Ie=>r.jsx("div",{className:"h-16 bg-gray-100 rounded animate-pulse"},Ie))}):R.length>0?r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Section"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Students"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg. Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg. Attendance"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R.map((Ie,je)=>r.jsx(xe.Fragment,{children:Ie.sections.map((oe,$e)=>{const et=`${n}-${Ie.className}-${oe.name}`,lt=L.has(et),rt=X.get(et)||[],Lt=se.has(et);return r.jsxs(xe.Fragment,{children:[r.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>ve(Ie.className,oe.name),children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[lt?r.jsx(L6,{className:"h-4 w-4 text-gray-500 mr-2"}):r.jsx(Gs,{className:"h-4 w-4 text-gray-500 mr-2"}),r.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Class ",Ie.className]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:oe.name||"All Sections"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-sm font-medium text-gray-900",children:oe.count.toLocaleString()}),$e===0&&Ie.sections.length>1&&r.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(Total: ",Ie.total,")"]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:"text-sm text-gray-900",children:oe.avgMarks!==void 0?`${oe.avgMarks.toFixed(1)}%`:"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:"text-sm text-gray-900",children:oe.avgAttendance!==void 0?`${oe.avgAttendance.toFixed(1)}%`:"N/A"})})]}),lt&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-4 bg-gray-50",children:Lt?r.jsxs("div",{className:"flex justify-center items-center py-4",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),r.jsx("span",{className:"ml-3 text-gray-600",children:"Loading students..."})]}):rt.length>0?r.jsxs("div",{className:"space-y-2",children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Student Details"}),console.log(" [ReportsPage] Displaying students:",rt),r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-100",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Student Name"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Avg. Marks"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Avg. Attendance"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:rt.map(kt=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:kt.studentName}),r.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:kt.avgMarks!==void 0&&kt.avgMarks!==null?`${Number(kt.avgMarks).toFixed(1)}%`:"N/A"}),r.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:kt.avgAttendance!==void 0&&kt.avgAttendance!==null?`${Number(kt.avgAttendance).toFixed(1)}%`:"N/A"})]},kt.studentId))})]})]}):r.jsx("div",{className:"text-center py-4 text-gray-500",children:"No student data available"})})})]},et)})},`${Ie.className}-${je}`))})]}):r.jsx("div",{className:"p-6 text-center text-gray-500",children:"No class/section data available"})})]})]}),T==="dues"&&r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex justify-end",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsxs("button",{onClick:be,disabled:Q,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(Ci,{className:"h-4 w-4 mr-2"}),Q?"Exporting...":"Export to CSV"]}),r.jsx("button",{onClick:re,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:Q,children:Q?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Outstanding Dues"}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(va,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{type:"text",placeholder:"Search students...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:fe,onChange:Ie=>Le(Ie.target.value)})]}),r.jsxs("select",{className:"block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",value:he,onChange:Ie=>K(Ie.target.value),children:[r.jsx("option",{value:"ALL",children:"All Status"}),r.jsx("option",{value:"PENDING",children:"Pending"}),r.jsx("option",{value:"PAID",children:"Paid"}),r.jsx("option",{value:"OVERDUE",children:"Overdue"}),r.jsx("option",{value:"PARTIAL",children:"Partial"})]})]})]}),r.jsxs("div",{className:"overflow-x-auto",children:[r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class / Section"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paid"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pending"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Q?r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-6 py-4 text-center",children:r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})})})}):W.length>0?W.map(Ie=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"flex items-center",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ie.studentName}),Ie.rollNumber&&r.jsx("div",{className:"text-sm text-gray-500",children:Ie.rollNumber})]})})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-sm text-gray-900",children:Ie.studentClass}),r.jsxs("div",{className:"text-sm text-gray-500",children:["Sec: ",Ie.studentSection]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Qb(Ie.totalAmount)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:Qb(Ie.totalPaid)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 font-medium",children:Qb(Ie.totalPending)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx(uQ,{status:Ie.status.toLowerCase()})})]},Ie.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No dues records found"})})})]}),r.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[r.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[r.jsx("button",{onClick:()=>te({...H,page:Math.max(1,H.page-1)}),disabled:H.page===1,className:`relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${H.page===1?"bg-gray-100 text-gray-400":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Previous"}),r.jsx("button",{onClick:()=>te({...H,page:Math.min(H.pages,H.page+1)}),disabled:H.page>=H.pages,className:`ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${H.page>=H.pages?"bg-gray-100 text-gray-400":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Next"})]}),r.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[r.jsx("div",{children:r.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",r.jsx("span",{className:"font-medium",children:(H.page-1)*H.limit+1})," to"," ",r.jsx("span",{className:"font-medium",children:Math.min(H.page*H.limit,H.total)})," ","of ",r.jsx("span",{className:"font-medium",children:H.total})," results"]})}),r.jsx("div",{children:r.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[r.jsxs("button",{onClick:()=>te({...H,page:Math.max(1,H.page-1)}),disabled:H.page===1,className:`relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${H.page===1?"text-gray-300":"text-gray-500 hover:bg-gray-50"}`,children:[r.jsx("span",{className:"sr-only",children:"Previous"}),""]}),Array.from({length:Math.min(5,H.pages)},(Ie,je)=>{let oe;return H.pages<=5||H.page<=3?oe=je+1:H.page>=H.pages-2?oe=H.pages-4+je:oe=H.page-2+je,r.jsx("button",{onClick:()=>te({...H,page:oe}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${H.page===oe?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:oe},oe)}),r.jsxs("button",{onClick:()=>te({...H,page:Math.min(H.pages,H.page+1)}),disabled:H.page>=H.pages,className:`relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${H.page>=H.pages?"text-gray-300":"text-gray-500 hover:bg-gray-50"}`,children:[r.jsx("span",{className:"sr-only",children:"Next"}),""]})]})})]})]})]})]})]})]})]})]})},hQ=()=>{const{user:e,token:t}=yr(),[n,a]=j.useState([]),[s,i]=j.useState([]),[l,d]=j.useState(!0),[u,m]=j.useState("all"),[p,f]=j.useState(""),[g,N]=j.useState(null),[v,w]=j.useState(!1),[y,E]=j.useState(""),[O,T]=j.useState(!1),A=()=>t||localStorage.getItem("token");j.useEffect(()=>{I()},[]);const I=async()=>{d(!0);try{const L=A();if(console.log(" Token exists:",!!L),console.log(" Token length:",L?.length||0),console.log(" User:",e?.userId,e?.role),console.log(" School Code:",e?.schoolCode),!L){console.error(" No authentication token found"),ge.error("Authentication required. Please log in again."),d(!1);return}console.log(" Fetching leave requests from backend...");const G=await zt.get("/leave-requests/admin/all");console.log(" Response status:",G.status);const X=G.data;if(console.log(" Leave requests API response:",X),console.log(" Number of requests:",X.data?.leaveRequests?.length||0),X.success&&X.data?.leaveRequests){const me=X.data.leaveRequests.map(se=>{const ee=new Date(se.startDate),W=new Date(se.endDate),U=Math.ceil((W.getTime()-ee.getTime())/(1e3*60*60*24))+1;return{_id:se._id,teacherId:se.teacherUserId||se.teacherId?._id||se.teacherId||"N/A",teacherName:se.teacherName||se.teacherId?.name?.displayName||"Unknown",teacherEmail:se.teacherEmail||se.teacherId?.email||"N/A",leaveType:se.leaveType||"other",subject:se.subjectLine||"No Subject",startDate:se.startDate,endDate:se.endDate,days:se.numberOfDays||U,reason:se.description||"No description provided",status:se.status,appliedOn:se.createdAt,reviewedBy:se.reviewedByName||se.reviewedBy?.name?.displayName,reviewedOn:se.reviewedAt,reviewComments:se.adminComments}});console.log(" Transformed data:",me),a(me),i(me)}else console.log(" No leave requests found in the database"),a([]),i([])}catch(L){console.error("Error fetching leave requests:",L),ge.error("Failed to load leave requests")}finally{d(!1)}};j.useEffect(()=>{let L=n;u!=="all"&&(L=L.filter(G=>G.status===u)),p&&(L=L.filter(G=>G.teacherName.toLowerCase().includes(p.toLowerCase())||G.teacherEmail.toLowerCase().includes(p.toLowerCase())||G.reason.toLowerCase().includes(p.toLowerCase()))),i(L)},[u,p,n]);const C=async L=>{T(!0);try{if(!A()){ge.error("Authentication required");return}(await zt.put(`/leave-requests/admin/${L}/status`,{status:"approved",adminComments:y||"Approved"})).data.success&&(ge.success("Leave request approved successfully"),w(!1),N(null),E(""),await I())}catch(G){console.error("Error approving leave request:",G),ge.error("Failed to approve leave request")}finally{T(!1)}},P=async L=>{T(!0);try{if(!A()){ge.error("Authentication required");return}(await zt.put(`/leave-requests/admin/${L}/status`,{status:"rejected",adminComments:y||"Rejected"})).data.success&&(ge.success("Leave request rejected"),w(!1),N(null),E(""),await I())}catch(G){console.error("Error rejecting leave request:",G),ge.error("Failed to reject leave request")}finally{T(!1)}},F=L=>{N(L),E(L.reviewComments||""),w(!0)},R=L=>{switch(L){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},$=L=>new Date(L).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return l?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):r.jsxs("div",{className:"p-4 sm:p-6 max-w-7xl mx-auto space-y-4 sm:space-y-6",children:[r.jsxs("div",{className:"mb-4 sm:mb-6",children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"Leave Management"}),r.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Review and manage teacher leave requests"})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[r.jsx("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Requests"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:n.length})]}),r.jsx(an,{className:"h-6 w-6 sm:h-8 sm:w-8 text-gray-400"})]})}),r.jsx("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Pending"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-yellow-600",children:n.filter(L=>L.status==="pending").length})]}),r.jsx(bs,{className:"h-6 w-6 sm:h-8 sm:w-8 text-yellow-400"})]})}),r.jsx("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Approved"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-green-600",children:n.filter(L=>L.status==="approved").length})]}),r.jsx(Ld,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-400"})]})}),r.jsx("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Rejected"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-red-600",children:n.filter(L=>L.status==="rejected").length})]}),r.jsx(Ur,{className:"h-6 w-6 sm:h-8 sm:w-8 text-red-400"})]})})]}),r.jsx("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow-sm border border-gray-200 mb-4 sm:mb-6",children:r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 sm:h-5 sm:w-5 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search by teacher name, email, or reason...",value:p,onChange:L=>f(L.target.value),className:"w-full pl-9 sm:pl-10 pr-4 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),r.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[r.jsx(ew,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-400 flex-shrink-0"}),r.jsxs("select",{value:u,onChange:L=>m(L.target.value),className:"flex-1 sm:flex-initial px-3 sm:px-4 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:s.length===0?r.jsxs("div",{className:"px-6 py-8 text-center text-gray-500",children:[r.jsx(an,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"No leave requests found"}),r.jsx("p",{className:"text-gray-600",children:"No leave requests match your current filters."})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden lg:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Applied On"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(L=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx(Ed,{className:"h-5 w-5 text-blue-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:L.teacherName}),r.jsx("div",{className:"text-sm text-gray-500",children:L.teacherId})]})]})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:[$(L.startDate)," - ",$(L.endDate)]}),r.jsxs("div",{className:"text-sm text-gray-500",children:[L.days," day",L.days>1?"s":""]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:$(L.appliedOn)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${R(L.status)}`,children:L.status.charAt(0).toUpperCase()+L.status.slice(1)})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("button",{onClick:()=>F(L),className:"text-blue-600 hover:text-blue-900 flex items-center gap-1",children:[r.jsx(Pn,{className:"h-4 w-4"}),"View Details"]})})]},L._id))})]})}),r.jsx("div",{className:"lg:hidden divide-y divide-gray-200",children:s.map(L=>r.jsxs("div",{className:"p-4 space-y-3",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx(Ed,{className:"h-5 w-5 text-blue-600"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:L.teacherName}),r.jsx("div",{className:"text-xs text-gray-500 truncate",children:L.teacherId})]}),r.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${R(L.status)}`,children:L.status.charAt(0).toUpperCase()+L.status.slice(1)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Subject:"}),r.jsx("span",{className:"text-gray-900 font-medium truncate ml-2",children:L.subject})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Duration:"}),r.jsxs("span",{className:"text-gray-900",children:[L.days," day",L.days>1?"s":""]})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Period:"}),r.jsxs("span",{className:"text-gray-900 text-right",children:[$(L.startDate)," - ",$(L.endDate)]})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Applied:"}),r.jsx("span",{className:"text-gray-900",children:$(L.appliedOn)})]})]}),r.jsx("div",{className:"pt-2",children:r.jsxs("button",{onClick:()=>F(L),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors",children:[r.jsx(Pn,{className:"h-4 w-4"}),"View Details"]})})]},L._id))})]})}),v&&g&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto mx-4",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Leave Request Details"}),r.jsx("button",{onClick:()=>{w(!1),N(null),E("")},className:"text-gray-400 hover:text-gray-600",children:r.jsx(Ur,{className:"h-6 w-6"})})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Teacher Information"}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsxs("div",{className:"flex items-center mb-2",children:[r.jsx(Ed,{className:"h-5 w-5 text-gray-400 mr-2"}),r.jsx("span",{className:"font-medium text-gray-900",children:g.teacherName})]}),r.jsx("p",{className:"text-sm text-gray-600",children:g.teacherEmail}),r.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",g.teacherId]})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Leave Details"}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-3",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-600 block mb-1",children:"Subject:"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:g.subject})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-600 block mb-1",children:"Description:"}),r.jsx("p",{className:"text-sm text-gray-700",children:g.reason})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Start Date:"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:$(g.startDate)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"End Date:"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:$(g.endDate)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Duration:"}),r.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[g.days," day",g.days>1?"s":""]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),r.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${R(g.status)}`,children:g.status.charAt(0).toUpperCase()+g.status.slice(1)})]})]})]}),g.status!=="pending"&&r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Review Information"}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Reviewed By:"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:g.reviewedBy})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Reviewed On:"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:g.reviewedOn&&$(g.reviewedOn)})]}),g.reviewComments&&r.jsxs("div",{children:[r.jsx("span",{className:"text-sm text-gray-600 block mb-1",children:"Comments:"}),r.jsx("p",{className:"text-sm text-gray-700",children:g.reviewComments})]})]})]}),g.status==="pending"&&r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[r.jsxs("button",{onClick:()=>C(g._id),disabled:O,className:"flex-1 bg-green-600 text-white px-4 py-3 sm:py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm sm:text-base",children:[r.jsx(Ld,{className:"h-5 w-5"}),O?"Processing...":"Approve"]}),r.jsxs("button",{onClick:()=>P(g._id),disabled:O,className:"flex-1 bg-red-600 text-white px-4 py-3 sm:py-2 rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm sm:text-base",children:[r.jsx(Ur,{className:"h-5 w-5"}),O?"Processing...":"Reject"]})]})]})})})]})};class ev extends xe.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("Error Boundary caught an error:",t,n)}render(){return this.state.hasError?this.props.fallback||r.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:r.jsx("div",{className:"max-w-4xl mx-auto",children:r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong with the component"}),r.jsxs("details",{className:"text-sm text-red-700",children:[r.jsx("summary",{className:"cursor-pointer",children:"Error Details"}),r.jsxs("pre",{className:"mt-2 whitespace-pre-wrap",children:[this.state.error?.toString(),`
`,this.state.error?.stack]})]})]})})}):this.props.children}}const Yn=({permission:e,permissionName:t,children:n})=>{const{hasPermission:a,showPermissionDenied:s,setShowPermissionDenied:i,deniedPermissionName:l,setDeniedPermissionName:d,loading:u,permissions:m}=iw(),p=il(),[f,g]=xe.useState(!1);xe.useEffect(()=>{!u&&!f&&e&&(g(!0),a(e)||(i(!0),d(t)))},[u,f,e,t,a,i,d]),xe.useEffect(()=>{g(!1)},[e]);const N=()=>{i(!1),p("/admin")};return e?u?r.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:r.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),r.jsx("p",{className:"text-sm text-gray-600",children:"Loading permissions..."})]})}):a(e)?r.jsx(r.Fragment,{children:n}):r.jsxs(r.Fragment,{children:[r.jsx(ow,{isOpen:s,onClose:N,permissionName:l||t}),r.jsx("div",{className:"flex items-center justify-center min-h-[400px] bg-gray-50",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-yellow-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m0 0v2m0-2h2m-2 0H9m6-6a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Restricted"}),r.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["You don't have permission to access ",r.jsx("strong",{children:t})]}),r.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Please use the navigation menu on the left to access other sections"}),r.jsx("button",{onClick:()=>p("/admin"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Go to Dashboard"})]})})]}):r.jsx(r.Fragment,{children:n})};function fQ(){return r.jsx(fP,{children:r.jsx(t5,{children:r.jsx(IR,{children:r.jsxs(O4,{children:[r.jsx(Lr,{index:!0,element:r.jsx(EZ,{})}),r.jsx(Lr,{path:"users",element:r.jsx(Yn,{permission:"manageUsers",permissionName:"User Management",children:r.jsx(o4,{})})}),r.jsx(Lr,{path:"manage-users",element:r.jsx(Yn,{permission:"manageUsers",permissionName:"User Management",children:r.jsx(o4,{})})}),r.jsx(Lr,{path:"settings",element:r.jsx(Yn,{permission:"manageSchoolSettings",permissionName:"School Settings",children:r.jsx(h4,{})})}),r.jsx(Lr,{path:"school-settings",element:r.jsx(Yn,{permission:"manageSchoolSettings",permissionName:"School Settings",children:r.jsx(h4,{})})}),r.jsx(Lr,{path:"settings/idcard-templates",element:r.jsx(Yn,{permission:"manageSchoolSettings",permissionName:"ID Card Templates",children:r.jsx(zZ,{})})}),r.jsx(Lr,{path:"academic-details",element:r.jsx(Yn,{permission:"viewAcademicDetails",permissionName:"Academic Details",children:r.jsx(ev,{children:r.jsx(UZ,{})})})}),r.jsx(Lr,{path:"attendance",element:r.jsx(Yn,{permission:"viewAttendance",permissionName:"Attendance",children:r.jsx(Zb,{})})}),r.jsx(Lr,{path:"attendance/mark",element:r.jsx(Yn,{permission:"viewAttendance",permissionName:"Mark Attendance",children:r.jsx(Zb,{})})}),r.jsx(Lr,{path:"attendance/view",element:r.jsx(Yn,{permission:"viewAttendance",permissionName:"View Attendance",children:r.jsx(Zb,{})})}),r.jsx(Lr,{path:"assignments",element:r.jsx(Yn,{permission:"viewAssignments",permissionName:"Assignments",children:r.jsx(ev,{children:r.jsx(KZ,{})})})}),r.jsx(Lr,{path:"results",element:r.jsx(Yn,{permission:"viewResults",permissionName:"Results",children:r.jsx(GZ,{})})}),r.jsx(Lr,{path:"results/entry",element:r.jsx(Yn,{permission:"viewResults",permissionName:"Results Entry",children:r.jsx(ev,{children:r.jsx(JZ,{})})})}),r.jsx(Lr,{path:"messages",element:r.jsx(Yn,{permission:"messageStudentsParents",permissionName:"Messages",children:r.jsx(rQ,{})})}),r.jsx(Lr,{path:"leave-management",element:r.jsx(Yn,{permission:"viewLeaves",permissionName:"Leave Management",children:r.jsx(hQ,{})})}),r.jsx(Lr,{path:"fees/structure",element:r.jsx(Yn,{permission:"viewFees",permissionName:"Fee Structure",children:r.jsx(f4,{})})}),r.jsx(Lr,{path:"fees/payments",element:r.jsx(Yn,{permission:"viewFees",permissionName:"Fee Payments",children:r.jsx(f4,{})})}),r.jsx(Lr,{path:"reports",element:r.jsx(Yn,{permission:"viewReports",permissionName:"Reports",children:r.jsx(mQ,{})})}),r.jsx(Lr,{path:"*",element:r.jsx(Vs,{to:"/admin"})})]})})})})}const pQ=({children:e,currentPage:t,onNavigate:n,onLogout:a})=>{const{user:s}=yr(),[i,l]=j.useState(!1),{hasPermission:d,showPermissionDenied:u,setShowPermissionDenied:m,deniedPermissionName:p,checkAndNavigate:f}=iw(),g=()=>{if(!s?.name)return"T";const w=s.name.split(" ");return w.length>=2?(w[0].charAt(0)+w[w.length-1].charAt(0)).toUpperCase():s.name.substring(0,2).toUpperCase()},N=[{name:"Dashboard",icon:tw,page:"dashboard",permission:null},{name:"Attendance",icon:_s,page:"attendance",permission:"viewAttendance"},{name:"Assignments",icon:Pn,page:"assignments",permission:"viewAssignments"},{name:"Results",icon:Q1,page:"view-results",permission:"viewResults"},{name:"Messages",icon:pf,page:"messages",permission:"messageStudentsParents"},{name:"Leave Request",icon:an,page:"leave-request",permission:"viewLeaves"}],v=w=>{w.permission&&!d(w.permission)?f(w.permission,w.name,()=>{n(w.page),l(!1)}):(n(w.page),l(!1))};return r.jsxs("div",{className:"flex h-screen bg-gray-50",children:[i&&r.jsx("div",{className:"fixed inset-0 z-20 bg-black bg-opacity-50 lg:hidden",onClick:()=>l(!1)}),r.jsxs("div",{className:`fixed inset-y-0 left-0 z-30 w-64 bg-white shadow-lg transform ${i?"translate-x-0":"-translate-x-full"} transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0`,children:[r.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-600 rounded-lg mr-3",children:r.jsx(Yo,{className:"h-5 w-5 text-white"})}),r.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"ERP Portal"})]}),r.jsx("button",{onClick:()=>l(!1),className:"lg:hidden p-1 rounded-md hover:bg-gray-100",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"flex flex-col h-full",children:[r.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:N.map(w=>{const y=w.icon;return r.jsxs("button",{onClick:()=>v(w),className:`w-full flex items-center px-3 py-2.5 text-sm font-medium rounded-lg transition-colors ${t===w.page?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx(y,{className:"h-5 w-5 mr-3"}),w.name]},w.name)})}),r.jsx("div",{className:"px-4 py-6 border-t border-gray-200",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center mr-3",children:r.jsx("span",{className:"text-white font-bold text-sm",children:g()})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:s?.name||"Teacher"}),r.jsx("p",{className:"text-xs text-gray-500",children:s?.userId||s?.email})]})]})})]})]}),r.jsx(ow,{isOpen:u,onClose:()=>m(!1),permissionName:p}),r.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[r.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 lg:hidden",children:r.jsxs("div",{className:"flex items-center justify-between h-16 px-4",children:[r.jsx("button",{onClick:()=>l(!0),className:"p-2 rounded-md text-gray-600 hover:bg-gray-100",children:r.jsx(L4,{className:"h-6 w-6"})}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900 capitalize",children:t.replace("-"," ")}),r.jsx("div",{className:"w-10"})]})}),r.jsx("main",{className:"flex-1 overflow-auto p-4 lg:p-6",children:e})]})]})},gQ=()=>{const{currentAcademicYear:e,academicYearStart:t,academicYearEnd:n,loading:a,error:s}=pn();if(a)return r.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl p-6 text-white shadow-lg",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"animate-spin h-6 w-6 border-3 border-white border-t-transparent rounded-full"}),r.jsx("span",{className:"text-sm",children:"Loading Academic Year..."})]})});if(s)return r.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-xl p-6 text-white shadow-lg",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(sa,{className:"h-6 w-6 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-sm",children:"Error Loading Academic Year"}),r.jsx("p",{className:"text-xs opacity-90 mt-1",children:s})]})]})});const i=l=>l?new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A";return r.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl p-6 text-white shadow-lg border-2 border-indigo-400",children:[r.jsx("div",{className:"flex items-start justify-between mb-4",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"bg-white bg-opacity-20 p-3 rounded-lg",children:r.jsx(an,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-sm font-medium opacity-90 flex items-center gap-2",children:["Current Academic Year",r.jsx("span",{title:"Read-only - Set by Admin",children:r.jsx(Fd,{className:"h-3.5 w-3.5"})})]}),r.jsx("p",{className:"text-2xl font-bold mt-1",children:e})]})]})}),r.jsx("div",{className:"bg-white bg-opacity-10 rounded-lg p-3 backdrop-blur-sm",children:r.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{children:[r.jsx("p",{className:"opacity-80 text-xs mb-1",children:"Start Date"}),r.jsx("p",{className:"font-semibold",children:i(t)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"opacity-80 text-xs mb-1",children:"End Date"}),r.jsx("p",{className:"font-semibold",children:i(n)})]})]})}),r.jsxs("div",{className:"mt-4 flex items-center space-x-2 text-xs opacity-80",children:[r.jsx(Fd,{className:"h-3.5 w-3.5"}),r.jsx("span",{children:"This academic year is set by your school admin and cannot be changed"})]})]})},g4=({onNavigate:e})=>{const{user:t,token:n}=yr(),{currentAcademicYear:a}=pn(),[s,i]=j.useState(!0),[l,d]=j.useState({totalAssignments:0,activeAssignments:0,leaveRequests:{total:0,pending:0,approved:0},todayAttendance:{marked:!1,classesCount:0}}),[u,m]=j.useState([]),[p,f]=j.useState([]),[g,N]=j.useState(null);j.useEffect(()=>{a&&v(a)},[n,a]);const v=async E=>{i(!0);try{console.log(` Fetching dashboard data for academic year: ${E}`);let O={assignments:[]};try{O=(await ot.get(`/assignments?limit=1000&page=1&academicYear=${E}`)).data,console.log(" Assignments data (all school, current year):",O)}catch(G){console.warn(" Assignments API failed:",G)}let T={requests:[]};try{T=(await ot.get("/leave-requests/teacher/my-requests")).data,console.log(" Leave requests data:",T)}catch(G){console.warn(" Leave requests API failed:",G)}let A={messages:[]};try{A=(await ot.get("/messages/teacher/messages?limit=1")).data,console.log(" Messages data:",A);const X=A.messages||A.data||[];X.length>0&&(N(X[0]),console.log(" Latest message stored:",X[0]))}catch(G){console.warn(" Messages API failed:",G)}const I=O.assignments||[],C=T.data?.leaveRequests||[];console.log(" Extracted assignments:",I.length),console.log(" Extracted leave requests:",C.length),m(I.slice(0,4)),f(C);const P=I.length,F=I.filter(G=>{const X=new Date(G.dueDate),me=new Date;return me.setHours(0,0,0,0),X>=me}).length,R=C.length,$=C.filter(G=>G.status==="pending").length,L=C.filter(G=>G.status==="approved").length;console.log(" Calculated stats:",{totalAssignments:P,activeAssignments:F,totalLeaves:R,pendingLeaves:$,approvedLeaves:L}),d({totalAssignments:P,activeAssignments:F,leaveRequests:{total:R,pending:$,approved:L},todayAttendance:{marked:!1,classesCount:0}})}catch(O){console.error(" Error fetching dashboard data:",O)}finally{i(!1)}},w=[{name:"Total Assignments",value:l.totalAssignments.toString(),icon:xs,color:"bg-blue-500",change:"(All Classes, This Year)",onClick:()=>e("assignments")},{name:"Leave Requests",value:l.leaveRequests.total.toString(),icon:an,color:"bg-green-500",change:`${l.leaveRequests.pending} pending`,onClick:()=>e("leave-request")},{name:"Approved Leaves",value:l.leaveRequests.approved.toString(),icon:ba,color:"bg-emerald-500",change:"This year",onClick:()=>e("leave-request")},{name:"Attendance",value:l.todayAttendance.marked?"Marked":"Pending",icon:_s,color:l.todayAttendance.marked?"bg-green-500":"bg-orange-500",change:"Today",onClick:()=>e("attendance")}],y=E=>{const O=new Date(E),T=new Date,A=O.getTime()-T.getTime(),I=Math.ceil(A/(1e3*60*60*24));return I<0?{text:"Overdue",color:"text-red-600",bgColor:"bg-red-50"}:I===0?{text:"Due Today",color:"text-orange-600",bgColor:"bg-orange-50"}:I===1?{text:"Due Tomorrow",color:"text-yellow-600",bgColor:"bg-yellow-50"}:{text:`${I} days left`,color:"text-blue-600",bgColor:"bg-blue-50"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-xl p-6 text-white",children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold mb-2",children:["Welcome back, ",t?.name||"Teacher","!"]}),r.jsxs("p",{className:"text-blue-100 mb-4 sm:mb-0",children:[t?.userId&&`ID: ${t.userId}  `,t?.schoolCode&&`School: ${t.schoolCode}`]})]}),r.jsxs("div",{className:"flex items-center bg-white bg-opacity-20 rounded-lg px-4 py-2",children:[r.jsx(bs,{className:"h-5 w-5 mr-2"}),r.jsx("span",{className:"font-medium",children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})})]})]})}),r.jsx(gQ,{}),s?r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(E=>r.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 animate-pulse",children:[r.jsx("div",{className:"h-12 bg-gray-200 rounded mb-4"}),r.jsx("div",{className:"h-8 bg-gray-200 rounded mb-2"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded"})]},E))}):r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:w.map((E,O)=>{const T=E.icon;return r.jsxs("button",{onClick:E.onClick,className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200 hover:scale-105 text-left",children:[r.jsx("div",{className:"flex items-center justify-between mb-4",children:r.jsx("div",{className:`p-2 rounded-lg ${E.color}`,children:r.jsx(T,{className:"h-6 w-6 text-white"})})}),r.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-1",children:E.value}),r.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:E.name}),r.jsx("p",{className:"text-xs text-gray-500",children:E.change})]},O)})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Upcoming Deadlines"}),r.jsx("button",{onClick:()=>e("assignments"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All "})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:u.length===0?r.jsxs("div",{className:"p-8 text-center",children:[r.jsx(xs,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),r.jsx("p",{className:"text-gray-500 text-sm",children:"No assignments yet"}),r.jsx("button",{onClick:()=>e("assignments"),className:"mt-3 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Create your first assignment"})]}):r.jsx("div",{className:"divide-y divide-gray-100",children:u.slice(0,4).map((E,O)=>{const T=y(E.dueDate);return r.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:E.title}),r.jsxs("div",{className:"flex items-center space-x-3 text-xs text-gray-500",children:[r.jsxs("span",{className:"flex items-center",children:[r.jsx(xs,{className:"h-3 w-3 mr-1"}),E.subject]}),r.jsxs("span",{className:"flex items-center",children:[r.jsx($n,{className:"h-3 w-3 mr-1"}),"Class ",E.class,"-",E.section]})]})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T.bgColor} ${T.color}`,children:T.text})]})},O)})})}),r.jsxs("div",{className:"mt-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Messages"}),r.jsx("button",{onClick:()=>e("messages"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All "})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:g?r.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>e("messages"),children:r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:r.jsx("span",{className:"text-white font-semibold text-sm",children:g.senderName?.charAt(0).toUpperCase()||"U"})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:g.senderName||"Unknown Sender"}),r.jsx("span",{className:"text-xs text-gray-500",children:new Date(g.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),r.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:g.subject}),r.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:g.message}),g.recipientType&&r.jsxs("span",{className:"inline-block mt-2 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-full",children:["To: ",g.recipientType]})]})]})}):r.jsxs("div",{className:"p-6 text-center",children:[r.jsx(pf,{className:"h-10 w-10 text-gray-300 mx-auto mb-2"}),r.jsx("p",{className:"text-gray-500 text-xs",children:"No messages yet"}),r.jsx("button",{onClick:()=>e("messages"),className:"mt-2 text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Send a message"})]})})]})]}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Leave Status"}),r.jsxs("div",{className:"space-y-4",children:[l.leaveRequests.pending>0&&r.jsx("div",{className:"bg-yellow-50 rounded-xl p-4 border-2 border-yellow-200",children:r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-yellow-100",children:r.jsx(bs,{className:"h-5 w-5 text-yellow-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("h3",{className:"font-semibold text-yellow-900 text-sm",children:[l.leaveRequests.pending," Pending Leave Request",l.leaveRequests.pending>1?"s":""]}),r.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Awaiting admin approval"}),r.jsx("button",{onClick:()=>e("leave-request"),className:"mt-2 text-xs text-yellow-800 hover:text-yellow-900 font-medium",children:"View Details "})]})]})}),r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[r.jsx("div",{className:"p-4 border-b border-gray-100",children:r.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:"Recent Leave Requests"})}),p.length===0?r.jsxs("div",{className:"p-6 text-center",children:[r.jsx(an,{className:"h-10 w-10 text-gray-300 mx-auto mb-2"}),r.jsx("p",{className:"text-gray-500 text-xs",children:"No leave requests"}),r.jsx("button",{onClick:()=>e("leave-request"),className:"mt-2 text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Apply for leave"})]}):r.jsx("div",{className:"divide-y divide-gray-100",children:p.slice(0,3).map((E,O)=>r.jsx("div",{className:"p-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:E.subjectLine}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(E.startDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})," - ",new Date(E.endDate).toLocaleDateString("en-US",{month:"short",day:"numeric"}),r.jsx("span",{className:"mx-1",children:""}),E.numberOfDays," day",E.numberOfDays>1?"s":""]})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${E.status==="approved"?"bg-green-100 text-green-700":E.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:E.status.charAt(0).toUpperCase()+E.status.slice(1)})]})},O))})]})]})]})]})]})},i5=()=>{const{user:e,token:t}=yr(),{classesData:n,getSectionsByClass:a}=Ea(),{currentAcademicYear:s}=pn(),[i,l]=j.useState(new Date().toISOString().split("T")[0]),[d,u]=j.useState(""),[m,p]=j.useState(""),[f,g]=j.useState("morning"),[N,v]=j.useState([]),[w,y]=j.useState([]),[E,O]=j.useState({}),[T,A]=j.useState(!1),[I,C]=j.useState({isMarked:!1,isFrozen:!1,canModify:!0}),P=n?.classes?.map(ee=>ee.className)||[];j.useEffect(()=>{if(d&&n){const ee=a(d);v(ee)}else v([]),p("")},[d,n,a]),j.useEffect(()=>{(async()=>{if(!d||!m){y([]);return}if(!t||!e?.schoolCode){ge.error("Authentication required");return}A(!0);try{console.log(" Fetching students for:",{class:d,section:m,schoolCode:e.schoolCode,academicYear:s}),console.log(" Filtering by Academic Year:",s);const W=new URLSearchParams({class:d,section:m});s&&W.append("academicYear",s);const Q=(await ot.get(`/users/role/student?${W.toString()}`)).data;console.log(" API Response:",Q);const Y=Q.data||Q||[];console.log(` Total users received from API (already filtered by backend): ${Y.length}`);const H=Y.filter(fe=>{if(fe.role!=="student")return!1;const Le=fe.academicInfo?.class||fe.studentDetails?.academic?.currentClass||fe.studentDetails?.currentClass||fe.studentDetails?.class||fe.class,he=fe.academicInfo?.section||fe.studentDetails?.academic?.currentSection||fe.studentDetails?.currentSection||fe.studentDetails?.section||fe.section,K=!d||String(Le).trim()===String(d).trim(),be=!m||String(he).trim().toUpperCase()===String(m).trim().toUpperCase();return K&&be});console.log(` Students for AY ${s}: ${H.length}`);const te=H.map(fe=>({_id:fe._id,userId:fe.userId,name:fe.name,studentDetails:fe.studentDetails,class:d,section:m}));y(te),O({}),te.length===0&&console.log(" No students found for this class and section")}catch(W){console.error("Error fetching students:",W),ge.error("Failed to load students")}finally{A(!1)}})()},[d,m,t,e?.schoolCode,s]),j.useEffect(()=>{d&&m&&i&&F()},[d,m,i,f]),j.useEffect(()=>{w.length>0&&i&&R()},[w.length,i,f]);const F=async()=>{if(!(!d||!m||!i))try{const ee=await V1({class:d,section:m,date:i,session:f});C({isMarked:ee.isMarked||!1,isFrozen:ee.isFrozen||!1,canModify:ee.canModify!==!1}),ee.isFrozen&&ge.error("This session attendance is frozen and cannot be modified")}catch(ee){console.warn("Could not check session status:",ee),C({isMarked:!1,isFrozen:!1,canModify:!0})}},R=async()=>{if(!(!d||!m||!i))try{const ee=await mp({class:d,section:m,date:i,session:f});if(ee.success&&ee.data&&ee.data.length>0){const W=ee.data.find(U=>U.session===f&&U.dateString===i);if(W&&W.students){const U={};W.students.forEach(Q=>{const Y=w.find(H=>H.userId===Q.studentId);Y&&(U[Y._id]=Q.status)}),O(U),console.log(" Loaded existing attendance:",U)}}}catch(ee){console.warn("Could not load existing attendance:",ee)}},$=(ee,W)=>{if(I.isFrozen){ge.error("Attendance is frozen and cannot be modified");return}O(U=>({...U,[ee]:W}))},L=()=>{if(I.isFrozen){ge.error("Attendance is frozen and cannot be modified");return}const ee={};w.forEach(W=>{ee[W._id]="present"}),O(ee),ge.success("Marked all students as present")},G=()=>{if(I.isFrozen){ge.error("Attendance is frozen and cannot be modified");return}const ee={};w.forEach(W=>{ee[W._id]="absent"}),O(ee),ge.success("Marked all students as absent")},X=async()=>{if(!d||!m||w.length===0){ge.error("Please select class and section first");return}if(I.isFrozen){ge.error("Attendance is frozen and cannot be modified");return}A(!0);try{const ee=w.map(U=>({studentId:U.userId,status:E[U._id]||"present"})),W=await r5({class:d,section:m,date:i,session:f,students:ee});W.success?(ge.success("Attendance saved successfully!"),await F()):ge.error(W.message||"Failed to save attendance")}catch(ee){console.error("Error saving attendance:",ee),ge.error(ee.response?.data?.message||"Failed to save attendance")}finally{A(!1)}},se=(()=>{const ee=Object.values(E),W=ee.filter(Y=>Y==="present").length,U=ee.filter(Y=>Y==="absent").length,Q=w.length;return{present:W,absent:U,total:Q}})();return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Mark Attendance"}),r.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 sm:mt-0",children:[I.isFrozen&&r.jsxs("div",{className:"flex items-center px-3 py-2 bg-yellow-100 text-yellow-800 rounded-lg text-sm font-medium",children:[r.jsx(Fd,{className:"h-4 w-4 mr-2"}),"Attendance Frozen"]}),r.jsxs("button",{onClick:L,disabled:w.length===0||T||I.isFrozen,className:`flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed ${I.isFrozen?"opacity-50":""}`,title:I.isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(ba,{className:"h-4 w-4 mr-2"}),"Mark All Present"]}),r.jsxs("button",{onClick:G,disabled:w.length===0||T||I.isFrozen,className:`flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed ${I.isFrozen?"opacity-50":""}`,title:I.isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(Ii,{className:"h-4 w-4 mr-2"}),"Mark All Absent"]}),r.jsxs("button",{onClick:X,disabled:w.length===0||T||I.isFrozen,className:`flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed ${I.isFrozen?"opacity-50":""}`,title:I.isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(rs,{className:"h-4 w-4 mr-2"}),"Save Attendance"]})]})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),r.jsx("input",{type:"date",value:i,onChange:ee=>l(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),r.jsx("input",{type:"text",value:s||"Loading...",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 font-semibold cursor-not-allowed",title:"Current academic year (set by Admin)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),r.jsxs("select",{value:d,onChange:ee=>{u(ee.target.value),p(""),y([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"Select Class"}),P.map(ee=>r.jsxs("option",{value:ee,children:["Class ",ee]},ee))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),r.jsxs("select",{value:m,onChange:ee=>p(ee.target.value),disabled:!d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",children:[r.jsx("option",{value:"",children:"Select Class First"}),d&&N.map(ee=>r.jsx("option",{value:ee.value,children:ee.label},ee.value))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:()=>g("morning"),className:`flex-1 flex items-center justify-center px-3 py-2 rounded-lg border-2 transition-colors ${f==="morning"?"bg-blue-600 border-blue-600 text-white":"bg-white border-gray-300 text-gray-700 hover:border-blue-400"}`,children:[r.jsx(bf,{className:"h-4 w-4 mr-1"}),"Morning"]}),r.jsxs("button",{onClick:()=>g("afternoon"),className:`flex-1 flex items-center justify-center px-3 py-2 rounded-lg border-2 transition-colors ${f==="afternoon"?"bg-blue-600 border-blue-600 text-white":"bg-white border-gray-300 text-gray-700 hover:border-blue-400"}`,children:[r.jsx(gf,{className:"h-4 w-4 mr-1"}),"Afternoon"]})]})]})]})}),w.length===0&&r.jsx("div",{className:"bg-blue-50 rounded-lg p-6 border border-blue-200",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx($n,{className:"h-6 w-6 text-blue-600 mr-3 mt-1"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Get Started"}),r.jsxs("ol",{className:"space-y-1 text-sm text-blue-800",children:[r.jsx("li",{children:"1. Select a date for attendance"}),r.jsx("li",{children:"2. Choose a class from the dropdown"}),r.jsx("li",{children:"3. Select a section to view students"}),r.jsx("li",{children:"4. Choose morning or afternoon session"}),r.jsx("li",{children:"5. Mark attendance for each student"}),r.jsx("li",{children:"6. Save the attendance record"})]})]})]})}),w.length>0&&r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[r.jsx("div",{className:"p-6 border-b border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Student Attendance"}),r.jsxs("div",{className:"flex gap-4 text-sm",children:[r.jsxs("span",{className:"text-gray-600",children:["Total: ",r.jsx("strong",{children:se.total})]}),r.jsxs("span",{className:"text-green-600",children:["Present: ",r.jsx("strong",{children:se.present})]}),r.jsxs("span",{className:"text-red-600",children:["Absent: ",r.jsx("strong",{children:se.absent})]})]})]})}),r.jsx("div",{className:"divide-y divide-gray-200",children:w.map((ee,W)=>r.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4",children:r.jsx("span",{className:"text-base font-semibold text-blue-700",children:(ee.name?.firstName?.[0]||"")+(ee.name?.lastName?.[0]||"")})}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[ee.name?.firstName," ",ee.name?.lastName]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["User ID: ",ee.userId||"N/A"]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[ee.class," - Section ",ee.section]})]})]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsxs("button",{onClick:()=>$(ee._id,"present"),disabled:I.isFrozen,className:`flex items-center px-4 py-2 rounded-lg border text-sm font-medium transition-colors ${E[ee._id]==="present"?"bg-green-100 text-green-800 border-green-200":E[ee._id]==="absent"?"bg-white text-gray-400 border-gray-200":"bg-white text-gray-700 border-gray-300 hover:bg-green-50"} ${I.isFrozen?"opacity-50 cursor-not-allowed":""}`,title:I.isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(ba,{className:"h-4 w-4 mr-1"}),"Present"]}),r.jsxs("button",{onClick:()=>$(ee._id,"absent"),disabled:I.isFrozen,className:`flex items-center px-4 py-2 rounded-lg border text-sm font-medium transition-colors ${E[ee._id]==="absent"?"bg-red-100 text-red-800 border-red-200":E[ee._id]==="present"?"bg-white text-gray-400 border-gray-200":"bg-white text-gray-700 border-gray-300 hover:bg-red-50"} ${I.isFrozen?"opacity-50 cursor-not-allowed":""}`,title:I.isFrozen?"Attendance is frozen and cannot be modified":"",children:[r.jsx(Ii,{className:"h-4 w-4 mr-1"}),"Absent"]})]})]})},ee._id))})]})]})},o5=()=>{const{token:e,user:t}=yr(),{classesData:n,loading:a,getSectionsByClass:s,hasClasses:i}=Ea(),{currentAcademicYear:l}=pn(),[d,u]=j.useState(new Date().toISOString().split("T")[0]),[m,p]=j.useState(""),[f,g]=j.useState(""),[N,v]=j.useState([]),[w,y]=j.useState("morning"),[E,O]=j.useState([]),[T,A]=j.useState([]),[I,C]=j.useState(""),[P,F]=j.useState(!1),[R,$]=j.useState(""),L=n?.classes?.map(Y=>Y.className)||[];j.useEffect(()=>{if(m&&n){const Y=s(m);v(Y),Y.length>0?g(Y[0].value):g("")}else v([]),g("")},[m,n]),j.useEffect(()=>{m&&f&&G()},[m,f,d,w,l]),j.useEffect(()=>{X()},[E,I]);const G=async()=>{if(!m||!f||!e||!t?.schoolCode){O([]);return}try{F(!0),$(""),console.log(" [ViewAttendance] Fetching students for:",{class:m,section:f,date:d,session:w,academicYear:l});const Y=new URLSearchParams({class:m,section:f});l&&Y.append("academicYear",l);const te=(await ot.get(`/users/role/student?${Y.toString()}`)).data,fe=te.data||te||[];console.log(` [ViewAttendance] Total users received from API (already filtered by backend): ${fe.length}`);const Le=fe.filter(K=>{if(K.role!=="student")return!1;const be=K.academicInfo?.class||K.studentDetails?.academic?.currentClass||K.studentDetails?.currentClass||K.studentDetails?.class||K.class,re=K.academicInfo?.section||K.studentDetails?.academic?.currentSection||K.studentDetails?.currentSection||K.studentDetails?.section||K.section,ie=!m||String(be).trim()===String(m).trim(),ne=!f||String(re).trim().toUpperCase()===String(f).trim().toUpperCase();return ie&&ne});console.log(` [ViewAttendance] Students for AY ${l}: ${Le.length}`);let he=Le.map(K=>({_id:K._id,userId:K.userId,name:K.name?.displayName||`${K.name?.firstName||""} ${K.name?.lastName||""}`.trim()||"Unknown",class:m,section:f,morningStatus:null,afternoonStatus:null}));if(d)try{const K=await mp({class:m,section:f,date:d,session:w});if(K.success&&K.data&&K.data.length>0){const be=K.data.find(re=>re.session===w&&re.dateString===d);be&&be.students&&(he=he.map(re=>{const ie=be.students.find(ne=>ne.studentId===re.userId);return ie?{...re,[w==="morning"?"morningStatus":"afternoonStatus"]:ie.status}:re}))}}catch(K){console.warn("Could not load existing attendance:",K)}O(he),he.length===0&&$(`No students found for Class ${m} Section ${f}`)}catch(Y){$("Failed to fetch students"),console.error("Error:",Y)}finally{F(!1)}},X=()=>{if(!I){A(E);return}const Y=E.filter(H=>H.name.toLowerCase().includes(I.toLowerCase())||H.userId.toLowerCase().includes(I.toLowerCase()));A(Y)},me=Y=>{p(Y.target.value),g(""),O([])},se=Y=>{g(Y.target.value)},ee=Y=>Y==="LKG"||Y==="UKG"?Y:`Class ${Y}`,W=Y=>w==="morning"?Y.morningStatus:Y.afternoonStatus,Q=(()=>{const Y=w==="morning"?"morningStatus":"afternoonStatus",H=T.filter(Le=>Le[Y]==="present").length,te=T.filter(Le=>Le[Y]==="absent").length,fe=T.filter(Le=>Le[Y]===null).length;return{present:H,absent:te,unmarked:fe,total:T.length}})();return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"View Attendance Records"})}),R&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:R}),r.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),r.jsx("input",{type:"date",value:d,onChange:Y=>u(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),r.jsx("input",{type:"text",value:l||"Loading...",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 font-semibold cursor-not-allowed",title:"Academic Year is set by Admin and cannot be changed"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),r.jsxs("select",{value:m,onChange:me,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a||!i(),children:[r.jsx("option",{value:"",children:a?"Loading...":"Select Class"}),L.map(Y=>r.jsx("option",{value:Y,children:ee(Y)},Y))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),r.jsxs("select",{value:f,onChange:se,disabled:!m||N.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",children:[r.jsx("option",{value:"",children:m?"Select Section":"Select Class First"}),N.map(Y=>r.jsxs("option",{value:Y.value,children:["Section ",Y.section]},Y.value))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session"}),r.jsxs("div",{className:"flex rounded-lg border border-gray-300",children:[r.jsxs("button",{type:"button",onClick:()=>y("morning"),className:`flex-1 py-2 px-3 text-sm font-medium rounded-l-lg flex items-center justify-center ${w==="morning"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(bf,{className:"h-4 w-4 mr-1"}),"Morning"]}),r.jsxs("button",{type:"button",onClick:()=>y("afternoon"),className:`flex-1 py-2 px-3 text-sm font-medium rounded-r-lg flex items-center justify-center ${w==="afternoon"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(gf,{className:"h-4 w-4 mr-1"}),"Afternoon"]})]})]})]})}),m&&f&&r.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"relative max-w-md",children:[r.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search by name or user ID...",value:I,onChange:Y=>C(Y.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),m&&f&&r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Present"}),r.jsx("div",{className:"text-2xl font-bold text-green-600",children:Q.present})]}),r.jsx(ba,{className:"h-8 w-8 text-green-600"})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Absent"}),r.jsx("div",{className:"text-2xl font-bold text-red-600",children:Q.absent})]}),r.jsx(Ii,{className:"h-8 w-8 text-red-600"})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600",children:"Not Marked"}),r.jsx("div",{className:"text-2xl font-bold text-gray-600",children:Q.unmarked})]}),r.jsx(bs,{className:"h-8 w-8 text-gray-600"})]})})]}),m&&f&&r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[w.charAt(0).toUpperCase()+w.slice(1)," Attendance - ",ee(m)," Section ",f]}),r.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",Q.total," students"]})]}),P?r.jsx("div",{className:"text-center py-4",children:"Loading students..."}):T.length===0?r.jsx("div",{className:"text-center py-4 text-gray-500",children:E.length===0?"No students found in this class and section":"No students match your search criteria"}):r.jsx("div",{className:"space-y-3",children:T.map(Y=>{const H=W(Y);return r.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-gray-50",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx($n,{className:"h-5 w-5 text-blue-600"})})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:Y.name}),r.jsxs("div",{className:"text-sm text-gray-500",children:["User ID: ",Y.userId]}),r.jsxs("div",{className:"text-sm text-gray-500",children:[Y.class," - Section ",Y.section]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[H==="present"&&r.jsxs("span",{className:"px-4 py-2 rounded-lg bg-green-100 text-green-800 border border-green-200 text-sm font-medium flex items-center space-x-1",children:[r.jsx(ba,{className:"h-4 w-4"}),r.jsx("span",{children:"Present"})]}),H==="absent"&&r.jsxs("span",{className:"px-4 py-2 rounded-lg bg-red-100 text-red-800 border border-red-200 text-sm font-medium flex items-center space-x-1",children:[r.jsx(Ii,{className:"h-4 w-4"}),r.jsx("span",{children:"Absent"})]}),H===null&&r.jsxs("span",{className:"px-4 py-2 rounded-lg bg-gray-100 text-gray-600 border border-gray-200 text-sm font-medium flex items-center space-x-1",children:[r.jsx(bs,{className:"h-4 w-4"}),r.jsx("span",{children:"Not Marked"})]})]})]},Y._id)})})]})}),!m||!f?r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx($n,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Get Started"}),r.jsx("div",{className:"mt-2 text-sm text-blue-700",children:r.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[r.jsx("li",{children:"Select a date to view attendance"}),r.jsx("li",{children:"Choose a class from the dropdown"}),r.jsx("li",{children:"Select a section to view students"}),r.jsx("li",{children:"Choose morning or afternoon session"}),r.jsx("li",{children:"View the attendance records for that day"})]})})]})]})}):null]})},xQ=({onNavigate:e})=>{const[t,n]=j.useState("mark"),{currentAcademicYear:a,viewingAcademicYear:s,isViewingHistoricalYear:i,setViewingYear:l,availableYears:d,loading:u}=pn();return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-100 rounded-lg",children:r.jsx(an,{className:"h-6 w-6 text-blue-600"})}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Management"})]}),r.jsxs("div",{className:"flex items-center space-x-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-4 py-2 rounded-lg shadow-md",children:[r.jsx(Jo,{className:"h-5 w-5"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs opacity-90",children:"Academic Year"}),r.jsx("span",{className:"font-bold text-sm",children:u?"Loading...":a||"2024-2025"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("div",{className:"flex space-x-8 px-6",children:[r.jsxs("button",{onClick:()=>n("mark"),className:`flex items-center space-x-2 py-4 border-b-2 transition-colors ${t==="mark"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[r.jsx(_s,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:"Mark Attendance"})]}),r.jsxs("button",{onClick:()=>n("view"),className:`flex items-center space-x-2 py-4 border-b-2 transition-colors ${t==="view"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[r.jsx(wn,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:"View Attendance"})]})]})}),r.jsx("div",{className:"p-6",children:t==="mark"?r.jsx(i5,{}):r.jsx(o5,{})})]})]})},l5=()=>{const{user:e}=yr(),{classesData:t,getSectionsByClass:n}=Ea(),{currentAcademicYear:a}=pn(),[s,i]=j.useState([]),[l,d]=j.useState([]),[u,m]=j.useState(!1),[p,f]=j.useState(""),[g,N]=j.useState(""),[v,w]=j.useState(""),[y,E]=j.useState(""),[O,T]=j.useState([]),[A,I]=j.useState([]),[C,P]=j.useState(null),[F,R]=j.useState(!1),$=t?.classes?.map(U=>U.className)||[];j.useEffect(()=>{L()},[a]),j.useEffect(()=>{X()},[s,p,g,v,y]),j.useEffect(()=>{if(g&&t){const U=n(g);T(U)}else T([])},[g,t,n]),j.useEffect(()=>{if(g&&v)G();else{const U=[...new Set(s.map(Q=>Q.subject).filter(Boolean))];I(U)}},[g,v,s]);const L=async()=>{try{m(!0),console.log(" Fetching assignments...");let U,Q=[];try{U=(await ot.get("/assignments")).data,U.data&&Array.isArray(U.data)?Q=U.data:U.assignments&&Array.isArray(U.assignments)?Q=U.assignments:Array.isArray(U)&&(Q=U),console.log(" Extracted assignments array:",Q)}catch(H){console.error(" Error with regular endpoint:",H);const te=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";console.log(" Trying direct endpoint with schoolCode:",te);const fe=await ot.get(`/direct-test/assignments?schoolCode=${te}`);if(U=fe.data,U&&U.success)throw new Error(`Direct endpoint failed with status: ${fe.status}`);console.log(" Direct endpoint response:",U),U.data&&Array.isArray(U.data)?Q=U.data:U.assignments&&Array.isArray(U.assignments)?Q=U.assignments:Array.isArray(U)&&(Q=U)}console.log(` Total assignments before filtering: ${Q.length}`);const Y=Q.filter(H=>{if(!H||typeof H!="object")return console.log(" Invalid assignment (not an object):",H),!1;const te=H.title&&H.title.trim()!=="",fe=H.class&&H.class.trim()!=="",Le=H.subject&&H.subject.trim()!=="";if(!te||!fe||!Le)return console.log(" Invalid assignment (missing fields):",{title:H.title,class:H.class,subject:H.subject}),!1;const he=H.academicYear,K=!a||!he||he===a;return K||console.log(" Skipping assignment from different academic year:",{title:H.title,academicYear:he,currentAcademicYear:a}),K});console.log(` Loaded ${Y.length} valid assignments out of ${Q.length} total`),console.log(" Valid assignments:",Y),i(Y)}catch(U){console.error(" Error fetching assignments:",U),console.error("Error details:",U.message,U.response),i([])}finally{m(!1)}},G=async()=>{try{const U=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"",Y=(await ot.get("/class-subjects/classes")).data;if(Y&&Y.success){const fe=(Y?.data?.classes?.find(Le=>Le.className===g&&Le.section===v)?.subjects||[]).filter(Le=>Le.isActive!==!1).map(Le=>Le.name).filter(Boolean);I(fe)}}catch(U){console.error("Error fetching subjects:",U),I([])}},X=()=>{let U=[...s];p&&(U=U.filter(Q=>Q.title.toLowerCase().includes(p.toLowerCase()))),g&&(U=U.filter(Q=>Q.class===g)),v&&(U=U.filter(Q=>Q.section===v)),y&&(U=U.filter(Q=>Q.subject===y)),d(U)},me=U=>{P(U),R(!0)},se=async U=>{if(C)try{const Q=new FormData;Q.append("title",U.title),Q.append("subject",U.subject),Q.append("class",U.class),Q.append("section",U.section),Q.append("startDate",U.startDate),Q.append("dueDate",U.dueDate),Q.append("instructions",U.description);const Y=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";Y&&Q.append("schoolCode",Y),await a5(C._id,Q),alert("Assignment updated successfully"),R(!1),P(null),L()}catch(Q){console.error("Error updating assignment:",Q),alert(Q.response?.data?.message||"Failed to update assignment")}},ee=async U=>{if(window.confirm("Are you sure you want to delete this assignment?"))try{await s5(U),alert("Assignment deleted successfully"),L()}catch(Q){console.error("Error deleting assignment:",Q),alert("Failed to delete assignment")}},W=U=>U?new Date(U).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A";return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search assignments...",value:p,onChange:U=>f(U.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("select",{value:g,onChange:U=>{N(U.target.value),w(""),E("")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Classes"}),$.map(U=>r.jsxs("option",{value:U,children:["Class ",U]},U))]}),r.jsxs("select",{value:v,onChange:U=>{w(U.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Sections"}),g&&O.map(U=>r.jsxs("option",{value:U.value,children:["Section ",U.section]},U.value))]}),r.jsxs("select",{value:y,onChange:U=>E(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Subjects"}),A.map(U=>r.jsx("option",{value:U,children:U},U))]})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assignment"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Section"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"Loading assignments..."})}):l.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"No assignments found"})}):l.map(U=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.title})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:U.class})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:U.section||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:U.subject})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[r.jsx(an,{className:"h-4 w-4 mr-1 text-gray-400"}),W(U.dueDate)]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("button",{onClick:()=>me(U),className:"text-blue-600 hover:text-blue-900",title:"Edit",children:r.jsx(Qs,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>ee(U._id),className:"text-red-600 hover:text-red-900",title:"Delete",children:r.jsx(Ba,{className:"h-4 w-4"})})]})})]},U._id))})]})}),F&&C&&r.jsx(yQ,{assignment:C,onClose:()=>{R(!1),P(null)},onUpdate:se})]})},yQ=({assignment:e,onClose:t,onUpdate:n})=>{const{user:a}=yr(),{classesData:s,getSectionsByClass:i}=Ea(),[l,d]=j.useState({title:e.title||"",description:e.instructions||e.description||"",subject:e.subject||"",class:e.class||"",section:e.section||"",startDate:e.startDate?e.startDate.split("T")[0]:"",dueDate:e.dueDate?e.dueDate.split("T")[0]:""}),[u,m]=j.useState([]),[p,f]=j.useState([]),[g,N]=j.useState(!1),[v,w]=j.useState(!1),y=s?.classes?.map(O=>O.className)||[];j.useEffect(()=>{if(l.class&&s){const O=i(l.class);m(O)}else m([])},[l.class,s,i]),j.useEffect(()=>{(async()=>{if(!l.class||!l.section){f([]);return}N(!0);try{const T=localStorage.getItem("erp.schoolCode")||a?.schoolCode||"",I=(await ot.get("/class-subjects/classes")).data;if(I&&I.success){const F=(I?.data?.classes?.find(R=>R.className===l.class&&R.section===l.section)?.subjects||[]).filter(R=>R.isActive!==!1).map(R=>R.name).filter(Boolean);f(F)}}catch(T){console.error("Error fetching subjects:",T),f([])}finally{N(!1)}})()},[l.class,l.section,a?.schoolCode]);const E=async()=>{if(!l.title||!l.description||!l.class||!l.section||!l.subject||!l.startDate||!l.dueDate){alert("Please fill in all required fields");return}if(new Date(l.dueDate)<=new Date(l.startDate)){alert("Due date must be after start date");return}w(!0);try{await n(l)}finally{w(!1)}};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Assignment"}),r.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Title *"}),r.jsx("input",{type:"text",value:l.title,onChange:O=>d({...l,title:O.target.value}),placeholder:"Enter assignment title",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class *"}),r.jsxs("select",{value:l.class,onChange:O=>d({...l,class:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"Select Class"}),y.map(O=>r.jsxs("option",{value:O,children:["Class ",O]},O))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section *"}),r.jsxs("select",{value:l.section,onChange:O=>d({...l,section:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",disabled:!l.class,children:[r.jsx("option",{value:"",children:"Select Section"}),u.map(O=>r.jsxs("option",{value:O.value,children:["Section ",O.section]},O.value))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),r.jsxs("select",{value:l.subject,onChange:O=>d({...l,subject:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",disabled:!l.section||g,children:[r.jsx("option",{value:"",children:l.class?l.section?g?"Loading subjects...":"Select Subject":"Select Section First":"Select Class First"}),p.map(O=>r.jsx("option",{value:O,children:O},O))]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),r.jsx("input",{type:"date",value:l.startDate,onChange:O=>d({...l,startDate:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date *"}),r.jsx("input",{type:"date",value:l.dueDate,onChange:O=>d({...l,dueDate:O.target.value}),min:l.startDate||new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Instructions *"}),r.jsx("textarea",{value:l.description,onChange:O=>d({...l,description:O.target.value}),rows:6,placeholder:"Write detailed instructions for the assignment...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:t,className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),r.jsxs("button",{onClick:E,disabled:v,className:"flex items-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[r.jsx(Os,{className:"h-4 w-4 mr-2"}),v?"Updating...":"Update Assignment"]})]})]})]})})},c5=()=>{const{user:e,token:t}=yr(),{classesData:n,loading:a,getSectionsByClass:s}=Ea(),{currentAcademicYear:i}=pn(),[l,d]=j.useState(!0),[u,m]=j.useState([]),[p,f]=j.useState([]),[g,N]=j.useState(!1),[v,w]=j.useState(!1),[y,E]=j.useState({title:"",description:"",subject:"",class:"",section:"",startDate:"",dueDate:"",attachments:[]}),O=n?.classes?.map(C=>C.className)||[];j.useEffect(()=>{if(y.class&&n){const C=s(y.class);m(C)}else m([]),E(C=>({...C,section:"",subject:""})),f([])},[y.class,n,s]),j.useEffect(()=>{(async()=>{if(!y.class||!y.section){f([]);return}N(!0);try{const P=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(!P)return;try{const G=((await zt.get("/class-subjects/classes")).data?.data?.classes?.find(X=>X.className===y.class&&X.section===y.section)?.subjects||[]).filter(X=>X.isActive!==!1).map(X=>X.name).filter(Boolean);f(G);return}catch{}try{const $=((await zt.get(`/direct-test/class-subjects/${y.class}?schoolCode=${P}`)).data?.data?.subjects||[]).map(L=>L.name).filter(Boolean);f($);return}catch{}f([])}catch(P){console.error("Error fetching subjects:",P),f([])}finally{N(!1)}})()},[y.class,y.section,t,e?.schoolCode]);const T=async()=>{if(!y.title||!y.description||!y.class||!y.section||!y.subject||!y.startDate||!y.dueDate){alert("Please fill in all required fields");return}if(new Date(y.dueDate)<=new Date(y.startDate)){alert("Due date must be after start date");return}w(!0);try{const C=new FormData;C.append("title",y.title),C.append("subject",y.subject),C.append("class",y.class),C.append("section",y.section),C.append("startDate",y.startDate),C.append("dueDate",y.dueDate),C.append("instructions",y.description);const P=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";P&&(C.append("schoolCode",P),console.log(" Added schoolCode to request:",P)),i&&(C.append("academicYear",i),console.log(" Added academicYear to request:",i)),console.log(" Creating assignment:",{title:y.title,subject:y.subject,class:y.class,section:y.section,startDate:y.startDate,dueDate:y.dueDate});const F=await n5(C);console.log(" Assignment created successfully:",F),alert(`Assignment created successfully for ${y.class}  Section ${y.section}`),E({title:"",description:"",subject:"",class:"",section:"",startDate:"",dueDate:"",attachments:[]})}catch(C){console.error(" Error creating assignment:",C),alert(C.response?.data?.message||C.message||"Failed to create assignment")}finally{w(!1)}},A=C=>{if(C){const P=Array.from(C).map(F=>F.name);E(F=>({...F,attachments:[...F.attachments,...P]}))}},I=C=>{E(P=>({...P,attachments:P.attachments.filter((F,R)=>R!==C)}))};return r.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[r.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2",children:"Add Assignments"}),r.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Create and manage assignments for your students"})]})}),l&&r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:[r.jsx("div",{className:"mb-4 sm:mb-6",children:r.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Create New Assignment"})}),r.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Title *"}),r.jsx("input",{type:"text",value:y.title,onChange:C=>E({...y,title:C.target.value}),placeholder:"Enter assignment title",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class *"}),r.jsxs("select",{value:y.class,onChange:C=>E({...y,class:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a,children:[r.jsx("option",{value:"",children:a?"Loading...":"Select Class"}),O.map(C=>r.jsxs("option",{value:C,children:["Class ",C]},C))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section *"}),r.jsxs("select",{value:y.section,onChange:C=>E({...y,section:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",disabled:!y.class||u.length===0,children:[r.jsx("option",{value:"",children:y.class?"Select Section":"Select Class First"}),u.map(C=>r.jsxs("option",{value:C.value,children:["Section ",C.section]},C.value))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),r.jsxs("select",{value:y.subject,onChange:C=>E({...y,subject:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",disabled:!y.section||g,children:[r.jsx("option",{value:"",children:y.class?y.section?g?"Loading subjects...":p.length===0?"No subjects found":"Select Subject":"Select Section First":"Select Class First"}),p.map(C=>r.jsx("option",{value:C,children:C},C))]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),r.jsx("input",{type:"date",value:y.startDate,onChange:C=>E({...y,startDate:C.target.value}),placeholder:"dd-mm-yyyy",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date *"}),r.jsx("input",{type:"date",value:y.dueDate,onChange:C=>E({...y,dueDate:C.target.value}),placeholder:"dd-mm-yyyy",min:y.startDate||new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-center",children:"Assignment Instructions *"}),r.jsx("textarea",{value:y.description,onChange:C=>E({...y,description:C.target.value}),rows:6,placeholder:"Write detailed instructions for the assignment...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-center",children:"Attachments (Optional)"}),r.jsx("div",{className:"border border-gray-300 rounded-lg p-4",children:r.jsx("input",{type:"file",multiple:!0,onChange:C=>A(C.target.files),className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200"})}),y.attachments.length>0&&r.jsx("div",{className:"mt-4 space-y-2",children:y.attachments.map((C,P)=>r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Pn,{className:"h-4 w-4 text-gray-400 mr-2"}),r.jsx("span",{className:"text-sm text-gray-700",children:C})]}),r.jsx("button",{onClick:()=>I(P),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:r.jsx(Ur,{className:"h-4 w-4"})})]},P))})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{onClick:()=>{E({title:"",description:"",subject:"",class:"",section:"",startDate:"",dueDate:"",attachments:[]})},className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),r.jsxs("button",{onClick:T,disabled:v,className:"flex items-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[r.jsx(Os,{className:"h-4 w-4 mr-2"}),v?"Creating...":"Create Assignment"]})]})]})]})]})},bQ=({onNavigate:e})=>{const[t,n]=j.useState("view"),{currentAcademicYear:a,viewingAcademicYear:s,isViewingHistoricalYear:i,setViewingYear:l,availableYears:d,loading:u}=pn();return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-purple-100 rounded-lg",children:r.jsx(xs,{className:"h-6 w-6 text-purple-600"})}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Assignments Management"})]}),r.jsxs("div",{className:"flex items-center space-x-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white px-4 py-2 rounded-lg shadow-md",children:[r.jsx(Jo,{className:"h-5 w-5"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs opacity-90",children:"Academic Year"}),r.jsx("span",{className:"font-bold text-sm",children:u?"Loading...":a||"2024-2025"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("div",{className:"flex space-x-8 px-6",children:[r.jsxs("button",{onClick:()=>n("view"),className:`flex items-center space-x-2 py-4 border-b-2 transition-colors ${t==="view"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[r.jsx(wn,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:"View Assignments"})]}),r.jsxs("button",{onClick:()=>n("add"),className:`flex items-center space-x-2 py-4 border-b-2 transition-colors ${t==="add"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[r.jsx(F6,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:"Add Assignment"})]})]})}),r.jsx("div",{className:"p-6",children:t==="view"?r.jsx(l5,{}):r.jsx(c5,{})})]})]})},vQ=()=>{const{user:e,token:t}=yr(),{currentAcademicYear:n,viewingAcademicYear:a,isViewingHistoricalYear:s,setViewingYear:i,availableYears:l,loading:d}=pn(),{classesData:u,loading:m,getSectionsByClass:p,hasClasses:f}=Ea(),[g,N]=j.useState(""),[v,w]=j.useState(""),[y,E]=j.useState([]),[O,T]=j.useState(!1),[A,I]=j.useState(""),[C,P]=j.useState(null),[F,R]=j.useState([]),[$,L]=j.useState(""),[G,X]=j.useState(100),[me,se]=j.useState(!1),[ee,W]=j.useState(!1),[U,Q]=j.useState(null),[Y,H]=j.useState([]),[te,fe]=j.useState(!1),[Le,he]=j.useState({}),[K,be]=j.useState([]),[re,ie]=j.useState([]),[ne,Te]=j.useState(!1),[ve,We]=j.useState([]),[Ie,je]=j.useState(!1),[oe,$e]=j.useState(!1),[et,lt]=j.useState(null),[rt,Lt]=j.useState(null),[kt,Oe]=j.useState(null),[Nt,Mt]=j.useState(!1),[rr,Ft]=j.useState(!1);j.useEffect(()=>{Mt(!1),$e(!1),se(!1)},[g,v,$,A]);const cr=j.useCallback(B=>{const Pe=Ae=>new Date(Ae.updatedAt||Ae.createdAt||0).getTime(),Se=new Map;for(const Ae of B||[]){const Xe=String(Ae.studentId||Ae.student_id||Ae.id||"");if(!Xe)continue;const Ke=String(Ae.subject||$||""),Ve=String(Ae.testType||A||""),ut=String(Ae.className||Ae.class||g||""),Je=String(Ae.section||v||""),ae=`${Xe}::${ut}::${Je}::${Ke}::${Ve}`,ct=Se.get(ae);(!ct||Pe(Ae)>=Pe(ct))&&Se.set(ae,Ae)}return Array.from(Se.values())},[$,A,g,v]),or=j.useCallback((B,Pe)=>{const Se=ut=>String(ut||"").toUpperCase().trim(),Ae=ut=>{const Je=Se(ut),ae=Je.match(/^(.*?)(\d+)$/);return ae?{p:ae[1],n:parseInt(ae[2],10)}:{p:Je,n:Number.MAX_SAFE_INTEGER}},Xe=Ae(B),Ke=Ae(Pe),Ve=Xe.p.localeCompare(Ke.p);return Ve!==0?Ve:Xe.n-Ke.n},[]),ke=j.useCallback(B=>[...B].sort((Pe,Se)=>or(Pe.userId,Se.userId)),[or]),ht=j.useCallback(B=>[...B].sort((Pe,Se)=>or(Pe?.userId,Se?.userId)),[or]),_e=j.useCallback(async B=>{try{const Se=(localStorage.getItem("erp.schoolCode")||e?.schoolCode||"").toUpperCase();if(!Se||!g||!v)return B;const Xe=(await Gn.getStudents(Se,{class:g,section:v}))?.data?.data||[],Ke=new Map,Ve=new Map,ut=new Map;for(const ae of Xe){const ct=String(ae._id||ae.id||""),st=String(ae.userId||ae.user_id||""),dt=String(ae.name?.displayName||`${ae.name?.firstName||""} ${ae.name?.lastName||""}`.trim()||ae.fullName||"").toLowerCase();ct&&Ke.set(ct,ae),st&&Ve.set(st,ae),dt&&ut.set(dt,ae)}return B.map(ae=>{if(ae.rollNumber&&ae.rollNumber!=="-")return ae;const ct=String(ae.name||"").toLowerCase(),st=Ke.get(String(ae.id))||Ve.get(String(ae.userId))||ut.get(ct),dt=st?.studentDetails?.rollNumber||st?.studentDetails?.currentRollNumber||st?.studentDetails?.rollNo||st?.rollNumber||st?.sequenceId||ae.rollNumber||"";return{...ae,rollNumber:dt}})}catch{return B}},[g,v,e?.schoolCode]),tt=u?.classes?.map(B=>B.className)||[],gt=j.useCallback(async B=>{if(!B){be([]);return}Te(!0);try{if(u&&u.testsByClass){let Se=u.testsByClass[B]||u.testsByClass[String(B)]||[];Se.length===0&&u.tests&&(Se=u.tests.filter(Xe=>String(Xe.className)===String(B)));const Ae=(Se||[]).filter(Xe=>typeof Xe?.maxMarks=="number"&&Xe.maxMarks>0);if(Ae.length>0){const Xe=Ae.map(Ve=>Ve.testName||Ve.displayName||Ve.name||Ve.testType).filter(Boolean),Ke=[...new Set(Xe)];be(Ke),Te(!1);return}}if(!(localStorage.getItem("erp.schoolCode")||e?.schoolCode||"")){ge.error("School code not available");return}be([])}catch(Pe){console.error("Error fetching test types:",Pe),ge.error("Failed to load test types"),be([])}finally{Te(!1)}},[e?.schoolCode,u]);j.useEffect(()=>{if(g&&u){const B=p(g);E(B),B.length>0?w(B[0].value):w(""),L(""),R([])}else E([]),w(""),L(""),R([])},[g,u,p]),j.useEffect(()=>{g?(gt(g),I(""),P(null),X("")):be([])},[g,gt]),j.useEffect(()=>{if(!g||!A||!u){P(null);return}const Pe=(u.testsByClass?.[g]||u.tests||[]).find(Ae=>(Ae.testName||Ae.displayName||Ae.name||Ae.testType)===A),Se=typeof Pe?.maxMarks=="number"?Pe.maxMarks:null;P(Se),Se!==null&&X(Se)},[g,A,u]),j.useEffect(()=>{(async()=>{if(!g||!v){R([]),L("");return}T(!0),console.log(" Fetching subjects for class:",g,"section:",v);try{const Pe=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(!Pe){console.error(" School code not available"),ge.error("School code not available");return}console.log(" Using school code:",Pe);try{console.log(" Trying primary API: /class-subjects/classes");const Se=await ot.get("/class-subjects/classes",{headers:{"x-school-code":Pe.toUpperCase()}});if(console.log(" Primary API response:",Se.data),Se.data?.success&&Se.data?.data?.classes){const Ae=Se.data.data.classes.find(Xe=>Xe.className===g&&Xe.section===v);if(console.log(" Found class data:",Ae),Ae?.subjects){const Ke=Ae.subjects.filter(Ve=>Ve.isActive!==!1).map(Ve=>Ve.name||Ve.subjectName).filter(Boolean);console.log(" Extracted subject names:",Ke),R(Ke),L(Ke[0]||""),T(!1);return}}}catch(Se){console.error(" Primary API failed:",Se)}try{console.log(" Trying fallback API: /direct-test/class-subjects");const Se=await ot.get(`/direct-test/class-subjects/${g}`,{params:{schoolCode:Pe},headers:{"x-school-code":Pe.toUpperCase()}});if(console.log(" Fallback API response:",Se.data),Se.data?.success&&Se.data?.data?.subjects){const Ae=Se.data.data.subjects.map(Xe=>Xe.name||Xe.subjectName).filter(Boolean);console.log(" Extracted subject names from fallback:",Ae),R(Ae),L(Ae[0]||""),T(!1);return}}catch(Se){console.error(" Fallback API failed:",Se)}console.warn(" No subjects found for class/section"),R([]),L(""),ge.error("No subjects found for selected class and section")}catch(Pe){console.error(" Error fetching subjects:",Pe),ge.error("Failed to load subjects"),R([]),L("")}finally{T(!1)}})()},[g,v,e?.schoolCode]);const Pt=j.useCallback(async()=>{W(!0),Q(null);try{const Pe=(localStorage.getItem("erp.schoolCode")||e?.schoolCode||"").toUpperCase();if(!Pe){ge.error("School code not available");return}const Se=await Gn.getStudents(Pe,{class:g,section:v});if(Se.data.success&&Se.data.data){const Ke=Se.data.data.filter(Ve=>{const ut=Ve.academicInfo?.class||Ve.studentDetails?.academic?.currentClass||Ve.studentDetails?.currentClass||Ve.studentDetails?.class||Ve.currentclass||Ve.class||Ve.className,Je=Ve.academicInfo?.section||Ve.studentDetails?.academic?.currentSection||Ve.studentDetails?.currentSection||Ve.studentDetails?.section||Ve.currentsection||Ve.section,ae=Ve.studentDetails?.academicYear||Ve.studentDetails?.academic?.academicYear||Ve.academicYear||Ve.academicInfo?.academicYear,ct=!ae||String(ae).trim()===String(a).trim();return String(ut).trim()===String(g).trim()&&String(Je).trim().toUpperCase()===String(v).trim().toUpperCase()&&ct}).map((Ve,ut)=>({id:Ve._id||Ve.id,name:Ve.name?.displayName||`${Ve.name?.firstName||""} ${Ve.name?.lastName||""}`.trim()||Ve.fullName||"Unknown",userId:Ve.userId||Ve.user_id||"N/A",rollNumber:Ve.studentDetails?.rollNumber||Ve.studentDetails?.currentRollNumber||Ve.rollNumber||Ve.sequenceId||`${Pe}-${v}-${String(ut+1).padStart(4,"0")}`,class:g,section:v,totalMarks:C,obtainedMarks:null,grade:null}));if(Ke.length>0){H(ke(Ke)),se(!0);const Ve={};Ke.forEach(ut=>{Ve[ut.id]=!1}),he(Ve),ge.success(`Found ${Ke.length} students in ${g}-${v}`);return}}else console.warn("Primary students API did not return data or success=false",Se.data);try{const ut=((await ot.get(`/school-users/${Pe}/users`)).data?.data||[]).filter(Je=>{const ae=Je.role==="student",ct=Je.studentDetails?.currentClass||Je.currentclass||Je.class||Je.className,st=Je.studentDetails?.currentSection||Je.currentsection||Je.section;return ae&&String(ct)===String(g)&&String(st).toUpperCase()===String(v).toUpperCase()}).map((Je,ae)=>({id:Je._id||Je.id,name:Je.name?.displayName||`${Je.name?.firstName||""} ${Je.name?.lastName||""}`.trim()||Je.fullName||"Unknown",userId:Je.userId||Je.user_id||"N/A",rollNumber:Je.studentDetails?.rollNumber||Je.studentDetails?.currentRollNumber||Je.rollNumber||Je.sequenceId||`${Pe}-${v}-${String(ae+1).padStart(4,"0")}`,class:g,section:v,totalMarks:C,obtainedMarks:null,grade:null}));if(ut.length>0){H(ke(ut)),se(!0);const Je={};ut.forEach(ae=>{Je[ae.id]=!1}),he(Je),ge.success(`Loaded ${ut.length} students via fallback API`);return}}catch(Ae){console.error("Fallback school-users API error:",Ae)}Q("No students found for the selected class and section"),H([]),se(!1)}catch(B){console.error("Error fetching students:",B),Q("Failed to load students. Please try again."),H([]),se(!1)}finally{W(!1)}},[g,v,C,e?.schoolCode,ke,a]),Ot=j.useCallback(async()=>{W(!0),Q(null);try{const B=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(!B){ge.error("School code not available");return}const Pe=await Gn.getResults({schoolCode:B,class:g,section:v,subject:$,testType:A});if(Pe.data?.success&&Array.isArray(Pe.data?.data)&&Pe.data.data.length>0){const Se=cr(Pe.data.data),Xe=Se[0]?.frozen||!1;Mt(Xe);let Ke=Se.map(ut=>({id:ut.studentId,name:ut.studentName,userId:ut.userId,rollNumber:ut.rollNumber||ut.sequenceId||"",class:ut.className||g,section:ut.section||v,totalMarks:typeof ut.totalMarks=="number"?ut.totalMarks:C,obtainedMarks:ut.obtainedMarks??null,grade:b(ut.obtainedMarks,typeof ut.totalMarks=="number"?ut.totalMarks:C),resultId:ut._id||ut.id}));Ke=await _e(Ke),H(ke(Ke)),se(!0);const Ve={};Ke.forEach(ut=>{Ve[ut.id]=!0}),he(Ve),Xe?ge.error(` Results are FROZEN and cannot be edited. Loaded ${Ke.length} result(s).`,{duration:5e3}):ge.success(`Loaded ${Ke.length} saved result(s)`);return}await Pt()}catch(B){console.error("Error fetching results/students:",B),Q("Failed to load results/students. Please try again."),H([]),se(!1)}finally{W(!1)}},[g,v,$,A,C,e?.schoolCode,Pt,_e,ke,cr]),vt=j.useCallback(async()=>{if(!g||!v){ge.error("Please select class and section first");return}if(!$){ge.error("Please select a subject first");return}if(!A){ge.error("Please select a test type first");return}je(!0);try{const B=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(!B){ge.error("School code not available");return}const Pe=await Gn.getResults({schoolCode:B,class:g,section:v,subject:$,testType:A});if(Pe.data.success&&Pe.data.data){const Se=cr(Pe.data.data),Xe=Se[0]?.frozen||!1;Mt(Xe);const Ke=await _e(Se.map(Je=>({id:Je.studentId,name:Je.studentName,userId:Je.userId,rollNumber:Je.rollNumber||Je.sequenceId||"",class:Je.className||g,section:Je.section||v,totalMarks:Je.totalMarks??C,obtainedMarks:Je.obtainedMarks??null,grade:Je.grade??null,resultId:Je._id||Je.id}))),Ve=new Map(Ke.map(Je=>[String(Je.id),Je.rollNumber])),ut=Se.map(Je=>({...Je,rollNumber:Je.rollNumber||Ve.get(String(Je.studentId))||Je.sequenceId||"",grade:b(Je.obtainedMarks,Je.totalMarks),frozen:Je.frozen||!1}));We(ht(ut)),$e(!0),se(!1),ge.success(`Found ${ut.length} existing results for ${g}-${v}`)}else We([]),$e(!1),await Pt(),fe(!0),ge.success("No existing results found. Loaded students for entering marks.")}catch(B){console.error("Error fetching existing results:",B),ge.error("Failed to load existing results"),We([]),$e(!1)}finally{je(!1)}},[g,v,$,A,C,e?.schoolCode,_e,ht,cr,Pt]),nr=B=>{lt(B._id),Lt(B.obtainedMarks)},Yt=()=>{lt(null),Lt(null)},Or=async B=>{if(rt==null){ge.error("Please enter valid marks");return}Oe(B._id);try{const Pe=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";await Gn.updateResult(B._id,{schoolCode:Pe,class:B.className,section:B.section,subject:B.subject,testType:B.testType,maxMarks:B.maxMarks||B.totalMarks,obtainedMarks:rt,totalMarks:B.totalMarks,studentId:B.studentId,studentName:B.studentName,userId:B.userId});const Se=b(rt,B.totalMarks);We(Ae=>Ae.map(Xe=>Xe._id===B._id?{...Xe,obtainedMarks:rt,grade:Se}:Xe)),lt(null),Lt(null),ge.success("Result updated successfully!")}catch(Pe){console.error("Error updating result:",Pe),ge.error("Failed to update result")}finally{Oe(null)}},Sr=async()=>{if(!g||!v||!$||!A){ge.error("Please ensure all filters are selected");return}if(window.confirm(`Are you sure you want to FREEZE results for ${g}-${v}, ${$} (${A})?

Once frozen, marks CANNOT be edited anymore!`)){Ft(!0);try{const Pe=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";await Gn.freezeResults({schoolCode:Pe,class:g,section:v,subject:$,testType:A,academicYear:"2024-25"}),We(Se=>Se.map(Ae=>({...Ae,frozen:!0}))),Mt(!0),ge.success("Results frozen successfully! Marks can no longer be edited.")}catch(Pe){console.error("Error freezing results:",Pe),ge.error("Failed to freeze results")}finally{Ft(!1)}}},$t=()=>{if(!g){ge.error("Please select a class");return}if(!v){ge.error("Please select a section");return}if(!$){ge.error("Please select a subject");return}if(!A){ge.error("Please select a test type");return}if(!C||C<=0){ge.error("Configured max marks not found for this test. Please configure in Admin > Settings.");return}$e(!1),fe(!0),Ot()},gr=async()=>{try{const B=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"";if(console.log(" Starting save process...",{schoolCode:B,selectedClass:g,selectedSection:v,selectedSubject:$,selectedTestType:A,configuredMaxMarks:C,totalStudents:Y.length}),!B){ge.error("School code not available");return}const Pe=Y.filter(Ke=>Ke.obtainedMarks!==null&&Ke.obtainedMarks!==void 0);if(console.log(" Valid results to save:",Pe.length,Pe),Pe.length===0){ge.error("Please enter obtained marks for at least one student");return}const Se=Pe.filter(Ke=>!!Ke.resultId),Ae=Pe.filter(Ke=>!Ke.resultId);if(console.log(" Split results:",{toUpdate:Se.length,toCreate:Ae.length}),Se.length>0&&(console.log(" Updating existing results:",Se),await Promise.all(Se.map(async Ke=>{const Ve={schoolCode:B,class:g,section:v,subject:$,testType:A,maxMarks:C,totalMarks:Ke.totalMarks??C,obtainedMarks:Ke.obtainedMarks,studentId:Ke.id,studentName:Ke.name,userId:Ke.userId};try{await Gn.updateResult(Ke.resultId,Ve)}catch(ut){console.warn("Update failed for result, attempting upsert via saveResults",Ke.resultId,ut);const Je={schoolCode:B,class:g,section:v,testType:A,subject:$,maxMarks:C,academicYear:"2024-25",results:[{studentId:Ke.id,studentName:Ke.name,userId:Ke.userId,obtainedMarks:Ke.obtainedMarks,totalMarks:Ke.totalMarks??C,grade:Ke.grade}]};try{await Gn.saveResults(Je)}catch(ae){console.error("Upsert via saveResults also failed for student",Ke.id,ae)}}}))),Ae.length>0){const Ke={schoolCode:B,class:g,section:v,testType:A,subject:$,maxMarks:C,academicYear:"2024-25",results:Ae.map(ut=>({studentId:ut.id,studentName:ut.name,userId:ut.userId,obtainedMarks:ut.obtainedMarks,totalMarks:ut.totalMarks??C,grade:ut.grade}))};console.log(" Creating new results:",Ke);const Ve=await Gn.saveResults(Ke);if(console.log(" Create response:",Ve.data),!Ve.data?.success){ge.error(Ve.data?.message||"Failed to create new results");return}}console.log(" Save completed successfully!"),ge.success(`Saved ${Se.length} update(s)${Ae.length?` and created ${Ae.length}`:""}`);const Xe={};Y.forEach(Ke=>{Xe[Ke.id]=!0}),he(Xe),fe(!1),console.log(" Refreshing results..."),await Ot()}catch(B){console.error("Error saving results:",B),ge.error("Failed to save results. Please try again.")}},kr=(B,Pe,Se)=>{H(Ae=>Ae.map(Xe=>{if(Xe.id===B){const Ke={...Xe,[Pe]:Se};return Ke.grade=b(Se,Xe.totalMarks),Ke}return Xe})),he(Ae=>({...Ae,[B]:!1}))},b=(B,Pe)=>{if(B==null||!Pe||Pe===0)return"N/A";const Se=B/Pe*100;return Se>=91?"A1":Se>=81?"A2":Se>=71?"B1":Se>=61?"B2":Se>=51?"C1":Se>=41?"C2":Se>=33?"D":Se>=21?"E1":"E2"};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Academic Results"}),me&&!Nt&&r.jsx("div",{className:"flex space-x-3",children:r.jsxs("button",{onClick:gr,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors",children:[r.jsx(rs,{className:"h-4 w-4 mr-2"}),"Save All Changes"]})})]}),s&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-4",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:" Viewing Historical Data:"})," You are viewing data from ",a,". This data is read-only."]})}),r.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex flex-wrap gap-4",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"year-select",className:"text-sm font-medium text-gray-700",children:"Academic Year"}),r.jsx("select",{id:"year-select",value:a,onChange:B=>i(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px] disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:!0,children:l.map(B=>r.jsxs("option",{value:B,children:[B," ",B===n&&"(Current)"]},B))})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"class-select",className:"text-sm font-medium text-gray-700",children:"Class"}),r.jsxs("select",{id:"class-select",value:g,onChange:B=>N(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",disabled:m||!f(),children:[r.jsx("option",{value:"",children:m?"Loading...":"Select Class"}),tt.map(B=>r.jsxs("option",{value:B,children:["Class ",B]},B))]}),!m&&!f()&&r.jsx("span",{className:"text-xs text-red-500 mt-1",children:"No classes configured"})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"section-select",className:"text-sm font-medium text-gray-700",children:"Section"}),r.jsxs("select",{id:"section-select",value:v,onChange:B=>w(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",disabled:!g||y.length===0,children:[r.jsx("option",{value:"",children:g?"Select Section":"Select Class First"}),y.map(B=>r.jsxs("option",{value:B.value,children:["Section ",B.section]},B.value))]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"subject-select",className:"text-sm font-medium text-gray-700",children:"Subject"}),r.jsxs("select",{id:"subject-select",value:$,onChange:B=>L(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[180px]",disabled:!g||!v||O,children:[r.jsx("option",{value:"",children:!g||!v?"Select Class & Section":O?"Loading...":F.length===0?"No Subjects":"Select Subject"}),F.map(B=>r.jsx("option",{value:B,children:B},B))]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{htmlFor:"test-type-select",className:"text-sm font-medium text-gray-700",children:"Test Type"}),r.jsxs("select",{id:"test-type-select",value:A,onChange:B=>I(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[150px]",disabled:!g||ne,children:[r.jsx("option",{value:"",children:g?ne?"Loading...":"Select Test":"Select Class First"}),K.map((B,Pe)=>r.jsx("option",{value:B,children:B},`${B}-${Pe}`))]}),!g&&r.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Select a class to see available tests"})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Total Marks"}),r.jsx("input",{type:"number",value:C??"",readOnly:!0,className:"px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-700 min-w-[120px]",placeholder:"Configured"})]}),r.jsxs("button",{onClick:$t,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors self-end",disabled:ee,children:[ee?r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r.jsx(va,{className:"h-4 w-4 mr-2"}),"Search"]}),r.jsxs("button",{onClick:vt,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors self-end disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:Ie||!g||!v||!$||!A,children:[Ie?r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"View Existing Results"]})]})}),U&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsx("p",{className:"text-red-700",children:U})}),oe&&r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:["Existing Results for ",g,"-",v,$&&` - ${$}`,A&&` (${A})`,Nt&&r.jsxs("span",{className:"px-3 py-1 bg-red-100 text-red-700 text-xs font-semibold rounded-full flex items-center gap-1",children:[r.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"FROZEN"]})]}),r.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Found ",ve.length," results. ",Nt?"Results are frozen and cannot be edited.":"Click on a result to edit it."]})]}),!Nt&&ve.length>0&&r.jsx("button",{onClick:Sr,disabled:rr,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors disabled:opacity-50",children:rr?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Freezing..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Freeze Results"]})})]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User ID"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Obtained Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ve.map((B,Pe)=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B.userId||"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:B.studentName}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-md text-xs font-medium",children:B.subject||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:r.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded-md text-xs font-medium",children:B.testType})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:et===B._id?r.jsx("input",{type:"number",value:rt||"",onChange:Se=>{const Ae=Se.target.value;(Ae===""||Ae.length<=3&&parseInt(Ae)<=B.totalMarks)&&Lt(Ae===""?null:parseInt(Ae))},className:"w-20 px-2 py-1 border border-blue-500 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Marks",min:"0",max:B.totalMarks,maxLength:3,autoFocus:!0}):B.obtainedMarks}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B.totalMarks}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:r.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${["A1","A2"].includes(et===B._id?b(rt,B.totalMarks):B.grade)?"bg-green-100 text-green-800":["B1","B2"].includes(et===B._id?b(rt,B.totalMarks):B.grade)?"bg-blue-100 text-blue-800":["C1","C2"].includes(et===B._id?b(rt,B.totalMarks):B.grade)?"bg-yellow-100 text-yellow-800":(et===B._id?b(rt,B.totalMarks):B.grade)==="D"?"bg-orange-100 text-orange-800":["E1","E2"].includes(et===B._id?b(rt,B.totalMarks):B.grade)?"bg-red-100 text-red-800":"bg-gray-100 text-gray-600"}`,children:et===B._id?b(rt,B.totalMarks):B.grade||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(B.createdAt).toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:et===B._id?r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>Or(B),disabled:kt===B._id,className:"text-green-600 hover:text-green-900 disabled:opacity-50",title:"Save",children:kt===B._id?r.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r.jsx(rs,{className:"h-5 w-5"})}),r.jsx("button",{onClick:Yt,disabled:kt===B._id,className:"text-red-600 hover:text-red-900 disabled:opacity-50",title:"Cancel",children:r.jsx(Ur,{className:"h-5 w-5"})})]}):r.jsx("button",{onClick:()=>nr(B),disabled:Nt||B.frozen,className:"text-blue-600 hover:text-blue-900 disabled:text-gray-400 disabled:cursor-not-allowed",title:Nt||B.frozen?"Results are frozen":"Edit",children:Nt||B.frozen?r.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}):r.jsx(Qs,{className:"h-5 w-5"})})})]},B._id||Pe))})]})})]}),me&&r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[Nt&&r.jsxs("div",{className:"px-6 py-3 bg-red-50 border-b border-red-200 flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),r.jsx("span",{className:"text-red-700 font-semibold",children:"Results are FROZEN - Editing is disabled"})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User ID"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Obtained Marks"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Y.map(B=>r.jsxs("tr",{className:Nt?"bg-gray-50":"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B.userId||"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:B.name}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B.totalMarks??C??"-"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.jsx("input",{type:"number",value:B.obtainedMarks||"",onChange:Pe=>{const Se=Pe.target.value,Ae=B.totalMarks??C??100;(Se===""||Se.length<=3&&parseInt(Se)<=Ae)&&kr(B.id,"obtainedMarks",Se===""?null:parseInt(Se))},disabled:Nt,className:"w-20 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter marks",min:"0",max:B.totalMarks??C??100,maxLength:3})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:r.jsx("span",{className:`px-3 py-1 rounded-md text-sm font-semibold ${B.grade&&["A1","A2"].includes(B.grade)?"bg-green-100 text-green-800":B.grade&&["B1","B2"].includes(B.grade)?"bg-blue-100 text-blue-800":B.grade&&["C1","C2"].includes(B.grade)?"bg-yellow-100 text-yellow-800":B.grade==="D"?"bg-orange-100 text-orange-800":B.grade&&["E1","E2"].includes(B.grade)?"bg-red-100 text-red-800":"bg-gray-100 text-gray-600"}`,children:B.grade||"N/A"})})]},B.id))})]})})]})]})},wQ=()=>{const{token:e,user:t}=yr(),{currentAcademicYear:n}=pn(),[a,s]=j.useState([]),[i,l]=j.useState(!0);j.useEffect(()=>{d()},[n]);const d=async()=>{l(!0);try{console.log(" Fetching messages from teacher endpoint");const m=await ot.get("/messages/teacher/messages");if(!m.data)throw new Error("Failed to fetch messages");const p=m.data;if(p.success){const f=p.messages||p.data?.messages||[];s(f),console.log(" Fetched messages for academic year:",n),console.log(" Total messages:",f.length),console.log(" Messages:",f)}else ge.error(p.message||"Failed to fetch messages")}catch(m){console.error("Error fetching messages:",m),ge.error("Failed to load messages")}finally{l(!1)}},u=m=>{const p=new Date(m),g=Math.floor((new Date().getTime()-p.getTime())/(1e3*60*60));return g<1?"Just now":g<24?`${g}h ago`:g<48?"Yesterday":p.toLocaleDateString()};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"School Messages"}),r.jsx("p",{className:"text-gray-600",children:"Messages sent by admins to students"})]}),r.jsxs("div",{className:"flex items-center space-x-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-4 py-2 rounded-lg shadow-md mt-4 sm:mt-0",children:[r.jsx(an,{className:"h-5 w-5"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs opacity-90",children:"Academic Year"}),r.jsx("span",{className:"font-bold text-sm",children:n||"Loading..."})]})]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-6",children:r.jsx("div",{children:r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"p-6 border-b border-gray-200",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Messages from Admin"}),r.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Viewing messages for academic year: ",r.jsx("span",{className:"font-semibold text-indigo-600",children:n})]})]}),i?r.jsxs("div",{className:"p-12 text-center",children:[r.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Loading messages..."})]}):a.length>0?r.jsx("div",{className:"p-6 space-y-4",children:a.map(m=>r.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-5 border border-blue-100 hover:shadow-md transition-all duration-200",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:m.title}),r.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Class ",m.class,"-",m.section]}),r.jsx("span",{className:"text-gray-500",children:""}),r.jsx("span",{className:"text-gray-600 font-medium",children:m.subject})]})]}),r.jsxs("div",{className:"flex flex-col items-end ml-4",children:[r.jsxs("div",{className:"flex items-center text-xs text-gray-500 bg-white px-2 py-1 rounded-md shadow-sm",children:[r.jsx(bs,{className:"h-3.5 w-3.5 mr-1"}),u(m.timestamp)]}),r.jsx("span",{className:"text-xs text-gray-400 mt-1",children:new Date(m.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]}),r.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-100",children:r.jsx("p",{className:"text-gray-700 text-sm leading-relaxed whitespace-pre-wrap",children:m.content||m.message})}),r.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-blue-100",children:[r.jsx("div",{className:"flex items-center space-x-2",children:r.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-1.5"}),"From Admin"]})}),r.jsx("span",{className:"text-xs text-gray-500 italic",children:m.messageAge})]})]},m.id))}):r.jsxs("div",{className:"p-12 text-center",children:[r.jsx(V6,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No messages yet"}),r.jsx("p",{className:"text-gray-600",children:"Messages will appear here when available"})]})]})})})]})},jQ=()=>{const{user:e,token:t}=yr(),[n,a]=j.useState(!1),[s,i]=j.useState({teacherName:"",teacherId:"",subjectLine:"",startDate:"",endDate:"",description:""});j.useEffect(()=>{if(e){const u=e.userId||e.id||"";console.log(" Updating form with user data:",{name:e.name,userId:e.userId,id:e.id,finalTeacherId:u}),i(m=>({...m,teacherName:e.name||"",teacherId:u}))}},[e]);const l=u=>{const{name:m,value:p}=u.target;i(f=>({...f,[m]:p}))},d=async u=>{if(u.preventDefault(),!s.subjectLine||!s.startDate||!s.endDate||!s.description){ge.error("Please fill in all required fields");return}if(new Date(s.endDate)<new Date(s.startDate)){ge.error("End date must be after or equal to start date");return}a(!0);try{const m=localStorage.getItem("erp.schoolCode")||e?.schoolCode||"",f=(await zt.post("/leave-requests/teacher/create",{...s,schoolCode:m})).data;f.success?(ge.success("Leave request submitted successfully!"),i({teacherName:e?.name||"",teacherId:e?.userId||"",subjectLine:"",startDate:"",endDate:"",description:""})):ge.error(f.message||"Failed to submit leave request")}catch(m){console.error(" Error submitting leave request:",m),ge.error(m.message||"Failed to submit leave request")}finally{a(!1)}};return r.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[r.jsxs("div",{className:"mb-4 sm:mb-6",children:[r.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Submit Leave Request"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Fill in the details below to request leave"})]}),r.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teacher Name *"}),r.jsx("input",{type:"text",name:"teacherName",value:s.teacherName,readOnly:!0,className:"w-full px-3 sm:px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600 cursor-not-allowed text-sm"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teacher ID *"}),r.jsx("input",{type:"text",name:"teacherId",value:s.teacherId,readOnly:!0,className:"w-full px-3 sm:px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600 cursor-not-allowed text-sm"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject Line *"}),r.jsx("input",{type:"text",name:"subjectLine",value:s.subjectLine,onChange:l,placeholder:"e.g., Medical Leave, Personal Leave",className:"w-full px-3 sm:px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Leave Start Date *"}),r.jsx("input",{type:"date",name:"startDate",value:s.startDate,onChange:l,className:"w-full px-3 sm:px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Leave End Date *"}),r.jsx("input",{type:"date",name:"endDate",value:s.endDate,onChange:l,className:"w-full px-3 sm:px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),r.jsx("textarea",{name:"description",value:s.description,onChange:l,rows:4,placeholder:"Provide details about your leave request...",className:"w-full px-3 sm:px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-sm",required:!0})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3 pt-4 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:()=>{i({teacherName:e?.name||"",teacherId:e?.userId||"",subjectLine:"",startDate:"",endDate:"",description:""})},className:"px-4 sm:px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm sm:text-base w-full sm:w-auto",children:"Cancel"}),r.jsx("button",{type:"submit",onClick:d,disabled:n,className:"px-4 sm:px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 text-sm sm:text-base w-full sm:w-auto",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),r.jsx("span",{children:"Submitting..."})]}):r.jsx("span",{children:"Submit Request"})})]})]})]})})},NQ=()=>{const{token:e}=yr(),{currentAcademicYear:t}=pn(),[n,a]=j.useState([]),[s,i]=j.useState(!0),[l,d]=j.useState("all");j.useEffect(()=>{u()},[e]);const u=async()=>{i(!0);try{const v=(await ot.get("/leave-requests/teacher/my-requests")).data;v.success?a(v.data.leaveRequests):ge.error("Failed to fetch leave requests")}catch(N){console.error("Error fetching leave requests:",N),ge.error("Failed to fetch leave requests")}finally{i(!1)}},m=N=>{const v="px-3 py-1 rounded-full text-xs font-medium";switch(N){case"approved":return`${v} bg-green-100 text-green-800`;case"rejected":return`${v} bg-red-100 text-red-800`;case"pending":return`${v} bg-yellow-100 text-yellow-800`;default:return`${v} bg-gray-100 text-gray-800`}},p=N=>new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),f=n.filter(N=>l==="all"?!0:N.status===l),g={total:n.length,pending:n.filter(N=>N.status==="pending").length,approved:n.filter(N=>N.status==="approved").length,rejected:n.filter(N=>N.status==="rejected").length};return s?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Total Requests"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.total})]}),r.jsx(an,{className:"h-8 w-8 text-blue-600"})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:g.pending})]}),r.jsx(bs,{className:"h-8 w-8 text-yellow-600"})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Approved"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:g.approved})]}),r.jsx(ba,{className:"h-8 w-8 text-green-600"})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Rejected"}),r.jsx("p",{className:"text-2xl font-bold text-red-600",children:g.rejected})]}),r.jsx(Ii,{className:"h-8 w-8 text-red-600"})]})})]}),r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>d("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${l==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All"}),r.jsx("button",{onClick:()=>d("pending"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${l==="pending"?"bg-yellow-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Pending"}),r.jsx("button",{onClick:()=>d("approved"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${l==="approved"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Approved"}),r.jsx("button",{onClick:()=>d("rejected"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${l==="rejected"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Rejected"})]})}),r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:f.length===0?r.jsxs("div",{className:"p-12 text-center",children:[r.jsx(an,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"No leave requests found"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Start Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"End Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reviewed By"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(N=>r.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:"text-sm font-medium text-gray-900",children:N.subjectLine})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"text-sm text-gray-600 max-w-xs",children:[N.description,N.adminComments&&r.jsxs("div",{className:"mt-1 text-xs text-gray-500 italic",children:['Admin: "',N.adminComments,'"']})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p(N.startDate)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p(N.endDate)}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[N.numberOfDays," ",N.numberOfDays===1?"day":"days"]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:m(N.status),children:N.status.toUpperCase()})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:p(N.createdAt)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.reviewedByName?r.jsxs("div",{className:"text-sm",children:[r.jsx("div",{className:"text-gray-900",children:N.reviewedByName}),N.reviewedAt&&r.jsx("div",{className:"text-gray-500 text-xs",children:p(N.reviewedAt)})]}):r.jsx("span",{className:"text-sm text-gray-400",children:"-"})})]},N._id))})]})})})]})},SQ=({onNavigate:e})=>{const[t,n]=j.useState("request");return r.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[r.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[r.jsx("div",{className:"flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 bg-blue-100 rounded-lg",children:r.jsx(Pn,{className:"h-4 w-4 sm:h-6 sm:w-6 text-blue-600"})}),r.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"Leave Request Management"})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-8 px-4 sm:px-6 overflow-x-auto",children:[r.jsxs("button",{onClick:()=>n("request"),className:`flex items-center justify-center sm:justify-start space-x-2 py-3 sm:py-4 border-b-2 transition-colors w-full sm:w-auto ${t==="request"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[r.jsx(U4,{className:"h-4 w-4 sm:h-5 sm:w-5"}),r.jsx("span",{className:"font-medium text-sm sm:text-base",children:"Leave Request"})]}),r.jsxs("button",{onClick:()=>n("view"),className:`flex items-center justify-center sm:justify-start space-x-2 py-3 sm:py-4 border-b-2 transition-colors w-full sm:w-auto ${t==="view"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[r.jsx(wn,{className:"h-4 w-4 sm:h-5 sm:w-5"}),r.jsx("span",{className:"font-medium text-sm sm:text-base",children:"View Leaves"})]})]})}),r.jsx("div",{className:"p-4 sm:p-6",children:t==="request"?r.jsx(jQ,{}):r.jsx(NQ,{})})]})]})};function CQ(){const{user:e}=yr(),[t,n]=j.useState(!1),[a,s]=j.useState("dashboard"),i=()=>{n(!1),s("dashboard")},l=u=>{s(u)},d=()=>{switch(a){case"dashboard":return r.jsx(g4,{onNavigate:l});case"attendance":return r.jsx(xQ,{onNavigate:l});case"mark-attendance":return r.jsx(i5,{});case"view-attendance":return r.jsx(o5,{});case"assignments":return r.jsx(bQ,{onNavigate:l});case"add-assignments":return r.jsx(c5,{});case"view-assignments":return r.jsx(l5,{});case"view-results":return r.jsx(vQ,{});case"messages":return r.jsx(wQ,{});case"leave-request":return r.jsx(Yn,{permission:"viewLeaves",permissionName:"Leave Management",children:r.jsx(SQ,{onNavigate:l})});default:return r.jsx(g4,{onNavigate:l})}};return r.jsx(t5,{schoolCode:e?.schoolCode,children:r.jsx(fP,{children:r.jsx(pQ,{currentPage:a,onNavigate:l,onLogout:i,children:d()})})})}const kQ=[],AQ={},x4={totalSchools:0,totalUsers:0,lastLogin:""},d5=j.createContext(void 0);function IQ({children:e}){console.log("[AppProvider] Rendering AppProvider");const[t,n]=j.useState(kQ),[a,s]=j.useState(AQ),[i,l]=j.useState("dashboard"),[d,u]=j.useState(null),[m,p]=j.useState(x4);j.useEffect(()=>{async function T(){try{console.log("Fetching schools from backend...");const A=await Kn.getAllSchools();console.log("Schools response:",A.data);const I=(A.data||[]).map(P=>{const F="https://erp-backend-kfut.onrender.com/api".replace("/api",""),R=P.logoUrl?P.logoUrl.startsWith("http")?P.logoUrl:`${F}${P.logoUrl}`:"/default-school-logo.svg",$={admin:{manageUsers:!0,manageSchoolSettings:!0,viewAcademicDetails:!0,viewAttendance:!0,viewAssignments:!0,viewResults:!0,viewLeaves:!0,messageStudentsParents:!0,viewFees:!0,viewReports:!0},teacher:{manageUsers:!1,manageSchoolSettings:"limited",viewAcademicDetails:!0,viewAttendance:!0,viewAssignments:!0,viewResults:"own",viewLeaves:"own",messageStudentsParents:!0,viewFees:!1,viewReports:!1},student:{manageUsers:!1,manageSchoolSettings:!1,viewAcademicDetails:!1,viewAttendance:!1,viewAssignments:!0,viewResults:!0,viewLeaves:!1,messageStudentsParents:!1,viewFees:!1,viewReports:!1},parent:{manageUsers:!1,manageSchoolSettings:!1,viewAcademicDetails:!1,viewAttendance:!1,viewAssignments:!1,viewResults:!1,viewLeaves:!1,messageStudentsParents:!1,viewFees:!1,viewReports:!1}},L=P.accessMatrix||{},G={admin:{...$.admin,...L.admin},teacher:{...$.teacher,...L.teacher},student:{...$.student,...L.student},parent:{...$.parent,...L.parent}};return{id:P._id||P.id,name:P.name,code:P.code||"",logo:R,area:P.address?.area||P.address?.street||"",district:P.address?.district||P.address?.city||"",pinCode:P.address?.pinCode||P.address?.zipCode||"",mobile:P.mobile||P.contact?.phone||"",principalName:P.principalName||"",principalEmail:P.principalEmail||P.contact?.email||"",bankDetails:P.bankDetails||{},accessMatrix:G}});console.log("Mapped schools:",I),n(I),console.log("Fetching total users across all schools...");try{const P=await Kn.getAllSchoolsStats();console.log("All schools stats response:",P.data),p(F=>({...F,totalSchools:I.length,totalUsers:P.data?.totalUsers||0}))}catch(P){console.error("Error fetching all schools stats:",P),p(F=>({...F,totalSchools:I.length,totalUsers:0}))}const C=localStorage.getItem("erp.auth")||sessionStorage.getItem("erp.auth");if(C)try{const F=JSON.parse(C).user?.lastLogin;if(console.log("[AppContext] Last login from auth:",F),F){const $=new Date(F).toLocaleString();console.log("[AppContext] Formatted last login:",$),p(L=>({...L,lastLogin:$}))}else console.log("[AppContext] No lastLogin found in auth data")}catch(P){console.error("[AppContext] Error parsing auth data:",P)}else console.log("[AppContext] No auth data found in storage")}catch(A){console.error("Error fetching schools:",A),n([]),p(x4)}}T()},[]);const f=async T=>{const A=new FormData;A.append("name",String(T.name||"")),A.append("code",String(T.code||"")),A.append("mobile",String(T.mobile||"")),A.append("principalName",String(T.principalName||"")),A.append("principalEmail",String(T.principalEmail||"")),A.append("area",String(T.area||"")),A.append("district",String(T.district||"")),A.append("pinCode",String(T.pinCode||"")),A.append("address",JSON.stringify({street:T.address?.street||"",area:T.address?.area||T.area||"",city:T.address?.city||"",district:T.address?.district||T.district||"",taluka:T.address?.taluka||"",state:T.address?.state||"",stateId:T.address?.stateId||null,districtId:T.address?.districtId||null,talukaId:T.address?.talukaId||null,country:T.address?.country||"India",pinCode:T.address?.pinCode||T.pinCode||"",zipCode:T.address?.pinCode||T.pinCode||""})),A.append("contact",JSON.stringify({phone:T.contact?.phone||T.mobile||"",email:T.contact?.email||T.principalEmail||"",website:T.contact?.website||T.website||""})),A.append("bankDetails",JSON.stringify({bankName:T.bankDetails?.bankName||"",accountNumber:T.bankDetails?.accountNumber||"",ifscCode:T.bankDetails?.ifscCode||"",branch:T.bankDetails?.branch||"",accountHolderName:T.bankDetails?.accountHolderName||""})),A.append("accessMatrix",JSON.stringify(T.accessMatrix||{admin:{manageUsers:!0,manageSchoolSettings:!0,viewAttendance:!0,viewResults:!0,messageStudentsParents:!0},teacher:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!0,viewResults:!0,messageStudentsParents:!0},student:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!0,viewResults:!0,messageStudentsParents:!1},parent:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!0,viewResults:!0,messageStudentsParents:!1}})),A.append("schoolType",String(T.schoolType||"Public")),A.append("establishedYear",String(T.establishedYear||new Date().getFullYear())),A.append("affiliationBoard",String(T.affiliationBoard||"CBSE")),A.append("website",String(T.website||"")),A.append("secondaryContact",String(T.secondaryContact||"")),A.append("settings",JSON.stringify({academicYear:{startDate:new Date().toISOString(),endDate:new Date().toISOString(),currentYear:"2024-25"}})),A.append("features",JSON.stringify({})),T.logoFile&&A.append("logo",T.logoFile);try{let I=localStorage.getItem("token");if(I||(I=localStorage.getItem("authToken")),!I){const F=localStorage.getItem("erp.auth");if(F)try{I=JSON.parse(F).token}catch(R){console.error("Error parsing auth data:",R)}}if(console.log("Retrieved token:",I),!I)throw new Error("Authorization token is missing");const C=await Kn.createSchool(A),P=C.data?.school||C.data;if(P){const F="https://erp-backend-kfut.onrender.com/api".replace("/api",""),R=P.logoUrl?P.logoUrl.startsWith("http")?P.logoUrl:`${F}${P.logoUrl}`:"";n($=>[...$,{id:P._id||P.id,name:P.name,code:P.code||"",logo:R,area:P.address?.street||"",district:P.address?.city||"",pinCode:P.address?.zipCode||"",mobile:P.contact?.phone||"",principalName:P.principalName||"",principalEmail:P.contact?.email||"",bankDetails:P.bankDetails||{},accessMatrix:P.accessMatrix||{}}]),p($=>({...$,totalSchools:$.totalSchools+1}));try{const $=await Kn.getAllSchoolsStats();p(L=>({...L,totalUsers:$.data?.totalUsers||0})),console.log("[ADD] Updated total users count after school addition")}catch($){console.error("[ADD] Error refreshing total users count:",$)}}}catch(I){console.error("Error adding school:",I);let C="Failed to create school";throw I?.response?.data?.message?C=I.response.data.message:I?.message&&(C=I.message),new Error(C)}},g=async T=>{try{console.log(`[DELETE] Starting deletion process for school ID: ${T}`);const A=await Kn.deleteSchool(T);if(console.log("[DELETE] Backend response:",A.data),A.data?.success===!1)throw new Error(A.data?.message||"Backend reported failure");n(I=>{const C=I.find(F=>F.id===T),P=I.filter(F=>F.id!==T);return console.log(`[DELETE] Removed school "${C?.name}" from UI. Remaining schools: ${P.length}`),P}),p(I=>({...I,totalSchools:I.totalSchools-1})),console.log("[DELETE] School successfully deleted from UI state");try{const I=await Kn.getAllSchoolsStats();p(C=>({...C,totalUsers:I.data?.totalUsers||0})),console.log("[DELETE] Updated total users count after school deletion")}catch(I){console.error("[DELETE] Error refreshing total users count:",I)}return A.data}catch(A){throw console.error("[DELETE] Error deleting school:",{error:A,response:A?.response?.data,status:A?.response?.status,message:A?.message}),A?.response?.status===401?new Error("Authentication failed. Please log in again."):A?.response?.status===403?new Error("Permission denied. Only super admin can delete schools."):A?.response?.status===404?new Error("School not found or already deleted."):A?.response?.data?.message?new Error(A.response.data.message):new Error(A?.message||"Failed to delete school. Please try again.")}},N=async T=>{const A=await Kn.updateSchool(T.id,T),I=A.data?.school||A.data;n(C=>C.map(P=>P.id===T.id?{...P,name:I.name??P.name,code:I.code??P.code,logo:I.logoUrl?String(I.logoUrl).startsWith("http")?I.logoUrl:`https://erp-backend-kfut.onrender.com/api${I.logoUrl}`:P.logo,area:I.address?.street??P.area,district:I.address?.city??P.district,pinCode:I.address?.zipCode??P.pinCode,mobile:I.contact?.phone??P.mobile,principalName:I.principalName??P.principalName,principalEmail:I.principalEmail??P.principalEmail,bankDetails:I.bankDetails??P.bankDetails,accessMatrix:I.accessMatrix??P.accessMatrix}:P))},v=async(T,A)=>{const I=await Kn.updateAccessMatrix(T,A),C=I.data?.school||I.data;n(P=>P.map(F=>F.id===T?{...F,accessMatrix:C.accessMatrix||A}:F))},w=async(T,A)=>{const I=await Kn.updateBankDetails(T,A),C=I.data?.bankDetails||I.data?.school?.bankDetails||A;n(P=>P.map(F=>F.id===T?{...F,bankDetails:C}:F))},y=async(T,A,I)=>{await Kn.updateUserRole(T,A,I)},E=async(T,A)=>{const I=await Kn.updateSchoolSettings(T,A),C=I.data?.school||I.data;n(P=>P.map(F=>F.id===T?{...F,bankDetails:C.bankDetails??F.bankDetails,accessMatrix:C.accessMatrix??F.accessMatrix}:F)),s(P=>({...P,[T]:{...P[T]||{},settings:C.settings||A}}))},O=T=>a[T];return r.jsx(d5.Provider,{value:{schools:t,schoolsData:a,currentView:i,selectedSchoolId:d,stats:m,setCurrentView:l,setSelectedSchoolId:u,addSchool:f,updateSchool:N,deleteSchool:g,updateSchoolAccess:v,updateBankDetails:w,updateUserRole:y,updateSchoolSettings:E,getSchoolData:O},children:e})}function Li(){const e=j.useContext(d5);if(console.log("[useApp] Context value:",e),e===void 0)throw console.error("[useApp] Context is undefined - this should not happen if AppProvider is properly set up"),new Error("useApp must be used within an AppProvider");return e}function EQ(){const{currentView:e,setCurrentView:t,stats:n}=Li(),a=[{id:"dashboard",label:"Dashboard",icon:tw},{id:"add-school",label:"Add New School",icon:Os}];return r.jsxs("div",{className:"bg-white border-r border-gray-200 w-full lg:w-64 lg:min-h-screen flex flex-col",children:[r.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Yo,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600"}),r.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Super Admin"})]})}),r.jsx("nav",{className:"flex-1 p-3 sm:p-4",children:r.jsx("ul",{className:"space-y-1 sm:space-y-2 lg:block flex lg:flex-col",children:a.map(s=>{const i=s.icon;return r.jsx("li",{className:"flex-1 lg:flex-none",children:r.jsxs("button",{onClick:()=>t(s.id),className:`w-full flex items-center justify-center lg:justify-start space-x-2 lg:space-x-3 px-3 lg:px-4 py-2 lg:py-3 rounded-lg transition-colors duration-200 text-sm lg:text-base ${e===s.id?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[r.jsx(i,{className:"h-4 w-4 lg:h-5 lg:w-5"}),r.jsx("span",{className:"font-medium hidden sm:inline lg:inline",children:s.label})]})},s.id)})})}),r.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200 hidden lg:block",children:r.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4 mb-4",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Quick Stats"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-xs text-gray-600",children:"Schools"}),r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n.totalSchools})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-xs text-gray-600",children:"Users"}),r.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n.totalUsers})]})]})]})})]})}function PQ({isOpen:e,schoolName:t,schoolId:n,onClose:a,onConfirm:s}){const[i,l]=j.useState("warning"),[d,u]=j.useState(""),[m,p]=j.useState(null),[f,g]=j.useState(!1);if(!e)return null;const N=()=>{l("confirm"),p(null)},v=async()=>{if(d!==t){p(`School name does not match. You entered: "${d}", Required: "${t}"`);return}l("processing"),g(!0),p(null);try{await s(n)}catch(y){p(y?.message||"Failed to delete school. Please try again."),l("confirm"),g(!1)}},w=()=>{f||(l("warning"),u(""),p(null),a())};return r.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:w}),r.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:r.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl max-w-lg w-full p-6 transform transition-all",children:[!f&&r.jsx("button",{onClick:w,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Ur,{className:"h-5 w-5"})}),i==="warning"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Zo,{className:"h-8 w-8 text-red-600"})}),r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Permanent Deletion Warning"})]}),r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsxs("p",{className:"text-sm font-medium text-red-900 mb-2",children:["You are about to delete school: ",r.jsxs("span",{className:"font-bold",children:['"',t,'"']})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"This action will PERMANENTLY DELETE:"}),r.jsxs("ul",{className:"space-y-1 text-sm text-gray-700",children:[r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-red-600 mr-2",children:""}),r.jsx("span",{children:"School record and all settings"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-red-600 mr-2",children:""}),r.jsx("span",{children:"All users (admins, teachers, students, parents)"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-red-600 mr-2",children:""}),r.jsx("span",{children:"All classes, sections, and subjects"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-red-600 mr-2",children:""}),r.jsx("span",{children:"All test records and results"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-red-600 mr-2",children:""}),r.jsx("span",{children:"All attendance data"})]}),r.jsxs("li",{className:"flex items-start",children:[r.jsx("span",{className:"text-red-600 mr-2",children:""}),r.jsx("span",{children:"School database and all data"})]})]})]}),r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:r.jsx("p",{className:"text-sm font-bold text-yellow-900 text-center",children:" THIS ACTION CANNOT BE UNDONE "})}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{onClick:w,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),r.jsx("button",{onClick:N,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:"I Understand, Continue"})]})]}),i==="confirm"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Zo,{className:"h-8 w-8 text-red-600"})}),r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Final Confirmation"})]}),r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[r.jsx("p",{className:"text-sm text-red-900 mb-3",children:"To confirm deletion, please type the school name exactly as shown below:"}),r.jsx("p",{className:"text-lg font-bold text-red-900 text-center bg-white rounded px-3 py-2 border border-red-300",children:t})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type school name to confirm:"}),r.jsx("input",{type:"text",value:d,onChange:y=>{u(y.target.value),p(null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Enter school name",autoFocus:!0})]}),m&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:r.jsx("p",{className:"text-sm text-red-800",children:m})}),r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:r.jsxs("p",{className:"text-xs text-yellow-900",children:[r.jsx("strong",{children:"Note:"})," This will delete ALL data permanently and cannot be recovered."]})}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{onClick:w,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),r.jsx("button",{onClick:v,disabled:d!==t,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium disabled:bg-red-300 disabled:cursor-not-allowed",children:"Delete Permanently"})]})]}),i==="processing"&&r.jsxs("div",{className:"space-y-6 py-8",children:[r.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[r.jsx(Hl,{className:"h-16 w-16 text-red-600 animate-spin"}),r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Deleting School..."}),r.jsxs("p",{className:"text-sm text-gray-600",children:['Please wait while we delete "',t,'" and all associated data.']}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"This may take a few moments."})]})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:r.jsx("p",{className:"text-xs text-blue-900 text-center",children:"Do not close this window or refresh the page."})})]})]})})]})}function y4(){const{schools:e,stats:t,setCurrentView:n,setSelectedSchoolId:a,deleteSchool:s}=Li(),[i,l]=j.useState(""),[d,u]=j.useState({isOpen:!1,schoolId:"",schoolName:""}),[m,p]=j.useState(null),f=A=>{a(A),n("view-access")},g=A=>{a(A),n("account-details")},N=A=>{a(A),n("school-details")},v=A=>{a(A),n("edit-school")},w=(A,I)=>{u({isOpen:!0,schoolId:A,schoolName:I})},y=async A=>{try{await s(A),u({isOpen:!1,schoolId:"",schoolName:""}),p(`School "${d.schoolName}" and all associated data have been permanently deleted.`),setTimeout(()=>p(null),5e3)}catch(I){throw I}},E=()=>{u({isOpen:!1,schoolId:"",schoolName:""})},O=[{title:"Total Schools",value:t.totalSchools,icon:Yo,color:"text-blue-600",bg:"bg-blue-50"},{title:"Total Users",value:t.totalUsers,icon:$n,color:"text-emerald-600",bg:"bg-emerald-50"},{title:"Last Login",value:t.lastLogin,icon:bs,color:"text-orange-600",bg:"bg-orange-50"}],T=e.filter(A=>{const I=i.toLowerCase();return A.name.toLowerCase().includes(I)||A.code?.toLowerCase().includes(I)||A.area.toLowerCase().includes(I)||A.district.toLowerCase().includes(I)||A.principalName.toLowerCase().includes(I)||A.principalEmail.toLowerCase().includes(I)});return r.jsxs(r.Fragment,{children:[r.jsx(PQ,{isOpen:d.isOpen,schoolId:d.schoolId,schoolName:d.schoolName,onClose:E,onConfirm:y}),r.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[m&&r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center space-x-3",children:[r.jsx(ba,{className:"h-5 w-5 text-green-600 flex-shrink-0"}),r.jsx("p",{className:"text-sm text-green-800",children:m})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"School Management Dashboard"}),r.jsxs("button",{onClick:()=>n("add-school"),className:"bg-blue-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center space-x-2 text-sm sm:text-base w-full sm:w-auto justify-center",children:[r.jsx(Yo,{className:"h-4 w-4 sm:h-5 sm:w-5"}),r.jsx("span",{children:"Add New School"})]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:O.map((A,I)=>{const C=A.icon;return r.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 sm:p-6 hover:shadow-lg transition-shadow duration-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:A.title}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:A.value})]}),r.jsx("div",{className:`${A.bg} p-3 rounded-lg`,children:r.jsx(C,{className:`h-6 w-6 ${A.color}`})})]})},I)})}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[r.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Registered Schools"})}),r.jsxs("div",{className:"mt-4 relative",children:[r.jsx(va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 sm:h-5 sm:w-5 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search schools by name, code, area, district, principal...",value:i,onChange:A=>l(A.target.value),className:"w-full pl-9 sm:pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),r.jsx("div",{className:"p-4 sm:p-6",children:T.length===0?r.jsxs("div",{className:"text-center py-8 sm:py-12",children:[r.jsx(Yo,{className:"h-8 w-8 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-3"}),r.jsx("p",{className:"text-sm sm:text-base text-gray-500",children:"No schools found matching your search."})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6",children:T.map(A=>r.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-4 sm:p-6 hover:shadow-md transition-shadow duration-200",children:[r.jsxs("div",{className:"flex items-start space-x-3 sm:space-x-4",children:[r.jsx("img",{src:A.logo,alt:`${A.logo} logo`,className:"w-12 h-12 sm:w-16 sm:h-16 rounded-lg object-cover border border-gray-200"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 truncate",children:A.name}),r.jsx("div",{className:"flex items-center space-x-2 mt-1",children:r.jsx("span",{className:"text-xs font-medium text-blue-600 bg-blue-100 px-2 py-1 rounded",children:A.code||"No Code"})}),r.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:[A.area,", ",A.district]}),r.jsxs("p",{className:"text-xs sm:text-sm text-gray-600",children:["PIN: ",A.pinCode]})]})]}),r.jsxs("div",{className:"mt-3 sm:mt-4 space-y-1 sm:space-y-2",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"Principal:"}),r.jsx("span",{className:"text-xs sm:text-sm text-gray-600 truncate",children:A.principalName})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"Contact:"}),r.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:A.mobile})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:"Email:"}),r.jsx("span",{className:"text-xs sm:text-sm text-gray-600 truncate",children:A.principalEmail})]})]}),r.jsxs("div",{className:"mt-4 sm:mt-6 flex flex-wrap gap-1 sm:gap-2",children:[r.jsxs("button",{onClick:()=>f(A.id),className:"flex items-center space-x-1 px-2 sm:px-3 py-1.5 sm:py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors duration-200 text-xs sm:text-sm font-medium",children:[r.jsx(wn,{className:"h-3 w-3 sm:h-4 sm:w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"View Access"}),r.jsx("span",{className:"sm:hidden",children:"View"})]}),r.jsxs("button",{onClick:()=>g(A.id),className:"flex items-center space-x-1 px-2 sm:px-3 py-1.5 sm:py-2 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition-colors duration-200 text-xs sm:text-sm font-medium",children:[r.jsx(Gl,{className:"h-3 w-3 sm:h-4 sm:w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Account Details"}),r.jsx("span",{className:"sm:hidden",children:"Account"})]}),r.jsxs("button",{onClick:()=>N(A.id),className:"flex items-center space-x-1 px-2 sm:px-3 py-1.5 sm:py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors duration-200 text-xs sm:text-sm font-medium",children:[r.jsx(Pn,{className:"h-3 w-3 sm:h-4 sm:w-4"}),r.jsx("span",{children:"Details"})]}),r.jsxs("button",{onClick:()=>v(A.id),className:"flex items-center space-x-1 px-2 sm:px-3 py-1.5 sm:py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-xs sm:text-sm font-medium",children:[r.jsx(Qs,{className:"h-3 w-3 sm:h-4 sm:w-4"}),r.jsx("span",{children:"Edit"})]}),r.jsxs("button",{onClick:()=>w(A.id,A.name),className:"flex items-center space-x-1 px-2 sm:px-3 py-1.5 sm:py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200 text-xs sm:text-sm font-medium",children:[r.jsx(Ba,{className:"h-3 w-3 sm:h-4 sm:w-4"}),r.jsx("span",{children:"Delete"})]})]})]},A.id))})})]})]})]})}Array.from({length:10},(e,t)=>(t+1).toString());(()=>{const e=new Date().getFullYear(),t=[];for(let n=-2;n<=2;n++){const a=e+n,s=a+1;t.push(`${a}-${s}`)}return t})();const Nd={mobile:/^\d{10}$/,pinCode:/^\d{6}$/,ifsc:/^[A-Z]{4}0[A-Z0-9]{6}$/,email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/};function TQ(){const{setCurrentView:e,addSchool:t}=Li(),[n,a]=j.useState({name:"",code:"",street:"",area:"",city:"",district:"",taluka:"",state:"",stateId:"",districtId:"",talukaId:"",districtText:"",talukaText:"",pinCode:"",mobile:"",principalName:"",principalEmail:"",website:"",bankName:"",accountNumber:"",ifscCode:"",branch:"",accountHolderName:"",schoolType:"",establishedYear:"",affiliationBoard:"",secondaryContact:""}),[s,i]=j.useState(null),[l,d]=j.useState(null),[u,m]=j.useState(null),[p,f]=j.useState(null),[g,N]=j.useState({}),[v,w]=j.useState(!1),y=()=>{const $={};if(n.name.trim()||($.name="School name is required"),n.code.trim()||($.code="School code is required"),n.area.trim()||($.area="Area is required"),n.district.trim()||($.district="District is required"),n.pinCode.trim()?Nd.pinCode.test(n.pinCode.trim())||($.pinCode="Pin code must be 6 digits"):$.pinCode="Pin code is required",n.mobile.trim()?Nd.mobile.test(n.mobile.trim())||($.mobile="Mobile number must be 10 digits"):$.mobile="Mobile number is required",n.principalName.trim()||($.principalName="Principal name is required"),n.principalEmail.trim()?Nd.email.test(n.principalEmail.trim())||($.principalEmail="Please enter a valid email address"):$.principalEmail="Principal email is required",n.schoolType||($.schoolType="School type is required"),!n.establishedYear.trim())$.establishedYear="Established year is required";else{const L=parseInt(n.establishedYear),G=new Date().getFullYear();isNaN(L)||L<1800||L>G?$.establishedYear=`Year must be between 1800 and ${G}`:n.establishedYear.length!==4&&($.establishedYear="Year must be exactly 4 digits")}return n.affiliationBoard||($.affiliationBoard="Affiliation board is required"),n.bankName.trim()||($.bankName="Bank name is required"),n.accountNumber.trim()?/^\d{16}$/.test(n.accountNumber.trim())||($.accountNumber="Account number must be exactly 16 digits"):$.accountNumber="Account number is required",n.ifscCode.trim()?Nd.ifsc.test(n.ifscCode.trim().toUpperCase())||($.ifscCode="IFSC code must be 11 characters (format: ABCD0123456)"):$.ifscCode="IFSC code is required",n.branch.trim()||($.branch="Branch name is required"),n.accountHolderName.trim()||($.accountHolderName="Account holder name is required"),n.secondaryContact.trim()&&!Nd.mobile.test(n.secondaryContact.trim())&&($.secondaryContact="Secondary contact must be 10 digits"),N($),Object.keys($).length===0},E=$=>{const L=$.target.files?.[0];if(L){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(L.type)){N(me=>({...me,logo:"Only image files (JPEG, PNG, GIF, WebP) are allowed"}));return}if(L.size>10*1024*1024){N(me=>({...me,logo:"File size must be less than 10MB"}));return}i(L),N(me=>({...me,logo:""}));const X=new FileReader;X.onloadend=()=>{d(X.result)},X.readAsDataURL(L)}},O=async $=>{if($.preventDefault(),m(null),f(null),!y()){f("Please fix the validation errors below");return}w(!0);try{await t({name:n.name.trim(),code:n.code.trim().toUpperCase(),mobile:n.mobile.trim(),principalName:n.principalName.trim(),principalEmail:n.principalEmail.trim(),logoFile:s||void 0,address:{street:n.street.trim(),area:n.area.trim(),city:n.city.trim(),district:n.district.trim(),taluka:n.taluka.trim(),state:n.state.trim(),stateId:n.stateId?parseInt(n.stateId):void 0,districtId:n.districtId?parseInt(n.districtId):void 0,talukaId:n.talukaId?parseInt(n.talukaId):void 0,pinCode:n.pinCode.trim(),country:"India"},contact:{phone:n.mobile.trim(),email:n.principalEmail.trim(),website:n.website.trim()},bankDetails:{bankName:n.bankName.trim(),accountNumber:n.accountNumber.trim(),ifscCode:n.ifscCode.trim().toUpperCase(),branch:n.branch.trim(),accountHolderName:n.accountHolderName.trim()},accessMatrix:{admin:{manageUsers:!0,manageSchoolSettings:!0,viewAttendance:!0,viewResults:!0,messageStudentsParents:!0},teacher:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!0,viewResults:!0,messageStudentsParents:!0},student:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!0,viewResults:!0,messageStudentsParents:!1},parent:{manageUsers:!1,manageSchoolSettings:!1,viewAttendance:!0,viewResults:!0,messageStudentsParents:!1}},schoolType:n.schoolType.trim(),establishedYear:n.establishedYear.trim(),affiliationBoard:n.affiliationBoard.trim(),secondaryContact:n.secondaryContact.trim()}),m("School created successfully!"),setTimeout(()=>{e("dashboard")},1200)}catch(L){f(L?.message||"Failed to create school")}finally{w(!1)}i(null),d(null)},T=()=>{a({name:"",code:"",street:"",area:"",city:"",district:"",taluka:"",state:"",stateId:"",districtId:"",talukaId:"",districtText:"",talukaText:"",pinCode:"",mobile:"",principalName:"",principalEmail:"",website:"",bankName:"",accountNumber:"",ifscCode:"",branch:"",accountHolderName:"",schoolType:"",establishedYear:"",affiliationBoard:"",secondaryContact:""}),i(null),d(null),N({}),f(null),m(null)},A=($,L)=>{a(G=>({...G,stateId:$.toString(),state:L.name,districtId:"",district:"",talukaId:"",taluka:"",districtText:"",talukaText:""}))},I=($,L)=>{a(G=>({...G,districtId:$.toString(),district:L.name,talukaId:"",taluka:"",talukaText:""}))},C=($,L)=>{a(G=>({...G,talukaId:$.toString(),taluka:L.name}))},P=$=>{a(L=>({...L,districtText:$,district:$,talukaText:""}))},F=$=>{a(L=>({...L,talukaText:$,taluka:$}))},R=$=>g[$]?r.jsx("p",{className:"text-red-500 text-xs mt-1",children:g[$]}):null;return r.jsx("div",{className:"p-6",children:r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsx("div",{className:"mb-6",children:r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add New School"})}),u&&r.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-800 rounded-lg",children:u}),p&&r.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 text-red-800 rounded-lg",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Ur,{className:"h-5 w-5 text-red-400"})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("h3",{className:"text-sm font-medium text-red-800",children:p.includes("already exists")?"School Code Already Used":"Error Creating School"}),r.jsx("div",{className:"mt-1 text-sm text-red-700",children:p})]})]})}),r.jsxs("form",{onSubmit:O,className:"space-y-8",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"School Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Name"}),r.jsx("input",{type:"text",required:!0,value:n.name,onChange:$=>a({...n,name:$.target.value}),className:`w-full px-3 py-2 border ${g.name?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter school name"}),R("name")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Code"}),r.jsx("input",{type:"text",required:!0,value:n.code,onChange:$=>a({...n,code:$.target.value.toUpperCase()}),className:`w-full px-3 py-2 border ${g.code?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter school code (e.g., NPS, DAV, KVS)",maxLength:10}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This code will be used for admin and teacher panel identification. Must be unique across all schools."}),R("code")]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Logo"}),r.jsxs("div",{className:"flex items-start space-x-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:E,className:`w-full px-3 py-2 border ${g.logo?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload school logo (JPEG, PNG, GIF, WebP). Max size: 10MB. Image will be compressed automatically."}),R("logo")]}),l&&r.jsx("div",{className:"flex-shrink-0",children:r.jsxs("div",{className:"relative w-24 h-24 border-2 border-gray-300 rounded-lg overflow-hidden",children:[r.jsx("img",{src:l,alt:"Logo preview",className:"w-full h-full object-contain"}),r.jsx("button",{type:"button",onClick:()=>{i(null),d(null)},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:r.jsx(Ur,{className:"h-3 w-3"})})]})})]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address"}),r.jsx("input",{type:"text",required:!0,value:n.street,onChange:$=>a({...n,street:$.target.value}),className:`w-full px-3 py-2 border ${g.street?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter street address"}),R("street")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Area/Locality"}),r.jsx("input",{type:"text",required:!0,value:n.area,onChange:$=>a({...n,area:$.target.value}),className:`w-full px-3 py-2 border ${g.area?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter area/locality"}),R("area")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),r.jsx("input",{type:"text",required:!0,value:n.city,onChange:$=>a({...n,city:$.target.value}),className:`w-full px-3 py-2 border ${g.city?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter city"}),R("city")]})]}),r.jsxs("div",{className:"mt-6",children:[r.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Location Details"}),r.jsx(yj,{selectedState:n.stateId,selectedDistrict:n.districtId,selectedTaluka:n.talukaId,districtText:n.districtText,talukaText:n.talukaText,onStateChange:A,onDistrictChange:I,onTalukaChange:C,onDistrictTextChange:P,onTalukaTextChange:F,required:!0,className:"grid grid-cols-1 md:grid-cols-3 gap-4"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pin Code"}),r.jsx("input",{type:"text",required:!0,maxLength:6,value:n.pinCode,onChange:$=>{const L=$.target.value.replace(/\D/g,"");a({...n,pinCode:L})},className:`w-full px-3 py-2 border ${g.pinCode?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter 6-digit pin code"}),R("pinCode")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobile Number"}),r.jsx("input",{type:"tel",required:!0,maxLength:10,value:n.mobile,onChange:$=>{const L=$.target.value.replace(/\D/g,"");a({...n,mobile:L})},className:`w-full px-3 py-2 border ${g.mobile?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter 10-digit mobile number"}),R("mobile")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Principal Name"}),r.jsx("input",{type:"text",required:!0,value:n.principalName,onChange:$=>a({...n,principalName:$.target.value}),className:`w-full px-3 py-2 border ${g.principalName?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter principal name"}),R("principalName")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Principal Email ID"}),r.jsx("input",{type:"email",required:!0,value:n.principalEmail,onChange:$=>a({...n,principalEmail:$.target.value}),className:`w-full px-3 py-2 border ${g.principalEmail?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter principal email"}),R("principalEmail")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website URL"}),r.jsx("input",{type:"url",value:n.website,onChange:$=>a({...n,website:$.target.value}),className:`w-full px-3 py-2 border ${g.website?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter website URL (optional)"}),R("website")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Type"}),r.jsxs("select",{required:!0,value:n.schoolType,onChange:$=>a({...n,schoolType:$.target.value}),className:`w-full px-3 py-2 border ${g.schoolType?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,children:[r.jsx("option",{value:"",children:"Select School Type"}),r.jsx("option",{value:"Public",children:"Public"}),r.jsx("option",{value:"Private",children:"Private"}),r.jsx("option",{value:"International",children:"International"})]}),R("schoolType")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Established Year"}),r.jsx("input",{type:"number",required:!0,min:1800,max:new Date().getFullYear(),maxLength:4,pattern:"[0-9]{4}",value:n.establishedYear,onChange:$=>{const L=$.target.value.replace(/\D/g,"");L.length<=4&&a({...n,establishedYear:L})},className:`w-full px-3 py-2 border ${g.establishedYear?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter year"}),R("establishedYear")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Affiliation Board"}),r.jsxs("select",{required:!0,value:n.affiliationBoard,onChange:$=>a({...n,affiliationBoard:$.target.value}),className:`w-full px-3 py-2 border ${g.affiliationBoard?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,children:[r.jsx("option",{value:"",children:"Select Affiliation Board"}),r.jsx("option",{value:"CBSE",children:"CBSE"}),r.jsx("option",{value:"ICSE",children:"ICSE"}),r.jsx("option",{value:"State Board",children:"State Board"}),r.jsx("option",{value:"IB",children:"IB"})]}),R("affiliationBoard")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secondary Contact Number"}),r.jsx("input",{type:"tel",maxLength:10,value:n.secondaryContact,onChange:$=>{const L=$.target.value.replace(/\D/g,"");a({...n,secondaryContact:L})},className:`w-full px-3 py-2 border ${g.secondaryContact?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter 10-digit secondary contact number"}),R("secondaryContact")]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Bank Account Details"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Name"}),r.jsx("input",{type:"text",required:!0,value:n.bankName,onChange:$=>a({...n,bankName:$.target.value}),className:`w-full px-3 py-2 border ${g.bankName?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter bank name"}),R("bankName")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Number"}),r.jsx("input",{type:"text",required:!0,maxLength:16,value:n.accountNumber,onChange:$=>{const L=$.target.value.replace(/\D/g,"");a({...n,accountNumber:L})},className:`w-full px-3 py-2 border ${g.accountNumber?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter 16-digit account number"}),R("accountNumber")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IFSC Code"}),r.jsx("input",{type:"text",required:!0,maxLength:11,value:n.ifscCode,onChange:$=>a({...n,ifscCode:$.target.value.toUpperCase()}),className:`w-full px-3 py-2 border ${g.ifscCode?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter 11-character IFSC code (e.g., SBIN0123456)"}),R("ifscCode")]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Branch"}),r.jsx("input",{type:"text",required:!0,value:n.branch,onChange:$=>a({...n,branch:$.target.value}),className:`w-full px-3 py-2 border ${g.branch?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter branch name"}),R("branch")]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Holder Name"}),r.jsx("input",{type:"text",required:!0,value:n.accountHolderName,onChange:$=>a({...n,accountHolderName:$.target.value}),className:`w-full px-3 py-2 border ${g.accountHolderName?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,placeholder:"Enter account holder name"}),R("accountHolderName")]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-4",children:[r.jsx("button",{type:"button",onClick:()=>e("dashboard"),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors duration-200 font-medium",children:"Cancel"}),r.jsx("button",{type:"button",onClick:T,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors duration-200 font-medium",children:"Clear"}),r.jsxs("button",{type:"submit",disabled:v,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium disabled:bg-blue-400 disabled:cursor-not-allowed flex items-center space-x-2",children:[v&&r.jsx(Hl,{className:"h-5 w-5 animate-spin"}),r.jsx("span",{children:v?"Creating School...":"Submit"})]})]})]})]})})}const DQ=[{key:"manageUsers",label:"Manage Users",description:"Access to add, edit, and delete users"},{key:"manageSchoolSettings",label:"Manage School Settings",description:"Access to configure school settings"},{key:"viewAcademicDetails",label:"Academic Details",description:"Access to manage academic year and classes"},{key:"viewAttendance",label:"Attendance",description:"Access to view and mark attendance"},{key:"viewAssignments",label:"Assignments",description:"Access to manage assignments"},{key:"viewResults",label:"Results",description:"Access to view student results"},{key:"viewLeaves",label:"Leave Management",description:"Access to manage leave requests and approvals"},{key:"messageStudentsParents",label:"Message Students/Parents",description:"Access to send messages to students and parents"},{key:"viewFees",label:"Manage Fees",description:"Access to manage fee structure and payments"},{key:"viewReports",label:"View Reports",description:"Access to generate and view reports"}],b4=[{key:"viewAttendance",label:"Attendance",description:"Access to view and mark attendance"},{key:"viewAssignments",label:"Assignments",description:"Access to view assignments"},{key:"viewResults",label:"Results",description:"Access to view student results"},{key:"viewLeaves",label:"Leave Management",description:"Access to manage own leave requests"},{key:"messageStudentsParents",label:"Message Students/Parents",description:"Access to send messages to students and parents"}],v4=DQ,OQ=["admin","teacher"];function _Q(){const{schools:e,selectedSchoolId:t,setCurrentView:n,updateSchoolAccess:a}=Li(),[s,i]=j.useState(null),l=e.find(p=>p.id===t);if(j.useEffect(()=>{l&&i(l.accessMatrix)},[l]),!l||!s)return r.jsx("div",{className:"p-6",children:r.jsx("p",{className:"text-gray-600",children:"School not found"})});const d=(p,f)=>{s&&i(g=>{const N=g[p][f];let v;return p==="teacher"&&f==="viewLeaves"||p==="teacher"&&f==="viewResults"?v=N==="own"||N===!0?!1:"own":p==="teacher"&&f==="manageSchoolSettings"?v=N==="limited"||N===!0?!1:"limited":v=!N,{...g,[p]:{...g[p],[f]:v}}})},u=async()=>{if(s&&t)try{await a(t,s),ge.success("Access permissions updated successfully!"),await new Promise(p=>setTimeout(p,500)),window.dispatchEvent(new Event("permission-refresh")),n("dashboard")}catch(p){ge.error("Failed to update access permissions"),console.error("Error updating access matrix:",p)}},m=({role:p})=>{const f=p==="teacher"?b4:v4,g=f.filter(N=>!!s[p][N.key]).length;return r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[r.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 capitalize",children:[p," Access Matrix"]}),r.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:["Configure access permissions for ",p," role"]})]}),r.jsx("div",{className:"flex items-center space-x-4",children:r.jsxs("div",{className:"text-left sm:text-right",children:[r.jsxs("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:[g," of ",f.length," permissions enabled"]}),r.jsx("div",{className:"w-24 sm:w-32 bg-gray-200 rounded-full h-2 mt-1",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${g/f.length*100}%`}})})]})})]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 sm:px-6 py-3 sm:py-4 text-left text-xs sm:text-sm font-semibold text-gray-900 min-w-[250px] sm:min-w-[300px]",children:"Permissions"}),r.jsx("th",{className:"px-3 sm:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm font-semibold text-gray-900 min-w-[80px] sm:min-w-[120px]",children:"Access"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:f.map(N=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900",children:N.label}),"description"in N&&r.jsx("span",{className:"text-xs text-gray-500 mt-0.5 hidden sm:block",children:N.description})]})}),r.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4 text-center",children:r.jsx("label",{className:"inline-flex items-center",children:r.jsx("input",{type:"checkbox",checked:!!s[p][N.key],onChange:()=>d(p,N.key),className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"})})})]},N.key))})]})})]})};return r.jsx("div",{className:"p-4 sm:p-6",children:r.jsxs("div",{className:"max-w-6xl mx-auto",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4 sm:mb-6",children:[r.jsx("div",{children:r.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:["Access Control - ",l.name]})}),r.jsxs("button",{onClick:u,className:"flex items-center justify-center space-x-2 bg-blue-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 w-full sm:w-auto text-sm sm:text-base",children:[r.jsx(rs,{className:"h-4 w-4 sm:h-5 sm:w-5"}),r.jsx("span",{children:"Save Changes"})]})]}),r.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-5 w-5 text-blue-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),r.jsx("div",{className:"ml-3",children:r.jsxs("p",{className:"text-sm text-blue-800",children:[r.jsx("strong",{className:"font-semibold",children:"Access Control:"})," When you uncheck a permission, users of that role will see a popup notification when they try to access that feature. Changes take effect immediately for logged-in users."]})})]}),r.jsx("div",{className:"mb-6",children:r.jsx(m,{role:"admin"})}),r.jsx("div",{className:"mb-6",children:r.jsx(m,{role:"teacher"})}),r.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:OQ.map(p=>{const f=p==="teacher"?b4:v4,g=f.filter(N=>!!s[p][N.key]).length;return r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[r.jsxs("h3",{className:"text-sm font-semibold text-gray-900 capitalize mb-2",children:[p," Role Summary"]}),r.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[g," of ",f.length," permissions enabled"]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${g/f.length*100}%`}})})]},p)})})]})})}function MQ(){const{schools:e,selectedSchoolId:t,setCurrentView:n,updateBankDetails:a}=Li(),[s,i]=j.useState(null),[l,d]=j.useState(!1),u=e.find(f=>f.id===t);if(j.useEffect(()=>{u&&i(u.bankDetails)},[u]),!u||!s)return r.jsx("div",{className:"p-6",children:r.jsx("p",{className:"text-gray-600",children:"School not found"})});const m=()=>{s&&t&&(a(t,s),d(!1))},p=()=>{u&&(i(u.bankDetails),d(!1))};return r.jsx("div",{className:"p-6",children:r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("div",{children:r.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Account Details - ",u.name]})}),l?r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:p,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),r.jsxs("button",{onClick:m,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[r.jsx(rs,{className:"h-5 w-5"}),r.jsx("span",{children:"Save Changes"})]})]}):r.jsxs("button",{onClick:()=>d(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:[r.jsx(Qs,{className:"h-5 w-5"}),r.jsx("span",{children:"Edit Details"})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[r.jsxs("div",{className:"p-6 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Gl,{className:"h-6 w-6 text-blue-600"}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Fee Payment Account Information"})]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Bank account details for fee collection"})]}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Name"}),l?r.jsx("input",{type:"text",value:s.bankName,onChange:f=>i({...s,bankName:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):r.jsx("p",{className:"px-3 py-2 bg-gray-50 rounded-lg text-gray-900",children:s.bankName})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Number"}),l?r.jsx("input",{type:"text",value:s.accountNumber,onChange:f=>i({...s,accountNumber:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):r.jsx("p",{className:"px-3 py-2 bg-gray-50 rounded-lg text-gray-900 font-mono",children:s.accountNumber})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IFSC Code"}),l?r.jsx("input",{type:"text",value:s.ifscCode,onChange:f=>i({...s,ifscCode:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):r.jsx("p",{className:"px-3 py-2 bg-gray-50 rounded-lg text-gray-900 font-mono",children:s.ifscCode})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Branch"}),l?r.jsx("input",{type:"text",value:s.branch,onChange:f=>i({...s,branch:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):r.jsx("p",{className:"px-3 py-2 bg-gray-50 rounded-lg text-gray-900",children:s.branch})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Holder Name"}),l?r.jsx("input",{type:"text",value:s.accountHolderName,onChange:f=>i({...s,accountHolderName:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):r.jsx("p",{className:"px-3 py-2 bg-gray-50 rounded-lg text-gray-900",children:s.accountHolderName})]})]}),!l&&r.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Account Status"}),r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("span",{className:"text-sm text-blue-800",children:"Active for fee collection"})})]})]})]})]})})}const RQ=()=>{const e=Li(),t=e?.selectedSchoolId||"",n=e?.schools||[],[a,s]=j.useState("classes"),[i,l]=j.useState([]),[d,u]=j.useState([]),[m,p]=j.useState(!1),[f,g]=j.useState(""),[N,v]=j.useState(""),[w,y]=j.useState(""),[E,O]=j.useState(""),[T,A]=j.useState(!1),[I,C]=j.useState(!1),P=n.find(W=>W.id===t),F=[{id:"classes",title:"Classes",description:"Manage school classes",icon:xs,color:"blue",count:i.length},{id:"sections",title:"Sections",description:"Manage class sections",icon:$n,color:"green",count:i.reduce((W,U)=>W+U.sections.length,0)},{id:"tests",title:"Tests",description:"Manage academic tests",icon:iv,color:"purple",count:d.length}],R=async()=>{if(t)try{p(!0),console.log("Fetching classes for school:",t);const W=await md.getSchoolClasses(t);if(console.log("Classes response:",W),W.success){console.log("Classes data:",W.data.classes);const U=(W.data.classes||[]).sort((Q,Y)=>{const H=["LKG","UKG","1","2","3","4","5","6","7","8","9","10","11","12"],te=H.indexOf(Q.className),fe=H.indexOf(Y.className);return te!==-1&&fe!==-1?te-fe:te!==-1?-1:fe!==-1?1:Q.className.localeCompare(Y.className)});U.forEach(Q=>{Q.sections&&Q.sections.length>0&&Q.sections.sort((Y,H)=>Y.localeCompare(H))}),l(U)}}catch(W){console.error("Error fetching classes:",W),ge.error("Error fetching classes")}finally{p(!1)}},$=async()=>{if(t)try{p(!0),console.log("Fetching tests for school:",t);const W=await Fm.getSchoolTests(t);if(console.log("Tests response:",W),W.success){console.log("Tests data:",W.data.tests),console.log("School info:",{schoolId:W.data.schoolId,schoolCode:W.data.schoolCode,schoolName:W.data.schoolName});const U=(W.data.tests||[]).sort((Q,Y)=>{const H=["LKG","UKG","1","2","3","4","5","6","7","8","9","10","11","12"],te=H.indexOf(Q.className),fe=H.indexOf(Y.className);return te!==-1&&fe!==-1?te-fe:te!==-1?-1:fe!==-1?1:Q.className.localeCompare(Y.className)});u(U),console.log(" Tests sorted by class order:",U)}}catch(W){console.error("Error fetching tests:",W),ge.error("Error fetching tests")}finally{p(!1)}},L=async()=>{if(!f.trim()){ge.error("Please enter class name");return}try{const W=await md.addClass(t,{className:f.trim(),academicYear:"2024-25"});if(W.success)ge.success(`Class ${f} created successfully`),g(""),await R();else throw new Error(W.message||"Failed to create class")}catch(W){console.error("Error adding class:",W),ge.error(W.message||"Failed to add class")}},G=async()=>{if(!w||!N.trim()){ge.error("Please select class and enter section name");return}try{const W=await md.addSectionToClass(t,w,N.trim());if(W.success)ge.success(`Section ${N} added successfully`),v(""),await R();else throw new Error(W.message||"Failed to add section")}catch(W){console.error("Error adding section:",W),ge.error(W.message||"Failed to add section")}},X=async(W,U)=>{const Q=i.find(fe=>fe._id===W);if(!Q){ge.error("Class not found");return}const Y=Q.className,H=d.filter(fe=>fe.className===Y),te=H.length>0?`Remove section ${U} from Class ${Y}? Note: This may affect ${H.length} test(s) for this class: ${H.map(fe=>fe.name).join(", ")}`:`Remove section ${U} from Class ${Y}?`;if(confirm(te))try{const fe=await md.removeSectionFromClass(t,W,U);if(fe.success)ge.success(`Section ${U} removed successfully`),await R(),await $();else throw new Error(fe.message||"Failed to remove section")}catch(fe){console.error("Error removing section:",fe),ge.error(fe.message||"Failed to remove section")}},me=async(W,U)=>{const Q=d.filter(te=>te.className===U),Y=Q.length,H=Y>0?`Delete class ${U}? This will also remove all sections and ${Y} related test(s): ${Q.map(te=>te.name).join(", ")}`:`Delete class ${U}? This will also remove all sections.`;if(confirm(H))try{if(Q.length>0){console.log(`Deleting ${Q.length} tests related to class ${U}:`,Q.map(fe=>fe.name));for(const fe of Q)try{console.log(`Deleting test: ${fe.name} (${fe._id})`);const Le=await Fm.deleteTest(t,fe._id);Le.success||console.warn(`Failed to delete test ${fe.name}:`,Le.message)}catch(Le){console.warn(`Error deleting test ${fe.name}:`,Le.message)}}const te=await md.deleteClass(t,W);if(te.success){const fe=Y>0?`Class ${U} and ${Y} related test(s) deleted successfully`:`Class ${U} deleted successfully`;ge.success(fe),await R(),await $()}else throw new Error(te.message||"Failed to delete class")}catch(te){console.error("Error deleting class:",te),ge.error(te.message||"Failed to delete class")}},se=async()=>{if(!I&&!w){ge.error('Please select a class or choose "All Classes"');return}if(!E.trim()){ge.error("Please enter test name");return}try{let W={name:E.trim(),description:I?"Test for all classes":`Test for Class ${i.find(Q=>Q._id===w)?.className}`,isActive:!0,academicYear:"2024-25",allSections:T,allClasses:I};if(!I){const Q=i.find(Y=>Y._id===w);if(!Q){ge.error("Selected class not found");return}W.className=Q.className,T?W.sections=Q.sections||[]:W.sections=Q.sections||[]}const U=await Fm.addTest(t,W);if(console.log("Add test response:",U),U.success){const Q=I?`Test "${E}" created for all classes`:T?`Test "${E}" created for all sections of Class ${W.className}`:`Test "${E}" created for Class ${W.className}`;ge.success(Q),O(""),y(""),A(!1),C(!1),await $()}else throw new Error(U.message||"Failed to create test")}catch(W){console.error("Error adding test:",W),ge.error(W.response?.data?.message||"Failed to add test")}},ee=async(W,U)=>{if(confirm(`Delete test "${U}"? Note: This will only delete the test - classes and sections will remain unaffected.`))try{console.log("Deleting test:",{testId:W,testName:U,selectedSchoolId:t});const Q=await Fm.deleteTest(t,W);if(console.log("Delete test response:",Q),Q.success)ge.success(`Test "${U}" deleted successfully`),await $();else throw new Error(Q.message||"Failed to delete test")}catch(Q){console.error("Error deleting test:",Q),ge.error(Q.message||"Failed to delete test")}};return xe.useEffect(()=>{t&&(R(),$())},[t]),!t||!P?r.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:r.jsx("div",{className:"max-w-6xl mx-auto",children:r.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:r.jsxs("div",{className:"text-center",children:[r.jsx(xs,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Academic Management"}),r.jsx("p",{className:"text-gray-600",children:"Please select a school to manage academic settings."})]})})})}):r.jsx("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6",children:r.jsxs("div",{className:"max-w-6xl mx-auto",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 mb-4 sm:mb-6",children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-2",children:"Academic Management"}),r.jsxs("p",{className:"text-sm sm:text-base text-gray-600",children:["Manage classes, sections, and tests for ",P.name]}),r.jsxs("div",{className:"mt-2 text-xs sm:text-sm text-gray-500",children:["School Code: ",P.code," | Total Classes: ",i.length]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-4 sm:mb-6",children:F.map(W=>{const U=W.icon,Q=a===W.id;return r.jsx("div",{onClick:()=>s(W.id),className:`bg-white rounded-lg shadow-md p-4 sm:p-6 cursor-pointer transition-all duration-200 hover:shadow-lg ${Q?"ring-2 ring-blue-500":""}`,children:r.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[r.jsx("div",{className:`p-2 sm:p-3 rounded-lg ${W.color==="blue"?"bg-blue-100 text-blue-600":W.color==="green"?"bg-green-100 text-green-600":"bg-purple-100 text-purple-600"}`,children:r.jsx(U,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-800 truncate",children:W.title}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:W.description}),r.jsx("div",{className:"mt-1 sm:mt-2 text-xl sm:text-2xl font-bold text-gray-900",children:W.count})]})]})},W.id)})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6",children:[a==="classes"&&r.jsxs("div",{children:[r.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6 gap-4",children:r.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800",children:"Classes Management"})}),r.jsxs("div",{className:"mb-4 p-3 sm:p-4 bg-gray-50 rounded-lg",children:[r.jsx("h3",{className:"text-sm sm:text-md font-medium text-gray-800 mb-3",children:"Add New Class"}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-stretch sm:items-center",children:[r.jsxs("select",{value:f,onChange:W=>g(W.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",children:[r.jsx("option",{value:"",children:"Select class..."}),r.jsx("option",{value:"LKG",children:"LKG"}),r.jsx("option",{value:"UKG",children:"UKG"}),[1,2,3,4,5,6,7,8,9,10,11,12].map(W=>r.jsxs("option",{value:W.toString(),children:["Class ",W]},W))]}),r.jsxs("button",{onClick:L,disabled:!f.trim()||m,className:"px-4 sm:px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm sm:text-base w-full sm:w-auto",children:[r.jsx(Os,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Add Class"}),r.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]}),r.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:[r.jsxs("p",{className:"text-sm text-yellow-800",children:["Debug: Classes count: ",i.length," | Loading: ",m.toString()]}),r.jsxs("p",{className:"text-xs text-yellow-600",children:["Selected School ID: ",t]})]}),r.jsx("div",{className:"space-y-4",children:i.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(xs,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Classes Found"}),r.jsx("p",{className:"text-gray-600",children:"Create your first class to get started."})]}):i.map(W=>r.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900",children:["Class ",W.className]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[W.sections.length," sections  Academic Year: ",W.academicYear]}),W.sections.length>0&&r.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:W.sections.map((U,Q)=>r.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:["Section ",U]},Q))})]}),r.jsx("button",{onClick:()=>me(W._id,W.className),className:"p-2 text-red-600 hover:bg-red-100 rounded",title:"Delete class",children:r.jsx(Ba,{className:"h-4 w-4"})})]})},W._id))})]}),a==="sections"&&r.jsxs("div",{children:[r.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6 gap-4",children:r.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800",children:"Sections Management"})}),r.jsxs("div",{className:"mb-4 p-3 sm:p-4 bg-gray-50 rounded-lg",children:[r.jsx("h3",{className:"text-sm sm:text-md font-medium text-gray-800 mb-3",children:"Add New Section"}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-stretch sm:items-center",children:[r.jsxs("select",{value:w,onChange:W=>y(W.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 text-sm",children:[r.jsx("option",{value:"",children:"Select a class..."}),i.map(W=>r.jsxs("option",{value:W._id,children:["Class ",W.className]},W._id))]}),r.jsx("input",{type:"text",value:N,onChange:W=>v(W.target.value.toUpperCase()),placeholder:"Section (e.g., A, B, C)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 text-sm"}),r.jsxs("button",{onClick:G,disabled:!w||!N.trim()||m,className:"px-4 sm:px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm sm:text-base w-full sm:w-auto",children:[r.jsx(Os,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Add Section"}),r.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]}),r.jsx("div",{className:"space-y-4",children:i.map(W=>r.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[r.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:["Class ",W.className]}),W.sections.length===0?r.jsx("p",{className:"text-gray-500 text-sm",children:"No sections added yet"}):r.jsx("div",{className:"flex flex-wrap gap-2",children:W.sections.map((U,Q)=>r.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full",children:[r.jsxs("span",{className:"text-sm",children:["Section ",U]}),r.jsx("button",{onClick:()=>X(W._id,U),className:"text-red-600 hover:text-red-800",title:"Remove section",children:r.jsx(Ba,{className:"h-3 w-3"})})]},Q))})]},W._id))})]}),a==="tests"&&r.jsxs("div",{children:[r.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6 gap-4",children:r.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800",children:"Tests Management"})}),r.jsxs("div",{className:"mb-4 p-3 sm:p-4 bg-gray-50 rounded-lg",children:[r.jsx("h3",{className:"text-sm sm:text-md font-medium text-gray-800 mb-3",children:"Add New Test"}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-3 items-stretch sm:items-center",children:[r.jsxs("select",{value:w,onChange:W=>y(W.target.value),disabled:I,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 disabled:bg-gray-200 text-sm",children:[r.jsx("option",{value:"",children:"Select a class..."}),i.map(W=>r.jsxs("option",{value:W._id,children:["Class ",W.className]},W._id))]}),r.jsx("input",{type:"text",value:E,onChange:W=>O(W.target.value),placeholder:"Test name (e.g., Midterm, Unit Test 1)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm"}),r.jsxs("button",{onClick:se,disabled:!I&&!w||!E.trim()||m,className:"px-4 sm:px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm sm:text-base w-full sm:w-auto",children:[r.jsx(Os,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Add Test"}),r.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),r.jsxs("div",{className:"flex gap-4 text-sm",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:T,onChange:W=>A(W.target.checked),disabled:I,className:"rounded"}),r.jsx("span",{children:"All sections"})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:I,onChange:W=>{C(W.target.checked),W.target.checked&&(y(""),A(!0))},className:"rounded"}),r.jsx("span",{className:"font-medium",children:"All classes"})]})]})]}),r.jsx("div",{className:"space-y-4",children:d.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(iv,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Tests Found"}),r.jsx("p",{className:"text-gray-600",children:"Create your first test to get started."})]}):d.map(W=>r.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-medium text-gray-900",children:W.name}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Test for Class ",W.className]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Scoring configured by school admin"})]}),r.jsx("button",{onClick:()=>ee(W._id,W.name),className:"p-2 text-red-600 hover:bg-red-100 rounded",title:"Delete test",children:r.jsx(Ba,{className:"h-4 w-4"})})]})},W._id))})]})]})]})})},$Q=()=>r.jsx(RQ,{});function LQ({schoolCode:e,onClose:t,onSuccess:n}){const[a,s]=j.useState(null),[i,l]=j.useState(null),[d,u]=j.useState(!1),[m,p]=j.useState(null),[f,g]=j.useState("student"),N=j.useRef(null),v=()=>{const P=localStorage.getItem("erp.auth");if(P)try{return JSON.parse(P).token}catch(F){console.error("Failed to parse erp.auth:",F)}return localStorage.getItem("token")},w=P=>{const F=P.target.files?.[0];if(F){if(F.type!=="text/csv"&&!F.name.endsWith(".csv")){l("Invalid file type. Please upload a .csv file."),s(null),N.current&&(N.current.value="");return}s(F),l(null),p(null)}},y=async()=>{if(!a){l("Please select a file to import.");return}if(!e){l("School code is missing. Cannot import.");return}const P=v();if(!P){l("Authentication token not found. Please log in again.");return}u(!0),l(null),p(null);try{const F=await pa.importUsers(e,a,f,P);p(F.data),console.log("Import API response:",F.data)}catch(F){console.error("Import failed:",F),l(F.message||F.error||"Failed to import users. Check console for details."),F.results&&p({success:!1,message:F.message||"Import failed with partial results.",results:F.results})}finally{u(!1)}},E=()=>{s(null),l(null),u(!1),p(null),N.current&&(N.current.value="")},O=()=>{E(),t()},T=()=>{n(),O()},A=()=>{if(!m||!m.results.successData.length)return;const P=["UserID","Name","Email","Password"],F=m.results.successData.map(X=>[`"${X.userId||""}"`,`"${(X.name||"").replace(/"/g,'""')}"`,`"${X.email||""}"`,`"${X.password||""}"`]),R=P.join(",")+`
`+F.map(X=>X.join(",")).join(`
`),$=new Blob([R],{type:"text/csv;charset=utf-8;"}),L=document.createElement("a"),G=URL.createObjectURL($);L.setAttribute("href",G),L.setAttribute("download",`${e}_${f}_credentials.csv`),L.style.visibility="hidden",document.body.appendChild(L),L.click(),document.body.removeChild(L)},I=()=>r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-6",children:[i&&r.jsxs("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded-lg flex items-start",children:[r.jsx(Zo,{className:"h-5 w-5 mt-0.5 mr-2 flex-shrink-0"}),r.jsx("p",{children:i})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Role to Import:"}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsxs("label",{className:"flex items-center cursor-pointer p-2 rounded-md hover:bg-gray-50",children:[r.jsx("input",{type:"radio",name:"role",value:"student",checked:f==="student",onChange:()=>g("student"),className:"form-radio h-4 w-4 text-blue-600 transition duration-150 ease-in-out"}),r.jsx("span",{className:"ml-2 text-sm text-gray-800",children:"Student"})]}),r.jsxs("label",{className:"flex items-center cursor-pointer p-2 rounded-md hover:bg-gray-50",children:[r.jsx("input",{type:"radio",name:"role",value:"teacher",checked:f==="teacher",onChange:()=>g("teacher"),className:"form-radio h-4 w-4 text-blue-600 transition duration-150 ease-in-out"}),r.jsx("span",{className:"ml-2 text-sm text-gray-800",children:"Teacher"})]})]})]}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center bg-gray-50 hover:bg-gray-100 transition-colors",children:[r.jsx("input",{type:"file",ref:N,onChange:w,accept:".csv",className:"hidden",id:"csv-upload-input"}),a?r.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[r.jsx(Pn,{className:"h-6 w-6 text-green-500 flex-shrink-0"}),r.jsx("span",{className:"font-medium text-gray-900 text-sm truncate",children:a.name}),r.jsx("button",{onClick:()=>{s(null),l(null),N.current&&(N.current.value="")},className:"text-red-600 hover:text-red-700 flex-shrink-0","aria-label":"Remove file",children:r.jsx(Ur,{size:18})})]}):r.jsxs("label",{htmlFor:"csv-upload-input",className:"cursor-pointer",children:[r.jsx(Xl,{className:"h-10 w-10 mx-auto text-gray-400 mb-3"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Drop your CSV file here or"}),r.jsx("span",{className:"mt-1 text-blue-600 hover:text-blue-700 font-medium text-sm",children:"browse files"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Only .csv files are accepted"})]})]}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("h4",{className:"font-medium text-blue-800 mb-2 text-sm",children:"Instructions:"}),f==="student"?r.jsxs("ul",{className:"list-disc list-inside text-sm text-blue-700 space-y-1",children:[r.jsx("li",{children:"Ensure your CSV has headers (e.g., `firstname`, `lastname`, `email`, `class`, `section`)."}),r.jsx("li",{children:"Required fields: `firstname`, `lastname`, `email`, `primaryphone`, `dateofbirth`, `gender`, `currentclass`, `currentsection`, `fathername`, `mothername`."}),r.jsx("li",{children:"Date format should be `DD-MM-YYYY`, `DD/MM/YYYY`, or `YYYY-MM-DD`."}),r.jsx("li",{children:r.jsx("a",{href:"/api/public/templates/student_import_template.csv",download:!0,className:"underline hover:text-blue-900",children:"Download student template"})})]}):r.jsxs("ul",{className:"list-disc list-inside text-sm text-blue-700 space-y-1",children:[r.jsx("li",{children:"Ensure your CSV has headers (e.g., `firstName`, `lastName`, `email`, `primaryPhone`)."}),r.jsx("li",{children:"Required fields: `firstName`, `lastName`, `email`, `primaryPhone`, `dateOfBirth`, `gender`, `joiningDate`, `highestQualification`, `totalExperience`."}),r.jsx("li",{children:"Recommended fields: `subjects` (comma-separated), `specialization`, `employeeId`."}),r.jsx("li",{children:"Date format should be `DD-MM-YYYY`, `DD/MM/YYYY`, or `YYYY-MM-DD`."}),r.jsx("li",{children:r.jsx("a",{href:"/api/public/templates/teacher_import_template.csv",download:!0,className:"underline hover:text-blue-900",children:"Download teacher template"})})]})]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 p-4 bg-gray-50 border-t rounded-b-xl",children:[r.jsx("button",{onClick:O,type:"button",className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 text-sm font-medium",children:"Cancel"}),r.jsx("button",{onClick:y,type:"button",disabled:!a||d,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center min-w-[120px] text-sm font-medium",children:d?r.jsx(Hl,{className:"h-5 w-5 animate-spin"}):"Import Users"})]})]}),C=()=>{if(!m)return null;const{successData:P=[],errors:F=[],totalRows:R=0,insertedCount:$=0}=m.results||{},L=P.length,G=F.length;return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"text-center mb-6",children:[m.success&&G===0?r.jsx(Ld,{className:"h-12 w-12 mx-auto text-green-500 bg-green-100 rounded-full p-2"}):r.jsx(Zo,{className:`h-12 w-12 mx-auto rounded-full p-2 ${G>0?"text-red-500 bg-red-100":"text-yellow-500 bg-yellow-100"}`}),r.jsx("h3",{className:"mt-4 text-lg font-semibold text-gray-900",children:"Import Complete"}),r.jsx("p",{className:`mt-1 text-sm ${G>0?"text-red-600":"text-gray-600"}`,children:m.message})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center border border-green-200",children:[r.jsx("div",{className:"text-3xl font-bold text-green-700",children:L}),r.jsx("div",{className:"text-sm font-medium text-green-800 mt-1",children:"Users Imported Successfully"})]}),r.jsxs("div",{className:`p-4 rounded-lg text-center border ${G>0?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[r.jsx("div",{className:`text-3xl font-bold ${G>0?"text-red-700":"text-gray-700"}`,children:G}),r.jsx("div",{className:`text-sm font-medium mt-1 ${G>0?"text-red-800":"text-gray-800"}`,children:"Rows Failed"})]})]}),G>0&&r.jsxs("div",{className:"mt-4",children:[r.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-sm",children:"Error Details (showing first 5):"}),r.jsxs("div",{className:"max-h-32 overflow-y-auto bg-gray-100 border border-gray-300 rounded-lg p-3 text-xs space-y-2",children:[F.slice(0,5).map((X,me)=>r.jsxs("div",{className:"p-2 bg-red-100 border border-red-200 rounded",children:[r.jsxs("p",{className:"font-semibold text-red-800",children:["Row ",X.row,":"]}),r.jsx("p",{className:"text-red-700 break-words",children:X.error})]},me)),F.length>5&&r.jsxs("p",{className:"text-center text-gray-500 text-xs mt-2",children:["... and ",F.length-5," more errors."]})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center p-4 bg-gray-50 border-t rounded-b-xl space-y-2 sm:space-y-0",children:[r.jsxs("button",{onClick:A,type:"button",disabled:L===0,className:"w-full sm:w-auto flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:[r.jsx(Ci,{className:"h-4 w-4"}),r.jsxs("span",{children:["Download Credentials (",L,")"]})]}),r.jsx("button",{onClick:T,type:"button",className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:"Done"})]})]})};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-auto overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:m?"Import Results":"Import Users from CSV"}),r.jsx("button",{onClick:O,className:"text-gray-400 hover:text-gray-600 rounded-full p-1 hover:bg-gray-100",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),m?C():I()]})})}function FQ(){try{return r.jsx(BQ,{})}catch(e){return console.error("FATAL ERROR IN SCHOOL DETAILS:",e),r.jsx("div",{className:"p-6",children:r.jsxs("div",{className:"bg-red-50 border border-red-300 rounded-lg p-4",children:[r.jsx("h2",{className:"text-xl font-bold text-red-800 mb-2",children:"Error Rendering School Details"}),r.jsx("p",{className:"text-red-700 mb-2",children:"An unexpected error occurred while rendering this page."}),r.jsxs("p",{className:"text-sm text-red-700 mb-4",children:["Error: ",String(e)]}),r.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Reload Page"})]})})}}function BQ(){const e=()=>{let oe;const $e=localStorage.getItem("erp.auth")||sessionStorage.getItem("erp.auth");if($e)try{oe=JSON.parse($e).token,console.log("[SchoolDetails] Token found in erp.auth:",oe?oe.substring(0,20)+"...":"null")}catch(et){console.log("[SchoolDetails] Failed to parse erp.auth:",et)}return oe||(oe=localStorage.getItem("token")||sessionStorage.getItem("token"),console.log("[SchoolDetails] Token found in direct storage:",oe?oe.substring(0,20)+"...":"null")),oe||(oe=localStorage.getItem("authToken")||sessionStorage.getItem("authToken"),console.log("[SchoolDetails] Token found in authToken:",oe?oe.substring(0,20)+"...":"null")),oe||console.error("[SchoolDetails] No authentication token found in any storage"),oe},t=Li(),n=t?.schools||[],a=t?.selectedSchoolId||"";t?.setCurrentView,t?.getSchoolData,t?.updateUserRole,t?.updateSchoolSettings;const[s,i]=j.useState(!0),[l,d]=j.useState(null),[u,m]=j.useState(null),[p,f]=j.useState("overview"),[g,N]=j.useState(null),[v,w]=j.useState(!1),[y,E]=j.useState({}),[O,T]=j.useState(!1),[A,I]=j.useState(!1),[C,P]=j.useState(null),[F,R]=j.useState({firstName:"",lastName:"",email:"",role:"admin",phone:""}),[$,L]=j.useState(!1),[G,X]=j.useState(null),[me,se]=j.useState(null),[ee,W]=j.useState({}),[U,Q]=j.useState(0),[Y,H]=j.useState(null),[te,fe]=j.useState(null),[Le,he]=j.useState(!1),[K,be]=j.useState(""),[re,ie]=j.useState("all"),ne=n.find(oe=>oe.id===a);j.useEffect(()=>{console.log("SchoolDetails - Debug Info:"),console.log("- selectedSchoolId:",a),console.log("- school found:",ne?"yes":"no"),console.log("- school name:",ne?.name),console.log("- loading state:",s),console.log("- error state:",l),console.log("- data loaded:",u?"yes":"no"),console.log("- schoolCode:",C)},[a,ne,s,l,u,C]),j.useEffect(()=>{let oe=!0,$e;async function et(){if(!a){console.log("No selectedSchoolId, skipping data fetch");return}console.log("Fetching data for school:",a,"reloadKey:",U),i(!0),d(null),P(null),$e=setTimeout(()=>{oe&&(i(!1),d("Request timed out after 10 seconds"))},1e4);try{console.log("Making API calls for school data...");let lt,rt,Lt;try{lt=await zt.get(`/schools/${a}/info`),rt=lt.data?.data||lt.data||{},Lt=rt.code}catch{console.log("School info endpoint failed, trying regular endpoint...");try{lt=await zt.get(`/schools/${a}`),rt=lt.data?.school||lt.data||{},Lt=rt.code}catch{console.log("Regular endpoint failed, trying to find school by ID from context...");const or=n.find(ke=>ke.id===a);if(or)Lt=or.code,rt={code:or.code,name:or.name,_id:or.id};else throw new Error("School not found in any source")}}if(!oe)return;if(!Lt)throw new Error("School code not found");P(Lt),console.log("Fetching users for school code:",Lt);const kt=e();if(!kt)throw new Error("No authentication token found");const Oe=await pa.getAllUsers(Lt,kt);if(!oe)return;clearTimeout($e),console.log("API responses received:",{school:rt,users:Oe});let Nt=[];Oe&&Oe.data&&Array.isArray(Oe.data)?(Nt=Oe.data,console.log("Processing user data (new format):",{totalUsers:Nt.length,breakdown:Oe.breakdown||{}})):Oe&&typeof Oe=="object"?(console.log("Processing user data (old format):",{hasAdmins:!!Oe.admin,hasTeachers:!!Oe.teacher,hasStudents:!!Oe.student,hasParents:!!Oe.parent,adminCount:Oe.admin?.length||0,teacherCount:Oe.teacher?.length||0,studentCount:Oe.student?.length||0,parentCount:Oe.parent?.length||0}),Oe.admin&&Array.isArray(Oe.admin)&&(console.log("Processing",Oe.admin.length,"admins"),Nt.push(...Oe.admin.map(Ft=>({...Ft,role:"admin"})))),Oe.teacher&&Array.isArray(Oe.teacher)&&(console.log("Processing",Oe.teacher.length,"teachers"),Nt.push(...Oe.teacher.map(Ft=>({...Ft,role:"teacher"})))),Oe.student&&Array.isArray(Oe.student)&&(console.log("Processing",Oe.student.length,"students"),Nt.push(...Oe.student.map(Ft=>({...Ft,role:"student"})))),Oe.parent&&Array.isArray(Oe.parent)&&(console.log("Processing",Oe.parent.length,"parents"),Nt.push(...Oe.parent.map(Ft=>({...Ft,role:"parent"}))))):(console.log("No user data received or unexpected format"),Nt=[]),console.log("Processing",Nt.length,"users...");const Mt=Nt.find(Ft=>Ft.role==="student");Mt&&console.log("Sample student data:",Mt),console.log("User breakdown:",{total:Nt.length,byRole:Nt.reduce((Ft,cr)=>(Ft[cr.role]=(Ft[cr.role]||0)+1,Ft),{})});const rr={users:Nt.filter(Ft=>!Ft._placeholder),results:[],attendance:[],marks:[],settings:{schoolName:rt?.name||"School",academicYear:rt?.settings?.academicYear?.currentYear||"2024-2025",attendanceThreshold:Number(rt?.settings?.attendanceThreshold)||75,schoolHours:{start:rt?.settings?.workingHours?.start||"08:00",end:rt?.settings?.workingHours?.end||"15:00"},subjects:Array.isArray(rt?.settings?.subjects)?rt.settings.subjects:[],classes:Array.isArray(rt?.settings?.classes)?rt.settings.classes:[]},schoolCode:Lt,accessMatrix:rt?.accessMatrix||{}};console.log("Final processed data:",{totalUsers:rr.users.length,userRoles:rr.users.reduce((Ft,cr)=>(Ft[cr.role]=(Ft[cr.role]||0)+1,Ft),{})}),m(rr),i(!1)}catch(lt){if(!oe)return;clearTimeout($e),console.error("Failed to load school details:",lt),console.error("Error response:",lt.response?.data),d(lt?.response?.data?.message||lt?.message||"Failed to load school details"),i(!1)}}return et(),()=>{oe=!1,clearTimeout($e)}},[a,U]);const Te=async oe=>{try{if(!C)throw new Error("School code not found");const $e=e();if(!$e)throw new Error("No authentication token found");const et=je?.users.find(rt=>rt._id===oe);if(!et)throw new Error("User not found");const lt={"name.firstName":ee.firstName||et.name.firstName,"name.lastName":ee.lastName||et.name.lastName,email:ee.email||et.email,"contact.primaryPhone":ee.phone||et.contact.primaryPhone};if(ee.password&&ee.password.trim()){if(ee.password!==ee.confirmPassword)throw new Error("Passwords do not match");lt.password=ee.password}ee.role&&ee.role!==et.role&&(lt.role=ee.role),ee.isActive!==void 0&&ee.isActive!==et.isActive&&(lt.isActive=ee.isActive),await pa.updateUser(C,et.userId,lt,$e),se(null),W({}),Q(rt=>rt+1),alert("User updated successfully!")}catch($e){console.error("Failed to update user:",$e),alert("Failed to update user: "+$e.message)}},ve=oe=>{se(oe._id),W({firstName:oe.name?.firstName||"",lastName:oe.name?.lastName||"",email:oe.email||"",phone:oe.contact?.primaryPhone||"",role:oe.role||"",isActive:oe.isActive!==void 0?oe.isActive:!0,password:"",confirmPassword:""})},We=async oe=>{try{const $e=e();if(!$e)throw new Error("No authentication token found");if(!C)throw new Error("School code not found");const et=je?.users.find(lt=>lt._id===oe);if(!et)throw new Error("User not found");await pa.deleteUser(C,et.userId,$e),X(null),Q(lt=>lt+1),alert("User deleted successfully!")}catch($e){console.error("Failed to delete user:",$e),alert("Failed to delete user: "+$e.message)}},Ie=async()=>{L(!0);try{if(!C)throw new Error("School code not found");if(console.log("Adding user with data:",{firstName:F.firstName,lastName:F.lastName,email:F.email,role:F.role,phone:F.phone,selectedSchoolId:a}),!F.firstName||!F.lastName||!F.email||!F.role)throw new Error("Please fill in all required fields");const oe=e();if(!oe)throw new Error("No authentication token found");const $e={firstName:F.firstName,lastName:F.lastName,email:F.email,role:F.role,phone:F.phone};console.log("Making API call to create user in school:",C);const et=await pa.addUser(C,$e,oe);console.log("User creation response:",et),T(!1),R({firstName:"",lastName:"",email:"",role:"admin",phone:""}),console.log("Triggering data refresh..."),Q(lt=>lt+1),alert(`User added successfully!

Credentials:
User ID: ${et.data.credentials.userId}
Email: ${et.data.credentials.email}
Password: ${et.data.credentials.password}

Please share these credentials with the user.`)}catch(oe){console.error("Failed to add user:",oe),console.error("Error response:",oe.response?.data);const $e=oe.response?.data?.message||oe.message||"Failed to add user. Please try again.";alert($e)}finally{L(!1)}},je=u;return a?ne?s?r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"mb-6",children:r.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["School Details - ",ne.name]})}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),r.jsx("p",{children:"Loading school details..."})]})]}):l?r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"mb-6",children:r.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["School Details - ",ne.name]})}),r.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4 mb-4",children:[r.jsx("h3",{className:"font-medium",children:"Error loading school details"}),r.jsx("p",{className:"mt-1",children:l})]}),r.jsx("button",{onClick:()=>Q(oe=>oe+1),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]}):r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-4 sm:p-6 lg:p-8",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-6 sm:mb-8",children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:ne.name}),r.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:["School Code: ",C||"N/A"]})]}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-3 sm:p-4 rounded-lg mb-4 sm:mb-6",children:[r.jsx("h2",{className:"font-bold text-blue-800 mb-2 text-sm sm:text-base",children:"Debug Information"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-xs sm:text-sm",children:[r.jsxs("div",{children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School ID:"})," ",a]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Name:"})," ",ne.name]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"School Code:"})," ",C||"N/A"]})]}),r.jsxs("div",{children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Data Loaded:"})," ",je?"":""]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Loading State:"})," ",s?"Loading":"Complete"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Users Count:"})," ",je?.users?.length||0]})]})]})]}),r.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm mb-4 sm:mb-6 p-1 sm:p-2",children:r.jsxs("nav",{className:"flex flex-col sm:flex-row space-y-1 sm:space-y-0 sm:space-x-2",children:[r.jsxs("button",{className:`flex items-center justify-center space-x-2 px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium text-xs sm:text-sm transition-all duration-200 ${p==="overview"?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-md":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,onClick:()=>f("overview"),children:[r.jsx(Q1,{className:"h-4 w-4"}),r.jsx("span",{children:"Overview"})]}),r.jsxs("button",{className:`flex items-center justify-center space-x-2 px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium text-xs sm:text-sm transition-all duration-200 ${p==="users"?"bg-gradient-to-r from-emerald-500 to-emerald-600 text-white shadow-md":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,onClick:()=>f("users"),children:[r.jsx($n,{className:"h-4 w-4"}),r.jsx("span",{children:"Users"})]}),r.jsxs("button",{className:`flex items-center justify-center space-x-2 px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium text-xs sm:text-sm transition-all duration-200 ${p==="academics"?"bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-md":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,onClick:()=>f("academics"),children:[r.jsx(Jo,{className:"h-4 w-4"}),r.jsx("span",{children:"Academics"})]})]})}),p==="overview"&&r.jsx("div",{className:"grid grid-cols-1 gap-6",children:r.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[r.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-3 rounded-xl",children:r.jsx(Yo,{className:"h-6 w-6 text-white"})}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"School Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-800 mb-4 text-lg",children:"Basic Info"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("p",{className:"text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Name:"})," ",ne.name]}),r.jsxs("p",{className:"text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Code:"})," ",C||"N/A"]}),r.jsxs("p",{className:"text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Contact:"})," ",je?.settings?.schoolName||"N/A"]})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-800 mb-4 text-lg",children:"User Counts"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("p",{className:"text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Total Users:"})," ",je?.users?.length||0]}),r.jsxs("p",{className:"text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Admin Users:"})," ",je?.users?.filter(oe=>oe.role==="admin").length||0]}),r.jsxs("p",{className:"text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Teachers:"})," ",je?.users?.filter(oe=>oe.role==="teacher").length||0]}),r.jsxs("p",{className:"text-gray-700",children:[r.jsx("span",{className:"font-medium",children:"Students:"})," ",je?.users?.filter(oe=>oe.role==="student").length||0]})]})]})]})]})}),p==="users"&&r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Users Management"}),r.jsx("div",{className:"flex space-x-2",children:r.jsxs("button",{onClick:()=>T(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[r.jsx(Os,{className:"h-4 w-4"}),r.jsx("span",{children:"Add User"})]})})]}),s&&r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsx("div",{className:"text-gray-500",children:"Loading users..."})}),l&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[r.jsx("div",{className:"text-red-800 font-medium",children:"Error loading users"}),r.jsx("div",{className:"text-red-600 text-sm mt-1",children:l}),r.jsx("button",{onClick:()=>Q(oe=>oe+1),className:"mt-2 text-red-600 hover:text-red-800 text-sm underline",children:"Try again"})]}),!s&&!l&&je&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{htmlFor:"searchUsers",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Users"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{id:"searchUsers",type:"text",placeholder:"Search by name or email...",value:K,onChange:oe=>be(oe.target.value),className:"w-full px-3 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[r.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-100 rounded-lg",children:[r.jsx("div",{className:"font-medium text-purple-800",children:"Admins"}),r.jsx("div",{className:"text-2xl font-bold text-purple-900",children:je.users.filter(oe=>oe.role==="admin").length})]}),r.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-100 rounded-lg",children:[r.jsx("div",{className:"font-medium text-blue-800",children:"Teachers"}),r.jsx("div",{className:"text-2xl font-bold text-blue-900",children:je.users.filter(oe=>oe.role==="teacher").length})]}),r.jsxs("div",{className:"p-4 bg-green-50 border border-green-100 rounded-lg",children:[r.jsx("div",{className:"font-medium text-green-800",children:"Students"}),r.jsx("div",{className:"text-2xl font-bold text-green-900",children:je.users.filter(oe=>oe.role==="student").length})]}),r.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-100 rounded-lg",children:[r.jsx("div",{className:"font-medium text-gray-800",children:"Total Users"}),r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:je.users.length})]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[je.users.filter(oe=>{if(K){const $e=K.toLowerCase();return(oe.name?.displayName||oe.name?.firstName||oe.email||"").toLowerCase().includes($e)||(oe.email||"").toLowerCase().includes($e)||(oe.userId||"").toLowerCase().includes($e)}return!0}).map(oe=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"h-10 w-10 flex-shrink-0 bg-gray-200 rounded-full overflow-hidden",children:oe.profileImage?r.jsx("img",{src:oe.profileImage.startsWith("http")?oe.profileImage:`${"https://erp-backend-kfut.onrender.com/api".replace("/api","")||""}${oe.profileImage}`,alt:oe.name?.displayName||"User",className:"h-full w-full object-cover",onError:$e=>{const et=$e.target;et.style.display="none";const lt=et.parentElement;lt&&(lt.innerHTML=`<div class="h-full w-full flex items-center justify-center bg-blue-100 text-blue-800 font-medium">${oe.name?.firstName?.[0]?.toUpperCase()||oe.name?.displayName?.[0]?.toUpperCase()||"U"}${oe.name?.lastName?.[0]?.toUpperCase()||oe.name?.displayName?.[1]?.toUpperCase()||"U"}</div>`)}}):r.jsxs("div",{className:"h-full w-full flex items-center justify-center bg-blue-100 text-blue-800 font-medium",children:[oe.name?.firstName?.[0]?.toUpperCase()||oe.name?.displayName?.[0]?.toUpperCase()||"U",oe.name?.lastName?.[0]?.toUpperCase()||oe.name?.displayName?.[1]?.toUpperCase()||"U"]})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:oe.name?.displayName||oe.name?.firstName||oe.email||"Unknown User"}),r.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",oe.userId||"N/A"]}),oe.role==="student"&&r.jsxs("div",{className:"text-sm text-gray-500",children:["Class: ",r.jsx("strong",{children:oe.studentDetails?.currentClass||"N/A"})," - ",r.jsx("strong",{children:oe.studentDetails?.currentSection||"N/A"})]}),r.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Since ",oe.createdAt?new Date(oe.createdAt).toLocaleDateString():"Unknown"]})]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-medium rounded-full ${oe.role==="admin"?"bg-purple-100 text-purple-800":oe.role==="teacher"?"bg-blue-100 text-blue-800":oe.role==="student"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:(oe.role||"unknown").charAt(0).toUpperCase()+(oe.role||"unknown").slice(1)})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:oe.email||"N/A"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-medium rounded-full ${oe.isActive!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:oe.isActive!==!1?"Active":"Inactive"})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[r.jsxs("button",{className:"text-blue-600 hover:text-blue-900 inline-flex items-center gap-1",onClick:()=>ve(oe),title:"Edit User",children:[r.jsx(Qs,{size:16}),"Edit"]}),r.jsxs("button",{className:"text-red-600 hover:text-red-900 inline-flex items-center gap-1",onClick:()=>X(oe._id),title:"Delete User",children:[r.jsx(Ba,{size:16}),"Delete"]})]})]},oe._id)),je.users.filter(oe=>{if(K){const $e=K.toLowerCase();return(oe.name?.displayName||oe.name?.firstName||oe.email||"").toLowerCase().includes($e)||(oe.email||"").toLowerCase().includes($e)||(oe.userId||"").toLowerCase().includes($e)}return!0}).length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-10 text-center text-gray-500",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-gray-300 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-lg font-medium",children:"No users found"}),r.jsx("p",{className:"text-sm mt-1",children:K?`No users match the search "${K}"`:"There are no users to display"}),K&&r.jsx("button",{onClick:()=>be(""),className:"mt-3 text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Clear search"})]})})})]})]})})]})]}),p==="academics"&&r.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Academic Test Configuration"}),r.jsxs("div",{className:"text-sm text-gray-600",children:["Configure test types and academic settings for ",ne?.name]})]}),r.jsx($Q,{})]}),!1,O&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-lg font-bold",children:"Add New User"}),r.jsx("button",{onClick:()=>T(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsxs("form",{onSubmit:oe=>{oe.preventDefault(),Ie()},children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),r.jsx("input",{type:"text",value:F.firstName,onChange:oe=>R({...F,firstName:oe.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"First Name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),r.jsx("input",{type:"text",value:F.lastName,onChange:oe=>R({...F,lastName:oe.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Last Name"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),r.jsx("input",{type:"email",value:F.email,onChange:oe=>R({...F,email:oe.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Email Address"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),r.jsx("input",{type:"text",value:"Admin",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-700 cursor-not-allowed"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Super Admin can only create Admin users"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone (Optional)"}),r.jsx("input",{type:"tel",value:F.phone,onChange:oe=>R({...F,phone:oe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Phone Number"})]}),r.jsx("div",{children:r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),r.jsx("div",{className:"ml-3",children:r.jsxs("p",{className:"text-sm text-blue-700",children:[r.jsx("strong",{children:"Password Auto-Generation:"})," A secure password and user ID will be automatically generated for this user. You'll receive the credentials after user creation."]})})]})})})]}),r.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[r.jsx("button",{type:"button",onClick:()=>T(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:$,className:`flex-1 px-4 py-2 rounded-lg text-white transition-colors duration-200 ${$?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:$?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):"Add User"})]})]})]})}),A&&C&&r.jsx(LQ,{schoolCode:C,onClose:()=>I(!1),onSuccess:()=>{I(!1),Q(oe=>oe+1),alert("Users imported successfully! The user list has been updated.")}}),G&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("h3",{className:"text-lg font-bold text-red-600",children:"Confirm Delete"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Are you sure you want to delete this user? This action cannot be undone."})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:()=>X(null),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:()=>We(G),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),me&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h3",{className:"text-xl font-bold",children:"Edit User"}),r.jsx("button",{onClick:()=>{se(null),W({})},className:"text-gray-500 hover:text-gray-700",children:r.jsx(Ur,{className:"h-6 w-6"})})]}),r.jsxs("form",{onSubmit:oe=>{oe.preventDefault(),Te(me)},children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Basic Information"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),r.jsx("input",{type:"text",value:ee.firstName||"",onChange:oe=>W({...ee,firstName:oe.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),r.jsx("input",{type:"text",value:ee.lastName||"",onChange:oe=>W({...ee,lastName:oe.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),r.jsx("input",{type:"email",value:ee.email||"",onChange:oe=>W({...ee,email:oe.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),r.jsx("input",{type:"tel",value:ee.phone||"",onChange:oe=>W({...ee,phone:oe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Password Management"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password (Optional)"}),r.jsx("input",{type:"password",value:ee.password||"",onChange:oe=>W({...ee,password:oe.target.value}),placeholder:"Leave blank to keep current password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep the current password"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),r.jsx("input",{type:"password",value:ee.confirmPassword||"",onChange:oe=>W({...ee,confirmPassword:oe.target.value}),placeholder:"Confirm new password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("button",{type:"button",onClick:async()=>{const oe=je?.users.find($e=>$e._id===me);if(oe)try{H(me);const $e=e();if(!$e)throw new Error("No authentication token");if(!C)throw new Error("School code not found");const et=await pa.resetPassword(C,oe.userId,$e),lt=et.data.password;W({...ee,password:lt,confirmPassword:lt}),fe(et.data),H(null),alert(`New password generated: ${lt}

The password has been set in the form above. Click "Save Changes" to apply it.`)}catch($e){console.error("Failed to generate new password:",$e),H(null),alert("Failed to generate new password: "+$e.message)}},disabled:Y===me,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:Y===me?r.jsxs(r.Fragment,{children:[r.jsx(xf,{className:"h-4 w-4 animate-spin"}),r.jsx("span",{children:"Generating..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(U6,{className:"h-4 w-4"}),r.jsx("span",{children:"Generate New Password"})]})}),r.jsx("div",{className:"text-sm text-gray-600",children:"This will generate a secure password and update the form fields above"})]})]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Role & Status"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),r.jsxs("select",{value:ee.role||"",onChange:oe=>W({...ee,role:oe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"teacher",children:"Teacher"}),r.jsx("option",{value:"student",children:"Student"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),r.jsxs("select",{value:ee.isActive!==void 0?ee.isActive.toString():"",onChange:oe=>W({...ee,isActive:oe.target.value==="true"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"true",children:"Active"}),r.jsx("option",{value:"false",children:"Inactive"})]})]})]})]})]}),r.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[r.jsx("button",{type:"button",onClick:()=>{se(null),W({})},className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save Changes"})]})]})]})})]})}):r.jsxs("div",{className:"p-6",children:[r.jsx("h1",{className:"text-xl font-bold mb-4",children:"School Details"}),r.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg",children:[r.jsx("p",{children:"School not found. The school ID may be invalid."}),r.jsxs("p",{className:"text-sm mt-2",children:["ID: ",a]})]})]}):r.jsxs("div",{className:"p-6",children:[r.jsx("h1",{className:"text-xl font-bold mb-4",children:"School Details"}),r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg",children:r.jsx("p",{children:"No school selected. Please go back and select a school."})})]})}const UQ=()=>{const{selectedSchoolId:e,setCurrentView:t,updateSchool:n}=Li(),[a,s]=j.useState(null),[i,l]=j.useState({}),[d,u]=j.useState(!1),[m,p]=j.useState(null),[f,g]=j.useState(null),[N,v]=j.useState(null);console.log("[SchoolEditDetails] Component rendered, selectedSchoolId:",e),j.useEffect(()=>{console.log("[SchoolEditDetails] useEffect triggered, selectedSchoolId:",e),(async()=>{if(!e){console.log("[SchoolEditDetails] No selectedSchoolId, skipping fetch");return}console.log("[SchoolEditDetails] Starting fetch for school:",e),u(!0),p(null);try{const F=await zt.get(`/schools/${e}`);console.log("[SchoolEditDetails] Raw API response:",F.data);const R=F.data.data||F.data;if(console.log("[SchoolEditDetails] Extracted school data:",R),console.log("[SchoolEditDetails] Key fields check:",{mobile:R.mobile,contactPhone:R.contact?.phone,principalName:R.principalName,principalEmail:R.principalEmail,address:R.address,contact:R.contact,street:R.street,area:R.area,city:R.city,district:R.district,pinCode:R.pinCode,state:R.state}),!R)throw new Error("No data received from API");s(R),l(R),console.log("[SchoolEditDetails] Profile and form state updated successfully")}catch(F){console.error("[SchoolEditDetails] Error fetching school data:",F),console.error("[SchoolEditDetails] Error details:",{message:F?.message,response:F?.response?.data,status:F?.response?.status}),p(F?.response?.data?.message||F?.message||"Failed to load school data")}finally{u(!1),console.log("[SchoolEditDetails] Fetch complete, loading set to false")}})()},[e]);const w=(P,F)=>{l(R=>{const $={...R||{}},L=P.split(".");let G=$;for(let X=0;X<L.length-1;X++){const me=L[X];(G[me]==null||typeof G[me]!="object")&&(G[me]={}),G=G[me]}return G[L[L.length-1]]=F,$})},y=async P=>{const F=P.target.files?.[0];if(F)try{if(console.log(" Image selected:",F.name,"Size:",(F.size/1024).toFixed(2),"KB"),!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(F.type)){alert("Please select a valid image file (JPEG, PNG, GIF, or WebP)");return}if(F.size>10*1024*1024){alert("Image size should be less than 10MB");return}const $=await DZ(F);console.log(" Image compressed:",($.size/1024).toFixed(2),"KB");const L=new File([$],F.name.replace(/\.[^.]+$/,".jpg"),{type:"image/jpeg"});g(L);const G=new FileReader;G.onloadend=()=>{v(G.result)},G.readAsDataURL(L),console.log(" Image ready for upload")}catch(R){console.error(" Error processing image:",R),alert("Error processing image. Please try again.")}},E=(P,F)=>{w("address.stateId",P),w("address.state",F.name),w("address.districtId",""),w("address.district",""),w("address.talukaId",""),w("address.taluka","")},O=(P,F)=>{w("address.districtId",P),w("address.district",F.name),w("address.talukaId",""),w("address.taluka","")},T=(P,F)=>{w("address.talukaId",P),w("address.taluka",F.name)},A=P=>{w("address.district",P),w("address.taluka","")},I=P=>{w("address.taluka",P)},C=async()=>{if(e){u(!0),p(null);try{console.log(" Saving school data...");const P=new FormData;f&&(P.append("logo",f),console.log(" Image attached to form data"));const F=["_id","id","createdAt","updatedAt","__v","databaseName","databaseCreated","databaseCreatedAt","fullAddress","admins","stats","features","settings","logoUrl"];Object.keys(i).forEach(L=>{if(F.includes(L))return;const G=i[L];G!=null&&(typeof G=="object"&&!Array.isArray(G)||Array.isArray(G)?P.append(L,JSON.stringify(G)):P.append(L,String(G)))}),console.log(" Sending update request...");const R=await Kn.updateSchool(e,P),$=R.data?.school||R.data;console.log(" School updated successfully:",$),g(null),v(null),s($),l($),await n({id:$._id||$.id||e,name:$.name,logo:$.logoUrl?String($.logoUrl).startsWith("http")?$.logoUrl:`https://erp-backend-kfut.onrender.com/api${$.logoUrl}`:"",area:$.address?.area||"",district:$.address?.district||"",pinCode:$.address?.pinCode||$.address?.zipCode||"",mobile:$.contact?.phone||"",principalName:$.principalName||"",principalEmail:$.principalEmail||$.contact?.email||"",bankDetails:$.bankDetails||{},accessMatrix:$.accessMatrix||{},address:$.address||{},contact:$.contact||{},schoolType:$.schoolType||"",establishedYear:$.establishedYear||"",affiliationBoard:$.affiliationBoard||"",website:$.contact?.website||"",secondaryContact:$.secondaryContact||""}),alert("School updated successfully!"),t("school-details")}catch(P){console.error(" Error saving school:",P),p(P?.response?.data?.message||P?.message||"Failed to save")}finally{u(!1)}}};return d&&!a?r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[r.jsxs("button",{onClick:()=>t("school-details"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[r.jsx(sv,{className:"h-5 w-5"}),r.jsx("span",{children:"Back to Details"})]}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit School"})]}),r.jsx("div",{className:"py-10 text-center text-gray-600",children:"Loading"})]}):a?r.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("button",{onClick:()=>t("school-details"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[r.jsx(sv,{className:"h-5 w-5"}),r.jsx("span",{children:"Back to Details"})]}),r.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Edit: ",a.name]})]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsxs("button",{onClick:()=>t("school-details"),className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:[r.jsx(Ur,{className:"h-4 w-4"}),r.jsx("span",{children:"Cancel"})]}),r.jsxs("button",{onClick:C,disabled:d,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50",children:[r.jsx(rs,{className:"h-4 w-4"}),r.jsx("span",{children:"Save"})]})]})]}),m&&r.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-800 rounded p-4",children:m}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[r.jsx(ov,{className:"h-6 w-6 text-indigo-600"}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Basic Information"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Name"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg",value:i?.name||"",onChange:P=>w("name",P.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Code"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg font-mono",value:i?.code||"",onChange:P=>w("code",P.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Principal Name"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg",value:i?.principalName||"",onChange:P=>w("principalName",P.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Principal Email"}),r.jsx("input",{type:"email",className:"w-full px-3 py-2 border rounded-lg",value:i?.principalEmail||i?.contact?.email||"",onChange:P=>w("principalEmail",P.target.value)})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[r.jsx($4,{className:"h-6 w-6 text-green-600"}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Address"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg",value:i?.address?.street||i?.street||"",onChange:P=>w("address.street",P.target.value),placeholder:"Enter street address",title:`Current value: ${i?.address?.street||i?.street||"Empty"}`})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Area/Locality"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg",value:i?.address?.area||i?.area||"",onChange:P=>w("address.area",P.target.value),placeholder:"Enter area/locality"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg",value:i?.address?.city||i?.city||"",onChange:P=>w("address.city",P.target.value),placeholder:"Enter city"})]})]}),r.jsxs("div",{className:"mt-6",children:[r.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Location Details"}),r.jsx(yj,{selectedState:i?.address?.stateId||"",selectedDistrict:i?.address?.districtId||"",selectedTaluka:i?.address?.talukaId||"",districtText:i?.address?.district||i?.district||"",talukaText:i?.address?.taluka||i?.taluka||"",onStateChange:E,onDistrictChange:O,onTalukaChange:T,onDistrictTextChange:A,onTalukaTextChange:I,required:!1,className:"grid grid-cols-1 md:grid-cols-3 gap-4"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pin Code"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg",value:i?.address?.pinCode||i?.address?.zipCode||i?.pinCode||"",onChange:P=>{w("address.pinCode",P.target.value),w("address.zipCode",P.target.value),w("pinCode",P.target.value)},placeholder:"Enter pin code"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg bg-gray-50",value:i?.address?.country||"India",readOnly:!0})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[r.jsx(W6,{className:"h-6 w-6 text-purple-600"}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Contact"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Phone"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg",value:i?.mobile||i?.contact?.phone||"",onChange:P=>{w("mobile",P.target.value),w("contact.phone",P.target.value)},placeholder:"Enter primary phone number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secondary Phone"}),r.jsx("input",{className:"w-full px-3 py-2 border rounded-lg",value:i?.secondaryContact||"",onChange:P=>w("secondaryContact",P.target.value),placeholder:"Enter secondary phone number"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),r.jsx("input",{type:"email",className:"w-full px-3 py-2 border rounded-lg",value:i?.principalEmail||i?.contact?.email||"",onChange:P=>{w("principalEmail",P.target.value),w("contact.email",P.target.value)},placeholder:"Enter email address"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),r.jsx("input",{type:"url",className:"w-full px-3 py-2 border rounded-lg",value:i?.contact?.website||"",onChange:P=>w("contact.website",P.target.value),placeholder:"Enter website URL"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[r.jsx(ov,{className:"h-6 w-6 text-blue-600"}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"School Details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Type"}),r.jsxs("select",{className:"w-full px-3 py-2 border rounded-lg",value:i?.schoolType||"",onChange:P=>w("schoolType",P.target.value),children:[r.jsx("option",{value:"",children:"Select School Type"}),r.jsx("option",{value:"Public",children:"Public"}),r.jsx("option",{value:"Private",children:"Private"}),r.jsx("option",{value:"International",children:"International"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Established Year"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border rounded-lg",value:i?.establishedYear||"",onChange:P=>w("establishedYear",parseInt(P.target.value)),placeholder:"Enter established year",min:"1800",max:"2030"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Affiliation Board"}),r.jsxs("select",{className:"w-full px-3 py-2 border rounded-lg",value:i?.affiliationBoard||"",onChange:P=>w("affiliationBoard",P.target.value),children:[r.jsx("option",{value:"",children:"Select Affiliation Board"}),r.jsx("option",{value:"CBSE",children:"CBSE"}),r.jsx("option",{value:"ICSE",children:"ICSE"}),r.jsx("option",{value:"State Board",children:"State Board"}),r.jsx("option",{value:"IB",children:"IB"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Established Date"}),r.jsx("input",{type:"date",className:"w-full px-3 py-2 border rounded-lg",value:i?.establishedDate?String(i.establishedDate).substring(0,10):"",onChange:P=>w("establishedDate",P.target.value)})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[r.jsx(yf,{className:"h-6 w-6 text-gray-700"}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Status & Timestamps"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Active Status"}),r.jsxs("select",{className:"w-full px-3 py-2 border rounded-lg",value:i?.isActive?"true":"false",onChange:P=>w("isActive",P.target.value==="true"),children:[r.jsx("option",{value:"true",children:"Active"}),r.jsx("option",{value:"false",children:"Inactive"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Created At"}),r.jsx("p",{className:"px-3 py-2 bg-gray-50 rounded-lg text-gray-900",children:a.createdAt?new Date(a.createdAt).toLocaleString():""})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Updated"}),r.jsx("p",{className:"px-3 py-2 bg-gray-50 rounded-lg text-gray-900",children:a.updatedAt?new Date(a.updatedAt).toLocaleString():""})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[r.jsx(B6,{className:"h-6 w-6 text-orange-600"}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"School Image"})]}),r.jsxs("div",{className:"space-y-4",children:[a?.logoUrl&&!N&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Image"}),r.jsx("div",{className:"relative w-48 h-48 border-2 border-gray-200 rounded-lg overflow-hidden",children:r.jsx("img",{src:a.logoUrl,alt:"Current school image",className:"w-full h-full object-cover",onError:P=>{P.target.src="https://via.placeholder.com/200?text=No+Image"}})})]}),N&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Image Preview"}),r.jsxs("div",{className:"relative w-48 h-48 border-2 border-green-500 rounded-lg overflow-hidden",children:[r.jsx("img",{src:N,alt:"Preview",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute top-2 right-2 bg-green-500 text-white px-2 py-1 rounded text-xs",children:"New"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:N?"Change Image":"Upload New Image"}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("label",{className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[r.jsx(Xl,{className:"h-4 w-4"}),r.jsx("span",{children:"Choose Image"}),r.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:y,className:"hidden"})]}),f&&r.jsxs("span",{className:"text-sm text-gray-600",children:[f.name," (",(f.size/1024).toFixed(2)," KB)"]})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Supported formats: JPEG, PNG, GIF, WebP (Max 10MB). Image will be compressed automatically."})]})]})]})]})]}):r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"mb-6",children:r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit School"})}),r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 rounded p-4 mb-4",children:[r.jsx("p",{className:"font-semibold mb-2",children:"No school data loaded"}),r.jsxs("p",{className:"text-sm",children:["Selected School ID: ",e||"None"]}),r.jsxs("p",{className:"text-sm mt-2",children:["Error: ",m||"No error message"]}),r.jsx("p",{className:"text-sm mt-2",children:"Check the browser console for more details."})]})]})};function zQ({onLoginSuccess:e,onBack:t}){const[n,a]=j.useState({email:"",password:""}),[s,i]=j.useState(!1),[l,d]=j.useState(!1),[u,m]=j.useState(null),p=async g=>{if(g.preventDefault(),m(null),!n.email||!n.password){m("Please fill in all fields");return}d(!0);try{const v=(await zt.post("/auth/login",{email:n.email,password:n.password})).data;v.success&&v.token?(localStorage.setItem("authToken",v.token),localStorage.setItem("userInfo",JSON.stringify(v.user)),e?e(v.user):alert(`Login successful!
Welcome ${v.user.name}
Role: ${v.user.role}
School: ${v.user.schoolName}`)):m("Invalid login credentials")}catch(N){console.error("Login error:",N),m(N.response?.data?.message||"Login failed. Please check your credentials and try again.")}finally{d(!1)}},f=(g,N)=>{a(v=>({...v,[g]:N})),u&&m(null)};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"max-w-md w-full space-y-8",children:[r.jsxs("div",{className:"text-center",children:[t&&r.jsxs("button",{onClick:t,className:"mb-4 inline-flex items-center space-x-2 text-blue-600 hover:text-blue-800 transition-colors",children:[r.jsx(sv,{className:"h-4 w-4"}),r.jsx("span",{children:"Back to Dashboard"})]}),r.jsx("div",{className:"mx-auto h-16 w-16 bg-blue-600 rounded-full flex items-center justify-center",children:r.jsx(Yo,{className:"h-8 w-8 text-white"})}),r.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"School Portal Login"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Sign in to access your school account"})]}),r.jsx("form",{className:"mt-8 space-y-6",onSubmit:p,children:r.jsxs("div",{className:"bg-white rounded-xl shadow-md p-8 space-y-6",children:[u&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-3",children:[r.jsx(sa,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),r.jsx("p",{className:"text-sm text-red-700",children:u})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),r.jsxs("div",{className:"relative",children:[r.jsx(Ed,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),r.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n.email,onChange:g=>f("email",g.target.value),className:"pl-10 w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Enter your email"})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{id:"password",name:"password",type:s?"text":"password",autoComplete:"current-password",required:!0,value:n.password,onChange:g=>f("password",g.target.value),onFocus:()=>i(!0),onBlur:()=>i(!1),className:"w-full px-3 py-3 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Enter your password"}),r.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:s?r.jsx(Wo,{className:"h-5 w-5"}):r.jsx(wn,{className:"h-5 w-5"})})]})]}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:l,className:`w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white transition-colors ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:l?r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r.jsx("span",{children:"Signing in..."})]}):"Sign In"})})]})}),r.jsx("div",{className:"text-center",children:r.jsxs("p",{className:"text-sm text-gray-600",children:["Having trouble logging in?"," ",r.jsx("a",{href:"#",className:"font-medium text-blue-600 hover:text-blue-500",children:"Contact your school administrator"})]})})]})})}function qQ({onClose:e,onSuccess:t}){const[n,a]=j.useState(""),[s,i]=j.useState(""),[l,d]=j.useState(""),[u,m]=j.useState(!1),[p,f]=j.useState(!1),[g,N]=j.useState(!1),[v,w]=j.useState(""),[y,E]=j.useState(!1),O=async T=>{if(T.preventDefault(),w(""),!n||!s||!l){w("All fields are required");return}if(s.length<6){w("New password must be at least 6 characters long");return}if(s!==l){w("New passwords do not match");return}if(n===s){w("New password must be different from current password");return}E(!0);try{const A=localStorage.getItem("erp.auth")||sessionStorage.getItem("erp.auth");if(!A)throw new Error("No authentication data found");const{token:I}=JSON.parse(A);if(!I)throw new Error("No authentication token found");const C=await zt.post("/auth/change-password",{currentPassword:n,newPassword:s});C.data.success?(alert("Password changed successfully! Please login again with your new password."),t()):w(C.data.message||"Failed to change password")}catch(A){console.error("Error changing password:",A),w(A.response?.data?.message||A.message||"Failed to change password")}finally{E(!1)}};return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx(Fd,{className:"h-5 w-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Change Password"}),r.jsx("p",{className:"text-sm text-gray-500",children:"You must change your password to continue"})]})]}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:y,children:r.jsx(Ur,{className:"h-5 w-5"})})]}),r.jsxs("form",{onSubmit:O,className:"p-6 space-y-4",children:[v&&r.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600",children:v})}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:u?"text":"password",value:n,onChange:T=>a(T.target.value),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter current password",disabled:y,required:!0}),r.jsx("button",{type:"button",onClick:()=>m(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",tabIndex:-1,children:u?r.jsx(Wo,{className:"h-5 w-5"}):r.jsx(wn,{className:"h-5 w-5"})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:p?"text":"password",value:s,onChange:T=>i(T.target.value),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter new password",disabled:y,required:!0,minLength:6}),r.jsx("button",{type:"button",onClick:()=>f(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",tabIndex:-1,children:p?r.jsx(Wo,{className:"h-5 w-5"}):r.jsx(wn,{className:"h-5 w-5"})})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:g?"text":"password",value:l,onChange:T=>d(T.target.value),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Confirm new password",disabled:y,required:!0}),r.jsx("button",{type:"button",onClick:()=>N(!g),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",tabIndex:-1,children:g?r.jsx(Wo,{className:"h-5 w-5"}):r.jsx(wn,{className:"h-5 w-5"})})]})]}),r.jsxs("div",{className:"flex space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:y,children:"Cancel"}),r.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 disabled:cursor-not-allowed",disabled:y,children:y?"Changing...":"Change Password"})]})]})]})})}function HQ(){console.log("[AppContent] Rendering AppContent");const{currentView:e,setCurrentView:t}=Li(),n=il(),{user:a,logout:s}=yr(),[i,l]=j.useState(!1);j.useEffect(()=>{a&&a.passwordChangeRequired&&(console.log("[SuperAdmin] Password change required for user"),l(!0))},[a]);const d=()=>{switch(e){case"dashboard":return r.jsx(y4,{});case"add-school":return r.jsx(TQ,{});case"view-access":return r.jsx(_Q,{});case"account-details":return r.jsx(MQ,{});case"school-details":return r.jsx(FQ,{});case"edit-school":return r.jsx(UQ,{});case"school-login":return r.jsx(zQ,{onLoginSuccess:p=>{console.log("[SuperAdmin] School login successful, navigating to school dashboard"),p.role==="admin"?n("/admin",{replace:!0}):p.role==="teacher"?n("/teacher",{replace:!0}):(alert(`Login successful!
Welcome ${p.name}
Role: ${p.role}
School: ${p.schoolName}`),t("dashboard"))},onBack:()=>t("dashboard")});default:return r.jsx(y4,{})}},u=()=>{l(!1),alert("Password changed successfully! Please login again."),s(),n("/login",{replace:!0})},m=()=>{if(a&&a.passwordChangeRequired){alert("You must change your password to continue using the system.");return}l(!1)};return r.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col lg:flex-row",children:[e!=="school-login"&&r.jsx(EQ,{}),r.jsx("main",{className:`flex-1 overflow-y-auto ${e==="school-login"?"w-full":""}`,children:d()}),i&&r.jsx(qQ,{onClose:m,onSuccess:u})]})}function VQ(){return console.log("[App] Rendering App component"),r.jsx(IQ,{children:r.jsx(HQ,{})})}const Ll={superadmin:{title:"Super Admin",subtitle:"All-powerful ruler",icon:r.jsx(z4,{className:"w-5 h-5"}),demoEmail:"super@erp.com",demoPass:"super123"},admin:{title:"Admin",subtitle:"System wizard",icon:r.jsx(yf,{className:"w-5 h-5"}),demoEmail:"admin@test.com",demoPass:"t8qW7Y58"},teacher:{title:"Teacher",subtitle:"Knowledge master",icon:r.jsx(Jo,{className:"w-5 h-5"}),demoEmail:"teacher@test.com",demoPass:"fFvja2L5"}};function WQ(){const{login:e}=yr(),[t,n]=j.useState("superadmin"),[a,s]=j.useState(Ll.superadmin.demoEmail),[i,l]=j.useState(Ll.superadmin.demoPass),[d,u]=j.useState(""),[m,p]=j.useState(!1),[f,g]=j.useState(!1),[N,v]=j.useState(""),[w,y]=j.useState(!1),E=il(),O=ni();j.useEffect(()=>{u("")},[t]);const T=C=>{n(C),C==="superadmin"?(s(Ll[C].demoEmail),l(Ll[C].demoPass),u("")):(s(""),l(""),u(""))},A=j.useMemo(()=>Object.keys(Ll).map(C=>{const P=C===t,F=Ll[C];return r.jsxs("button",{type:"button",onClick:()=>T(C),className:["flex-1 min-w-[120px] sm:min-w-[160px] p-3 sm:p-4 rounded-xl border transition shadow-sm text-left",P?"border-violet-500 bg-white ring-2 ring-violet-200":"border-slate-200 bg-white/80 hover:border-slate-300"].join(" "),children:[r.jsx("div",{className:["w-9 h-9 rounded-full mb-2 flex items-center justify-center",P?"bg-violet-100 text-violet-700":"bg-slate-100 text-slate-700"].join(" "),"aria-hidden":!0,children:F.icon}),r.jsxs("div",{className:"text-sm sm:font-medium text-slate-800 flex items-center gap-2",children:[F.title,C==="superadmin"&&r.jsx("span",{}),C==="admin"&&r.jsx("span",{}),C==="teacher"&&r.jsx("span",{})]}),r.jsx("div",{className:"text-xs text-slate-500 hidden sm:block",children:F.subtitle})]},C)}),[t]),I=async C=>{C.preventDefault(),v(""),y(!0);try{const P=d&&d.trim()?{email:a,password:i,schoolCode:d.trim(),role:t}:{email:a,password:i,role:t};await e(P);const F=O.state?.from;E(F??"/",{replace:!0})}catch(P){v(P?.message||"Login failed")}finally{y(!1)}};return r.jsxs("div",{className:"min-h-screen bg-login-gradient relative overflow-hidden",children:[r.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[r.jsx("div",{className:"floating-emoji left-[5%] top-[12%]",children:""}),r.jsx("div",{className:"floating-emoji left-[94%] top-[18%]",children:""}),r.jsx("div",{className:"floating-emoji left-[8%] top-[70%]",children:""}),r.jsx("div",{className:"floating-emoji left-[96%] top-[75%]",children:""})]}),r.jsx("div",{className:"container mx-auto px-4 py-6 sm:py-12",children:r.jsx("div",{className:"max-w-5xl mx-auto bg-white/90 backdrop-blur shadow-2xl rounded-2xl sm:rounded-3xl px-4 sm:px-6 md:px-12 py-6 sm:py-10",children:r.jsxs("div",{className:"grid md:grid-cols-2 gap-6 sm:gap-10 items-center",children:[r.jsxs("div",{className:"space-y-3 sm:space-y-4 flex flex-col items-center text-center",children:[r.jsx("div",{className:"w-32 h-32 sm:w-40 sm:h-40 rounded-2xl sm:rounded-3xl bg-violet-100 flex items-center justify-center overflow-hidden shadow-lg",children:r.jsx("img",{src:"/logo.png",alt:"School Logo",className:"w-28 h-28 sm:w-36 sm:h-36 object-contain"})}),r.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-extrabold",children:r.jsx("span",{className:"bg-gradient-to-r from-fuchsia-500 via-violet-500 to-blue-500 bg-clip-text text-transparent",children:"EduLogix"})}),r.jsx("p",{className:"text-slate-500 text-lg sm:text-xl md:text-2xl font-semibold",children:"Welcome back, superstar! "})]}),r.jsxs("form",{onSubmit:I,className:"space-y-4 sm:space-y-5",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-slate-700 mb-2 sm:mb-3",children:"Choose your adventure "}),r.jsx("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:A})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm text-slate-600",children:"Email Address"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"email",className:"w-full border border-slate-200 rounded-xl px-3 sm:px-4 py-2.5 sm:py-3 pr-10 focus:outline-none focus:ring-2 focus:ring-violet-200 focus:border-violet-400 text-sm sm:text-base",placeholder:"your.email@school.com ",value:a,onChange:C=>s(C.target.value),required:!0,autoComplete:"username"}),r.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm text-slate-600",children:"Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:f?"text":"password",className:"w-full border border-slate-200 rounded-xl px-3 sm:px-4 py-2.5 sm:py-3 pr-12 focus:outline-none focus:ring-2 focus:ring-violet-200 focus:border-violet-400 text-sm sm:text-base",placeholder:"Your super secret password ",value:i,onChange:C=>l(C.target.value),required:!0,autoComplete:"current-password"}),r.jsx("button",{type:"button",onClick:()=>g(C=>!C),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-700","aria-label":f?"Hide password":"Show password",children:f?r.jsx(Wo,{className:"w-5 h-5"}):r.jsx(wn,{className:"w-5 h-5"})})]})]}),t!=="superadmin"&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm text-slate-600",children:"School Code"}),r.jsx("input",{type:"text",className:"w-full border border-slate-200 rounded-xl px-3 sm:px-4 py-2.5 sm:py-3 focus:outline-none focus:ring-2 focus:ring-violet-200 focus:border-violet-400 text-sm sm:text-base",placeholder:"Enter school code (e.g., 'p')",value:d,onChange:C=>u(C.target.value),required:!0})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 sm:gap-0",children:[r.jsxs("label",{className:"flex items-center gap-2 text-xs sm:text-sm text-slate-600",children:[r.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300",checked:m,onChange:C=>p(C.target.checked)}),"Remember me"]}),r.jsx("button",{type:"button",onClick:()=>alert("Hook this to your /auth/forgot-password route"),className:"text-xs sm:text-sm text-slate-600 hover:text-slate-900 text-left sm:text-right",children:"Forgot your password?"})]}),N&&r.jsx("div",{className:"text-sm text-red-600",children:N}),r.jsx("button",{disabled:w,className:`w-full h-10 sm:h-12 rounded-xl text-white text-sm sm:text-base font-medium shadow-lg disabled:opacity-60\r
                  bg-gradient-to-r from-violet-600 via-fuchsia-500 to-blue-500 hover:opacity-95 transition`,children:w?"Signing you in":"Let's Go!"}),r.jsx("p",{className:"text-xs text-slate-500 text-center sm:text-left",children:"Tip: Only SuperAdmin has auto-filled demo credentials. Admin and Teacher require manual entry."})]})]})})})]})}function YQ(){const{user:e}=yr();return e?e.role==="superadmin"?r.jsx(Vs,{to:"/super-admin",replace:!0}):e.role==="admin"?r.jsx(Vs,{to:"/admin",replace:!0}):e.role==="teacher"?r.jsx(Vs,{to:"/teacher",replace:!0}):r.jsx(Vs,{to:"/login",replace:!0}):r.jsx(Vs,{to:"/login",replace:!0})}function KQ(){const{user:e,logout:t}=yr(),n=il();return e?r.jsx("div",{className:"w-full bg-slate-100 border-b",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-2 flex items-center justify-between",children:[r.jsxs("div",{className:"text-sm text-slate-700",children:["Signed in as ",r.jsx("b",{children:e.name})," (",e.role,")"]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(ph,{className:"text-blue-600 hover:underline",to:"/",children:"Home"}),r.jsx("button",{className:"px-3 py-1 rounded-lg bg-slate-800 text-white hover:bg-black",onClick:()=>{t(),n("/login",{replace:!0})},children:"Logout"})]})]})}):null}function GQ(){const{user:e,loading:t,token:n}=yr();return console.log("[APP] Render state:",{hasUser:!!e,userRole:e?.role,hasToken:!!n,loading:t}),r.jsxs(r.Fragment,{children:[r.jsx(KQ,{}),r.jsxs(O4,{children:[r.jsx(Lr,{path:"/login",element:r.jsx(WQ,{})}),r.jsxs(Lr,{element:r.jsx(T6,{}),children:[r.jsx(Lr,{index:!0,element:r.jsx(YQ,{})}),r.jsx(Lr,{element:r.jsx(Fg,{allow:["superadmin"]}),children:r.jsx(Lr,{path:"/super-admin/*",element:r.jsx(VQ,{})})}),r.jsx(Lr,{element:r.jsx(Fg,{allow:["admin"]}),children:r.jsx(Lr,{path:"/admin/*",element:r.jsx(fQ,{})})}),r.jsx(Lr,{element:r.jsx(Fg,{allow:["teacher"]}),children:r.jsx(Lr,{path:"/teacher/*",element:r.jsx(CQ,{})})})]}),r.jsx(Lr,{path:"*",element:r.jsx(Vs,{to:"/",replace:!0})})]})]})}N_.createRoot(document.getElementById("root")).render(r.jsx(N6,{future:{v7_relativeSplatPath:!0,v7_startTransition:!0},children:r.jsxs(P6,{children:[r.jsx(IZ,{position:"top-right"}),r.jsx(GQ,{})]})}));
